<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mermaid Treemap Diagram Demo</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet" />
    <style>
      body {
        font-family: 'Montserrat', sans-serif;
        margin: 0 auto;
        max-width: 900px;
        padding: 20px;
      }
      .mermaid {
        margin: 30px 0;
      }
      h1,
      h2 {
        color: #333;
      }
      pre {
        background-color: #f5f5f5;
        padding: 15px;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <h1>Treemap Diagram Demo</h1>
    <p>This is a demo of the new treemap diagram type in Mermaid.</p>

    <h2>Basic Treemap Example</h2>
    <pre class="mermaid">
treemap
    "Root"
        "Branch 1"
            "Leaf 1.1": 10
            "Leaf 1.2": 15
        "Branch 2"
            "Branch 2.1"
                "Leaf 2.1.1": 20
                "Leaf 2.1.2": 25
            "Leaf 2.2": 25
            "Leaf 2.3": 30
    </pre>

    <h2>Technology Stack Treemap Example</h2>
    <pre class="mermaid">
treemap
    "Technology Stack"
        "Frontend"
            "React": 35
            "CSS": 15
            "HTML": 10
        "Backend"
            "Node.js": 25
            "Express": 10
            "MongoDB": 15
        "DevOps"
            "Docker": 10
            "Kubernetes": 15
            "CI/CD": 5
    </pre>

    <h2>Dark/Light Title Contrast Demo (3rd)</h2>
    <p>
      Toggle the theme and container background to verify the title stays readable on dark
      backgrounds.
    </p>
    <label style="display: inline-flex; gap: 8px; align-items: center; margin-bottom: 8px">
      <input type="checkbox" id="darkToggle" /> Dark mode
    </label>
    <div
      id="themedBox"
      class="themed light"
      style="margin: 10px 0; padding: 16px; border-radius: 8px; border: 1px solid #ccc"
    >
      <div id="treemap3"></div>
    </div>

    <script type="module">
      import mermaid from './mermaid.esm.mjs';
      mermaid.initialize({
        theme: 'forest',
        logLevel: 1,
        securityLevel: 'loose',
        startOnLoad: true,
      });
      await mermaid.run({ querySelector: 'pre.mermaid' });
      // Render with theme toggle
      const baseThirdDiagram = `treemap
title Sales Data Q4 2024
"All Products"
  "Electronics"
    "Laptops": 2000
    "Phones": 1500
    "Tablets": 800
  "Clothing"
    "Women's": 750
    "Men's": 500
    "Kids": 300
  "Home & Garden"
    "Furniture": 400
    "Decor": 200
`;

      async function renderThird(theme) {
        const themedDiagram = `%%{init: {"theme": "${theme}", "securityLevel": "loose"}}%%\n${baseThirdDiagram}`;
        const { svg } = await mermaid.render('treemap3-svg', themedDiagram);
        const el = document.getElementById('treemap3');
        el.innerHTML = svg;
      }

      const box = document.getElementById('themedBox');
      const toggle = document.getElementById('darkToggle');
      function setMode(dark) {
        box.classList.toggle('dark', dark);
        box.classList.toggle('light', !dark);
        box.style.background = dark ? '#0e0f12' : '#ffffff';
        box.style.color = dark ? '#e7e7e7' : '#111111';
      }
      toggle.addEventListener('change', (e) => {
        const dark = e.target.checked;
        setMode(dark);
        renderThird(dark ? 'dark' : 'default');
      });
      setMode(false);
      renderThird('default');
    </script>
  </body>
</html>
