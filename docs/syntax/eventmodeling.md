> **Warning**
>
> ## THIS IS AN AUTOGENERATED FILE. DO NOT EDIT.
>
> ## Please edit the corresponding file in [/packages/mermaid/src/docs/syntax/eventmodeling.md](../../packages/mermaid/src/docs/syntax/eventmodeling.md).

# Event Modeling Diagram (v\<MERMAID_RELEASE_VERSION>+)

## Introduction

> **Event Modeling** (EM) is a method of describing systems using an example of how information has changed within them over time. Event Modeling specifically omits transient details and looks at what the information flow is and what the user sees at any particular point in time.

You can read more at [Event Modeling web page](https://eventmodeling.org/).

Event Modeling diagram is composed of a few main entities:

- Trigger - Screen and Processor
- Command
- View / Read Model
- Event

Entities are organized in swimlanes forming a timeline usually based on the following patterns:

- State View
- State Change
- Translation
- Automation

You can find more details in the [cheat sheet](https://eventmodeling.org/posts/event-modeling-cheatsheet/).

The purpose of the Domain Specific Language (DSL) supporting the drawing of the Event Modeling diagram is the rapid creation. Relations among the entities are inferred by default, so the distraction while you design is limited. Further detail to the entities can be added gradually.

The grammar for the DSL is also maintained in a [separate project](https://github.com/lgazo/event-modeling-dsl) with the intention to provide also different types of output, VS Code (and potentially other) IDEs, etc.

## Basic Syntax

### Timeline

The timeline is the key part of the diagram and it is composed of **Time Frame** definitions using the `tf` token.

```md
eventmodeling

tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded
```

rendering to

```mermaid-example
eventmodeling

tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded

```

```mermaid
eventmodeling

tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded

```

Each Time Frame is referenced by a **unique number**. Depending on the complexity of the diagram it should be enough to have just two digit number or more. The Time Frame contains also an **Entity Identifier**, e.g. in case of `01` Time Frame it is `CartScreen`.

### Inline data

It is possible to provide data examples for individual Time Frames. An Inline Data is wrapped in curly brackets on the same line as the Time Frame.

```mermaid-example
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem { description: string }
tf 03 evt ItemAdded { description: string }
```

```mermaid
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem { description: string }
tf 03 evt ItemAdded { description: string }
```

### Data block

If you need to provide more complex data description, you can define the **Data Block** separately. Data Block is referenced from a Time Frame by providing the identifier inside of double-square brackets `[[identifier]]`.

```mermaid-example
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem [[AddItem02]]
tf 03 evt ItemAdded [[ItemAdded03]]

data AddItem02 {
  description: string
  image: string
  price: number
}

data ItemAdded03 {
  description: string
  image: string
  price: number
}
```

```mermaid
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem [[AddItem02]]
tf 03 evt ItemAdded [[ItemAdded03]]

data AddItem02 {
  description: string
  image: string
  price: number
}

data ItemAdded03 {
  description: string
  image: string
  price: number
}
```

In case the same entity is repeated you need to uniquely identify the data blocks, therefore the Data Block identifier is suffixed with a number.

### Resetting the flow

By default the diagram builds the relations based on the inference. But modeling a more complex business flow requires to break such inference. For that you can use a different type of Time Frame called **Reset Frame**. It is represented by a `rf` token.

```mermaid-example
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded

rf 04 evt External.InventoryChanged
tf 05 pcr InventoryProcessor
tf 06 cmd ChangeInventory
tf 07 evt Cart.InventoryChanged
```

```mermaid
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded

rf 04 evt External.InventoryChanged
tf 05 pcr InventoryProcessor
tf 06 cmd ChangeInventory
tf 07 evt Cart.InventoryChanged
```

### Multiple relations

There are situations where you need to specify multiple relations for an entity. For example when a **Read Model** is built of multiple **Events**. You can use `>f` token for that.

```mermaid-example
eventmodeling


rf 02 evt CartCreated
rf 03 evt ItemAdded
rf 04 evt ItemRemoved
rf 05 evt CartCleared
tf 01 rmo CartScreen >f 02 >f 03 >f 04 >f 05
```

```mermaid
eventmodeling


rf 02 evt CartCreated
rf 03 evt ItemAdded
rf 04 evt ItemRemoved
rf 05 evt CartCleared
tf 01 rmo CartScreen >f 02 >f 03 >f 04 >f 05
```

## Event Modeling patterns

### State Change

```mermaid-example
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded
```

```mermaid
eventmodeling


tf 01 scn CartScreen
tf 02 cmd AddItem
tf 03 evt ItemAdded
```

### State View

```mermaid-example
eventmodeling

tf 03 evt ItemAdded
tf 02 rmo CartItems
tf 04 scn CartScreen
```

```mermaid
eventmodeling

tf 03 evt ItemAdded
tf 02 rmo CartItems
tf 04 scn CartScreen
```

### Translation

```mermaid-example
eventmodeling

tf 03 evt External.InventoryChanged
tf 02 pcr InventoryProcessor
tf 04 cmd ChangeInventory
tf 05 evt Cart.InventoryChanged
```

```mermaid
eventmodeling

tf 03 evt External.InventoryChanged
tf 02 pcr InventoryProcessor
tf 04 cmd ChangeInventory
tf 05 evt Cart.InventoryChanged
```

## Details of the Syntax

### Entity types

Entity type is determined by the third column in the Time Frame grammar.

```md
tf 01 pcr InventoryProcessor
```

Entities are assigned to default swimlanes unless a **Namespace** is specified in the Entity Identifier.

There are the following types available:

- `scn`: Screen - belongs to UI/Automation swimlane
- `pcr`: Processor - belongs to UI/Automation swimlane
- `cmd`: Command - belongs to Command/Read Model swimlane
- `rmo`: Read Model - belongs to Command/Read Model swimlane
- `evt`: Event - belongs to Events swimlane

### Swimlanes and Namespaces

There are three basic **Swimlanes** inferred from the Entity Type.

- UI/Automation
- Command/Read Model
- Events

As your diagram grows and you explore the depths of a particular software system, you want to categorize your Entities as well. In order to do that, you can use **Namespace** identifier as part of the Entity Identifier.

```md
Inventory.InventoryChanged
```

**Namespace** is the first part before the `.` of the Entity Identifier. Each combination of the Namespace and Entity type forms new Swimlane. The order how they are specified in the text definition specifies the order of the Swimlanes in the diagram.

```mermaid-example

eventmodeling

rf 01 evt Inventory.InventoryChanged
rf 02 evt External.InventoryChanged
```

```mermaid

eventmodeling

rf 01 evt Inventory.InventoryChanged
rf 02 evt External.InventoryChanged
```

### Data block data types

A **Data** is always wrapped in curly brackets. It can be prepended by a data type in backticks. The pattern applies for **Inline Data** as well as for **Data Block**.

```md
tf 01 rmo UserAdded `json`{ "name": "foo" }
```

or for Data Block

```md
data UserAdded01 `json`{
"name": "foo"
}
```

> **Warning**
> There is no special treatment in the diagram renderer at the moment for a specific data type.

Supported types are:

- `json`
- `jsobj`
- `figma`
- `salt`
- `uri`
- `md`
- `html`
- `text`
