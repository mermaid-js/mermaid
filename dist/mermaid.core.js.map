{"version":3,"file":"mermaid.core.js","mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;ACVA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,0xCAA0xC;AACryC,aAAa,uyBAAuyB;AACpzB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,iCAAiC;AACjC;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,iDAAiD,wBAAwB;AACzE;AACA;AACA,sBAAsB,mCAAmC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA,kCAAkC;AAClC;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,qCAAqC;AACvD;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,+BAA+B;AACjD;AACA;AACA,kBAAkB,uCAAuC;AACzD;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,+CAA+C;AACjE;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,SAAS,yEAAyE,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,0EAA0E,EAAE,QAAQ,sDAAsD,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,QAAQ,EAAE,uBAAuB,oBAAoB,qNAAqN,EAAE,UAAU,EAAE,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,oBAAoB,eAAe,UAAU,8IAA8I,gFAAgF,GAAG,8CAA8C,8BAA8B,2BAA2B,EAAE,8CAA8C,EAAE,8CAA8C,EAAE,8CAA8C,EAAE,UAAU,eAAe,wDAAwD,gBAAgB,UAAU,oHAAoH,aAAa,EAAE,UAAU,EAAE,SAAS,EAAE,+NAA+N,gBAAgB,wDAAwD,EAAE,4DAA4D,gBAAgB,oBAAoB,eAAe,kCAAkC,oGAAoG,oBAAoB,GAAG,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,oBAAoB,EAAE,2BAA2B,4CAA4C,UAAU,EAAE,UAAU,gBAAgB,8CAA8C,EAAE,wDAAwD,eAAe,kCAAkC,iBAAiB,2BAA2B,EAAE,aAAa,EAAE,8CAA8C,eAAe,UAAU,gBAAgB,qBAAqB,gBAAgB,sBAAsB,gBAAgB,sBAAsB,2DAA2D,+CAA+C,6BAA6B,WAAW,GAAG,WAAW,EAAE,wBAAwB,yDAAyD,WAAW,8BAA8B,WAAW,8BAA8B,WAAW,iBAAiB,cAAc,gBAAgB,UAAU,4CAA4C,WAAW;AACt6F,iBAAiB,sGAAsG;AACvH;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,WAAW;AACX;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA,wCAAwC,mBAAmB;AAC3D;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iBAAiB,yIAAyI,8BAA8B,mBAAmB,yBAAyB,8DAA8D,gCAAgC,yFAAyF,oBAAoB,WAAW,yBAAyB,0fAA0f,EAAE,MAAM,YAAY,EAAE;AACn+B,aAAa,iBAAiB,gCAAgC,mBAAmB,gCAAgC,mBAAmB,8BAA8B,kBAAkB,kCAAkC,kBAAkB,qCAAqC,SAAS,kCAAkC,WAAW,2CAA2C,YAAY,kCAAkC,aAAa,kCAAkC,WAAW,kCAAkC,YAAY;AACpgB,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;ACh4BA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,+vBAA+vB;AAC1wB,aAAa,2aAA2a;AACxb;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,kBAAkB,mCAAmC;AACrD;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA,CAAC;AACD,SAAS,0BAA0B,EAAE,MAAM,cAAc,IAAI,GAAG,0BAA0B,EAAE,cAAc,EAAE,UAAU,EAAE,mFAAmF,EAAE,QAAQ,EAAE,uBAAuB,gCAAgC,QAAQ,gBAAgB,kDAAkD,uDAAuD,kDAAkD,GAAG,UAAU,EAAE,UAAU,mDAAmD,UAAU,EAAE,gBAAgB,EAAE,UAAU,eAAe,aAAa,EAAE,mCAAmC,EAAE,0BAA0B,mGAAmG,aAAa,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,gBAAgB,mCAAmC,EAAE,gBAAgB,EAAE,UAAU,EAAE,kCAAkC,8BAA8B,UAAU,EAAE,0BAA0B,gBAAgB,UAAU,eAAe,6BAA6B,2BAA2B,UAAU,uEAAuE,aAAa;AAC9pC,iBAAiB,mEAAmE;AACpF;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,yBAAyB;AACzB;AACA,qCAAqC;AACrC;AACA,yBAAyB;AACzB;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,0GAA0G,kBAAkB,gCAAgC,oBAAoB,yBAAyB,oBAAoB,gGAAgG,2GAA2G,mCAAmC,cAAc,uCAAuC,aAAa;AAC7gB,aAAa,kBAAkB,8BAA8B,UAAU,8BAA8B,mBAAmB,8BAA8B,mBAAmB,gCAAgC,kBAAkB,gCAAgC,UAAU,iDAAiD,YAAY;AAClU,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;AClxBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,48DAA48D;AACv9D,aAAa,4tCAA4tC;AACzuC;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,6CAA6C,8CAA8C,WAAW;AACtG;AACA;AACA,+CAA+C,gDAAgD,WAAW;AAC1G;AACA;AACA,iCAAiC,aAAa;AAC9C;AACA;AACA,gCAAgC,aAAa;AAC7C;AACA;AACA,iCAAiC;AACjC;AACA;AACA,mCAAmC,qDAAqD;AACxF;AACA;AACA,oBAAoB;AACpB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,+BAA+B,kBAAkB;AACjD;AACA;AACA,uBAAuB;AACvB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,6CAA6C,UAAU;AACvD;AACA;AACA,kCAAkC,UAAU;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,qCAAqC;AACvD;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,+CAA+C;AACjE;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,+BAA+B;AACjD;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,uCAAuC;AACzD;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,8CAA8C;AAChE;AACA;AACA,kBAAkB,4CAA4C;AAC9D;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACD,SAAS,iDAAiD,EAAE,MAAM,EAAE,QAAQ,EAAE,kDAAkD,YAAY,MAAM,GAAG,eAAe,EAAE,2BAA2B,EAAE,2BAA2B,EAAE,oBAAoB,EAAE,SAAS,EAAE,QAAQ,EAAE,sUAAsU,EAAE,sBAAsB,6DAA6D,uCAAuC,sFAAsF,0DAA0D,EAAE,0BAA0B,EAAE,0BAA0B,EAAE,0BAA0B,EAAE,0BAA0B,EAAE,0BAA0B,EAAE,oCAAoC,gBAAgB,UAAU,EAAE,UAAU,eAAe,aAAa,GAAG,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,6KAA6K,2EAA2E,WAAW,gBAAgB,uQAAuQ,kQAAkQ,2BAA2B,EAAE,kBAAkB,0DAA0D,WAAW,gBAAgB,cAAc,iBAAiB,qJAAqJ,6DAA6D,6BAA6B,GAAG,oSAAoS,qJAAqJ,oSAAoS,aAAa,OAAO,4CAA4C,QAAQ,GAAG,4JAA4J,EAAE,+BAA+B,EAAE,2JAA2J,EAAE,gJAAgJ,iBAAiB,sBAAsB,kBAAkB,WAAW,kBAAkB,qJAAqJ,kBAAkB,WAAW,mSAAmS,yIAAyI,EAAE,oSAAoS,EAAE,oSAAoS,EAAE,+SAA+S,EAAE,oSAAoS,EAAE,oSAAoS,EAAE,oSAAoS,EAAE,WAAW,EAAE,oSAAoS,EAAE,+SAA+S,EAAE,oSAAoS,EAAE,oSAAoS,EAAE,oSAAoS,+BAA+B,aAAa,EAAE,SAAS,4CAA4C,cAAc,iBAAiB,WAAW,GAAG,WAAW,EAAE,oSAAoS,EAAE,gSAAgS,qWAAqW,2TAA2T,EAAE,yUAAyU,EAAE,cAAc,EAAE,qJAAqJ,EAAE,WAAW,EAAE,WAAW,EAAE,uBAAuB,kBAAkB,WAAW,EAAE,qJAAqJ,EAAE,qJAAqJ,EAAE,WAAW,iBAAiB,WAAW,GAAG,uBAAuB,EAAE,WAAW,kBAAkB,uBAAuB,eAAe,mIAAmI,GAAG,gSAAgS,EAAE,gSAAgS,EAAE,oSAAoS,EAAE,gSAAgS,EAAE,gSAAgS,EAAE,gSAAgS,EAAE,gSAAgS,EAAE,WAAW,EAAE,gSAAgS,EAAE,gSAAgS,EAAE,oSAAoS,EAAE,gSAAgS,EAAE,2SAA2S,EAAE,2SAA2S,EAAE,2BAA2B,eAAe,QAAQ,iCAAiC,gSAAgS,gCAAgC,oSAAoS,aAAa,OAAO,iBAAiB,+IAA+I,EAAE,sHAAsH,EAAE,sHAAsH,EAAE,kIAAkI,EAAE,kIAAkI,EAAE,YAAY,EAAE,sHAAsH,EAAE,sHAAsH,EAAE,gJAAgJ,kBAAkB,WAAW,iBAAiB,WAAW,kDAAkD,WAAW,+CAA+C,gSAAgS,0DAA0D,WAAW,8BAA8B,gSAAgS,gKAAgK,gSAAgS,EAAE,yUAAyU,+BAA+B,SAAS,kBAAkB,uGAAuG,kNAAkN,SAAS,kBAAkB,SAAS,GAAG,WAAW,iBAAiB,SAAS,GAAG,WAAW,gCAAgC,SAAS,iBAAiB,SAAS,iBAAiB,0IAA0I,mBAAmB,YAAY,EAAE,YAAY,EAAE,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,2BAA2B,gBAAgB,+GAA+G,kBAAkB,gJAAgJ,EAAE,gJAAgJ,gDAAgD,oSAAoS,2BAA2B,OAAO,kBAAkB,uGAAuG,kBAAkB,qJAAqJ,kBAAkB,qJAAqJ,GAAG,gSAAgS,EAAE,yUAAyU,EAAE,sHAAsH,EAAE,sHAAsH,6CAA6C,SAAS,kBAAkB,SAAS;AACz6nB,iBAAiB,mCAAmC;AACpD;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,WAAW;AACX;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,yBAAyB;AACzB;AACA,qCAAqC;AACrC;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qBAAqB;AACrD;AACA,gCAAgC,qBAAqB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iBAAiB,iBAAiB,8BAA8B,mBAAmB,yBAAyB,mBAAmB,+2BAA+2B,21JAA21J,UAAU;AACn1L,aAAa,mBAAmB,6BAA6B,kBAAkB,gCAAgC,mBAAmB,gCAAgC,mBAAmB,8BAA8B,iBAAiB,kCAAkC,iBAAiB,qCAAqC,SAAS,kCAAkC,UAAU,kCAAkC,WAAW,6BAA6B,QAAQ,6DAA6D,mBAAmB,+BAA+B,UAAU,8BAA8B,WAAW,kCAAkC,YAAY;AACnpB,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;ACvhCA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,ikBAAikB;AAC5kB,aAAa,sXAAsX;AACnY;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,aAAa;AACb;AACA;AACA,oCAAoC;AACpC;AACA;AACA,iCAAiC;AACjC;AACA;AACA,iCAAiC;AACjC;AACA;AACA,qCAAqC;AACrC;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,wCAAwC;AACxC;AACA;AACA,gCAAgC;AAChC;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB;AAClB;AACA;AACA,kBAAkB,2CAA2C;AAC7D;AACA;AACA,kBAAkB,+CAA+C;AACjE;AACA;AACA,kBAAkB,yCAAyC;AAC3D;AACA;AACA,kBAAkB,6CAA6C;AAC/D;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA,CAAC;AACD,SAAS,0BAA0B,EAAE,MAAM,EAAE,0BAA0B,cAAc,IAAI,GAAG,cAAc,EAAE,UAAU,EAAE,QAAQ,EAAE,kJAAkJ,EAAE,uBAAuB,gCAAgC,QAAQ,gBAAgB,iHAAiH,qLAAqL,UAAU,gBAAgB,oBAAoB,EAAE,UAAU,EAAE,gBAAgB,EAAE,UAAU,0CAA0C,oBAAoB,gBAAgB,UAAU,iBAAiB,aAAa,EAAE,UAAU,eAAe,UAAU,8BAA8B,UAAU,GAAG,UAAU;AACn7B,iBAAiB,qCAAqC;AACtD;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iBAAiB,kBAAkB,gCAAgC,oBAAoB,0BAA0B,qBAAqB,8TAA8T,2EAA2E,2BAA2B,2BAA2B,6BAA6B,qDAAqD,iCAAiC,2BAA2B,kBAAkB,kBAAkB;AACvvB,aAAa,mBAAmB,6BAA6B,kBAAkB,gCAAgC,mBAAmB,gCAAgC,mBAAmB,8BAA8B,iBAAiB,kCAAkC,iBAAiB,qCAAqC,SAAS,kCAAkC,UAAU,kCAAkC,YAAY;AAC/Z,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;AClwBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,mhBAAmhB,0BAA0B;AACxjB,aAAa,wTAAwT,EAAE;AACvU;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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ACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA,UAAU,wBAAwB,WAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iBAAiB,kBAAkB,gCAAgC,oBAAoB;AACvF,aAAa,mBAAmB,6BAA6B,kBAAkB,gCAAgC,mBAAmB,gCAAgC,mBAAmB,8BAA8B,YAAY,kCAAkC,WAAW,kCAAkC,YAAY;AAC1T,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;ACt5BA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,mHAAmH;AAC9H,aAAa,gDAAgD;AAC7D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,SAAS,YAAY,EAAE,MAAM,cAAc,IAAI,GAAG,iCAAiC,EAAE,QAAQ;AAC7F,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,aAAa,WAAW;AACxB,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;AC7mBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,iSAAiS,mHAAmH;AAC/Z,aAAa,mJAAmJ,2FAA2F;AAC3P;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA,CAAC;AACD,SAAS,mDAAmD,EAAE,MAAM,EAAE,oDAAoD,EAAE,oDAAoD,YAAY,cAAc,6CAA6C,gBAAgB,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,YAAY,yDAAyD,aAAa,KAAK,GAAG,uBAAuB,iCAAiC,0BAA0B,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,0BAA0B,yDAAyD,iBAAiB,gBAAgB,sEAAsE,aAAa,EAAE,UAAU;AAC1sB,iBAAiB,qCAAqC;AACtD;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,0BAA0B;AAC1B;AACA,sCAAsC;AACtC;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iBAAiB,kBAAkB,gCAAgC,oBAAoB,0BAA0B,oBAAoB;AACrI,aAAa,mBAAmB,6BAA6B,kBAAkB,gCAAgC,mBAAmB,gCAAgC,mBAAmB,8BAA8B,mBAAmB,+BAA+B,UAAU,+BAA+B,WAAW,kCAAkC,YAAY;AACvW,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;AC3pBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,4kCAA4kC;AACvlC,aAAa,wtBAAwtB;AACruB;AACA;AACA;;AAEA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA,2CAA2C;AAC3C;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,SAAS,uCAAuC,EAAE,MAAM,EAAE,+CAA+C,EAAE,SAAS,EAAE,gBAAgB,4BAA4B,SAAS,EAAE,wCAAwC,EAAE,QAAQ,EAAE,4IAA4I,EAAE,uBAAuB,mBAAmB,QAAQ,EAAE,SAAS,EAAE,4IAA4I,EAAE,4IAA4I,EAAE,4IAA4I,EAAE,4IAA4I,EAAE,4IAA4I,EAAE,0BAA0B,EAAE,0BAA0B,EAAE,oBAAoB,+HAA+H,gBAAgB,gBAAgB,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,uDAAuD,EAAE,uDAAuD,EAAE,aAAa,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,oGAAoG,UAAU,eAAe,+CAA+C,EAAE,iCAAiC,EAAE,oBAAoB,EAAE,oBAAoB,gBAAgB,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,+CAA+C,8BAA8B,UAAU,EAAE,UAAU,EAAE,iCAAiC,4CAA4C,oBAAoB,EAAE,0BAA0B,EAAE,oCAAoC,EAAE,+CAA+C,gBAAgB,6BAA6B,EAAE,6BAA6B,gBAAgB,UAAU,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,gDAAgD,EAAE,gDAAgD,EAAE,gDAAgD,EAAE,gDAAgD,EAAE,kCAAkC,EAAE,kCAAkC;AAC10F,iBAAiB,6QAA6Q;AAC9R;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,CAAC;AACD,iBAAiB,kBAAkB,gCAAgC,oBAAoB,gCAAgC,iCAAiC,iHAAiH,WAAW,qoBAAqoB;AACz5B,aAAa,mBAAmB,6BAA6B,kBAAkB,gCAAgC,mBAAmB,gCAAgC,mBAAmB,8BAA8B,cAAc,6BAA6B,UAAU,6BAA6B,WAAW,kCAAkC,YAAY;AAC9V,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;ACzyBA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,2iCAA2iC;AACtjC,aAAa,0pBAA0pB;AACvqB;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,gDAAgD;AAC/E;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,yBAAyB,gDAAgD;AACzE;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,UAAU;AACV;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA,iCAAiC;AACjC;AACA;AACA,iCAAiC;AACjC;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA,oBAAoB,0FAA0F;AAC9G,iBAAiB,qEAAqE;AACtF;AACA;AACA;AACA;AACA,oBAAoB,wFAAwF;AAC5G,iBAAiB,oFAAoF;AACrG;AACA;AACA;AACA;AACA,oBAAoB,uFAAuF;AAC3G,iBAAiB,mFAAmF;AACpG;AACA;AACA;AACA;AACA;AACA,oBAAoB,uFAAuF;AAC3G;AACA;AACA,iBAAiB,gDAAgD;AACjE;AACA;AACA;AACA;AACA;AACA,oBAAoB,uFAAuF;AAC3G;AACA;AACA,iBAAiB,gDAAgD;AACjE;AACA;AACA;AACA,4BAA4B,gFAAgF;AAC5G;AACA;AACA,4BAA4B,kFAAkF;AAC9G;AACA;AACA;AACA,uBAAuB,sEAAsE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qFAAqF;AAC5G;AACA;AACA;AACA,uBAAuB,mDAAmD;AAC1E;AACA;AACA;AACA;AACA,uBAAuB,mDAAmD;AAC1E;AACA;AACA;AACA;AACA,uBAAuB,wDAAwD;AAC/E;AACA;AACA;AACA;AACA,uBAAuB,qDAAqD;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4FAA4F;AAC1H,gBAAgB;AAChB;AACA;AACA;AACA,8BAA8B,4FAA4F;AAC1H,eAAe;AACf;AACA;AACA;AACA,8BAA8B,4FAA4F;AAC1H;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA,CAAC;AACD,SAAS,sCAAsC,EAAE,MAAM,EAAE,sCAAsC,EAAE,sCAAsC,EAAE,uCAAuC,4EAA4E,KAAK,GAAG,gBAAgB,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,+NAA+N,EAAE,uBAAuB,iCAAiC,sMAAsM,4BAA4B,aAAa,EAAE,aAAa,EAAE,SAAS,EAAE,6BAA6B,EAAE,aAAa,EAAE,aAAa,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,4CAA4C,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,gBAAgB,sFAAsF,EAAE,oCAAoC,EAAE,aAAa,EAAE,aAAa,EAAE,aAAa,EAAE,aAAa,iDAAiD,SAAS,EAAE,gBAAgB,EAAE,SAAS,eAAe,mBAAmB,EAAE,mBAAmB,gBAAgB,mBAAmB,EAAE,SAAS,gBAAgB,SAAS,EAAE,SAAS,kFAAkF,KAAK,aAAa,KAAK,aAAa,KAAK,aAAa,YAAY,aAAa,aAAa,GAAG,oCAAoC,kHAAkH,cAAc,EAAE,qBAAqB,EAAE,UAAU,EAAE,UAAU,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,gBAAgB,cAAc,EAAE,UAAU,EAAE,WAAW,gBAAgB,WAAW,gBAAgB,UAAU,0DAA0D,kOAAkO,EAAE,kOAAkO,EAAE,kOAAkO,EAAE,WAAW,EAAE,4OAA4O,EAAE,WAAW,EAAE,4OAA4O,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,qBAAqB,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,wEAAwE,WAAW,gBAAgB,WAAW,EAAE,cAAc,EAAE,cAAc,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,cAAc,sDAAsD,aAAa,aAAa,aAAa,GAAG,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU;AACvwH,iBAAiB,yNAAyN;AAC1O;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA,2BAA2B;AAC3B;AACA,yCAAyC,qBAAqB;AAC9D;AACA,0BAA0B,iBAAiB,oBAAoB;AAC/D;AACA,0BAA0B,iBAAiB;AAC3C;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,6BAA6B;AAC7B;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iBAAiB,kBAAkB,gCAAgC,oBAAoB,uFAAuF,oBAAoB,iFAAiF,iCAAiC,sKAAsK,uNAAuN,yBAAyB,iCAAiC,mFAAmF,qBAAqB,yCAAyC,4IAA4I;AACxgC,aAAa,kBAAkB,gCAAgC,mBAAmB,kCAAkC,kBAAkB,kCAAkC,OAAO,mCAAmC,UAAU,sCAAsC,SAAS,mCAAmC,YAAY;AAC1T,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;AC74BA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,ylBAAylB,qJAAqJ;AACzvB,aAAa,wZAAwZ,6HAA6H;AACliB;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,yBAAyB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,WAAW;AACvD;AACA;AACA,6DAA6D,WAAW;AACxE;AACA;AACA;AACA,2CAA2C,iCAAiC;AAC5E,iBAAiB,4BAA4B,+DAA+D,WAAW;AACvH;AACA;AACA;AACA;AACA,sEAAsE;AACtE,iBAAiB,4BAA4B,+DAA+D,WAAW,8DAA8D;AACrL;AACA;AACA;AACA;AACA,2EAA2E;AAC3E,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G,kBAAkB;AAClB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,6GAA6G;AAC7G,iBAAiB,0CAA0C;AAC3D;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA,CAAC;AACD,SAAS,sCAAsC,EAAE,MAAM,EAAE,sCAAsC,EAAE,sCAAsC,EAAE,uCAAuC,sEAAsE,KAAK,GAAG,gBAAgB,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,mLAAmL,EAAE,uBAAuB,iCAAiC,0JAA0J,yCAAyC,oBAAoB,iBAAiB,UAAU,eAAe,UAAU,GAAG,UAAU,0DAA0D,oCAAoC,8BAA8B,UAAU,EAAE,UAAU,oGAAoG,gBAAgB,2CAA2C,oBAAoB,0BAA0B,KAAK,GAAG,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,8BAA8B,aAAa,EAAE,UAAU,eAAe,UAAU,GAAG,qLAAqL,eAAe,UAAU,GAAG,UAAU,EAAE,UAAU,sDAAsD,KAAK,+BAA+B,qLAAqL;AACzyD,iBAAiB,gEAAgE;AACjF;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA,6BAA6B,kCAAkC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,wCAAwC;AAC1E;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,0BAA0B;AAC1B;AACA,sCAAsC;AACtC;AACA,0BAA0B;AAC1B;AACA,gEAAgE;AAChE;AACA,wBAAwB,0CAA0C,yCAAyC;AAC3G;AACA,wBAAwB,yCAAyC,yCAAyC;AAC1G;AACA,wBAAwB,0CAA0C,yCAAyC;AAC3G;AACA,wBAAwB,yCAAyC,yCAAyC;AAC1G;AACA,wBAAwB,yCAAyC,yCAAyC;AAC1G;AACA,wBAAwB,0CAA0C,yCAAyC;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA,wBAAwB,2BAA2B;AACnD;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA,wDAAwD;AACxD;AACA,oDAAoD;AACpD;AACA;AACA;AACA,wBAAwB,0BAA0B,0CAA0C;AAC5F;AACA,wCAAwC,oBAAoB;AAC5D;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,yBAAyB,0BAA0B;AACnD;AACA,yBAAyB,0BAA0B;AACnD;AACA,yBAAyB;AACzB;AACA,wBAAwB,mCAAmC;AAC3D;AACA;AACA;AACA,2DAA2D;AAC3D;AACA,wBAAwB,8CAA8C;AACtE;AACA,yBAAyB,4BAA4B,6CAA6C;AAClG;AACA,yBAAyB,mDAAmD,2CAA2C;AACvH;AACA,yBAAyB,mDAAmD,6CAA6C;AACzH;AACA,4DAA4D;AAC5D;AACA,4DAA4D;AAC5D;AACA,qDAAqD;AACrD;AACA,iDAAiD;AACjD;AACA,2CAA2C;AAC3C;AACA,yCAAyC,sCAAsC;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,6IAA6I,kBAAkB,gCAAgC,oBAAoB,0BAA0B,oBAAoB,6hBAA6hB,6CAA6C,wBAAwB,WAAW,gLAAgL,oJAAoJ,qBAAqB;AACvsC,aAAa,QAAQ,kCAAkC,oBAAoB,kCAAkC,kBAAkB,sCAAsC,mBAAmB,sCAAsC,mBAAmB,oCAAoC,WAAW,yEAAyE,qBAAqB,+BAA+B,kBAAkB,qCAAqC,cAAc,kCAAkC,YAAY,+BAA+B,SAAS,qCAAqC,mBAAmB,+BAA+B,UAAU,+BAA+B,UAAU,kCAAkC,UAAU,6BAA6B,aAAa,+BAA+B,iBAAiB,kCAAkC,eAAe,6BAA6B,UAAU,mEAAmE,OAAO,kCAAkC,YAAY;AACxhC,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,CAAC;;;AAGD,IAAI,IAAgE;AACpE,cAAc;AACd,cAAc;AACd,aAAa,iBAAiB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,qDAA0B,CAAC,sFAAyB;AACrE;AACA;AACA,IAAI,KAA6B,IAAI,4CAAY;AACjD;AACA;AACA;;;;;;;;;;;ACl1BA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA,eAAe,kCAAkC;AACjD,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,qBAAqB,IAAI;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oJAAoJ;AACpJ,SAAS;;AAET;AACA;AACA,qBAAqB,+BAA+B;AACpD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,WAAW,YAAY,IAAI,WAAW,SAAS;AACvE,cAAc,4BAA4B;AAC1C,MAAM;AACN,WAAW,kXAAkX;AAC7X,aAAa,oNAAoN;AACjO;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,2CAA2C;AAC3C;AACA;AACA,gCAAgC;AAChC;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,qBAAqB;AACrB;AACA;AACA,CAAC;AACD,SAAS,0BAA0B,EAAE,MAAM,cAAc,IAAI,GAAG,0BAA0B,EAAE,cAAc,EAAE,UAAU,EAAE,oFAAoF,EAAE,QAAQ,EAAE,uBAAuB,gCAAgC,QAAQ,gBAAgB,mDAAmD,sEAAsE,UAAU,gBAAgB,UAAU,EAAE,gBAAgB,EAAE,UAAU,0CAA0C,aAAa,EAAE,UAAU,EAAE,UAAU;AACjjB,iBAAiB,qCAAqC;AACtD;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kCAAkC;AAClC,sBAAsB;AACtB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL,sDAAsD;AACtD;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL,UAAU,wBAAwB;AAClC;AACA;AACA;AACA,sCAAsC;AACtC;AACA,sCAAsC;AACtC;AACA,yBAAyB,6BAA6B;AACtD;AACA,yBAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEsa,EAAAA,QAAQ,EAAE,CAxCG;;AA0Cb;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEV,EAAAA,aAAa,EAAE,QAtDF;;AAwDb;AACF;AACA;AACA;AACA;AACA;AACA;AACEW,EAAAA,WAAW,EAAE,IA/DA;;AAiEb;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEpP,EAAAA,mBAAmB,EAAE,KA5ER;;AA8Eb;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE1L,EAAAA,MAAM,EAAE,CAAC,QAAD,EAAW,eAAX,EAA4B,aAA5B,EAA2C,aAA3C,CAxFK;;AA0Fb;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE+a,EAAAA,gBAAgB,EAAE,KAtGL;;AAwGb;AACF;AACA;AACA;AACA;AACEC,EAAAA,mBAAmB,EAAExZ,SA7GR;;AA+Gb;AACAG,EAAAA,SAAS,EAAE;AACT;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIsZ,IAAAA,cAAc,EAAE,CAbP;;AAeT;AACJ;AACA;AACA;AACA;AACA;AACA;AACIrZ,IAAAA,UAAU,EAAE,IAtBH;;AAwBT;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIsZ,IAAAA,WAAW,EAAE,EApCJ;;AAsCT;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,WAAW,EAAE,EAlDJ;;AAoDT;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIjQ,IAAAA,KAAK,EAAE,OA7DE;AA8DT;AACA;AACA/I,IAAAA,OAAO,EAAE,EAhEA;;AAkET;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIiZ,IAAAA,WAAW,EAAE,IA9EJ;;AAgFT;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,eAAe,EAAE;AA5FR,GAhHE;;AA+Mb;AACAC,EAAAA,QAAQ,EAAE;AACR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,eAAe,EAAE,EART;;AAUR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,cAAc,EAAE,EAjBR;;AAmBR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,cAAc,EAAE,EA1BR;;AA4BR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,WAAW,EAAE,EAnCL;;AAqCR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIzZ,IAAAA,KAAK,EAAE,GA5CC;;AA8CR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,MAAM,EAAE,EArDA;;AAuDR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIyZ,IAAAA,SAAS,EAAE,EA9DH;;AAgER;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,aAAa,EAAE,CAvEP;;AAyER;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,UAAU,EAAE,EAhFJ;;AAkFR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,aAAa,EAAE,EAzFP;;AA2FR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,YAAY,EAAE,QAlGN;;AAoGR;AACJ;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,YAAY,EAAE,IA3GN;;AA6GR;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,UAAU,EAAE,KAtHJ;;AAwHR;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,eAAe,EAAE,CAnIT;;AAqIR;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACId,IAAAA,WAAW,EAAE,IA/IL;;AAiJR;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIe,IAAAA,WAAW,EAAE,KA5JL;;AA8JR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ACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,8BAA8B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,yBAAyB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,qBAAqB;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,YAAY;AACZ;AACA,sCAAsC;AACtC;AACA;AACA,UAAU;AACV;AACA;AACA,iDAAiD;AACjD;AACA,YAAY;AACZ;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4CAA4C,cAAc;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gCAAgC,QAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gDAAgD;AAChD;AACA,MAAM;AACN,gCAAgC,QAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,WAAW,YAAY;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oFAAoF;AACpF;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA,8DAA8D;;AAE9D;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;;;;;;;;;;AChhBA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;;;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WC5BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;WACA;WACA;WACA;WACA;;;;;UEJA;UACA;UACA;UACA","sources":["webpack://mermaid/webpack/universalModuleDefinition","webpack://mermaid/./src/diagrams/class/parser/classDiagram.jison","webpack://mermaid/./src/diagrams/er/parser/erDiagram.jison","webpack://mermaid/./src/diagrams/flowchart/parser/flow.jison","webpack://mermaid/./src/diagrams/gantt/parser/gantt.jison","webpack://mermaid/./src/diagrams/git/parser/gitGraph.jison","webpack://mermaid/./src/diagrams/info/parser/info.jison","webpack://mermaid/./src/diagrams/pie/parser/pie.jison","webpack://mermaid/./src/diagrams/requirement/parser/requirementDiagram.jison","webpack://mermaid/./src/diagrams/sequence/parser/sequenceDiagram.jison","webpack://mermaid/./src/diagrams/state/parser/stateDiagram.jison","webpack://mermaid/./src/diagrams/user-journey/parser/journey.jison","webpack://mermaid/./src/accessibility.js","webpack://mermaid/./src/config.js","webpack://mermaid/./src/dagre-wrapper/clusters.js","webpack://mermaid/./src/dagre-wrapper/createLabel.js","webpack://mermaid/./src/dagre-wrapper/edges.js","webpack://mermaid/./src/dagre-wrapper/index.js","webpack://mermaid/./src/dagre-wrapper/intersect/index.js","webpack://mermaid/./src/dagre-wrapper/intersect/intersect-circle.js","webpack://mermaid/./src/dagre-wrapper/intersect/intersect-ellipse.js","webpack://mermaid/./src/dagre-wrapper/intersect/intersect-line.js","webpack://mermaid/./src/dagre-wrapper/intersect/intersect-node.js","webpack://mermaid/./src/dagre-wrapper/intersect/intersect-polygon.js","webpack://mermaid/./src/dagre-wrapper/intersect/intersect-rect.js","webpack://mermaid/./src/dagre-wrapper/markers.js","webpack://mermaid/./src/dagre-wrapper/mermaid-graphlib.js","webpack://mermaid/./src/dagre-wrapper/nodes.js","webpack://mermaid/./src/dagre-wrapper/shapes/note.js","webpack://mermaid/./src/dagre-wrapper/shapes/util.js","webpack://mermaid/./src/defaultConfig.js","webpack://mermaid/./src/diagrams/class/classDb.js","webpack://mermaid/./src/diagrams/class/classRenderer-v2.js","webpack://mermaid/./src/diagrams/class/classRenderer.js","webpack://mermaid/./src/diagrams/class/styles.js","webpack://mermaid/./src/diagrams/class/svgDraw.js","webpack://mermaid/./src/diagrams/common/common.js","webpack://mermaid/./src/diagrams/er/erDb.js","webpack://mermaid/./src/diagrams/er/erMarkers.js","webpack://mermaid/./src/diagrams/er/erRenderer.js","webpack://mermaid/./src/diagrams/er/styles.js","webpack://mermaid/./src/diagrams/flowchart/flowChartShapes.js","webpack://mermaid/./src/diagrams/flowchart/flowDb.js","webpack://mermaid/./src/diagrams/flowchart/flowRenderer-v2.js","webpack://mermaid/./src/diagrams/flowchart/flowRenderer.js","webpack://mermaid/./src/diagrams/flowchart/styles.js","webpack://mermaid/./src/diagrams/gantt/ganttDb.js","webpack://mermaid/./src/diagrams/gantt/ganttRenderer.js","webpack://mermaid/./src/diagrams/gantt/styles.js","webpack://mermaid/./src/diagrams/git/gitGraphAst.js","webpack://mermaid/./src/diagrams/git/gitGraphRenderer.js","webpack://mermaid/./src/diagrams/git/styles.js","webpack://mermaid/./src/diagrams/info/infoDb.js","webpack://mermaid/./src/diagrams/info/infoRenderer.js","webpack://mermaid/./src/diagrams/info/styles.js","webpack://mermaid/./src/diagrams/pie/pieDb.js","webpack://mermaid/./src/diagrams/pie/pieRenderer.js","webpack://mermaid/./src/diagrams/pie/styles.js","webpack://mermaid/./src/diagrams/requirement/requirementDb.js","webpack://mermaid/./src/diagrams/requirement/requirementMarkers.js","webpack://mermaid/./src/diagrams/requirement/requirementRenderer.js","webpack://mermaid/./src/diagrams/requirement/styles.js","webpack://mermaid/./src/diagrams/sequence/sequenceDb.js","webpack://mermaid/./src/diagrams/sequence/sequenceRenderer.js","webpack://mermaid/./src/diagrams/sequence/styles.js","webpack://mermaid/./src/diagrams/sequence/svgDraw.js","webpack://mermaid/./src/diagrams/state/id-cache.js","webpack://mermaid/./src/diagrams/state/shapes.js","webpack://mermaid/./src/diagrams/state/stateDb.js","webpack://mermaid/./src/diagrams/state/stateRenderer-v2.js","webpack://mermaid/./src/diagrams/state/stateRenderer.js","webpack://mermaid/./src/diagrams/state/styles.js","webpack://mermaid/./src/diagrams/user-journey/journeyDb.js","webpack://mermaid/./src/diagrams/user-journey/journeyRenderer.js","webpack://mermaid/./src/diagrams/user-journey/styles.js","webpack://mermaid/./src/diagrams/user-journey/svgDraw.js","webpack://mermaid/./src/errorRenderer.js","webpack://mermaid/./src/interactionDb.js","webpack://mermaid/./src/logger.js","webpack://mermaid/./src/mermaid.js","webpack://mermaid/./src/mermaidAPI.js","webpack://mermaid/./src/styles.js","webpack://mermaid/./src/themes/index.js","webpack://mermaid/./src/themes/theme-base.js","webpack://mermaid/./src/themes/theme-dark.js","webpack://mermaid/./src/themes/theme-default.js","webpack://mermaid/./src/themes/theme-forest.js","webpack://mermaid/./src/themes/theme-helpers.js","webpack://mermaid/./src/themes/theme-neutral.js","webpack://mermaid/./src/utils.js","webpack://mermaid/./node_modules/path-browserify/index.js","webpack://mermaid/external commonjs \"@braintree/sanitize-url\"","webpack://mermaid/external commonjs \"d3\"","webpack://mermaid/external commonjs \"dagre\"","webpack://mermaid/external commonjs \"dagre-d3\"","webpack://mermaid/external commonjs \"dagre-d3/lib/label/add-html-label.js\"","webpack://mermaid/external commonjs \"dompurify\"","webpack://mermaid/external commonjs \"graphlib\"","webpack://mermaid/external commonjs \"khroma\"","webpack://mermaid/external commonjs \"moment-mini\"","webpack://mermaid/external commonjs \"stylis\"","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\class\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\er\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\flowchart\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\gantt\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\git\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\info\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\pie\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\requirement\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\sequence\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\state\\parser|fs","webpack://mermaid/ignored|C:\\DATA\\code\\mermaid\\src\\diagrams\\user-journey\\parser|fs","webpack://mermaid/webpack/bootstrap","webpack://mermaid/webpack/runtime/compat get default export","webpack://mermaid/webpack/runtime/define property getters","webpack://mermaid/webpack/runtime/hasOwnProperty shorthand","webpack://mermaid/webpack/runtime/make namespace object","webpack://mermaid/webpack/runtime/node module decorator","webpack://mermaid/webpack/before-startup","webpack://mermaid/webpack/startup","webpack://mermaid/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"mermaid\"] = factory();\n\telse\n\t\troot[\"mermaid\"] = factory();\n})(typeof self !== \"undefined\" ? self : this, () => {\nreturn ","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,3],$V1=[1,7],$V2=[1,8],$V3=[1,9],$V4=[1,10],$V5=[1,13],$V6=[1,12],$V7=[1,16,25],$V8=[1,20],$V9=[1,31],$Va=[1,32],$Vb=[1,34],$Vc=[1,37],$Vd=[1,35],$Ve=[1,36],$Vf=[1,38],$Vg=[1,39],$Vh=[1,40],$Vi=[1,41],$Vj=[1,44],$Vk=[1,45],$Vl=[1,46],$Vm=[1,47],$Vn=[16,25],$Vo=[1,59],$Vp=[1,60],$Vq=[1,61],$Vr=[1,62],$Vs=[1,63],$Vt=[1,64],$Vu=[16,25,32,41,42,50,53,54,55,56,57,58,63,65],$Vv=[16,25,30,32,41,42,46,50,53,54,55,56,57,58,63,65,80,81,82,83],$Vw=[5,8,9,10,11,16,19,23,25],$Vx=[50,80,81,82,83],$Vy=[50,57,58,80,81,82,83],$Vz=[50,53,54,55,56,80,81,82,83],$VA=[16,25,32],$VB=[1,96];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"mermaidDoc\":4,\"statments\":5,\"direction\":6,\"directive\":7,\"direction_tb\":8,\"direction_bt\":9,\"direction_rl\":10,\"direction_lr\":11,\"graphConfig\":12,\"openDirective\":13,\"typeDirective\":14,\"closeDirective\":15,\"NEWLINE\":16,\":\":17,\"argDirective\":18,\"open_directive\":19,\"type_directive\":20,\"arg_directive\":21,\"close_directive\":22,\"CLASS_DIAGRAM\":23,\"statements\":24,\"EOF\":25,\"statement\":26,\"className\":27,\"alphaNumToken\":28,\"classLiteralName\":29,\"GENERICTYPE\":30,\"relationStatement\":31,\"LABEL\":32,\"classStatement\":33,\"methodStatement\":34,\"annotationStatement\":35,\"clickStatement\":36,\"cssClassStatement\":37,\"title\":38,\"accDescription\":39,\"CLASS\":40,\"STYLE_SEPARATOR\":41,\"STRUCT_START\":42,\"members\":43,\"STRUCT_STOP\":44,\"ANNOTATION_START\":45,\"ANNOTATION_END\":46,\"MEMBER\":47,\"SEPARATOR\":48,\"relation\":49,\"STR\":50,\"relationType\":51,\"lineType\":52,\"AGGREGATION\":53,\"EXTENSION\":54,\"COMPOSITION\":55,\"DEPENDENCY\":56,\"LINE\":57,\"DOTTED_LINE\":58,\"CALLBACK\":59,\"LINK\":60,\"LINK_TARGET\":61,\"CLICK\":62,\"CALLBACK_NAME\":63,\"CALLBACK_ARGS\":64,\"HREF\":65,\"CSSCLASS\":66,\"commentToken\":67,\"textToken\":68,\"graphCodeTokens\":69,\"textNoTagsToken\":70,\"TAGSTART\":71,\"TAGEND\":72,\"==\":73,\"--\":74,\"PCT\":75,\"DEFAULT\":76,\"SPACE\":77,\"MINUS\":78,\"keywords\":79,\"UNICODE_TEXT\":80,\"NUM\":81,\"ALPHA\":82,\"BQUOTE_STR\":83,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",5:\"statments\",8:\"direction_tb\",9:\"direction_bt\",10:\"direction_rl\",11:\"direction_lr\",16:\"NEWLINE\",17:\":\",19:\"open_directive\",20:\"type_directive\",21:\"arg_directive\",22:\"close_directive\",23:\"CLASS_DIAGRAM\",25:\"EOF\",30:\"GENERICTYPE\",32:\"LABEL\",38:\"title\",39:\"accDescription\",40:\"CLASS\",41:\"STYLE_SEPARATOR\",42:\"STRUCT_START\",44:\"STRUCT_STOP\",45:\"ANNOTATION_START\",46:\"ANNOTATION_END\",47:\"MEMBER\",48:\"SEPARATOR\",50:\"STR\",53:\"AGGREGATION\",54:\"EXTENSION\",55:\"COMPOSITION\",56:\"DEPENDENCY\",57:\"LINE\",58:\"DOTTED_LINE\",59:\"CALLBACK\",60:\"LINK\",61:\"LINK_TARGET\",62:\"CLICK\",63:\"CALLBACK_NAME\",64:\"CALLBACK_ARGS\",65:\"HREF\",66:\"CSSCLASS\",69:\"graphCodeTokens\",71:\"TAGSTART\",72:\"TAGEND\",73:\"==\",74:\"--\",75:\"PCT\",76:\"DEFAULT\",77:\"SPACE\",78:\"MINUS\",79:\"keywords\",80:\"UNICODE_TEXT\",81:\"NUM\",82:\"ALPHA\",83:\"BQUOTE_STR\"},\nproductions_: [0,[3,1],[3,1],[3,1],[3,2],[6,1],[6,1],[6,1],[6,1],[4,1],[7,4],[7,6],[13,1],[14,1],[18,1],[15,1],[12,4],[24,1],[24,2],[24,3],[27,1],[27,1],[27,2],[27,2],[27,2],[26,1],[26,2],[26,1],[26,1],[26,1],[26,1],[26,1],[26,1],[26,1],[26,1],[26,1],[33,2],[33,4],[33,5],[33,7],[35,4],[43,1],[43,2],[34,1],[34,2],[34,1],[34,1],[31,3],[31,4],[31,4],[31,5],[49,3],[49,2],[49,2],[49,1],[51,1],[51,1],[51,1],[51,1],[52,1],[52,1],[36,3],[36,4],[36,3],[36,4],[36,4],[36,5],[36,3],[36,4],[36,4],[36,5],[36,3],[36,4],[36,4],[36,5],[37,3],[67,1],[67,1],[68,1],[68,1],[68,1],[68,1],[68,1],[68,1],[68,1],[70,1],[70,1],[70,1],[70,1],[28,1],[28,1],[28,1],[29,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 5:\n yy.setDirection('TB');\nbreak;\ncase 6:\n yy.setDirection('BT');\nbreak;\ncase 7:\n yy.setDirection('RL');\nbreak;\ncase 8:\n yy.setDirection('LR');\nbreak;\ncase 12:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 13:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 14:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 15:\n yy.parseDirective('}%%', 'close_directive', 'class'); \nbreak;\ncase 20: case 21:\n this.$=$$[$0]; \nbreak;\ncase 22:\n this.$=$$[$0-1]+$$[$0]; \nbreak;\ncase 23: case 24:\n this.$=$$[$0-1]+'~'+$$[$0]; \nbreak;\ncase 25:\n yy.addRelation($$[$0]); \nbreak;\ncase 26:\n $$[$0-1].title =  yy.cleanupLabel($$[$0]); yy.addRelation($$[$0-1]);        \nbreak;\ncase 34:\nyy.setTitle($$[$0].substring(6));this.$=$$[$0].substring(6);\nbreak;\ncase 35:\nyy.setAccDescription($$[$0].substring(15));this.$=$$[$0].substring(15);\nbreak;\ncase 36:\nyy.addClass($$[$0]);\nbreak;\ncase 37:\nyy.addClass($$[$0-2]);yy.setCssClass($$[$0-2], $$[$0]);\nbreak;\ncase 38:\n/*console.log($$[$0-3],JSON.stringify($$[$0-1]));*/yy.addClass($$[$0-3]);yy.addMembers($$[$0-3],$$[$0-1]);\nbreak;\ncase 39:\nyy.addClass($$[$0-5]);yy.setCssClass($$[$0-5], $$[$0-3]);yy.addMembers($$[$0-5],$$[$0-1]);\nbreak;\ncase 40:\n yy.addAnnotation($$[$0],$$[$0-2]); \nbreak;\ncase 41:\n this.$ = [$$[$0]]; \nbreak;\ncase 42:\n $$[$0].push($$[$0-1]);this.$=$$[$0];\nbreak;\ncase 43:\n/*console.log('Rel found',$$[$0]);*/\nbreak;\ncase 44:\nyy.addMember($$[$0-1],yy.cleanupLabel($$[$0]));\nbreak;\ncase 45:\n/*console.warn('Member',$$[$0]);*/\nbreak;\ncase 46:\n/*console.log('sep found',$$[$0]);*/\nbreak;\ncase 47:\n this.$ = {'id1':$$[$0-2],'id2':$$[$0], relation:$$[$0-1], relationTitle1:'none', relationTitle2:'none'}; \nbreak;\ncase 48:\n this.$ = {id1:$$[$0-3], id2:$$[$0], relation:$$[$0-1], relationTitle1:$$[$0-2], relationTitle2:'none'}\nbreak;\ncase 49:\n this.$ = {id1:$$[$0-3], id2:$$[$0], relation:$$[$0-2], relationTitle1:'none', relationTitle2:$$[$0-1]}; \nbreak;\ncase 50:\n this.$ = {id1:$$[$0-4], id2:$$[$0], relation:$$[$0-2], relationTitle1:$$[$0-3], relationTitle2:$$[$0-1]} \nbreak;\ncase 51:\n this.$={type1:$$[$0-2],type2:$$[$0],lineType:$$[$0-1]}; \nbreak;\ncase 52:\n this.$={type1:'none',type2:$$[$0],lineType:$$[$0-1]}; \nbreak;\ncase 53:\n this.$={type1:$$[$0-1],type2:'none',lineType:$$[$0]}; \nbreak;\ncase 54:\n this.$={type1:'none',type2:'none',lineType:$$[$0]}; \nbreak;\ncase 55:\n this.$=yy.relationType.AGGREGATION;\nbreak;\ncase 56:\n this.$=yy.relationType.EXTENSION;\nbreak;\ncase 57:\n this.$=yy.relationType.COMPOSITION;\nbreak;\ncase 58:\n this.$=yy.relationType.DEPENDENCY;\nbreak;\ncase 59:\nthis.$=yy.lineType.LINE;\nbreak;\ncase 60:\nthis.$=yy.lineType.DOTTED_LINE;\nbreak;\ncase 61: case 67:\nthis.$ = $$[$0-2];yy.setClickEvent($$[$0-1], $$[$0]);\nbreak;\ncase 62: case 68:\nthis.$ = $$[$0-3];yy.setClickEvent($$[$0-2], $$[$0-1]);yy.setTooltip($$[$0-2], $$[$0]);\nbreak;\ncase 63: case 71:\nthis.$ = $$[$0-2];yy.setLink($$[$0-1], $$[$0]);\nbreak;\ncase 64:\nthis.$ = $$[$0-3];yy.setLink($$[$0-2], $$[$0-1],$$[$0]);\nbreak;\ncase 65: case 73:\nthis.$ = $$[$0-3];yy.setLink($$[$0-2], $$[$0-1]);yy.setTooltip($$[$0-2], $$[$0]);\nbreak;\ncase 66: case 74:\nthis.$ = $$[$0-4];yy.setLink($$[$0-3], $$[$0-2], $$[$0]);yy.setTooltip($$[$0-3], $$[$0-1]);\nbreak;\ncase 69:\nthis.$ = $$[$0-3];yy.setClickEvent($$[$0-2], $$[$0-1], $$[$0]);\nbreak;\ncase 70:\nthis.$ = $$[$0-4];yy.setClickEvent($$[$0-3], $$[$0-2], $$[$0-1]);yy.setTooltip($$[$0-3], $$[$0]);\nbreak;\ncase 72:\nthis.$ = $$[$0-3];yy.setLink($$[$0-2], $$[$0-1], $$[$0]);\nbreak;\ncase 75:\nyy.setCssClass($$[$0-1], $$[$0]);\nbreak;\n}\n},\ntable: [{3:1,4:2,5:$V0,6:4,7:5,8:$V1,9:$V2,10:$V3,11:$V4,12:6,13:11,19:$V5,23:$V6},{1:[3]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{3:14,4:2,5:$V0,6:4,7:5,8:$V1,9:$V2,10:$V3,11:$V4,12:6,13:11,19:$V5,23:$V6},{1:[2,9]},o($V7,[2,5]),o($V7,[2,6]),o($V7,[2,7]),o($V7,[2,8]),{14:15,20:[1,16]},{16:[1,17]},{20:[2,12]},{1:[2,4]},{15:18,17:[1,19],22:$V8},o([17,22],[2,13]),{6:30,7:29,8:$V1,9:$V2,10:$V3,11:$V4,13:11,19:$V5,24:21,26:22,27:33,28:42,29:43,31:23,33:24,34:25,35:26,36:27,37:28,38:$V9,39:$Va,40:$Vb,45:$Vc,47:$Vd,48:$Ve,59:$Vf,60:$Vg,62:$Vh,66:$Vi,80:$Vj,81:$Vk,82:$Vl,83:$Vm},{16:[1,48]},{18:49,21:[1,50]},{16:[2,15]},{25:[1,51]},{16:[1,52],25:[2,17]},o($Vn,[2,25],{32:[1,53]}),o($Vn,[2,27]),o($Vn,[2,28]),o($Vn,[2,29]),o($Vn,[2,30]),o($Vn,[2,31]),o($Vn,[2,32]),o($Vn,[2,33]),o($Vn,[2,34]),o($Vn,[2,35]),o($Vn,[2,43],{49:54,51:57,52:58,32:[1,56],50:[1,55],53:$Vo,54:$Vp,55:$Vq,56:$Vr,57:$Vs,58:$Vt}),{27:65,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},o($Vn,[2,45]),o($Vn,[2,46]),{28:66,80:$Vj,81:$Vk,82:$Vl},{27:67,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},{27:68,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},{27:69,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},{50:[1,70]},o($Vu,[2,20],{28:42,29:43,27:71,30:[1,72],80:$Vj,81:$Vk,82:$Vl,83:$Vm}),o($Vu,[2,21],{30:[1,73]}),o($Vv,[2,89]),o($Vv,[2,90]),o($Vv,[2,91]),o([16,25,30,32,41,42,50,53,54,55,56,57,58,63,65],[2,92]),o($Vw,[2,10]),{15:74,22:$V8},{22:[2,14]},{1:[2,16]},{6:30,7:29,8:$V1,9:$V2,10:$V3,11:$V4,13:11,19:$V5,24:75,25:[2,18],26:22,27:33,28:42,29:43,31:23,33:24,34:25,35:26,36:27,37:28,38:$V9,39:$Va,40:$Vb,45:$Vc,47:$Vd,48:$Ve,59:$Vf,60:$Vg,62:$Vh,66:$Vi,80:$Vj,81:$Vk,82:$Vl,83:$Vm},o($Vn,[2,26]),{27:76,28:42,29:43,50:[1,77],80:$Vj,81:$Vk,82:$Vl,83:$Vm},{49:78,51:57,52:58,53:$Vo,54:$Vp,55:$Vq,56:$Vr,57:$Vs,58:$Vt},o($Vn,[2,44]),{52:79,57:$Vs,58:$Vt},o($Vx,[2,54],{51:80,53:$Vo,54:$Vp,55:$Vq,56:$Vr}),o($Vy,[2,55]),o($Vy,[2,56]),o($Vy,[2,57]),o($Vy,[2,58]),o($Vz,[2,59]),o($Vz,[2,60]),o($Vn,[2,36],{41:[1,81],42:[1,82]}),{46:[1,83]},{50:[1,84]},{50:[1,85]},{63:[1,86],65:[1,87]},{28:88,80:$Vj,81:$Vk,82:$Vl},o($Vu,[2,22]),o($Vu,[2,23]),o($Vu,[2,24]),{16:[1,89]},{25:[2,19]},o($VA,[2,47]),{27:90,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},{27:91,28:42,29:43,50:[1,92],80:$Vj,81:$Vk,82:$Vl,83:$Vm},o($Vx,[2,53],{51:93,53:$Vo,54:$Vp,55:$Vq,56:$Vr}),o($Vx,[2,52]),{28:94,80:$Vj,81:$Vk,82:$Vl},{43:95,47:$VB},{27:97,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},o($Vn,[2,61],{50:[1,98]}),o($Vn,[2,63],{50:[1,100],61:[1,99]}),o($Vn,[2,67],{50:[1,101],64:[1,102]}),o($Vn,[2,71],{50:[1,104],61:[1,103]}),o($Vn,[2,75]),o($Vw,[2,11]),o($VA,[2,49]),o($VA,[2,48]),{27:105,28:42,29:43,80:$Vj,81:$Vk,82:$Vl,83:$Vm},o($Vx,[2,51]),o($Vn,[2,37],{42:[1,106]}),{44:[1,107]},{43:108,44:[2,41],47:$VB},o($Vn,[2,40]),o($Vn,[2,62]),o($Vn,[2,64]),o($Vn,[2,65],{61:[1,109]}),o($Vn,[2,68]),o($Vn,[2,69],{50:[1,110]}),o($Vn,[2,72]),o($Vn,[2,73],{61:[1,111]}),o($VA,[2,50]),{43:112,47:$VB},o($Vn,[2,38]),{44:[2,42]},o($Vn,[2,66]),o($Vn,[2,70]),o($Vn,[2,74]),{44:[1,113]},o($Vn,[2,39])],\ndefaultActions: {2:[2,1],3:[2,2],4:[2,3],6:[2,9],13:[2,12],14:[2,4],20:[2,15],50:[2,14],51:[2,16],75:[2,19],108:[2,42]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 19; \nbreak;\ncase 1:return 8;\nbreak;\ncase 2:return 9;\nbreak;\ncase 3:return 10;\nbreak;\ncase 4:return 11;\nbreak;\ncase 5: this.begin('type_directive'); return 20; \nbreak;\ncase 6: this.popState(); this.begin('arg_directive'); return 17; \nbreak;\ncase 7: this.popState(); this.popState(); return 22; \nbreak;\ncase 8:return 21;\nbreak;\ncase 9:/* skip comments */\nbreak;\ncase 10:/* skip comments */\nbreak;\ncase 11:return 38;\nbreak;\ncase 12:return 39;\nbreak;\ncase 13:return 16;\nbreak;\ncase 14:/* skip whitespace */\nbreak;\ncase 15:return 23;\nbreak;\ncase 16:return 23;\nbreak;\ncase 17: this.begin(\"struct\"); /*console.log('Starting struct');*/ return 42;\nbreak;\ncase 18:return \"EOF_IN_STRUCT\";\nbreak;\ncase 19:return \"OPEN_IN_STRUCT\";\nbreak;\ncase 20: /*console.log('Ending struct');*/this.popState(); return 44;\nbreak;\ncase 21:/* nothing */\nbreak;\ncase 22: /*console.log('lex-member: ' + yy_.yytext);*/  return \"MEMBER\";\nbreak;\ncase 23:return 40;\nbreak;\ncase 24:return 66;\nbreak;\ncase 25:return 59;\nbreak;\ncase 26:return 60;\nbreak;\ncase 27:return 62;\nbreak;\ncase 28:return 45;\nbreak;\ncase 29:return 46;\nbreak;\ncase 30:this.begin(\"generic\");\nbreak;\ncase 31:this.popState();\nbreak;\ncase 32:return \"GENERICTYPE\";\nbreak;\ncase 33:this.begin(\"string\");\nbreak;\ncase 34:this.popState();\nbreak;\ncase 35:return \"STR\";\nbreak;\ncase 36:this.begin(\"bqstring\");\nbreak;\ncase 37:this.popState();\nbreak;\ncase 38:return \"BQUOTE_STR\";\nbreak;\ncase 39:this.begin(\"href\");\nbreak;\ncase 40:this.popState();\nbreak;\ncase 41:return 65;\nbreak;\ncase 42:this.begin(\"callback_name\");\nbreak;\ncase 43:this.popState();\nbreak;\ncase 44:this.popState(); this.begin(\"callback_args\");\nbreak;\ncase 45:return 63;\nbreak;\ncase 46:this.popState();\nbreak;\ncase 47:return 64;\nbreak;\ncase 48:return 61;\nbreak;\ncase 49:return 61;\nbreak;\ncase 50:return 61;\nbreak;\ncase 51:return 61;\nbreak;\ncase 52:return 54;\nbreak;\ncase 53:return 54;\nbreak;\ncase 54:return 56;\nbreak;\ncase 55:return 56;\nbreak;\ncase 56:return 55;\nbreak;\ncase 57:return 53;\nbreak;\ncase 58:return 57;\nbreak;\ncase 59:return 58;\nbreak;\ncase 60:return 32;\nbreak;\ncase 61:return 41;\nbreak;\ncase 62:return 78;\nbreak;\ncase 63:return 'DOT';\nbreak;\ncase 64:return 'PLUS';\nbreak;\ncase 65:return 75;\nbreak;\ncase 66:return 'EQUALS';\nbreak;\ncase 67:return 'EQUALS';\nbreak;\ncase 68:return 82;\nbreak;\ncase 69:return 'PUNCTUATION';\nbreak;\ncase 70:return 81;\nbreak;\ncase 71:return 80;\nbreak;\ncase 72:return 77;\nbreak;\ncase 73:return 25;\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/,/^(?:.*direction\\s+TB[^\\n]*)/,/^(?:.*direction\\s+BT[^\\n]*)/,/^(?:.*direction\\s+RL[^\\n]*)/,/^(?:.*direction\\s+LR[^\\n]*)/,/^(?:((?:(?!\\}%%)[^:.])*))/,/^(?::)/,/^(?:\\}%%)/,/^(?:((?:(?!\\}%%).|\\n)*))/,/^(?:%%(?!\\{)*[^\\n]*(\\r?\\n?)+)/,/^(?:%%[^\\n]*(\\r?\\n)*)/,/^(?:title\\s[^#\\n;]+)/,/^(?:accDescription\\s[^#\\n;]+)/,/^(?:\\s*(\\r?\\n)+)/,/^(?:\\s+)/,/^(?:classDiagram-v2\\b)/,/^(?:classDiagram\\b)/,/^(?:[{])/,/^(?:$)/,/^(?:[{])/,/^(?:[}])/,/^(?:[\\n])/,/^(?:[^{}\\n]*)/,/^(?:class\\b)/,/^(?:cssClass\\b)/,/^(?:callback\\b)/,/^(?:link\\b)/,/^(?:click\\b)/,/^(?:<<)/,/^(?:>>)/,/^(?:[~])/,/^(?:[~])/,/^(?:[^~]*)/,/^(?:[\"])/,/^(?:[\"])/,/^(?:[^\"]*)/,/^(?:[`])/,/^(?:[`])/,/^(?:[^`]+)/,/^(?:href[\\s]+[\"])/,/^(?:[\"])/,/^(?:[^\"]*)/,/^(?:call[\\s]+)/,/^(?:\\([\\s]*\\))/,/^(?:\\()/,/^(?:[^(]*)/,/^(?:\\))/,/^(?:[^)]*)/,/^(?:_self\\b)/,/^(?:_blank\\b)/,/^(?:_parent\\b)/,/^(?:_top\\b)/,/^(?:\\s*<\\|)/,/^(?:\\s*\\|>)/,/^(?:\\s*>)/,/^(?:\\s*<)/,/^(?:\\s*\\*)/,/^(?:\\s*o\\b)/,/^(?:--)/,/^(?:\\.\\.)/,/^(?::{1}[^:\\n;]+)/,/^(?::{3})/,/^(?:-)/,/^(?:\\.)/,/^(?:\\+)/,/^(?:%)/,/^(?:=)/,/^(?:=)/,/^(?:\\w+)/,/^(?:[!\"#$%&'*+,-.`?\\\\/])/,/^(?:[0-9]+)/,/^(?:[\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6]|[\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377]|[\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5]|[\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA]|[\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE]|[\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA]|[\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0]|[\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977]|[\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2]|[\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A]|[\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39]|[\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8]|[\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C]|[\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C]|[\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99]|[\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0]|[\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D]|[\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3]|[\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10]|[\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1]|[\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81]|[\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3]|[\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6]|[\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A]|[\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081]|[\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D]|[\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0]|[\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310]|[\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C]|[\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711]|[\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7]|[\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C]|[\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16]|[\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF]|[\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC]|[\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D]|[\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D]|[\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3]|[\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F]|[\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128]|[\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184]|[\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3]|[\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6]|[\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE]|[\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C]|[\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D]|[\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC]|[\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B]|[\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788]|[\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805]|[\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB]|[\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28]|[\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5]|[\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4]|[\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E]|[\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D]|[\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36]|[\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D]|[\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC]|[\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF]|[\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC])/,/^(?:\\s)/,/^(?:$)/],\nconditions: {\"arg_directive\":{\"rules\":[7,8],\"inclusive\":false},\"type_directive\":{\"rules\":[6,7],\"inclusive\":false},\"open_directive\":{\"rules\":[5],\"inclusive\":false},\"callback_args\":{\"rules\":[46,47],\"inclusive\":false},\"callback_name\":{\"rules\":[43,44,45],\"inclusive\":false},\"href\":{\"rules\":[40,41],\"inclusive\":false},\"struct\":{\"rules\":[18,19,20,21,22],\"inclusive\":false},\"generic\":{\"rules\":[31,32],\"inclusive\":false},\"bqstring\":{\"rules\":[37,38],\"inclusive\":false},\"string\":{\"rules\":[34,35],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,1,2,3,4,9,10,11,12,13,14,15,16,17,23,24,25,26,27,28,29,30,33,36,39,42,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,2],$V1=[1,5],$V2=[6,9,11,23,25,27,45],$V3=[1,17],$V4=[1,18],$V5=[1,19],$V6=[1,22],$V7=[1,27],$V8=[1,28],$V9=[1,29],$Va=[1,30],$Vb=[1,41],$Vc=[27,42,43],$Vd=[4,6,9,11,23,25,27,45],$Ve=[38,39,40,41],$Vf=[22,33],$Vg=[1,59];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"ER_DIAGRAM\":4,\"document\":5,\"EOF\":6,\"directive\":7,\"line\":8,\"SPACE\":9,\"statement\":10,\"NEWLINE\":11,\"openDirective\":12,\"typeDirective\":13,\"closeDirective\":14,\":\":15,\"argDirective\":16,\"entityName\":17,\"relSpec\":18,\"role\":19,\"BLOCK_START\":20,\"attributes\":21,\"BLOCK_STOP\":22,\"title\":23,\"title_value\":24,\"accDescription\":25,\"description_value\":26,\"ALPHANUM\":27,\"attribute\":28,\"attributeType\":29,\"attributeName\":30,\"attributeKeyType\":31,\"attributeComment\":32,\"ATTRIBUTE_WORD\":33,\"ATTRIBUTE_KEY\":34,\"COMMENT\":35,\"cardinality\":36,\"relType\":37,\"ZERO_OR_ONE\":38,\"ZERO_OR_MORE\":39,\"ONE_OR_MORE\":40,\"ONLY_ONE\":41,\"NON_IDENTIFYING\":42,\"IDENTIFYING\":43,\"WORD\":44,\"open_directive\":45,\"type_directive\":46,\"arg_directive\":47,\"close_directive\":48,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",4:\"ER_DIAGRAM\",6:\"EOF\",9:\"SPACE\",11:\"NEWLINE\",15:\":\",20:\"BLOCK_START\",22:\"BLOCK_STOP\",23:\"title\",24:\"title_value\",25:\"accDescription\",26:\"description_value\",27:\"ALPHANUM\",33:\"ATTRIBUTE_WORD\",34:\"ATTRIBUTE_KEY\",35:\"COMMENT\",38:\"ZERO_OR_ONE\",39:\"ZERO_OR_MORE\",40:\"ONE_OR_MORE\",41:\"ONLY_ONE\",42:\"NON_IDENTIFYING\",43:\"IDENTIFYING\",44:\"WORD\",45:\"open_directive\",46:\"type_directive\",47:\"arg_directive\",48:\"close_directive\"},\nproductions_: [0,[3,3],[3,2],[5,0],[5,2],[8,2],[8,1],[8,1],[8,1],[7,4],[7,6],[10,1],[10,5],[10,4],[10,3],[10,1],[10,2],[10,2],[17,1],[21,1],[21,2],[28,2],[28,3],[28,3],[28,4],[29,1],[30,1],[31,1],[32,1],[18,3],[36,1],[36,1],[36,1],[36,1],[37,1],[37,1],[19,1],[19,1],[12,1],[13,1],[16,1],[14,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:\n /*console.log('finished parsing');*/ \nbreak;\ncase 3:\n this.$ = [] \nbreak;\ncase 4:\n$$[$0-1].push($$[$0]);this.$ = $$[$0-1]\nbreak;\ncase 5: case 6:\n this.$ = $$[$0] \nbreak;\ncase 7: case 8:\n this.$=[];\nbreak;\ncase 12:\n\r\n          yy.addEntity($$[$0-4]);\r\n          yy.addEntity($$[$0-2]);\r\n          yy.addRelationship($$[$0-4], $$[$0], $$[$0-2], $$[$0-3]);\r\n          /*console.log($$[$0-4] + $$[$0-3] + $$[$0-2] + ':' + $$[$0]);*/\r\n      \nbreak;\ncase 13:\n\r\n          /* console.log('detected block'); */\r\n          yy.addEntity($$[$0-3]);\r\n          yy.addAttributes($$[$0-3], $$[$0-1]);\r\n          /* console.log('handled block'); */\r\n      \nbreak;\ncase 14:\n yy.addEntity($$[$0-2]); \nbreak;\ncase 15:\n yy.addEntity($$[$0]); \nbreak;\ncase 16:\n this.$=$$[$0].trim();yy.setTitle(this.$); \nbreak;\ncase 17:\n this.$=$$[$0].trim();yy.setAccDescription(this.$); \nbreak;\ncase 18:\n this.$ = $$[$0]; /*console.log('Entity: ' + $$[$0]);*/ \nbreak;\ncase 19:\n this.$ = [$$[$0]]; \nbreak;\ncase 20:\n $$[$0].push($$[$0-1]); this.$=$$[$0]; \nbreak;\ncase 21:\n this.$ = { attributeType: $$[$0-1], attributeName: $$[$0] }; \nbreak;\ncase 22:\n this.$ = { attributeType: $$[$0-2], attributeName: $$[$0-1], attributeKeyType: $$[$0] }; \nbreak;\ncase 23:\n this.$ = { attributeType: $$[$0-2], attributeName: $$[$0-1], attributeComment: $$[$0] }; \nbreak;\ncase 24:\n this.$ = { attributeType: $$[$0-3], attributeName: $$[$0-2], attributeKeyType: $$[$0-1], attributeComment: $$[$0] }; \nbreak;\ncase 25: case 26: case 27:\n this.$=$$[$0]; \nbreak;\ncase 28:\n this.$=$$[$0].replace(/\"/g, ''); \nbreak;\ncase 29:\n\r\n        this.$ = { cardA: $$[$0], relType: $$[$0-1], cardB: $$[$0-2] };\r\n        /*console.log('relSpec: ' + $$[$0] + $$[$0-1] + $$[$0-2]);*/\r\n      \nbreak;\ncase 30:\n this.$ = yy.Cardinality.ZERO_OR_ONE; \nbreak;\ncase 31:\n this.$ = yy.Cardinality.ZERO_OR_MORE; \nbreak;\ncase 32:\n this.$ = yy.Cardinality.ONE_OR_MORE; \nbreak;\ncase 33:\n this.$ = yy.Cardinality.ONLY_ONE; \nbreak;\ncase 34:\n this.$ = yy.Identification.NON_IDENTIFYING;  \nbreak;\ncase 35:\n this.$ = yy.Identification.IDENTIFYING; \nbreak;\ncase 36:\n this.$ = $$[$0].replace(/\"/g, ''); \nbreak;\ncase 37:\n this.$ = $$[$0]; \nbreak;\ncase 38:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 39:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 40:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 41:\n yy.parseDirective('}%%', 'close_directive', 'er'); \nbreak;\n}\n},\ntable: [{3:1,4:$V0,7:3,12:4,45:$V1},{1:[3]},o($V2,[2,3],{5:6}),{3:7,4:$V0,7:3,12:4,45:$V1},{13:8,46:[1,9]},{46:[2,38]},{6:[1,10],7:15,8:11,9:[1,12],10:13,11:[1,14],12:4,17:16,23:$V3,25:$V4,27:$V5,45:$V1},{1:[2,2]},{14:20,15:[1,21],48:$V6},o([15,48],[2,39]),o($V2,[2,8],{1:[2,1]}),o($V2,[2,4]),{7:15,10:23,12:4,17:16,23:$V3,25:$V4,27:$V5,45:$V1},o($V2,[2,6]),o($V2,[2,7]),o($V2,[2,11]),o($V2,[2,15],{18:24,36:26,20:[1,25],38:$V7,39:$V8,40:$V9,41:$Va}),{24:[1,31]},{26:[1,32]},o([6,9,11,15,20,23,25,27,38,39,40,41,45],[2,18]),{11:[1,33]},{16:34,47:[1,35]},{11:[2,41]},o($V2,[2,5]),{17:36,27:$V5},{21:37,22:[1,38],28:39,29:40,33:$Vb},{37:42,42:[1,43],43:[1,44]},o($Vc,[2,30]),o($Vc,[2,31]),o($Vc,[2,32]),o($Vc,[2,33]),o($V2,[2,16]),o($V2,[2,17]),o($Vd,[2,9]),{14:45,48:$V6},{48:[2,40]},{15:[1,46]},{22:[1,47]},o($V2,[2,14]),{21:48,22:[2,19],28:39,29:40,33:$Vb},{30:49,33:[1,50]},{33:[2,25]},{36:51,38:$V7,39:$V8,40:$V9,41:$Va},o($Ve,[2,34]),o($Ve,[2,35]),{11:[1,52]},{19:53,27:[1,55],44:[1,54]},o($V2,[2,13]),{22:[2,20]},o($Vf,[2,21],{31:56,32:57,34:[1,58],35:$Vg}),o([22,33,34,35],[2,26]),{27:[2,29]},o($Vd,[2,10]),o($V2,[2,12]),o($V2,[2,36]),o($V2,[2,37]),o($Vf,[2,22],{32:60,35:$Vg}),o($Vf,[2,23]),o([22,33,35],[2,27]),o($Vf,[2,28]),o($Vf,[2,24])],\ndefaultActions: {5:[2,38],7:[2,2],22:[2,41],35:[2,40],41:[2,25],48:[2,20],51:[2,29]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin(\"title\");return 23; \nbreak;\ncase 1: this.popState(); return \"title_value\"; \nbreak;\ncase 2: this.begin(\"accDescription\");return 25; \nbreak;\ncase 3: this.popState(); return \"description_value\"; \nbreak;\ncase 4: this.begin('open_directive'); return 45; \nbreak;\ncase 5: this.begin('type_directive'); return 46; \nbreak;\ncase 6: this.popState(); this.begin('arg_directive'); return 15; \nbreak;\ncase 7: this.popState(); this.popState(); return 48; \nbreak;\ncase 8:return 47;\nbreak;\ncase 9:/* skip comments */\nbreak;\ncase 10:/* skip comments */\nbreak;\ncase 11:return 11;\nbreak;\ncase 12:/* skip whitespace */\nbreak;\ncase 13:return 9;\nbreak;\ncase 14:return 44;\nbreak;\ncase 15:return 4;\nbreak;\ncase 16: this.begin(\"block\"); return 20; \nbreak;\ncase 17:/* skip whitespace in block */\nbreak;\ncase 18:return 34\nbreak;\ncase 19:return 33\nbreak;\ncase 20:return 35;\nbreak;\ncase 21:/* nothing */\nbreak;\ncase 22: this.popState(); return 22; \nbreak;\ncase 23:return yy_.yytext[0];\nbreak;\ncase 24:return 38;\nbreak;\ncase 25:return 39;\nbreak;\ncase 26:return 40;\nbreak;\ncase 27:return 41;\nbreak;\ncase 28:return 38;\nbreak;\ncase 29:return 39;\nbreak;\ncase 30:return 40;\nbreak;\ncase 31:return 42;\nbreak;\ncase 32:return 43;\nbreak;\ncase 33:return 42;\nbreak;\ncase 34:return 42;\nbreak;\ncase 35:return 27;\nbreak;\ncase 36:return yy_.yytext[0];\nbreak;\ncase 37:return 6;\nbreak;\n}\n},\nrules: [/^(?:title\\b)/i,/^(?:(?!\\n||)*[^\\n]*)/i,/^(?:accDescription\\b)/i,/^(?:(?!\\n||)*[^\\n]*)/i,/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:%(?!\\{)[^\\n]*)/i,/^(?:[^\\}]%%[^\\n]*)/i,/^(?:[\\n]+)/i,/^(?:\\s+)/i,/^(?:[\\s]+)/i,/^(?:\"[^\"]*\")/i,/^(?:erDiagram\\b)/i,/^(?:\\{)/i,/^(?:\\s+)/i,/^(?:(?:PK)|(?:FK))/i,/^(?:[A-Za-z][A-Za-z0-9\\-_]*)/i,/^(?:\"[^\"]*\")/i,/^(?:[\\n]+)/i,/^(?:\\})/i,/^(?:.)/i,/^(?:\\|o\\b)/i,/^(?:\\}o\\b)/i,/^(?:\\}\\|)/i,/^(?:\\|\\|)/i,/^(?:o\\|)/i,/^(?:o\\{)/i,/^(?:\\|\\{)/i,/^(?:\\.\\.)/i,/^(?:--)/i,/^(?:\\.-)/i,/^(?:-\\.)/i,/^(?:[A-Za-z][A-Za-z0-9\\-_]*)/i,/^(?:.)/i,/^(?:$)/i],\nconditions: {\"accDescription\":{\"rules\":[3],\"inclusive\":false},\"title\":{\"rules\":[1],\"inclusive\":false},\"open_directive\":{\"rules\":[5],\"inclusive\":false},\"type_directive\":{\"rules\":[6,7],\"inclusive\":false},\"arg_directive\":{\"rules\":[7,8],\"inclusive\":false},\"block\":{\"rules\":[17,18,19,20,21,22,23],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,2,4,9,10,11,12,13,14,15,16,24,25,26,27,28,29,30,31,32,33,34,35,36,37],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,9],$V1=[1,7],$V2=[1,6],$V3=[1,8],$V4=[1,20,21,22,23,38,44,46,51,65,66,85,86,87,88,89,90,94,104,105,108,110,111,117,118,119,120,121,122,123,124,125,126],$V5=[2,10],$V6=[1,20],$V7=[1,21],$V8=[1,22],$V9=[1,23],$Va=[1,30],$Vb=[1,32],$Vc=[1,33],$Vd=[1,61],$Ve=[1,47],$Vf=[1,51],$Vg=[1,35],$Vh=[1,36],$Vi=[1,37],$Vj=[1,38],$Vk=[1,39],$Vl=[1,55],$Vm=[1,62],$Vn=[1,50],$Vo=[1,52],$Vp=[1,54],$Vq=[1,58],$Vr=[1,59],$Vs=[1,40],$Vt=[1,41],$Vu=[1,42],$Vv=[1,43],$Vw=[1,60],$Vx=[1,49],$Vy=[1,53],$Vz=[1,56],$VA=[1,57],$VB=[1,48],$VC=[1,65],$VD=[1,70],$VE=[1,20,21,22,23,38,42,44,46,51,65,66,85,86,87,88,89,90,94,104,105,108,110,111,117,118,119,120,121,122,123,124,125,126],$VF=[1,74],$VG=[1,73],$VH=[1,75],$VI=[20,21,23,80,81],$VJ=[1,98],$VK=[1,103],$VL=[1,106],$VM=[1,107],$VN=[1,100],$VO=[1,105],$VP=[1,108],$VQ=[1,101],$VR=[1,113],$VS=[1,112],$VT=[1,102],$VU=[1,104],$VV=[1,109],$VW=[1,110],$VX=[1,111],$VY=[1,114],$VZ=[20,21,22,23,80,81],$V_=[20,21,22,23,52,80,81],$V$=[20,21,22,23,40,51,52,54,56,58,60,62,64,65,66,68,70,72,73,75,80,81,90,94,104,105,108,110,111,121,122,123,124,125,126],$V01=[20,21,23],$V11=[20,21,23,51,65,66,80,81,90,94,104,105,108,110,111,121,122,123,124,125,126],$V21=[1,12,20,21,22,23,24,38,42,44,46,51,65,66,85,86,87,88,89,90,94,104,105,108,110,111,117,118,119,120,121,122,123,124,125,126],$V31=[51,65,66,90,94,104,105,108,110,111,121,122,123,124,125,126],$V41=[1,148],$V51=[1,156],$V61=[1,157],$V71=[1,158],$V81=[1,159],$V91=[1,143],$Va1=[1,144],$Vb1=[1,140],$Vc1=[1,151],$Vd1=[1,152],$Ve1=[1,153],$Vf1=[1,154],$Vg1=[1,155],$Vh1=[1,160],$Vi1=[1,161],$Vj1=[1,146],$Vk1=[1,149],$Vl1=[1,145],$Vm1=[1,142],$Vn1=[20,21,22,23,38,42,44,46,51,65,66,85,86,87,88,89,90,94,104,105,108,110,111,117,118,119,120,121,122,123,124,125,126],$Vo1=[1,164],$Vp1=[20,21,22,23,26,51,65,66,90,104,105,108,110,111,121,122,123,124,125,126],$Vq1=[20,21,22,23,24,26,38,40,41,42,51,55,57,59,61,63,65,66,67,69,71,72,74,76,80,81,85,86,87,88,89,90,91,94,104,105,108,110,111,112,113,121,122,123,124,125,126],$Vr1=[12,21,22,24],$Vs1=[22,105],$Vt1=[1,249],$Vu1=[1,244],$Vv1=[1,245],$Vw1=[1,253],$Vx1=[1,250],$Vy1=[1,247],$Vz1=[1,246],$VA1=[1,248],$VB1=[1,251],$VC1=[1,252],$VD1=[1,254],$VE1=[1,272],$VF1=[20,21,23,105],$VG1=[20,21,22,23,65,66,85,101,104,105,108,109,110,111,112];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"mermaidDoc\":4,\"directive\":5,\"openDirective\":6,\"typeDirective\":7,\"closeDirective\":8,\"separator\":9,\":\":10,\"argDirective\":11,\"open_directive\":12,\"type_directive\":13,\"arg_directive\":14,\"close_directive\":15,\"graphConfig\":16,\"document\":17,\"line\":18,\"statement\":19,\"SEMI\":20,\"NEWLINE\":21,\"SPACE\":22,\"EOF\":23,\"GRAPH\":24,\"NODIR\":25,\"DIR\":26,\"FirstStmtSeperator\":27,\"ending\":28,\"endToken\":29,\"spaceList\":30,\"spaceListNewline\":31,\"verticeStatement\":32,\"styleStatement\":33,\"linkStyleStatement\":34,\"classDefStatement\":35,\"classStatement\":36,\"clickStatement\":37,\"subgraph\":38,\"text\":39,\"SQS\":40,\"SQE\":41,\"end\":42,\"direction\":43,\"title\":44,\"title_value\":45,\"accDescription\":46,\"description_value\":47,\"link\":48,\"node\":49,\"vertex\":50,\"AMP\":51,\"STYLE_SEPARATOR\":52,\"idString\":53,\"DOUBLECIRCLESTART\":54,\"DOUBLECIRCLEEND\":55,\"PS\":56,\"PE\":57,\"(-\":58,\"-)\":59,\"STADIUMSTART\":60,\"STADIUMEND\":61,\"SUBROUTINESTART\":62,\"SUBROUTINEEND\":63,\"VERTEX_WITH_PROPS_START\":64,\"ALPHA\":65,\"COLON\":66,\"PIPE\":67,\"CYLINDERSTART\":68,\"CYLINDEREND\":69,\"DIAMOND_START\":70,\"DIAMOND_STOP\":71,\"TAGEND\":72,\"TRAPSTART\":73,\"TRAPEND\":74,\"INVTRAPSTART\":75,\"INVTRAPEND\":76,\"linkStatement\":77,\"arrowText\":78,\"TESTSTR\":79,\"START_LINK\":80,\"LINK\":81,\"textToken\":82,\"STR\":83,\"keywords\":84,\"STYLE\":85,\"LINKSTYLE\":86,\"CLASSDEF\":87,\"CLASS\":88,\"CLICK\":89,\"DOWN\":90,\"UP\":91,\"textNoTags\":92,\"textNoTagsToken\":93,\"DEFAULT\":94,\"stylesOpt\":95,\"alphaNum\":96,\"CALLBACKNAME\":97,\"CALLBACKARGS\":98,\"HREF\":99,\"LINK_TARGET\":100,\"HEX\":101,\"numList\":102,\"INTERPOLATE\":103,\"NUM\":104,\"COMMA\":105,\"style\":106,\"styleComponent\":107,\"MINUS\":108,\"UNIT\":109,\"BRKT\":110,\"DOT\":111,\"PCT\":112,\"TAGSTART\":113,\"alphaNumToken\":114,\"idStringToken\":115,\"alphaNumStatement\":116,\"direction_tb\":117,\"direction_bt\":118,\"direction_rl\":119,\"direction_lr\":120,\"PUNCTUATION\":121,\"UNICODE_TEXT\":122,\"PLUS\":123,\"EQUALS\":124,\"MULT\":125,\"UNDERSCORE\":126,\"graphCodeTokens\":127,\"ARROW_CROSS\":128,\"ARROW_POINT\":129,\"ARROW_CIRCLE\":130,\"ARROW_OPEN\":131,\"QUOTE\":132,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",10:\":\",12:\"open_directive\",13:\"type_directive\",14:\"arg_directive\",15:\"close_directive\",20:\"SEMI\",21:\"NEWLINE\",22:\"SPACE\",23:\"EOF\",24:\"GRAPH\",25:\"NODIR\",26:\"DIR\",38:\"subgraph\",40:\"SQS\",41:\"SQE\",42:\"end\",44:\"title\",45:\"title_value\",46:\"accDescription\",47:\"description_value\",51:\"AMP\",52:\"STYLE_SEPARATOR\",54:\"DOUBLECIRCLESTART\",55:\"DOUBLECIRCLEEND\",56:\"PS\",57:\"PE\",58:\"(-\",59:\"-)\",60:\"STADIUMSTART\",61:\"STADIUMEND\",62:\"SUBROUTINESTART\",63:\"SUBROUTINEEND\",64:\"VERTEX_WITH_PROPS_START\",65:\"ALPHA\",66:\"COLON\",67:\"PIPE\",68:\"CYLINDERSTART\",69:\"CYLINDEREND\",70:\"DIAMOND_START\",71:\"DIAMOND_STOP\",72:\"TAGEND\",73:\"TRAPSTART\",74:\"TRAPEND\",75:\"INVTRAPSTART\",76:\"INVTRAPEND\",79:\"TESTSTR\",80:\"START_LINK\",81:\"LINK\",83:\"STR\",85:\"STYLE\",86:\"LINKSTYLE\",87:\"CLASSDEF\",88:\"CLASS\",89:\"CLICK\",90:\"DOWN\",91:\"UP\",94:\"DEFAULT\",97:\"CALLBACKNAME\",98:\"CALLBACKARGS\",99:\"HREF\",100:\"LINK_TARGET\",101:\"HEX\",103:\"INTERPOLATE\",104:\"NUM\",105:\"COMMA\",108:\"MINUS\",109:\"UNIT\",110:\"BRKT\",111:\"DOT\",112:\"PCT\",113:\"TAGSTART\",117:\"direction_tb\",118:\"direction_bt\",119:\"direction_rl\",120:\"direction_lr\",121:\"PUNCTUATION\",122:\"UNICODE_TEXT\",123:\"PLUS\",124:\"EQUALS\",125:\"MULT\",126:\"UNDERSCORE\",128:\"ARROW_CROSS\",129:\"ARROW_POINT\",130:\"ARROW_CIRCLE\",131:\"ARROW_OPEN\",132:\"QUOTE\"},\nproductions_: [0,[3,1],[3,2],[5,4],[5,6],[6,1],[7,1],[11,1],[8,1],[4,2],[17,0],[17,2],[18,1],[18,1],[18,1],[18,1],[18,1],[16,2],[16,2],[16,2],[16,3],[28,2],[28,1],[29,1],[29,1],[29,1],[27,1],[27,1],[27,2],[31,2],[31,2],[31,1],[31,1],[30,2],[30,1],[19,2],[19,2],[19,2],[19,2],[19,2],[19,2],[19,9],[19,6],[19,4],[19,1],[19,2],[19,2],[9,1],[9,1],[9,1],[32,3],[32,4],[32,2],[32,1],[49,1],[49,5],[49,3],[50,4],[50,4],[50,6],[50,4],[50,4],[50,4],[50,8],[50,4],[50,4],[50,4],[50,6],[50,4],[50,4],[50,4],[50,4],[50,4],[50,1],[48,2],[48,3],[48,3],[48,1],[48,3],[77,1],[78,3],[39,1],[39,2],[39,1],[84,1],[84,1],[84,1],[84,1],[84,1],[84,1],[84,1],[84,1],[84,1],[84,1],[84,1],[92,1],[92,2],[35,5],[35,5],[36,5],[37,2],[37,4],[37,3],[37,5],[37,2],[37,4],[37,4],[37,6],[37,2],[37,4],[37,2],[37,4],[37,4],[37,6],[33,5],[33,5],[34,5],[34,5],[34,9],[34,9],[34,7],[34,7],[102,1],[102,3],[95,1],[95,3],[106,1],[106,2],[107,1],[107,1],[107,1],[107,1],[107,1],[107,1],[107,1],[107,1],[107,1],[107,1],[107,1],[82,1],[82,1],[82,1],[82,1],[82,1],[82,1],[93,1],[93,1],[93,1],[93,1],[53,1],[53,2],[96,1],[96,2],[116,1],[116,1],[116,1],[116,1],[43,1],[43,1],[43,1],[43,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[114,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[115,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1],[127,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 5:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 6:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 7:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 8:\n yy.parseDirective('}%%', 'close_directive', 'flowchart'); \nbreak;\ncase 10:\n this.$ = [];\nbreak;\ncase 11:\n\r\n\t    if($$[$0] !== []){\r\n\t        $$[$0-1].push($$[$0]);\r\n\t    }\r\n\t    this.$=$$[$0-1];\nbreak;\ncase 12: case 81: case 83: case 95: case 151: case 153: case 154:\nthis.$=$$[$0];\nbreak;\ncase 19:\n yy.setDirection('TB');this.$ = 'TB';\nbreak;\ncase 20:\n yy.setDirection($$[$0-1]);this.$ = $$[$0-1];\nbreak;\ncase 35:\n /* console.warn('finat vs', $$[$0-1].nodes); */ this.$=$$[$0-1].nodes\nbreak;\ncase 36: case 37: case 38: case 39: case 40:\nthis.$=[];\nbreak;\ncase 41:\nthis.$=yy.addSubGraph($$[$0-6],$$[$0-1],$$[$0-4]);\nbreak;\ncase 42:\nthis.$=yy.addSubGraph($$[$0-3],$$[$0-1],$$[$0-3]);\nbreak;\ncase 43:\nthis.$=yy.addSubGraph(undefined,$$[$0-1],undefined);\nbreak;\ncase 45:\n this.$=$$[$0].trim();yy.setTitle(this.$); \nbreak;\ncase 46:\n this.$=$$[$0].trim();yy.setAccDescription(this.$); \nbreak;\ncase 50:\n /* console.warn('vs',$$[$0-2].stmt,$$[$0]); */ yy.addLink($$[$0-2].stmt,$$[$0],$$[$0-1]); this.$ = { stmt: $$[$0], nodes: $$[$0].concat($$[$0-2].nodes) } \nbreak;\ncase 51:\n /* console.warn('vs',$$[$0-3].stmt,$$[$0-1]); */ yy.addLink($$[$0-3].stmt,$$[$0-1],$$[$0-2]); this.$ = { stmt: $$[$0-1], nodes: $$[$0-1].concat($$[$0-3].nodes) } \nbreak;\ncase 52:\n/*console.warn('noda', $$[$0-1]);*/ this.$ = {stmt: $$[$0-1], nodes:$$[$0-1] }\nbreak;\ncase 53:\n /*console.warn('noda', $$[$0]);*/ this.$ = {stmt: $$[$0], nodes:$$[$0] }\nbreak;\ncase 54:\n /* console.warn('nod', $$[$0]); */ this.$ = [$$[$0]];\nbreak;\ncase 55:\n this.$ = $$[$0-4].concat($$[$0]); /* console.warn('pip', $$[$0-4][0], $$[$0], this.$); */ \nbreak;\ncase 56:\nthis.$ = [$$[$0-2]];yy.setClass($$[$0-2],$$[$0])\nbreak;\ncase 57:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'square');\nbreak;\ncase 58:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'doublecircle');\nbreak;\ncase 59:\nthis.$ = $$[$0-5];yy.addVertex($$[$0-5],$$[$0-2],'circle');\nbreak;\ncase 60:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'ellipse');\nbreak;\ncase 61:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'stadium');\nbreak;\ncase 62:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'subroutine');\nbreak;\ncase 63:\nthis.$ = $$[$0-7];yy.addVertex($$[$0-7],$$[$0-1],'rect',undefined,undefined,undefined, Object.fromEntries([[$$[$0-5], $$[$0-3]]]));\nbreak;\ncase 64:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'cylinder');\nbreak;\ncase 65:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'round');\nbreak;\ncase 66:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'diamond');\nbreak;\ncase 67:\nthis.$ = $$[$0-5];yy.addVertex($$[$0-5],$$[$0-2],'hexagon');\nbreak;\ncase 68:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'odd');\nbreak;\ncase 69:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'trapezoid');\nbreak;\ncase 70:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'inv_trapezoid');\nbreak;\ncase 71:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'lean_right');\nbreak;\ncase 72:\nthis.$ = $$[$0-3];yy.addVertex($$[$0-3],$$[$0-1],'lean_left');\nbreak;\ncase 73:\n /*console.warn('h: ', $$[$0]);*/this.$ = $$[$0];yy.addVertex($$[$0]);\nbreak;\ncase 74:\n$$[$0-1].text = $$[$0];this.$ = $$[$0-1];\nbreak;\ncase 75: case 76:\n$$[$0-2].text = $$[$0-1];this.$ = $$[$0-2];\nbreak;\ncase 77:\nthis.$ = $$[$0];\nbreak;\ncase 78:\nvar inf = yy.destructLink($$[$0], $$[$0-2]); this.$ = {\"type\":inf.type,\"stroke\":inf.stroke,\"length\":inf.length,\"text\":$$[$0-1]};\nbreak;\ncase 79:\nvar inf = yy.destructLink($$[$0]);this.$ = {\"type\":inf.type,\"stroke\":inf.stroke,\"length\":inf.length};\nbreak;\ncase 80:\nthis.$ = $$[$0-1];\nbreak;\ncase 82: case 96: case 152:\nthis.$=$$[$0-1]+''+$$[$0];\nbreak;\ncase 97: case 98:\nthis.$ = $$[$0-4];yy.addClass($$[$0-2],$$[$0]);\nbreak;\ncase 99:\nthis.$ = $$[$0-4];yy.setClass($$[$0-2], $$[$0]);\nbreak;\ncase 100: case 108:\nthis.$ = $$[$0-1];yy.setClickEvent($$[$0-1], $$[$0]);\nbreak;\ncase 101: case 109:\nthis.$ = $$[$0-3];yy.setClickEvent($$[$0-3], $$[$0-2]);yy.setTooltip($$[$0-3], $$[$0]);\nbreak;\ncase 102:\nthis.$ = $$[$0-2];yy.setClickEvent($$[$0-2], $$[$0-1], $$[$0]);\nbreak;\ncase 103:\nthis.$ = $$[$0-4];yy.setClickEvent($$[$0-4], $$[$0-3], $$[$0-2]);yy.setTooltip($$[$0-4], $$[$0]);\nbreak;\ncase 104: case 110:\nthis.$ = $$[$0-1];yy.setLink($$[$0-1], $$[$0]);\nbreak;\ncase 105: case 111:\nthis.$ = $$[$0-3];yy.setLink($$[$0-3], $$[$0-2]);yy.setTooltip($$[$0-3], $$[$0]);\nbreak;\ncase 106: case 112:\nthis.$ = $$[$0-3];yy.setLink($$[$0-3], $$[$0-2], $$[$0]);\nbreak;\ncase 107: case 113:\nthis.$ = $$[$0-5];yy.setLink($$[$0-5], $$[$0-4], $$[$0]);yy.setTooltip($$[$0-5], $$[$0-2]);\nbreak;\ncase 114:\nthis.$ = $$[$0-4];yy.addVertex($$[$0-2],undefined,undefined,$$[$0]);\nbreak;\ncase 115: case 117:\nthis.$ = $$[$0-4];yy.updateLink($$[$0-2],$$[$0]);\nbreak;\ncase 116:\nthis.$ = $$[$0-4];yy.updateLink([$$[$0-2]],$$[$0]);\nbreak;\ncase 118:\nthis.$ = $$[$0-8];yy.updateLinkInterpolate([$$[$0-6]],$$[$0-2]);yy.updateLink([$$[$0-6]],$$[$0]);\nbreak;\ncase 119:\nthis.$ = $$[$0-8];yy.updateLinkInterpolate($$[$0-6],$$[$0-2]);yy.updateLink($$[$0-6],$$[$0]);\nbreak;\ncase 120:\nthis.$ = $$[$0-6];yy.updateLinkInterpolate([$$[$0-4]],$$[$0]);\nbreak;\ncase 121:\nthis.$ = $$[$0-6];yy.updateLinkInterpolate($$[$0-4],$$[$0]);\nbreak;\ncase 122: case 124:\nthis.$ = [$$[$0]]\nbreak;\ncase 123: case 125:\n$$[$0-2].push($$[$0]);this.$ = $$[$0-2];\nbreak;\ncase 127:\nthis.$ = $$[$0-1] + $$[$0];\nbreak;\ncase 149:\nthis.$=$$[$0]\nbreak;\ncase 150:\nthis.$=$$[$0-1]+''+$$[$0]\nbreak;\ncase 155:\nthis.$='v';\nbreak;\ncase 156:\nthis.$='-';\nbreak;\ncase 157:\n this.$={stmt:'dir', value:'TB'};\nbreak;\ncase 158:\n this.$={stmt:'dir', value:'BT'};\nbreak;\ncase 159:\n this.$={stmt:'dir', value:'RL'};\nbreak;\ncase 160:\n this.$={stmt:'dir', value:'LR'};\nbreak;\n}\n},\ntable: [{3:1,4:2,5:3,6:5,12:$V0,16:4,21:$V1,22:$V2,24:$V3},{1:[3]},{1:[2,1]},{3:10,4:2,5:3,6:5,12:$V0,16:4,21:$V1,22:$V2,24:$V3},o($V4,$V5,{17:11}),{7:12,13:[1,13]},{16:14,21:$V1,22:$V2,24:$V3},{16:15,21:$V1,22:$V2,24:$V3},{25:[1,16],26:[1,17]},{13:[2,5]},{1:[2,2]},{1:[2,9],18:18,19:19,20:$V6,21:$V7,22:$V8,23:$V9,32:24,33:25,34:26,35:27,36:28,37:29,38:$Va,43:31,44:$Vb,46:$Vc,49:34,50:44,51:$Vd,53:45,65:$Ve,66:$Vf,85:$Vg,86:$Vh,87:$Vi,88:$Vj,89:$Vk,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,117:$Vs,118:$Vt,119:$Vu,120:$Vv,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},{8:63,10:[1,64],15:$VC},o([10,15],[2,6]),o($V4,[2,17]),o($V4,[2,18]),o($V4,[2,19]),{20:[1,67],21:[1,68],22:$VD,27:66,30:69},o($VE,[2,11]),o($VE,[2,12]),o($VE,[2,13]),o($VE,[2,14]),o($VE,[2,15]),o($VE,[2,16]),{9:71,20:$VF,21:$VG,23:$VH,48:72,77:76,80:[1,77],81:[1,78]},{9:79,20:$VF,21:$VG,23:$VH},{9:80,20:$VF,21:$VG,23:$VH},{9:81,20:$VF,21:$VG,23:$VH},{9:82,20:$VF,21:$VG,23:$VH},{9:83,20:$VF,21:$VG,23:$VH},{9:85,20:$VF,21:$VG,22:[1,84],23:$VH},o($VE,[2,44]),{45:[1,86]},{47:[1,87]},o($VI,[2,53],{30:88,22:$VD}),{22:[1,89]},{22:[1,90]},{22:[1,91]},{22:[1,92]},{26:$VJ,51:$VK,65:$VL,66:$VM,83:[1,96],90:$VN,96:95,97:[1,93],99:[1,94],104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($VE,[2,157]),o($VE,[2,158]),o($VE,[2,159]),o($VE,[2,160]),o($VZ,[2,54],{52:[1,115]}),o($V_,[2,73],{115:128,40:[1,116],51:$Vd,54:[1,117],56:[1,118],58:[1,119],60:[1,120],62:[1,121],64:[1,122],65:$Ve,66:$Vf,68:[1,123],70:[1,124],72:[1,125],73:[1,126],75:[1,127],90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB}),o($V$,[2,149]),o($V$,[2,174]),o($V$,[2,175]),o($V$,[2,176]),o($V$,[2,177]),o($V$,[2,178]),o($V$,[2,179]),o($V$,[2,180]),o($V$,[2,181]),o($V$,[2,182]),o($V$,[2,183]),o($V$,[2,184]),o($V$,[2,185]),o($V$,[2,186]),o($V$,[2,187]),o($V$,[2,188]),o($V$,[2,189]),{9:129,20:$VF,21:$VG,23:$VH},{11:130,14:[1,131]},o($V01,[2,8]),o($V4,[2,20]),o($V4,[2,26]),o($V4,[2,27]),{21:[1,132]},o($V11,[2,34],{30:133,22:$VD}),o($VE,[2,35]),{49:134,50:44,51:$Vd,53:45,65:$Ve,66:$Vf,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},o($V21,[2,47]),o($V21,[2,48]),o($V21,[2,49]),o($V31,[2,77],{78:135,67:[1,137],79:[1,136]}),{22:$V41,24:$V51,26:$V61,38:$V71,39:138,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o([51,65,66,67,79,90,94,104,105,108,110,111,121,122,123,124,125,126],[2,79]),o($VE,[2,36]),o($VE,[2,37]),o($VE,[2,38]),o($VE,[2,39]),o($VE,[2,40]),{22:$V41,24:$V51,26:$V61,38:$V71,39:162,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($Vn1,$V5,{17:163}),o($VE,[2,45]),o($VE,[2,46]),o($VI,[2,52],{51:$Vo1}),{26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,96:165,101:[1,166],104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{94:[1,167],102:168,104:[1,169]},{26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,94:[1,170],96:171,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,96:172,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V01,[2,100],{22:[1,173],98:[1,174]}),o($V01,[2,104],{22:[1,175]}),o($V01,[2,108],{114:99,116:177,22:[1,176],26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY}),o($V01,[2,110],{22:[1,178]}),o($Vp1,[2,151]),o($Vp1,[2,153]),o($Vp1,[2,154]),o($Vp1,[2,155]),o($Vp1,[2,156]),o($Vq1,[2,161]),o($Vq1,[2,162]),o($Vq1,[2,163]),o($Vq1,[2,164]),o($Vq1,[2,165]),o($Vq1,[2,166]),o($Vq1,[2,167]),o($Vq1,[2,168]),o($Vq1,[2,169]),o($Vq1,[2,170]),o($Vq1,[2,171]),o($Vq1,[2,172]),o($Vq1,[2,173]),{51:$Vd,53:179,65:$Ve,66:$Vf,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},{22:$V41,24:$V51,26:$V61,38:$V71,39:180,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:181,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:183,42:$V81,51:$VK,56:[1,182],65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:184,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:185,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:186,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{65:[1,187]},{22:$V41,24:$V51,26:$V61,38:$V71,39:188,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:189,42:$V81,51:$VK,65:$VL,66:$VM,70:[1,190],72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:191,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:192,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:193,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V$,[2,150]),o($Vr1,[2,3]),{8:194,15:$VC},{15:[2,7]},o($V4,[2,28]),o($V11,[2,33]),o($VI,[2,50],{30:195,22:$VD}),o($V31,[2,74],{22:[1,196]}),{22:[1,197]},{22:$V41,24:$V51,26:$V61,38:$V71,39:198,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,81:[1,199],82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($Vq1,[2,81]),o($Vq1,[2,83]),o($Vq1,[2,139]),o($Vq1,[2,140]),o($Vq1,[2,141]),o($Vq1,[2,142]),o($Vq1,[2,143]),o($Vq1,[2,144]),o($Vq1,[2,145]),o($Vq1,[2,146]),o($Vq1,[2,147]),o($Vq1,[2,148]),o($Vq1,[2,84]),o($Vq1,[2,85]),o($Vq1,[2,86]),o($Vq1,[2,87]),o($Vq1,[2,88]),o($Vq1,[2,89]),o($Vq1,[2,90]),o($Vq1,[2,91]),o($Vq1,[2,92]),o($Vq1,[2,93]),o($Vq1,[2,94]),{9:202,20:$VF,21:$VG,22:$V41,23:$VH,24:$V51,26:$V61,38:$V71,40:[1,201],42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{18:18,19:19,20:$V6,21:$V7,22:$V8,23:$V9,32:24,33:25,34:26,35:27,36:28,37:29,38:$Va,42:[1,203],43:31,44:$Vb,46:$Vc,49:34,50:44,51:$Vd,53:45,65:$Ve,66:$Vf,85:$Vg,86:$Vh,87:$Vi,88:$Vj,89:$Vk,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,117:$Vs,118:$Vt,119:$Vu,120:$Vv,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},{22:$VD,30:204},{22:[1,205],26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:177,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:[1,206]},{22:[1,207]},{22:[1,208],105:[1,209]},o($Vs1,[2,122]),{22:[1,210]},{22:[1,211],26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:177,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:[1,212],26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:177,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{83:[1,213]},o($V01,[2,102],{22:[1,214]}),{83:[1,215],100:[1,216]},{83:[1,217]},o($Vp1,[2,152]),{83:[1,218],100:[1,219]},o($VZ,[2,56],{115:128,51:$Vd,65:$Ve,66:$Vf,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB}),{22:$V41,24:$V51,26:$V61,38:$V71,41:[1,220],42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,55:[1,221],65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:222,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,57:[1,223],65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,59:[1,224],65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,61:[1,225],65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,63:[1,226],65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{66:[1,227]},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,69:[1,228],72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,71:[1,229],72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,39:230,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,41:[1,231],42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,74:[1,232],76:[1,233],80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,74:[1,235],76:[1,234],80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{9:236,20:$VF,21:$VG,23:$VH},o($VI,[2,51],{51:$Vo1}),o($V31,[2,76]),o($V31,[2,75]),{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,67:[1,237],72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V31,[2,78]),o($Vq1,[2,82]),{22:$V41,24:$V51,26:$V61,38:$V71,39:238,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($Vn1,$V5,{17:239}),o($VE,[2,43]),{50:240,51:$Vd,53:45,65:$Ve,66:$Vf,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:241,101:$Vx1,104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:255,101:$Vx1,104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:256,101:$Vx1,103:[1,257],104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:258,101:$Vx1,103:[1,259],104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{104:[1,260]},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:261,101:$Vx1,104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:262,101:$Vx1,104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,96:263,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V01,[2,101]),{83:[1,264]},o($V01,[2,105],{22:[1,265]}),o($V01,[2,106]),o($V01,[2,109]),o($V01,[2,111],{22:[1,266]}),o($V01,[2,112]),o($V_,[2,57]),o($V_,[2,58]),{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,57:[1,267],65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V_,[2,65]),o($V_,[2,60]),o($V_,[2,61]),o($V_,[2,62]),{65:[1,268]},o($V_,[2,64]),o($V_,[2,66]),{22:$V41,24:$V51,26:$V61,38:$V71,42:$V81,51:$VK,65:$VL,66:$VM,71:[1,269],72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V_,[2,68]),o($V_,[2,69]),o($V_,[2,71]),o($V_,[2,70]),o($V_,[2,72]),o($Vr1,[2,4]),o([22,51,65,66,90,94,104,105,108,110,111,121,122,123,124,125,126],[2,80]),{22:$V41,24:$V51,26:$V61,38:$V71,41:[1,270],42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{18:18,19:19,20:$V6,21:$V7,22:$V8,23:$V9,32:24,33:25,34:26,35:27,36:28,37:29,38:$Va,42:[1,271],43:31,44:$Vb,46:$Vc,49:34,50:44,51:$Vd,53:45,65:$Ve,66:$Vf,85:$Vg,86:$Vh,87:$Vi,88:$Vj,89:$Vk,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,117:$Vs,118:$Vt,119:$Vu,120:$Vv,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},o($VZ,[2,55]),o($V01,[2,114],{105:$VE1}),o($VF1,[2,124],{107:273,22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,101:$Vx1,104:$Vy1,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1}),o($VG1,[2,126]),o($VG1,[2,128]),o($VG1,[2,129]),o($VG1,[2,130]),o($VG1,[2,131]),o($VG1,[2,132]),o($VG1,[2,133]),o($VG1,[2,134]),o($VG1,[2,135]),o($VG1,[2,136]),o($VG1,[2,137]),o($VG1,[2,138]),o($V01,[2,115],{105:$VE1}),o($V01,[2,116],{105:$VE1}),{22:[1,274]},o($V01,[2,117],{105:$VE1}),{22:[1,275]},o($Vs1,[2,123]),o($V01,[2,97],{105:$VE1}),o($V01,[2,98],{105:$VE1}),o($V01,[2,99],{114:99,116:177,26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY}),o($V01,[2,103]),{100:[1,276]},{100:[1,277]},{57:[1,278]},{67:[1,279]},{71:[1,280]},{9:281,20:$VF,21:$VG,23:$VH},o($VE,[2,42]),{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,101:$Vx1,104:$Vy1,106:282,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},o($VG1,[2,127]),{26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,96:283,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,96:284,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,114:99,116:97,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V01,[2,107]),o($V01,[2,113]),o($V_,[2,59]),{22:$V41,24:$V51,26:$V61,38:$V71,39:285,42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:139,83:$Vb1,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},o($V_,[2,67]),o($Vn1,$V5,{17:286}),o($VF1,[2,125],{107:273,22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,101:$Vx1,104:$Vy1,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1}),o($V01,[2,120],{114:99,116:177,22:[1,287],26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY}),o($V01,[2,121],{114:99,116:177,22:[1,288],26:$VJ,51:$VK,65:$VL,66:$VM,90:$VN,104:$VO,105:$VP,108:$VQ,110:$VR,111:$VS,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY}),{22:$V41,24:$V51,26:$V61,38:$V71,41:[1,289],42:$V81,51:$VK,65:$VL,66:$VM,72:$V91,80:$Va1,82:200,84:150,85:$Vc1,86:$Vd1,87:$Ve1,88:$Vf1,89:$Vg1,90:$Vh1,91:$Vi1,93:141,94:$Vj1,104:$VO,105:$VP,108:$Vk1,110:$VR,111:$VS,112:$Vl1,113:$Vm1,114:147,121:$VT,122:$VU,123:$VV,124:$VW,125:$VX,126:$VY},{18:18,19:19,20:$V6,21:$V7,22:$V8,23:$V9,32:24,33:25,34:26,35:27,36:28,37:29,38:$Va,42:[1,290],43:31,44:$Vb,46:$Vc,49:34,50:44,51:$Vd,53:45,65:$Ve,66:$Vf,85:$Vg,86:$Vh,87:$Vi,88:$Vj,89:$Vk,90:$Vl,94:$Vm,104:$Vn,105:$Vo,108:$Vp,110:$Vq,111:$Vr,115:46,117:$Vs,118:$Vt,119:$Vu,120:$Vv,121:$Vw,122:$Vx,123:$Vy,124:$Vz,125:$VA,126:$VB},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:291,101:$Vx1,104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},{22:$Vt1,65:$Vu1,66:$Vv1,85:$Vw1,95:292,101:$Vx1,104:$Vy1,106:242,107:243,108:$Vz1,109:$VA1,110:$VB1,111:$VC1,112:$VD1},o($V_,[2,63]),o($VE,[2,41]),o($V01,[2,118],{105:$VE1}),o($V01,[2,119],{105:$VE1})],\ndefaultActions: {2:[2,1],9:[2,5],10:[2,2],131:[2,7]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 12; \nbreak;\ncase 1: this.begin('type_directive'); return 13; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 10; \nbreak;\ncase 3: this.popState(); this.popState(); return 15; \nbreak;\ncase 4:return 14;\nbreak;\ncase 5:/* skip comments */\nbreak;\ncase 6:/* skip comments */\nbreak;\ncase 7: this.begin(\"title\");return 44; \nbreak;\ncase 8: this.popState(); return \"title_value\"; \nbreak;\ncase 9: this.begin(\"accDescription\");return 46; \nbreak;\ncase 10: this.popState(); return \"description_value\"; \nbreak;\ncase 11:this.begin(\"string\");\nbreak;\ncase 12:this.popState();\nbreak;\ncase 13:return \"STR\";\nbreak;\ncase 14:return 85;\nbreak;\ncase 15:return 94;\nbreak;\ncase 16:return 86;\nbreak;\ncase 17:return 103;\nbreak;\ncase 18:return 87;\nbreak;\ncase 19:return 88;\nbreak;\ncase 20:this.begin(\"href\");\nbreak;\ncase 21:this.popState();\nbreak;\ncase 22:return 99;\nbreak;\ncase 23:this.begin(\"callbackname\");\nbreak;\ncase 24:this.popState();\nbreak;\ncase 25:this.popState(); this.begin(\"callbackargs\");\nbreak;\ncase 26:return 97;\nbreak;\ncase 27:this.popState();\nbreak;\ncase 28:return 98;\nbreak;\ncase 29:this.begin(\"click\");\nbreak;\ncase 30:this.popState();\nbreak;\ncase 31:return 89;\nbreak;\ncase 32:if(yy.lex.firstGraph()){this.begin(\"dir\");}  return 24;\nbreak;\ncase 33:if(yy.lex.firstGraph()){this.begin(\"dir\");}  return 24;\nbreak;\ncase 34:return 38;\nbreak;\ncase 35:return 42;\nbreak;\ncase 36:return 100;\nbreak;\ncase 37:return 100;\nbreak;\ncase 38:return 100;\nbreak;\ncase 39:return 100;\nbreak;\ncase 40:   this.popState();  return 25; \nbreak;\ncase 41:   this.popState();  return 26; \nbreak;\ncase 42:   this.popState();  return 26; \nbreak;\ncase 43:   this.popState();  return 26; \nbreak;\ncase 44:   this.popState();  return 26; \nbreak;\ncase 45:   this.popState();  return 26; \nbreak;\ncase 46:   this.popState();  return 26; \nbreak;\ncase 47:   this.popState();  return 26; \nbreak;\ncase 48:   this.popState();  return 26; \nbreak;\ncase 49:   this.popState();  return 26; \nbreak;\ncase 50:   this.popState();  return 26; \nbreak;\ncase 51:return 117;\nbreak;\ncase 52:return 118;\nbreak;\ncase 53:return 119;\nbreak;\ncase 54:return 120;\nbreak;\ncase 55: return 104;\nbreak;\ncase 56:return 110;\nbreak;\ncase 57:return 52;\nbreak;\ncase 58:return 66;\nbreak;\ncase 59:return 51;\nbreak;\ncase 60:return 20;\nbreak;\ncase 61:return 105;\nbreak;\ncase 62:return 125;\nbreak;\ncase 63:return 81;\nbreak;\ncase 64:return 81;\nbreak;\ncase 65:return 81;\nbreak;\ncase 66:return 80;\nbreak;\ncase 67:return 80;\nbreak;\ncase 68:return 80;\nbreak;\ncase 69:return 58;\nbreak;\ncase 70:return 59;\nbreak;\ncase 71:return 60;\nbreak;\ncase 72:return 61;\nbreak;\ncase 73:return 62;\nbreak;\ncase 74:return 63;\nbreak;\ncase 75:return 64;\nbreak;\ncase 76:return 68;\nbreak;\ncase 77:return 69;\nbreak;\ncase 78:return 54;\nbreak;\ncase 79:return 55;\nbreak;\ncase 80:return 108;\nbreak;\ncase 81:return 111;\nbreak;\ncase 82:return 126;\nbreak;\ncase 83:return 123;\nbreak;\ncase 84:return 112;\nbreak;\ncase 85:return 124;\nbreak;\ncase 86:return 124;\nbreak;\ncase 87:return 113;\nbreak;\ncase 88:return 72;\nbreak;\ncase 89:return 91;\nbreak;\ncase 90:return 'SEP';\nbreak;\ncase 91:return 90;\nbreak;\ncase 92:return 65;\nbreak;\ncase 93:return 74;\nbreak;\ncase 94:return 73;\nbreak;\ncase 95:return 76;\nbreak;\ncase 96:return 75;\nbreak;\ncase 97:return 121;\nbreak;\ncase 98:return 122;\nbreak;\ncase 99:return 67;\nbreak;\ncase 100:return 56;\nbreak;\ncase 101:return 57;\nbreak;\ncase 102:return 40;\nbreak;\ncase 103:return 41;\nbreak;\ncase 104:return 70\nbreak;\ncase 105:return 71\nbreak;\ncase 106:return 132;\nbreak;\ncase 107:return 21;\nbreak;\ncase 108:return 22;\nbreak;\ncase 109:return 23;\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/,/^(?:((?:(?!\\}%%)[^:.])*))/,/^(?::)/,/^(?:\\}%%)/,/^(?:((?:(?!\\}%%).|\\n)*))/,/^(?:%%(?!\\{)[^\\n]*)/,/^(?:[^\\}]%%[^\\n]*)/,/^(?:title\\b)/,/^(?:(?!\\n||)*[^\\n]*)/,/^(?:accDescription\\b)/,/^(?:(?!\\n||)*[^\\n]*)/,/^(?:[\"])/,/^(?:[\"])/,/^(?:[^\"]*)/,/^(?:style\\b)/,/^(?:default\\b)/,/^(?:linkStyle\\b)/,/^(?:interpolate\\b)/,/^(?:classDef\\b)/,/^(?:class\\b)/,/^(?:href[\\s]+[\"])/,/^(?:[\"])/,/^(?:[^\"]*)/,/^(?:call[\\s]+)/,/^(?:\\([\\s]*\\))/,/^(?:\\()/,/^(?:[^(]*)/,/^(?:\\))/,/^(?:[^)]*)/,/^(?:click[\\s]+)/,/^(?:[\\s\\n])/,/^(?:[^\\s\\n]*)/,/^(?:graph\\b)/,/^(?:flowchart\\b)/,/^(?:subgraph\\b)/,/^(?:end\\b\\s*)/,/^(?:_self\\b)/,/^(?:_blank\\b)/,/^(?:_parent\\b)/,/^(?:_top\\b)/,/^(?:(\\r?\\n)*\\s*\\n)/,/^(?:\\s*LR\\b)/,/^(?:\\s*RL\\b)/,/^(?:\\s*TB\\b)/,/^(?:\\s*BT\\b)/,/^(?:\\s*TD\\b)/,/^(?:\\s*BR\\b)/,/^(?:\\s*<)/,/^(?:\\s*>)/,/^(?:\\s*\\^)/,/^(?:\\s*v\\b)/,/^(?:.*direction\\s+TB[^\\n]*)/,/^(?:.*direction\\s+BT[^\\n]*)/,/^(?:.*direction\\s+RL[^\\n]*)/,/^(?:.*direction\\s+LR[^\\n]*)/,/^(?:[0-9]+)/,/^(?:#)/,/^(?::::)/,/^(?::)/,/^(?:&)/,/^(?:;)/,/^(?:,)/,/^(?:\\*)/,/^(?:\\s*[xo<]?--+[-xo>]\\s*)/,/^(?:\\s*[xo<]?==+[=xo>]\\s*)/,/^(?:\\s*[xo<]?-?\\.+-[xo>]?\\s*)/,/^(?:\\s*[xo<]?--\\s*)/,/^(?:\\s*[xo<]?==\\s*)/,/^(?:\\s*[xo<]?-\\.\\s*)/,/^(?:\\(-)/,/^(?:-\\))/,/^(?:\\(\\[)/,/^(?:\\]\\))/,/^(?:\\[\\[)/,/^(?:\\]\\])/,/^(?:\\[\\|)/,/^(?:\\[\\()/,/^(?:\\)\\])/,/^(?:\\(\\(\\()/,/^(?:\\)\\)\\))/,/^(?:-)/,/^(?:\\.)/,/^(?:[\\_])/,/^(?:\\+)/,/^(?:%)/,/^(?:=)/,/^(?:=)/,/^(?:<)/,/^(?:>)/,/^(?:\\^)/,/^(?:\\\\\\|)/,/^(?:v\\b)/,/^(?:[A-Za-z]+)/,/^(?:\\\\\\])/,/^(?:\\[\\/)/,/^(?:\\/\\])/,/^(?:\\[\\\\)/,/^(?:[!\"#$%&'*+,-.`?\\\\_/])/,/^(?:[\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6]|[\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377]|[\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5]|[\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA]|[\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE]|[\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA]|[\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0]|[\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977]|[\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2]|[\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A]|[\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39]|[\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8]|[\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C]|[\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C]|[\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99]|[\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0]|[\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D]|[\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3]|[\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10]|[\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1]|[\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81]|[\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3]|[\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6]|[\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A]|[\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081]|[\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D]|[\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0]|[\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310]|[\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C]|[\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711]|[\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7]|[\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C]|[\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16]|[\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF]|[\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC]|[\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D]|[\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D]|[\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3]|[\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F]|[\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128]|[\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184]|[\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3]|[\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6]|[\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE]|[\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C]|[\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D]|[\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC]|[\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B]|[\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788]|[\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805]|[\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB]|[\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28]|[\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5]|[\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4]|[\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E]|[\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D]|[\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36]|[\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D]|[\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC]|[\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF]|[\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC])/,/^(?:\\|)/,/^(?:\\()/,/^(?:\\))/,/^(?:\\[)/,/^(?:\\])/,/^(?:\\{)/,/^(?:\\})/,/^(?:\")/,/^(?:(\\r?\\n)+)/,/^(?:\\s)/,/^(?:$)/],\nconditions: {\"close_directive\":{\"rules\":[],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3],\"inclusive\":false},\"open_directive\":{\"rules\":[1],\"inclusive\":false},\"callbackargs\":{\"rules\":[27,28],\"inclusive\":false},\"callbackname\":{\"rules\":[24,25,26],\"inclusive\":false},\"href\":{\"rules\":[21,22],\"inclusive\":false},\"click\":{\"rules\":[30,31],\"inclusive\":false},\"vertex\":{\"rules\":[],\"inclusive\":false},\"dir\":{\"rules\":[40,41,42,43,44,45,46,47,48,49,50],\"inclusive\":false},\"accDescription\":{\"rules\":[10],\"inclusive\":false},\"title\":{\"rules\":[8],\"inclusive\":false},\"string\":{\"rules\":[12,13],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,7,9,11,14,15,16,17,18,19,20,23,29,32,33,34,35,36,37,38,39,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,3],$V1=[1,5],$V2=[7,9,11,12,13,14,15,16,17,18,19,20,21,23,30,35],$V3=[1,15],$V4=[1,16],$V5=[1,17],$V6=[1,18],$V7=[1,19],$V8=[1,20],$V9=[1,21],$Va=[1,22],$Vb=[1,23],$Vc=[1,24],$Vd=[1,26],$Ve=[1,28],$Vf=[1,31],$Vg=[5,7,9,11,12,13,14,15,16,17,18,19,20,21,23,30,35];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"directive\":4,\"gantt\":5,\"document\":6,\"EOF\":7,\"line\":8,\"SPACE\":9,\"statement\":10,\"NL\":11,\"dateFormat\":12,\"inclusiveEndDates\":13,\"topAxis\":14,\"axisFormat\":15,\"excludes\":16,\"includes\":17,\"todayMarker\":18,\"title\":19,\"accDescription\":20,\"section\":21,\"clickStatement\":22,\"taskTxt\":23,\"taskData\":24,\"openDirective\":25,\"typeDirective\":26,\"closeDirective\":27,\":\":28,\"argDirective\":29,\"click\":30,\"callbackname\":31,\"callbackargs\":32,\"href\":33,\"clickStatementDebug\":34,\"open_directive\":35,\"type_directive\":36,\"arg_directive\":37,\"close_directive\":38,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",5:\"gantt\",7:\"EOF\",9:\"SPACE\",11:\"NL\",12:\"dateFormat\",13:\"inclusiveEndDates\",14:\"topAxis\",15:\"axisFormat\",16:\"excludes\",17:\"includes\",18:\"todayMarker\",19:\"title\",20:\"accDescription\",21:\"section\",23:\"taskTxt\",24:\"taskData\",28:\":\",30:\"click\",31:\"callbackname\",32:\"callbackargs\",33:\"href\",35:\"open_directive\",36:\"type_directive\",37:\"arg_directive\",38:\"close_directive\"},\nproductions_: [0,[3,2],[3,3],[6,0],[6,2],[8,2],[8,1],[8,1],[8,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,1],[10,2],[10,1],[4,4],[4,6],[22,2],[22,3],[22,3],[22,4],[22,3],[22,4],[22,2],[34,2],[34,3],[34,3],[34,4],[34,3],[34,4],[34,2],[25,1],[26,1],[29,1],[27,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 2:\n return $$[$0-1]; \nbreak;\ncase 3:\n this.$ = [] \nbreak;\ncase 4:\n$$[$0-1].push($$[$0]);this.$ = $$[$0-1]\nbreak;\ncase 5: case 6:\n this.$ = $$[$0] \nbreak;\ncase 7: case 8:\n this.$=[];\nbreak;\ncase 9:\nyy.setDateFormat($$[$0].substr(11));this.$=$$[$0].substr(11);\nbreak;\ncase 10:\nyy.enableInclusiveEndDates();this.$=$$[$0].substr(18);\nbreak;\ncase 11:\nyy.TopAxis();this.$=$$[$0].substr(8);\nbreak;\ncase 12:\nyy.setAxisFormat($$[$0].substr(11));this.$=$$[$0].substr(11);\nbreak;\ncase 13:\nyy.setExcludes($$[$0].substr(9));this.$=$$[$0].substr(9);\nbreak;\ncase 14:\nyy.setIncludes($$[$0].substr(9));this.$=$$[$0].substr(9);\nbreak;\ncase 15:\nyy.setTodayMarker($$[$0].substr(12));this.$=$$[$0].substr(12);\nbreak;\ncase 16:\nyy.setTitle($$[$0].substr(6));this.$=$$[$0].substr(6);\nbreak;\ncase 17:\nyy.setAccDescription($$[$0].substr(15));this.$=$$[$0].substr(15);\nbreak;\ncase 18:\nyy.addSection($$[$0].substr(8));this.$=$$[$0].substr(8);\nbreak;\ncase 20:\nyy.addTask($$[$0-1],$$[$0]);this.$='task';\nbreak;\ncase 24:\nthis.$ = $$[$0-1];yy.setClickEvent($$[$0-1], $$[$0], null);\nbreak;\ncase 25:\nthis.$ = $$[$0-2];yy.setClickEvent($$[$0-2], $$[$0-1], $$[$0]);\nbreak;\ncase 26:\nthis.$ = $$[$0-2];yy.setClickEvent($$[$0-2], $$[$0-1], null);yy.setLink($$[$0-2],$$[$0]);\nbreak;\ncase 27:\nthis.$ = $$[$0-3];yy.setClickEvent($$[$0-3], $$[$0-2], $$[$0-1]);yy.setLink($$[$0-3],$$[$0]);\nbreak;\ncase 28:\nthis.$ = $$[$0-2];yy.setClickEvent($$[$0-2], $$[$0], null);yy.setLink($$[$0-2],$$[$0-1]);\nbreak;\ncase 29:\nthis.$ = $$[$0-3];yy.setClickEvent($$[$0-3], $$[$0-1], $$[$0]);yy.setLink($$[$0-3],$$[$0-2]);\nbreak;\ncase 30:\nthis.$ = $$[$0-1];yy.setLink($$[$0-1], $$[$0]);\nbreak;\ncase 31: case 37:\nthis.$=$$[$0-1] + ' ' + $$[$0];\nbreak;\ncase 32: case 33: case 35:\nthis.$=$$[$0-2] + ' ' + $$[$0-1] + ' ' + $$[$0];\nbreak;\ncase 34: case 36:\nthis.$=$$[$0-3] + ' ' + $$[$0-2] + ' ' + $$[$0-1] + ' ' + $$[$0];\nbreak;\ncase 38:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 39:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 40:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 41:\n yy.parseDirective('}%%', 'close_directive', 'gantt'); \nbreak;\n}\n},\ntable: [{3:1,4:2,5:$V0,25:4,35:$V1},{1:[3]},{3:6,4:2,5:$V0,25:4,35:$V1},o($V2,[2,3],{6:7}),{26:8,36:[1,9]},{36:[2,38]},{1:[2,1]},{4:27,7:[1,10],8:11,9:[1,12],10:13,11:[1,14],12:$V3,13:$V4,14:$V5,15:$V6,16:$V7,17:$V8,18:$V9,19:$Va,20:$Vb,21:$Vc,22:25,23:$Vd,25:4,30:$Ve,35:$V1},{27:29,28:[1,30],38:$Vf},o([28,38],[2,39]),o($V2,[2,8],{1:[2,2]}),o($V2,[2,4]),{4:27,10:32,12:$V3,13:$V4,14:$V5,15:$V6,16:$V7,17:$V8,18:$V9,19:$Va,20:$Vb,21:$Vc,22:25,23:$Vd,25:4,30:$Ve,35:$V1},o($V2,[2,6]),o($V2,[2,7]),o($V2,[2,9]),o($V2,[2,10]),o($V2,[2,11]),o($V2,[2,12]),o($V2,[2,13]),o($V2,[2,14]),o($V2,[2,15]),o($V2,[2,16]),o($V2,[2,17]),o($V2,[2,18]),o($V2,[2,19]),{24:[1,33]},o($V2,[2,21]),{31:[1,34],33:[1,35]},{11:[1,36]},{29:37,37:[1,38]},{11:[2,41]},o($V2,[2,5]),o($V2,[2,20]),o($V2,[2,24],{32:[1,39],33:[1,40]}),o($V2,[2,30],{31:[1,41]}),o($Vg,[2,22]),{27:42,38:$Vf},{38:[2,40]},o($V2,[2,25],{33:[1,43]}),o($V2,[2,26]),o($V2,[2,28],{32:[1,44]}),{11:[1,45]},o($V2,[2,27]),o($V2,[2,29]),o($Vg,[2,23])],\ndefaultActions: {5:[2,38],6:[2,1],31:[2,41],38:[2,40]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 35; \nbreak;\ncase 1: this.begin('type_directive'); return 36; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 28; \nbreak;\ncase 3: this.popState(); this.popState(); return 38; \nbreak;\ncase 4:return 37;\nbreak;\ncase 5:/* skip comments */\nbreak;\ncase 6:/* skip comments */\nbreak;\ncase 7:/* do nothing */\nbreak;\ncase 8:return 11;\nbreak;\ncase 9:/* skip whitespace */\nbreak;\ncase 10:/* skip comments */\nbreak;\ncase 11:/* skip comments */\nbreak;\ncase 12:this.begin(\"href\");\nbreak;\ncase 13:this.popState();\nbreak;\ncase 14:return 33;\nbreak;\ncase 15:this.begin(\"callbackname\");\nbreak;\ncase 16:this.popState();\nbreak;\ncase 17:this.popState(); this.begin(\"callbackargs\");\nbreak;\ncase 18:return 31;\nbreak;\ncase 19:this.popState();\nbreak;\ncase 20:return 32;\nbreak;\ncase 21:this.begin(\"click\");\nbreak;\ncase 22:this.popState();\nbreak;\ncase 23:return 30;\nbreak;\ncase 24:return 5;\nbreak;\ncase 25:return 12;\nbreak;\ncase 26:return 13;\nbreak;\ncase 27:return 14;\nbreak;\ncase 28:return 15;\nbreak;\ncase 29:return 17;\nbreak;\ncase 30:return 16;\nbreak;\ncase 31:return 18;\nbreak;\ncase 32:return 'date';\nbreak;\ncase 33:return 19;\nbreak;\ncase 34:return 20\nbreak;\ncase 35:return 21;\nbreak;\ncase 36:return 23;\nbreak;\ncase 37:return 24;\nbreak;\ncase 38:return 28;\nbreak;\ncase 39:return 7;\nbreak;\ncase 40:return 'INVALID';\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:%%(?!\\{)*[^\\n]*)/i,/^(?:[^\\}]%%*[^\\n]*)/i,/^(?:%%*[^\\n]*[\\n]*)/i,/^(?:[\\n]+)/i,/^(?:\\s+)/i,/^(?:#[^\\n]*)/i,/^(?:%[^\\n]*)/i,/^(?:href[\\s]+[\"])/i,/^(?:[\"])/i,/^(?:[^\"]*)/i,/^(?:call[\\s]+)/i,/^(?:\\([\\s]*\\))/i,/^(?:\\()/i,/^(?:[^(]*)/i,/^(?:\\))/i,/^(?:[^)]*)/i,/^(?:click[\\s]+)/i,/^(?:[\\s\\n])/i,/^(?:[^\\s\\n]*)/i,/^(?:gantt\\b)/i,/^(?:dateFormat\\s[^#\\n;]+)/i,/^(?:inclusiveEndDates\\b)/i,/^(?:topAxis\\b)/i,/^(?:axisFormat\\s[^#\\n;]+)/i,/^(?:includes\\s[^#\\n;]+)/i,/^(?:excludes\\s[^#\\n;]+)/i,/^(?:todayMarker\\s[^\\n;]+)/i,/^(?:\\d\\d\\d\\d-\\d\\d-\\d\\d\\b)/i,/^(?:title\\s[^#\\n;]+)/i,/^(?:accDescription\\s[^#\\n;]+)/i,/^(?:section\\s[^#:\\n;]+)/i,/^(?:[^#:\\n;]+)/i,/^(?::[^#\\n;]+)/i,/^(?::)/i,/^(?:$)/i,/^(?:.)/i],\nconditions: {\"close_directive\":{\"rules\":[],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3],\"inclusive\":false},\"open_directive\":{\"rules\":[1],\"inclusive\":false},\"callbackargs\":{\"rules\":[19,20],\"inclusive\":false},\"callbackname\":{\"rules\":[16,17,18],\"inclusive\":false},\"href\":{\"rules\":[13,14],\"inclusive\":false},\"click\":{\"rules\":[22,23],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,7,8,9,10,11,12,15,21,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,4],$V1=[1,7],$V2=[1,5],$V3=[1,9],$V4=[1,6],$V5=[2,6],$V6=[1,16],$V7=[6,8,14,18,20,21,22,37,41],$V8=[8,14,18,20,21,22],$V9=[8,13,14,18,20,21,22],$Va=[1,26],$Vb=[6,8,14,37,41],$Vc=[8,14,41],$Vd=[1,53],$Ve=[1,54],$Vf=[1,55],$Vg=[8,14,24,28,29,41];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"eol\":4,\"directive\":5,\"GG\":6,\"document\":7,\"EOF\":8,\":\":9,\"DIR\":10,\"options\":11,\"body\":12,\"OPT\":13,\"NL\":14,\"line\":15,\"statement\":16,\"commitStatement\":17,\"BRANCH\":18,\"ID\":19,\"CHECKOUT\":20,\"MERGE\":21,\"COMMIT\":22,\"commit_arg\":23,\"COMMIT_TAG\":24,\"STR\":25,\"COMMIT_TYPE\":26,\"commitType\":27,\"COMMIT_ID\":28,\"COMMIT_MSG\":29,\"NORMAL\":30,\"REVERSE\":31,\"HIGHLIGHT\":32,\"openDirective\":33,\"typeDirective\":34,\"closeDirective\":35,\"argDirective\":36,\"open_directive\":37,\"type_directive\":38,\"arg_directive\":39,\"close_directive\":40,\";\":41,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",6:\"GG\",8:\"EOF\",9:\":\",10:\"DIR\",13:\"OPT\",14:\"NL\",18:\"BRANCH\",19:\"ID\",20:\"CHECKOUT\",21:\"MERGE\",22:\"COMMIT\",24:\"COMMIT_TAG\",25:\"STR\",26:\"COMMIT_TYPE\",28:\"COMMIT_ID\",29:\"COMMIT_MSG\",30:\"NORMAL\",31:\"REVERSE\",32:\"HIGHLIGHT\",37:\"open_directive\",38:\"type_directive\",39:\"arg_directive\",40:\"close_directive\",41:\";\"},\nproductions_: [0,[3,2],[3,2],[3,3],[3,4],[3,5],[7,0],[7,2],[11,2],[11,1],[12,0],[12,2],[15,2],[15,1],[16,1],[16,2],[16,2],[16,2],[17,2],[17,3],[17,3],[17,5],[17,5],[17,3],[17,5],[17,5],[17,5],[17,5],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,3],[17,5],[17,5],[17,5],[17,5],[17,5],[17,5],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,7],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[17,9],[23,0],[23,1],[27,1],[27,1],[27,1],[5,3],[5,5],[33,1],[34,1],[36,1],[35,1],[4,1],[4,1],[4,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 3:\n return $$[$0]; \nbreak;\ncase 4:\n return $$[$0-1]; \nbreak;\ncase 5:\nyy.setDirection($$[$0-3]); return $$[$0-1];\nbreak;\ncase 7:\n yy.setOptions($$[$0-1]); this.$ = $$[$0]\nbreak;\ncase 8:\n$$[$0-1] +=$$[$0]; this.$=$$[$0-1]\nbreak;\ncase 10:\nthis.$ = []\nbreak;\ncase 11:\n$$[$0-1].push($$[$0]); this.$=$$[$0-1];\nbreak;\ncase 12:\nthis.$ =$$[$0-1]\nbreak;\ncase 15:\nyy.branch($$[$0])\nbreak;\ncase 16:\nyy.checkout($$[$0])\nbreak;\ncase 17:\nyy.merge($$[$0])\nbreak;\ncase 18:\nyy.commit($$[$0])\nbreak;\ncase 19:\nyy.commit('','',yy.commitType.NORMAL,$$[$0])\nbreak;\ncase 20:\nyy.commit('','',$$[$0],'')\nbreak;\ncase 21:\nyy.commit('','',$$[$0],$$[$0-2])\nbreak;\ncase 22:\nyy.commit('','',$$[$0-2],$$[$0])\nbreak;\ncase 23:\nyy.commit('',$$[$0],yy.commitType.NORMAL,'')\nbreak;\ncase 24:\nyy.commit('',$$[$0-2],yy.commitType.NORMAL,$$[$0])\nbreak;\ncase 25:\nyy.commit('',$$[$0],yy.commitType.NORMAL,$$[$0-2])\nbreak;\ncase 26:\nyy.commit('',$$[$0-2],$$[$0],'')\nbreak;\ncase 27:\nyy.commit('',$$[$0],$$[$0-2],'')\nbreak;\ncase 28:\nyy.commit('',$$[$0-4],$$[$0-2],$$[$0])\nbreak;\ncase 29:\nyy.commit('',$$[$0-4],$$[$0],$$[$0-2])\nbreak;\ncase 30:\nyy.commit('',$$[$0-2],$$[$0-4],$$[$0])\nbreak;\ncase 31:\nyy.commit('',$$[$0],$$[$0-4],$$[$0-2])\nbreak;\ncase 32:\nyy.commit('',$$[$0],$$[$0-2],$$[$0-4])\nbreak;\ncase 33:\nyy.commit('',$$[$0-2],$$[$0],$$[$0-4])\nbreak;\ncase 34:\nyy.commit($$[$0],'',yy.commitType.NORMAL,'')\nbreak;\ncase 35:\nyy.commit($$[$0],'',yy.commitType.NORMAL,$$[$0-2])\nbreak;\ncase 36:\nyy.commit($$[$0-2],'',yy.commitType.NORMAL,$$[$0])\nbreak;\ncase 37:\nyy.commit($$[$0-2],'',$$[$0],'')\nbreak;\ncase 38:\nyy.commit($$[$0],'',$$[$0-2],'')\nbreak;\ncase 39:\nyy.commit($$[$0],$$[$0-2],yy.commitType.NORMAL,'')\nbreak;\ncase 40:\nyy.commit($$[$0-2],$$[$0],yy.commitType.NORMAL,'')\nbreak;\ncase 41:\nyy.commit($$[$0-4],'',$$[$0-2],$$[$0])\nbreak;\ncase 42:\nyy.commit($$[$0-4],'',$$[$0],$$[$0-2])\nbreak;\ncase 43:\nyy.commit($$[$0-2],'',$$[$0-4],$$[$0])\nbreak;\ncase 44:\nyy.commit($$[$0],'',$$[$0-4],$$[$0-2])\nbreak;\ncase 45:\nyy.commit($$[$0],'',$$[$0-2],$$[$0-4])\nbreak;\ncase 46:\nyy.commit($$[$0-2],'',$$[$0],$$[$0-4])\nbreak;\ncase 47:\nyy.commit($$[$0-4],$$[$0],$$[$0-2],'')\nbreak;\ncase 48:\nyy.commit($$[$0-4],$$[$0-2],$$[$0],'')\nbreak;\ncase 49:\nyy.commit($$[$0-2],$$[$0],$$[$0-4],'')\nbreak;\ncase 50:\nyy.commit($$[$0],$$[$0-2],$$[$0-4],'')\nbreak;\ncase 51:\nyy.commit($$[$0],$$[$0-4],$$[$0-2],'')\nbreak;\ncase 52:\nyy.commit($$[$0-2],$$[$0-4],$$[$0],'')\nbreak;\ncase 53:\nyy.commit($$[$0-4],$$[$0],yy.commitType.NORMAL,$$[$0-2])\nbreak;\ncase 54:\nyy.commit($$[$0-4],$$[$0-2],yy.commitType.NORMAL,$$[$0])\nbreak;\ncase 55:\nyy.commit($$[$0-2],$$[$0],yy.commitType.NORMAL,$$[$0-4])\nbreak;\ncase 56:\nyy.commit($$[$0],$$[$0-2],yy.commitType.NORMAL,$$[$0-4])\nbreak;\ncase 57:\nyy.commit($$[$0],$$[$0-4],yy.commitType.NORMAL,$$[$0-2])\nbreak;\ncase 58:\nyy.commit($$[$0-2],$$[$0-4],yy.commitType.NORMAL,$$[$0])\nbreak;\ncase 59:\nyy.commit($$[$0-6],$$[$0-4],$$[$0-2],$$[$0])\nbreak;\ncase 60:\nyy.commit($$[$0-6],$$[$0-4],$$[$0],$$[$0-2])\nbreak;\ncase 61:\nyy.commit($$[$0-6],$$[$0-2],$$[$0-4],$$[$0])\nbreak;\ncase 62:\nyy.commit($$[$0-6],$$[$0],$$[$0-4],$$[$0-2])\nbreak;\ncase 63:\nyy.commit($$[$0-6],$$[$0-2],$$[$0],$$[$0-4])\nbreak;\ncase 64:\nyy.commit($$[$0-6],$$[$0],$$[$0-2],$$[$0-4])\nbreak;\ncase 65:\nyy.commit($$[$0-4],$$[$0-6],$$[$0-2],$$[$0])\nbreak;\ncase 66:\nyy.commit($$[$0-4],$$[$0-6],$$[$0],$$[$0-2])\nbreak;\ncase 67:\nyy.commit($$[$0-2],$$[$0-6],$$[$0-4],$$[$0])\nbreak;\ncase 68:\nyy.commit($$[$0],$$[$0-6],$$[$0-4],$$[$0-2])\nbreak;\ncase 69:\nyy.commit($$[$0-2],$$[$0-6],$$[$0],$$[$0-4])\nbreak;\ncase 70:\nyy.commit($$[$0],$$[$0-6],$$[$0-2],$$[$0-4])\nbreak;\ncase 71:\nyy.commit($$[$0],$$[$0-4],$$[$0-2],$$[$0-6])\nbreak;\ncase 72:\nyy.commit($$[$0-2],$$[$0-4],$$[$0],$$[$0-6])\nbreak;\ncase 73:\nyy.commit($$[$0],$$[$0-2],$$[$0-4],$$[$0-6])\nbreak;\ncase 74:\nyy.commit($$[$0-2],$$[$0],$$[$0-4],$$[$0-6])\nbreak;\ncase 75:\nyy.commit($$[$0-4],$$[$0-2],$$[$0],$$[$0-6])\nbreak;\ncase 76:\nyy.commit($$[$0-4],$$[$0],$$[$0-2],$$[$0-6])\nbreak;\ncase 77:\nyy.commit($$[$0-2],$$[$0-4],$$[$0-6],$$[$0])\nbreak;\ncase 78:\nyy.commit($$[$0],$$[$0-4],$$[$0-6],$$[$0-2])\nbreak;\ncase 79:\nyy.commit($$[$0-2],$$[$0],$$[$0-6],$$[$0-4])\nbreak;\ncase 80:\nyy.commit($$[$0],$$[$0-2],$$[$0-6],$$[$0-4])\nbreak;\ncase 81:\nyy.commit($$[$0-4],$$[$0-2],$$[$0-6],$$[$0])\nbreak;\ncase 82:\nyy.commit($$[$0-4],$$[$0],$$[$0-6],$$[$0-2])\nbreak;\ncase 83:\nthis.$ = \"\"\nbreak;\ncase 84:\nthis.$=$$[$0]\nbreak;\ncase 85:\n this.$=yy.commitType.NORMAL;\nbreak;\ncase 86:\n this.$=yy.commitType.REVERSE;\nbreak;\ncase 87:\n this.$=yy.commitType.HIGHLIGHT;\nbreak;\ncase 90:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 91:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 92:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 93:\n yy.parseDirective('}%%', 'close_directive', 'gitGraph'); \nbreak;\n}\n},\ntable: [{3:1,4:2,5:3,6:$V0,8:$V1,14:$V2,33:8,37:$V3,41:$V4},{1:[3]},{3:10,4:2,5:3,6:$V0,8:$V1,14:$V2,33:8,37:$V3,41:$V4},{3:11,4:2,5:3,6:$V0,8:$V1,14:$V2,33:8,37:$V3,41:$V4},{7:12,8:$V5,9:[1,13],10:[1,14],11:15,14:$V6},o($V7,[2,94]),o($V7,[2,95]),o($V7,[2,96]),{34:17,38:[1,18]},{38:[2,90]},{1:[2,1]},{1:[2,2]},{8:[1,19]},{7:20,8:$V5,11:15,14:$V6},{9:[1,21]},o($V8,[2,10],{12:22,13:[1,23]}),o($V9,[2,9]),{9:[1,25],35:24,40:$Va},o([9,40],[2,91]),{1:[2,3]},{8:[1,27]},{7:28,8:$V5,11:15,14:$V6},{8:[2,7],14:[1,31],15:29,16:30,17:32,18:[1,33],20:[1,34],21:[1,35],22:[1,36]},o($V9,[2,8]),o($Vb,[2,88]),{36:37,39:[1,38]},o($Vb,[2,93]),{1:[2,4]},{8:[1,39]},o($V8,[2,11]),{4:40,8:$V1,14:$V2,41:$V4},o($V8,[2,13]),o($Vc,[2,14]),{19:[1,41]},{19:[1,42]},{19:[1,43]},o($Vc,[2,83],{23:44,24:[1,45],25:[1,49],26:[1,46],28:[1,47],29:[1,48]}),{35:50,40:$Va},{40:[2,92]},{1:[2,5]},o($V8,[2,12]),o($Vc,[2,15]),o($Vc,[2,16]),o($Vc,[2,17]),o($Vc,[2,18]),{25:[1,51]},{27:52,30:$Vd,31:$Ve,32:$Vf},{25:[1,56]},{25:[1,57]},o($Vc,[2,84]),o($Vb,[2,89]),o($Vc,[2,19],{26:[1,58],28:[1,59],29:[1,60]}),o($Vc,[2,20],{24:[1,61],28:[1,62],29:[1,63]}),o($Vg,[2,85]),o($Vg,[2,86]),o($Vg,[2,87]),o($Vc,[2,23],{24:[1,64],26:[1,65],29:[1,66]}),o($Vc,[2,34],{24:[1,67],26:[1,68],28:[1,69]}),{27:70,30:$Vd,31:$Ve,32:$Vf},{25:[1,71]},{25:[1,72]},{25:[1,73]},{25:[1,74]},{25:[1,75]},{25:[1,76]},{27:77,30:$Vd,31:$Ve,32:$Vf},{25:[1,78]},{25:[1,79]},{27:80,30:$Vd,31:$Ve,32:$Vf},{25:[1,81]},o($Vc,[2,21],{28:[1,82],29:[1,83]}),o($Vc,[2,25],{26:[1,84],29:[1,85]}),o($Vc,[2,35],{26:[1,86],28:[1,87]}),o($Vc,[2,22],{28:[1,88],29:[1,89]}),o($Vc,[2,27],{24:[1,90],29:[1,91]}),o($Vc,[2,38],{24:[1,92],28:[1,93]}),o($Vc,[2,24],{26:[1,94],29:[1,95]}),o($Vc,[2,26],{24:[1,96],29:[1,97]}),o($Vc,[2,39],{24:[1,99],26:[1,98]}),o($Vc,[2,36],{26:[1,100],28:[1,101]}),o($Vc,[2,37],{24:[1,102],28:[1,103]}),o($Vc,[2,40],{24:[1,105],26:[1,104]}),{25:[1,106]},{25:[1,107]},{27:108,30:$Vd,31:$Ve,32:$Vf},{25:[1,109]},{27:110,30:$Vd,31:$Ve,32:$Vf},{25:[1,111]},{25:[1,112]},{25:[1,113]},{25:[1,114]},{25:[1,115]},{25:[1,116]},{25:[1,117]},{27:118,30:$Vd,31:$Ve,32:$Vf},{25:[1,119]},{25:[1,120]},{25:[1,121]},{27:122,30:$Vd,31:$Ve,32:$Vf},{25:[1,123]},{27:124,30:$Vd,31:$Ve,32:$Vf},{25:[1,125]},{25:[1,126]},{25:[1,127]},{27:128,30:$Vd,31:$Ve,32:$Vf},{25:[1,129]},o($Vc,[2,32],{29:[1,130]}),o($Vc,[2,45],{28:[1,131]}),o($Vc,[2,33],{29:[1,132]}),o($Vc,[2,56],{26:[1,133]}),o($Vc,[2,46],{28:[1,134]}),o($Vc,[2,55],{26:[1,135]}),o($Vc,[2,31],{29:[1,136]}),o($Vc,[2,44],{28:[1,137]}),o($Vc,[2,30],{29:[1,138]}),o($Vc,[2,50],{24:[1,139]}),o($Vc,[2,43],{28:[1,140]}),o($Vc,[2,49],{24:[1,141]}),o($Vc,[2,29],{29:[1,142]}),o($Vc,[2,57],{26:[1,143]}),o($Vc,[2,28],{29:[1,144]}),o($Vc,[2,51],{24:[1,145]}),o($Vc,[2,52],{24:[1,146]}),o($Vc,[2,58],{26:[1,147]}),o($Vc,[2,42],{28:[1,148]}),o($Vc,[2,53],{26:[1,149]}),o($Vc,[2,41],{28:[1,150]}),o($Vc,[2,47],{24:[1,151]}),o($Vc,[2,48],{24:[1,152]}),o($Vc,[2,54],{26:[1,153]}),{25:[1,154]},{25:[1,155]},{25:[1,156]},{27:157,30:$Vd,31:$Ve,32:$Vf},{25:[1,158]},{27:159,30:$Vd,31:$Ve,32:$Vf},{25:[1,160]},{25:[1,161]},{25:[1,162]},{25:[1,163]},{25:[1,164]},{25:[1,165]},{25:[1,166]},{27:167,30:$Vd,31:$Ve,32:$Vf},{25:[1,168]},{25:[1,169]},{25:[1,170]},{27:171,30:$Vd,31:$Ve,32:$Vf},{25:[1,172]},{27:173,30:$Vd,31:$Ve,32:$Vf},{25:[1,174]},{25:[1,175]},{25:[1,176]},{27:177,30:$Vd,31:$Ve,32:$Vf},o($Vc,[2,73]),o($Vc,[2,74]),o($Vc,[2,71]),o($Vc,[2,72]),o($Vc,[2,76]),o($Vc,[2,75]),o($Vc,[2,80]),o($Vc,[2,79]),o($Vc,[2,78]),o($Vc,[2,77]),o($Vc,[2,82]),o($Vc,[2,81]),o($Vc,[2,70]),o($Vc,[2,69]),o($Vc,[2,68]),o($Vc,[2,67]),o($Vc,[2,65]),o($Vc,[2,66]),o($Vc,[2,64]),o($Vc,[2,63]),o($Vc,[2,62]),o($Vc,[2,61]),o($Vc,[2,59]),o($Vc,[2,60])],\ndefaultActions: {9:[2,90],10:[2,1],11:[2,2],19:[2,3],27:[2,4],38:[2,92],39:[2,5]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 37; \nbreak;\ncase 1: this.begin('type_directive'); return 38; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 9; \nbreak;\ncase 3: this.popState(); this.popState(); return 40; \nbreak;\ncase 4:return 39;\nbreak;\ncase 5:/*{console.log('New line');return 14;}*/ return 14;\nbreak;\ncase 6:/* skip all whitespace */\nbreak;\ncase 7:/* skip comments */\nbreak;\ncase 8:/* skip comments */\nbreak;\ncase 9:return 6;\nbreak;\ncase 10:return 22;\nbreak;\ncase 11:return 28;\nbreak;\ncase 12:return 26;\nbreak;\ncase 13:return 29;\nbreak;\ncase 14:return 30;\nbreak;\ncase 15:return 31;\nbreak;\ncase 16:return 32;\nbreak;\ncase 17:return 24;\nbreak;\ncase 18:return 18;\nbreak;\ncase 19:return 21;\nbreak;\ncase 20:return 20;\nbreak;\ncase 21:return 10;\nbreak;\ncase 22:return 10;\nbreak;\ncase 23:return 9;\nbreak;\ncase 24:return 'CARET'\nbreak;\ncase 25:this.begin(\"options\");\nbreak;\ncase 26:this.popState();\nbreak;\ncase 27:return 13;\nbreak;\ncase 28:this.begin(\"string\");\nbreak;\ncase 29:this.popState();\nbreak;\ncase 30:return 25;\nbreak;\ncase 31:return 19;\nbreak;\ncase 32:return 8;\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:(\\r?\\n)+)/i,/^(?:\\s+)/i,/^(?:#[^\\n]*)/i,/^(?:%[^\\n]*)/i,/^(?:gitGraph\\b)/i,/^(?:commit\\b)/i,/^(?:id:)/i,/^(?:type:)/i,/^(?:msg:)/i,/^(?:NORMAL\\b)/i,/^(?:REVERSE\\b)/i,/^(?:HIGHLIGHT\\b)/i,/^(?:tag:)/i,/^(?:branch\\b)/i,/^(?:merge\\b)/i,/^(?:checkout\\b)/i,/^(?:LR\\b)/i,/^(?:BT\\b)/i,/^(?::)/i,/^(?:\\^)/i,/^(?:options\\r?\\n)/i,/^(?:end\\r?\\n)/i,/^(?:[^\\n]+\\r?\\n)/i,/^(?:[\"])/i,/^(?:[\"])/i,/^(?:[^\"]*)/i,/^(?:[a-zA-Z][-_\\.a-zA-Z0-9]*[-_a-zA-Z0-9])/i,/^(?:$)/i],\nconditions: {\"close_directive\":{\"rules\":[],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3],\"inclusive\":false},\"open_directive\":{\"rules\":[1],\"inclusive\":false},\"options\":{\"rules\":[26,27],\"inclusive\":false},\"string\":{\"rules\":[29,30],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,28,31,32],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[6,9,10];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"info\":4,\"document\":5,\"EOF\":6,\"line\":7,\"statement\":8,\"NL\":9,\"showInfo\":10,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",4:\"info\",6:\"EOF\",9:\"NL\",10:\"showInfo\"},\nproductions_: [0,[3,3],[5,0],[5,2],[7,1],[7,1],[8,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:\n return yy; \nbreak;\ncase 4:\n \nbreak;\ncase 6:\n yy.setInfo(true);  \nbreak;\n}\n},\ntable: [{3:1,4:[1,2]},{1:[3]},o($V0,[2,2],{5:3}),{6:[1,4],7:5,8:6,9:[1,7],10:[1,8]},{1:[2,1]},o($V0,[2,3]),o($V0,[2,4]),o($V0,[2,5]),o($V0,[2,6])],\ndefaultActions: {4:[2,1]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\r\n\t// Pre-lexer code can go here\r\n\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:return 4    ;\nbreak;\ncase 1:return 9      ;\nbreak;\ncase 2:return 'space';\nbreak;\ncase 3:return 10;\nbreak;\ncase 4:return 6     ;\nbreak;\ncase 5:return 'TXT' ;\nbreak;\n}\n},\nrules: [/^(?:info\\b)/i,/^(?:[\\s\\n\\r]+)/i,/^(?:[\\s]+)/i,/^(?:showInfo\\b)/i,/^(?:$)/i,/^(?:.)/i],\nconditions: {\"INITIAL\":{\"rules\":[0,1,2,3,4,5],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,4],$V1=[1,5],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,11,13,15,22,23,24,25],$V6=[2,5],$V7=[1,6,11,13,15,22,23,24,25],$V8=[22,23,24],$V9=[2,8],$Va=[1,18],$Vb=[1,19],$Vc=[1,20],$Vd=[1,25],$Ve=[6,22,23,24,25];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"eol\":4,\"directive\":5,\"PIE\":6,\"document\":7,\"showData\":8,\"line\":9,\"statement\":10,\"txt\":11,\"value\":12,\"title\":13,\"title_value\":14,\"accDescription\":15,\"description_value\":16,\"openDirective\":17,\"typeDirective\":18,\"closeDirective\":19,\":\":20,\"argDirective\":21,\"NEWLINE\":22,\";\":23,\"EOF\":24,\"open_directive\":25,\"type_directive\":26,\"arg_directive\":27,\"close_directive\":28,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",6:\"PIE\",8:\"showData\",11:\"txt\",12:\"value\",13:\"title\",14:\"title_value\",15:\"accDescription\",16:\"description_value\",20:\":\",22:\"NEWLINE\",23:\";\",24:\"EOF\",25:\"open_directive\",26:\"type_directive\",27:\"arg_directive\",28:\"close_directive\"},\nproductions_: [0,[3,2],[3,2],[3,2],[3,3],[7,0],[7,2],[9,2],[10,0],[10,2],[10,2],[10,2],[10,1],[5,3],[5,5],[4,1],[4,1],[4,1],[17,1],[18,1],[21,1],[19,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 4:\nyy.setShowData(true);\nbreak;\ncase 7:\n this.$ = $$[$0-1] \nbreak;\ncase 9:\n yy.addSection($$[$0-1],yy.cleanupValue($$[$0])); \nbreak;\ncase 10:\n this.$=$$[$0].trim();yy.setTitle(this.$); \nbreak;\ncase 11:\n this.$=$$[$0].trim();yy.setAccDescription(this.$); \nbreak;\ncase 18:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 19:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 20:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 21:\n yy.parseDirective('}%%', 'close_directive', 'pie'); \nbreak;\n}\n},\ntable: [{3:1,4:2,5:3,6:$V0,17:8,22:$V1,23:$V2,24:$V3,25:$V4},{1:[3]},{3:10,4:2,5:3,6:$V0,17:8,22:$V1,23:$V2,24:$V3,25:$V4},{3:11,4:2,5:3,6:$V0,17:8,22:$V1,23:$V2,24:$V3,25:$V4},o($V5,$V6,{7:12,8:[1,13]}),o($V7,[2,15]),o($V7,[2,16]),o($V7,[2,17]),{18:14,26:[1,15]},{26:[2,18]},{1:[2,1]},{1:[2,2]},o($V8,$V9,{17:8,9:16,10:17,5:21,1:[2,3],11:$Va,13:$Vb,15:$Vc,25:$V4}),o($V5,$V6,{7:22}),{19:23,20:[1,24],28:$Vd},o([20,28],[2,19]),o($V5,[2,6]),{4:26,22:$V1,23:$V2,24:$V3},{12:[1,27]},{14:[1,28]},{16:[1,29]},o($V8,[2,12]),o($V8,$V9,{17:8,9:16,10:17,5:21,1:[2,4],11:$Va,13:$Vb,15:$Vc,25:$V4}),o($Ve,[2,13]),{21:30,27:[1,31]},o($Ve,[2,21]),o($V5,[2,7]),o($V8,[2,9]),o($V8,[2,10]),o($V8,[2,11]),{19:32,28:$Vd},{28:[2,20]},o($Ve,[2,14])],\ndefaultActions: {9:[2,18],10:[2,1],11:[2,2],31:[2,20]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 25; \nbreak;\ncase 1: this.begin('type_directive'); return 26; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 20; \nbreak;\ncase 3: this.popState(); this.popState(); return 28; \nbreak;\ncase 4:return 27;\nbreak;\ncase 5:/* skip comments */\nbreak;\ncase 6:/* skip comments */{ /*console.log('');*/ }\nbreak;\ncase 7:return 22;\nbreak;\ncase 8:/* do nothing */\nbreak;\ncase 9:/* ignore */\nbreak;\ncase 10: this.begin(\"title\");return 13; \nbreak;\ncase 11: this.popState(); return \"title_value\"; \nbreak;\ncase 12: this.begin(\"accDescription\");return 15; \nbreak;\ncase 13: this.popState(); return \"description_value\"; \nbreak;\ncase 14: this.begin(\"string\"); \nbreak;\ncase 15: this.popState(); \nbreak;\ncase 16: return \"txt\"; \nbreak;\ncase 17:return 6;\nbreak;\ncase 18:return 8;\nbreak;\ncase 19:return \"value\";\nbreak;\ncase 20:return 24;\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:%%(?!\\{)[^\\n]*)/i,/^(?:[^\\}]%%[^\\n]*)/i,/^(?:[\\n\\r]+)/i,/^(?:%%[^\\n]*)/i,/^(?:[\\s]+)/i,/^(?:title\\b)/i,/^(?:(?!\\n||)*[^\\n]*)/i,/^(?:accDescription\\b)/i,/^(?:(?!\\n||)*[^\\n]*)/i,/^(?:[\"])/i,/^(?:[\"])/i,/^(?:[^\"]*)/i,/^(?:pie\\b)/i,/^(?:showData\\b)/i,/^(?::[\\s]*[\\d]+(?:\\.[\\d]+)?)/i,/^(?:$)/i],\nconditions: {\"close_directive\":{\"rules\":[],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3],\"inclusive\":false},\"open_directive\":{\"rules\":[1],\"inclusive\":false},\"accDescription\":{\"rules\":[13],\"inclusive\":false},\"title\":{\"rules\":[11],\"inclusive\":false},\"string\":{\"rules\":[15,16],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,7,8,9,10,12,14,17,18,19,20],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,3],$V1=[1,5],$V2=[1,6],$V3=[1,7],$V4=[5,6,8,14,15,16,37,38,39,40,41,42,50,68,69],$V5=[1,19],$V6=[2,12],$V7=[1,23],$V8=[1,24],$V9=[1,25],$Va=[1,26],$Vb=[1,27],$Vc=[1,28],$Vd=[1,21],$Ve=[1,29],$Vf=[1,30],$Vg=[1,33],$Vh=[68,69],$Vi=[5,8,14,15,16,37,38,39,40,41,42,50,57,59,68,69],$Vj=[1,53],$Vk=[1,54],$Vl=[1,55],$Vm=[1,56],$Vn=[1,57],$Vo=[1,58],$Vp=[1,59],$Vq=[59,60],$Vr=[1,71],$Vs=[1,67],$Vt=[1,68],$Vu=[1,69],$Vv=[1,70],$Vw=[1,72],$Vx=[1,76],$Vy=[1,77],$Vz=[1,74],$VA=[1,75],$VB=[5,8,14,15,16,37,38,39,40,41,42,50,68,69];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"directive\":4,\"NEWLINE\":5,\"RD\":6,\"diagram\":7,\"EOF\":8,\"openDirective\":9,\"typeDirective\":10,\"closeDirective\":11,\":\":12,\"argDirective\":13,\"title\":14,\"accDescription\":15,\"open_directive\":16,\"type_directive\":17,\"arg_directive\":18,\"close_directive\":19,\"requirementDef\":20,\"elementDef\":21,\"relationshipDef\":22,\"requirementType\":23,\"requirementName\":24,\"STRUCT_START\":25,\"requirementBody\":26,\"ID\":27,\"COLONSEP\":28,\"id\":29,\"TEXT\":30,\"text\":31,\"RISK\":32,\"riskLevel\":33,\"VERIFYMTHD\":34,\"verifyType\":35,\"STRUCT_STOP\":36,\"REQUIREMENT\":37,\"FUNCTIONAL_REQUIREMENT\":38,\"INTERFACE_REQUIREMENT\":39,\"PERFORMANCE_REQUIREMENT\":40,\"PHYSICAL_REQUIREMENT\":41,\"DESIGN_CONSTRAINT\":42,\"LOW_RISK\":43,\"MED_RISK\":44,\"HIGH_RISK\":45,\"VERIFY_ANALYSIS\":46,\"VERIFY_DEMONSTRATION\":47,\"VERIFY_INSPECTION\":48,\"VERIFY_TEST\":49,\"ELEMENT\":50,\"elementName\":51,\"elementBody\":52,\"TYPE\":53,\"type\":54,\"DOCREF\":55,\"ref\":56,\"END_ARROW_L\":57,\"relationship\":58,\"LINE\":59,\"END_ARROW_R\":60,\"CONTAINS\":61,\"COPIES\":62,\"DERIVES\":63,\"SATISFIES\":64,\"VERIFIES\":65,\"REFINES\":66,\"TRACES\":67,\"unqString\":68,\"qString\":69,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",5:\"NEWLINE\",6:\"RD\",8:\"EOF\",12:\":\",14:\"title\",15:\"accDescription\",16:\"open_directive\",17:\"type_directive\",18:\"arg_directive\",19:\"close_directive\",25:\"STRUCT_START\",27:\"ID\",28:\"COLONSEP\",30:\"TEXT\",32:\"RISK\",34:\"VERIFYMTHD\",36:\"STRUCT_STOP\",37:\"REQUIREMENT\",38:\"FUNCTIONAL_REQUIREMENT\",39:\"INTERFACE_REQUIREMENT\",40:\"PERFORMANCE_REQUIREMENT\",41:\"PHYSICAL_REQUIREMENT\",42:\"DESIGN_CONSTRAINT\",43:\"LOW_RISK\",44:\"MED_RISK\",45:\"HIGH_RISK\",46:\"VERIFY_ANALYSIS\",47:\"VERIFY_DEMONSTRATION\",48:\"VERIFY_INSPECTION\",49:\"VERIFY_TEST\",50:\"ELEMENT\",53:\"TYPE\",55:\"DOCREF\",57:\"END_ARROW_L\",59:\"LINE\",60:\"END_ARROW_R\",61:\"CONTAINS\",62:\"COPIES\",63:\"DERIVES\",64:\"SATISFIES\",65:\"VERIFIES\",66:\"REFINES\",67:\"TRACES\",68:\"unqString\",69:\"qString\"},\nproductions_: [0,[3,3],[3,2],[3,4],[4,3],[4,5],[4,1],[4,1],[9,1],[10,1],[13,1],[11,1],[7,0],[7,2],[7,2],[7,2],[7,2],[7,2],[20,5],[26,5],[26,5],[26,5],[26,5],[26,2],[26,1],[23,1],[23,1],[23,1],[23,1],[23,1],[23,1],[33,1],[33,1],[33,1],[35,1],[35,1],[35,1],[35,1],[21,5],[52,5],[52,5],[52,2],[52,1],[22,5],[22,5],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[24,1],[24,1],[29,1],[29,1],[31,1],[31,1],[51,1],[51,1],[54,1],[54,1],[56,1],[56,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 6:\nyy.setTitle($$[$0].substring(6));this.$=$$[$0].substring(6);\nbreak;\ncase 7:\nyy.setAccDescription($$[$0].substring(15));this.$=$$[$0].substring(15);\nbreak;\ncase 8:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 9:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 10:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 11:\n yy.parseDirective('}%%', 'close_directive', 'pie'); \nbreak;\ncase 12:\n this.$ = [] \nbreak;\ncase 18:\n yy.addRequirement($$[$0-3], $$[$0-4]) \nbreak;\ncase 19:\n yy.setNewReqId($$[$0-2]); \nbreak;\ncase 20:\n yy.setNewReqText($$[$0-2]); \nbreak;\ncase 21:\n yy.setNewReqRisk($$[$0-2]); \nbreak;\ncase 22:\n yy.setNewReqVerifyMethod($$[$0-2]); \nbreak;\ncase 25:\n this.$=yy.RequirementType.REQUIREMENT;\nbreak;\ncase 26:\n this.$=yy.RequirementType.FUNCTIONAL_REQUIREMENT;\nbreak;\ncase 27:\n this.$=yy.RequirementType.INTERFACE_REQUIREMENT;\nbreak;\ncase 28:\n this.$=yy.RequirementType.PERFORMANCE_REQUIREMENT;\nbreak;\ncase 29:\n this.$=yy.RequirementType.PHYSICAL_REQUIREMENT;\nbreak;\ncase 30:\n this.$=yy.RequirementType.DESIGN_CONSTRAINT;\nbreak;\ncase 31:\n this.$=yy.RiskLevel.LOW_RISK;\nbreak;\ncase 32:\n this.$=yy.RiskLevel.MED_RISK;\nbreak;\ncase 33:\n this.$=yy.RiskLevel.HIGH_RISK;\nbreak;\ncase 34:\n this.$=yy.VerifyType.VERIFY_ANALYSIS;\nbreak;\ncase 35:\n this.$=yy.VerifyType.VERIFY_DEMONSTRATION;\nbreak;\ncase 36:\n this.$=yy.VerifyType.VERIFY_INSPECTION;\nbreak;\ncase 37:\n this.$=yy.VerifyType.VERIFY_TEST;\nbreak;\ncase 38:\n yy.addElement($$[$0-3]) \nbreak;\ncase 39:\n yy.setNewElementType($$[$0-2]); \nbreak;\ncase 40:\n yy.setNewElementDocRef($$[$0-2]); \nbreak;\ncase 43:\n  yy.addRelationship($$[$0-2], $$[$0], $$[$0-4]) \nbreak;\ncase 44:\n yy.addRelationship($$[$0-2], $$[$0-4], $$[$0]) \nbreak;\ncase 45:\n this.$=yy.Relationships.CONTAINS;\nbreak;\ncase 46:\n this.$=yy.Relationships.COPIES;\nbreak;\ncase 47:\n this.$=yy.Relationships.DERIVES;\nbreak;\ncase 48:\n this.$=yy.Relationships.SATISFIES;\nbreak;\ncase 49:\n this.$=yy.Relationships.VERIFIES;\nbreak;\ncase 50:\n this.$=yy.Relationships.REFINES;\nbreak;\ncase 51:\n this.$=yy.Relationships.TRACES;\nbreak;\n}\n},\ntable: [{3:1,4:2,6:$V0,9:4,14:$V1,15:$V2,16:$V3},{1:[3]},{3:9,4:2,5:[1,8],6:$V0,9:4,14:$V1,15:$V2,16:$V3},{5:[1,10]},{10:11,17:[1,12]},o($V4,[2,6]),o($V4,[2,7]),{17:[2,8]},{3:13,4:2,6:$V0,9:4,14:$V1,15:$V2,16:$V3},{1:[2,2]},{4:18,5:$V5,7:14,8:$V6,9:4,14:$V1,15:$V2,16:$V3,20:15,21:16,22:17,23:20,29:22,37:$V7,38:$V8,39:$V9,40:$Va,41:$Vb,42:$Vc,50:$Vd,68:$Ve,69:$Vf},{11:31,12:[1,32],19:$Vg},o([12,19],[2,9]),{1:[2,1]},{8:[1,34]},{4:18,5:$V5,7:35,8:$V6,9:4,14:$V1,15:$V2,16:$V3,20:15,21:16,22:17,23:20,29:22,37:$V7,38:$V8,39:$V9,40:$Va,41:$Vb,42:$Vc,50:$Vd,68:$Ve,69:$Vf},{4:18,5:$V5,7:36,8:$V6,9:4,14:$V1,15:$V2,16:$V3,20:15,21:16,22:17,23:20,29:22,37:$V7,38:$V8,39:$V9,40:$Va,41:$Vb,42:$Vc,50:$Vd,68:$Ve,69:$Vf},{4:18,5:$V5,7:37,8:$V6,9:4,14:$V1,15:$V2,16:$V3,20:15,21:16,22:17,23:20,29:22,37:$V7,38:$V8,39:$V9,40:$Va,41:$Vb,42:$Vc,50:$Vd,68:$Ve,69:$Vf},{4:18,5:$V5,7:38,8:$V6,9:4,14:$V1,15:$V2,16:$V3,20:15,21:16,22:17,23:20,29:22,37:$V7,38:$V8,39:$V9,40:$Va,41:$Vb,42:$Vc,50:$Vd,68:$Ve,69:$Vf},{4:18,5:$V5,7:39,8:$V6,9:4,14:$V1,15:$V2,16:$V3,20:15,21:16,22:17,23:20,29:22,37:$V7,38:$V8,39:$V9,40:$Va,41:$Vb,42:$Vc,50:$Vd,68:$Ve,69:$Vf},{24:40,68:[1,41],69:[1,42]},{51:43,68:[1,44],69:[1,45]},{57:[1,46],59:[1,47]},o($Vh,[2,25]),o($Vh,[2,26]),o($Vh,[2,27]),o($Vh,[2,28]),o($Vh,[2,29]),o($Vh,[2,30]),o($Vi,[2,54]),o($Vi,[2,55]),o($V4,[2,4]),{13:48,18:[1,49]},o($V4,[2,11]),{1:[2,3]},{8:[2,13]},{8:[2,14]},{8:[2,15]},{8:[2,16]},{8:[2,17]},{25:[1,50]},{25:[2,52]},{25:[2,53]},{25:[1,51]},{25:[2,58]},{25:[2,59]},{58:52,61:$Vj,62:$Vk,63:$Vl,64:$Vm,65:$Vn,66:$Vo,67:$Vp},{58:60,61:$Vj,62:$Vk,63:$Vl,64:$Vm,65:$Vn,66:$Vo,67:$Vp},{11:61,19:$Vg},{19:[2,10]},{5:[1,62]},{5:[1,63]},{59:[1,64]},o($Vq,[2,45]),o($Vq,[2,46]),o($Vq,[2,47]),o($Vq,[2,48]),o($Vq,[2,49]),o($Vq,[2,50]),o($Vq,[2,51]),{60:[1,65]},o($V4,[2,5]),{5:$Vr,26:66,27:$Vs,30:$Vt,32:$Vu,34:$Vv,36:$Vw},{5:$Vx,36:$Vy,52:73,53:$Vz,55:$VA},{29:78,68:$Ve,69:$Vf},{29:79,68:$Ve,69:$Vf},o($VB,[2,18]),{28:[1,80]},{28:[1,81]},{28:[1,82]},{28:[1,83]},{5:$Vr,26:84,27:$Vs,30:$Vt,32:$Vu,34:$Vv,36:$Vw},o($VB,[2,24]),o($VB,[2,38]),{28:[1,85]},{28:[1,86]},{5:$Vx,36:$Vy,52:87,53:$Vz,55:$VA},o($VB,[2,42]),o($VB,[2,43]),o($VB,[2,44]),{29:88,68:$Ve,69:$Vf},{31:89,68:[1,90],69:[1,91]},{33:92,43:[1,93],44:[1,94],45:[1,95]},{35:96,46:[1,97],47:[1,98],48:[1,99],49:[1,100]},o($VB,[2,23]),{54:101,68:[1,102],69:[1,103]},{56:104,68:[1,105],69:[1,106]},o($VB,[2,41]),{5:[1,107]},{5:[1,108]},{5:[2,56]},{5:[2,57]},{5:[1,109]},{5:[2,31]},{5:[2,32]},{5:[2,33]},{5:[1,110]},{5:[2,34]},{5:[2,35]},{5:[2,36]},{5:[2,37]},{5:[1,111]},{5:[2,60]},{5:[2,61]},{5:[1,112]},{5:[2,62]},{5:[2,63]},{5:$Vr,26:113,27:$Vs,30:$Vt,32:$Vu,34:$Vv,36:$Vw},{5:$Vr,26:114,27:$Vs,30:$Vt,32:$Vu,34:$Vv,36:$Vw},{5:$Vr,26:115,27:$Vs,30:$Vt,32:$Vu,34:$Vv,36:$Vw},{5:$Vr,26:116,27:$Vs,30:$Vt,32:$Vu,34:$Vv,36:$Vw},{5:$Vx,36:$Vy,52:117,53:$Vz,55:$VA},{5:$Vx,36:$Vy,52:118,53:$Vz,55:$VA},o($VB,[2,19]),o($VB,[2,20]),o($VB,[2,21]),o($VB,[2,22]),o($VB,[2,39]),o($VB,[2,40])],\ndefaultActions: {7:[2,8],9:[2,2],13:[2,1],34:[2,3],35:[2,13],36:[2,14],37:[2,15],38:[2,16],39:[2,17],41:[2,52],42:[2,53],44:[2,58],45:[2,59],49:[2,10],90:[2,56],91:[2,57],93:[2,31],94:[2,32],95:[2,33],97:[2,34],98:[2,35],99:[2,36],100:[2,37],102:[2,60],103:[2,61],105:[2,62],106:[2,63]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 16; \nbreak;\ncase 1: this.begin('type_directive'); return 17; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 12; \nbreak;\ncase 3: this.popState(); this.popState(); return 19; \nbreak;\ncase 4:return 18;\nbreak;\ncase 5:return 14;\nbreak;\ncase 6:return 15;\nbreak;\ncase 7:return 5;\nbreak;\ncase 8:/* skip all whitespace */\nbreak;\ncase 9:/* skip comments */\nbreak;\ncase 10:/* skip comments */\nbreak;\ncase 11:return 8;\nbreak;\ncase 12:return 6;\nbreak;\ncase 13:return 25;\nbreak;\ncase 14:return 36;\nbreak;\ncase 15:return 28;\nbreak;\ncase 16:return 27;\nbreak;\ncase 17:return 30;\nbreak;\ncase 18:return 32;\nbreak;\ncase 19:return 34;\nbreak;\ncase 20:return 37;\nbreak;\ncase 21:return 38;\nbreak;\ncase 22:return 39;\nbreak;\ncase 23:return 40;\nbreak;\ncase 24:return 41;\nbreak;\ncase 25:return 42;\nbreak;\ncase 26:return 43;\nbreak;\ncase 27:return 44;\nbreak;\ncase 28:return 45;\nbreak;\ncase 29:return 46;\nbreak;\ncase 30:return 47;\nbreak;\ncase 31:return 48;\nbreak;\ncase 32:return 49;\nbreak;\ncase 33:return 50;\nbreak;\ncase 34:return 61;\nbreak;\ncase 35:return 62;\nbreak;\ncase 36:return 63;\nbreak;\ncase 37:return 64;\nbreak;\ncase 38:return 65;\nbreak;\ncase 39:return 66;\nbreak;\ncase 40:return 67;\nbreak;\ncase 41:return 53;\nbreak;\ncase 42:return 55;\nbreak;\ncase 43:return 57;\nbreak;\ncase 44:return 60;\nbreak;\ncase 45:return 59;\nbreak;\ncase 46: this.begin(\"string\"); \nbreak;\ncase 47: this.popState(); \nbreak;\ncase 48: return \"qString\"; \nbreak;\ncase 49: yy_.yytext = yy_.yytext.trim(); return 68;\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:title\\s[^#\\n;]+)/i,/^(?:accDescription\\s[^#\\n;]+)/i,/^(?:(\\r?\\n)+)/i,/^(?:\\s+)/i,/^(?:#[^\\n]*)/i,/^(?:%[^\\n]*)/i,/^(?:$)/i,/^(?:requirementDiagram\\b)/i,/^(?:\\{)/i,/^(?:\\})/i,/^(?::)/i,/^(?:id\\b)/i,/^(?:text\\b)/i,/^(?:risk\\b)/i,/^(?:verifyMethod\\b)/i,/^(?:requirement\\b)/i,/^(?:functionalRequirement\\b)/i,/^(?:interfaceRequirement\\b)/i,/^(?:performanceRequirement\\b)/i,/^(?:physicalRequirement\\b)/i,/^(?:designConstraint\\b)/i,/^(?:low\\b)/i,/^(?:medium\\b)/i,/^(?:high\\b)/i,/^(?:analysis\\b)/i,/^(?:demonstration\\b)/i,/^(?:inspection\\b)/i,/^(?:test\\b)/i,/^(?:element\\b)/i,/^(?:contains\\b)/i,/^(?:copies\\b)/i,/^(?:derives\\b)/i,/^(?:satisfies\\b)/i,/^(?:verifies\\b)/i,/^(?:refines\\b)/i,/^(?:traces\\b)/i,/^(?:type\\b)/i,/^(?:docref\\b)/i,/^(?:<-)/i,/^(?:->)/i,/^(?:-)/i,/^(?:[\"])/i,/^(?:[\"])/i,/^(?:[^\"]*)/i,/^(?:[\\w][^\\r\\n\\{\\<\\>\\-\\=]*)/i],\nconditions: {\"close_directive\":{\"rules\":[],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3],\"inclusive\":false},\"open_directive\":{\"rules\":[1],\"inclusive\":false},\"unqString\":{\"rules\":[],\"inclusive\":false},\"token\":{\"rules\":[],\"inclusive\":false},\"string\":{\"rules\":[47,48],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,49],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,2],$V1=[1,3],$V2=[1,5],$V3=[1,7],$V4=[2,5],$V5=[1,15],$V6=[1,17],$V7=[1,18],$V8=[1,19],$V9=[1,21],$Va=[1,22],$Vb=[1,23],$Vc=[1,29],$Vd=[1,30],$Ve=[1,31],$Vf=[1,32],$Vg=[1,33],$Vh=[1,34],$Vi=[1,35],$Vj=[1,36],$Vk=[1,39],$Vl=[1,40],$Vm=[1,41],$Vn=[1,42],$Vo=[1,43],$Vp=[1,44],$Vq=[1,47],$Vr=[1,4,5,16,20,22,25,26,32,33,34,35,36,37,38,39,41,43,44,45,50,51,52,53,61,71],$Vs=[4,5,16,20,22,25,26,32,33,34,35,36,37,38,39,41,45,50,51,52,53,61,71],$Vt=[4,5,16,20,22,25,26,32,33,34,35,36,37,38,39,41,44,45,50,51,52,53,61,71],$Vu=[4,5,16,20,22,25,26,32,33,34,35,36,37,38,39,41,43,45,50,51,52,53,61,71],$Vv=[59,60,61],$Vw=[1,110],$Vx=[1,4,5,7,16,20,22,25,26,32,33,34,35,36,37,38,39,41,43,44,45,50,51,52,53,61,71];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"SPACE\":4,\"NEWLINE\":5,\"directive\":6,\"SD\":7,\"document\":8,\"line\":9,\"statement\":10,\"openDirective\":11,\"typeDirective\":12,\"closeDirective\":13,\":\":14,\"argDirective\":15,\"participant\":16,\"actor\":17,\"AS\":18,\"restOfLine\":19,\"participant_actor\":20,\"signal\":21,\"autonumber\":22,\"NUM\":23,\"off\":24,\"activate\":25,\"deactivate\":26,\"note_statement\":27,\"links_statement\":28,\"link_statement\":29,\"properties_statement\":30,\"details_statement\":31,\"title\":32,\"legacy_title\":33,\"accDescription\":34,\"loop\":35,\"end\":36,\"rect\":37,\"opt\":38,\"alt\":39,\"else_sections\":40,\"par\":41,\"par_sections\":42,\"and\":43,\"else\":44,\"note\":45,\"placement\":46,\"text2\":47,\"over\":48,\"actor_pair\":49,\"links\":50,\"link\":51,\"properties\":52,\"details\":53,\"spaceList\":54,\",\":55,\"left_of\":56,\"right_of\":57,\"signaltype\":58,\"+\":59,\"-\":60,\"ACTOR\":61,\"SOLID_OPEN_ARROW\":62,\"DOTTED_OPEN_ARROW\":63,\"SOLID_ARROW\":64,\"DOTTED_ARROW\":65,\"SOLID_CROSS\":66,\"DOTTED_CROSS\":67,\"SOLID_POINT\":68,\"DOTTED_POINT\":69,\"TXT\":70,\"open_directive\":71,\"type_directive\":72,\"arg_directive\":73,\"close_directive\":74,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",4:\"SPACE\",5:\"NEWLINE\",7:\"SD\",14:\":\",16:\"participant\",18:\"AS\",19:\"restOfLine\",20:\"participant_actor\",22:\"autonumber\",23:\"NUM\",24:\"off\",25:\"activate\",26:\"deactivate\",32:\"title\",33:\"legacy_title\",34:\"accDescription\",35:\"loop\",36:\"end\",37:\"rect\",38:\"opt\",39:\"alt\",41:\"par\",43:\"and\",44:\"else\",45:\"note\",48:\"over\",50:\"links\",51:\"link\",52:\"properties\",53:\"details\",55:\",\",56:\"left_of\",57:\"right_of\",59:\"+\",60:\"-\",61:\"ACTOR\",62:\"SOLID_OPEN_ARROW\",63:\"DOTTED_OPEN_ARROW\",64:\"SOLID_ARROW\",65:\"DOTTED_ARROW\",66:\"SOLID_CROSS\",67:\"DOTTED_CROSS\",68:\"SOLID_POINT\",69:\"DOTTED_POINT\",70:\"TXT\",71:\"open_directive\",72:\"type_directive\",73:\"arg_directive\",74:\"close_directive\"},\nproductions_: [0,[3,2],[3,2],[3,2],[3,2],[8,0],[8,2],[9,2],[9,1],[9,1],[6,4],[6,6],[10,5],[10,3],[10,5],[10,3],[10,2],[10,4],[10,3],[10,3],[10,2],[10,3],[10,3],[10,2],[10,2],[10,2],[10,2],[10,2],[10,1],[10,1],[10,1],[10,4],[10,4],[10,4],[10,4],[10,4],[10,1],[42,1],[42,4],[40,1],[40,4],[27,4],[27,4],[28,3],[29,3],[30,3],[31,3],[54,2],[54,1],[49,3],[49,1],[46,1],[46,1],[21,5],[21,5],[21,4],[17,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[47,1],[11,1],[12,1],[15,1],[13,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 4:\n yy.apply($$[$0]);return $$[$0]; \nbreak;\ncase 5:\n this.$ = [] \nbreak;\ncase 6:\n$$[$0-1].push($$[$0]);this.$ = $$[$0-1]\nbreak;\ncase 7: case 8:\n this.$ = $$[$0] \nbreak;\ncase 9:\n this.$=[]; \nbreak;\ncase 12:\n$$[$0-3].type='addParticipant';$$[$0-3].description=yy.parseMessage($$[$0-1]); this.$=$$[$0-3];\nbreak;\ncase 13:\n$$[$0-1].type='addParticipant';this.$=$$[$0-1];\nbreak;\ncase 14:\n$$[$0-3].type='addActor';$$[$0-3].description=yy.parseMessage($$[$0-1]); this.$=$$[$0-3];\nbreak;\ncase 15:\n$$[$0-1].type='addActor'; this.$=$$[$0-1];\nbreak;\ncase 17:\n this.$= {type:'sequenceIndex',sequenceIndex: Number($$[$0-2]), sequenceIndexStep:Number($$[$0-1]), sequenceVisible:true, signalType:yy.LINETYPE.AUTONUMBER};\nbreak;\ncase 18:\n this.$ = {type:'sequenceIndex',sequenceIndex: Number($$[$0-1]), sequenceIndexStep:1, sequenceVisible:true, signalType:yy.LINETYPE.AUTONUMBER};\nbreak;\ncase 19:\n this.$ = {type:'sequenceIndex', sequenceVisible:false, signalType:yy.LINETYPE.AUTONUMBER};\nbreak;\ncase 20:\nthis.$ = {type:'sequenceIndex', sequenceVisible:true, signalType:yy.LINETYPE.AUTONUMBER}; \nbreak;\ncase 21:\nthis.$={type: 'activeStart', signalType: yy.LINETYPE.ACTIVE_START, actor: $$[$0-1]};\nbreak;\ncase 22:\nthis.$={type: 'activeEnd', signalType: yy.LINETYPE.ACTIVE_END, actor: $$[$0-1]};\nbreak;\ncase 28:\nyy.setTitle($$[$0].substring(6));this.$=$$[$0].substring(6);\nbreak;\ncase 29:\nyy.setTitle($$[$0].substring(7));this.$=$$[$0].substring(7);\nbreak;\ncase 30:\nyy.setAccDescription($$[$0].substring(15));this.$=$$[$0].substring(15);\nbreak;\ncase 31:\n\r\n\t\t$$[$0-1].unshift({type: 'loopStart', loopText:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.LOOP_START});\r\n\t\t$$[$0-1].push({type: 'loopEnd', loopText:$$[$0-2], signalType: yy.LINETYPE.LOOP_END});\r\n\t\tthis.$=$$[$0-1];\nbreak;\ncase 32:\n\r\n\t\t$$[$0-1].unshift({type: 'rectStart', color:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.RECT_START });\r\n\t\t$$[$0-1].push({type: 'rectEnd', color:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.RECT_END });\r\n\t\tthis.$=$$[$0-1];\nbreak;\ncase 33:\n\r\n\t\t$$[$0-1].unshift({type: 'optStart', optText:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.OPT_START});\r\n\t\t$$[$0-1].push({type: 'optEnd', optText:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.OPT_END});\r\n\t\tthis.$=$$[$0-1];\nbreak;\ncase 34:\n\r\n\t\t// Alt start\r\n\t\t$$[$0-1].unshift({type: 'altStart', altText:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.ALT_START});\r\n\t\t// Content in alt is already in $$[$0-1]\r\n\t\t// End\r\n\t\t$$[$0-1].push({type: 'altEnd', signalType: yy.LINETYPE.ALT_END});\r\n\t\tthis.$=$$[$0-1];\nbreak;\ncase 35:\n\r\n\t\t// Parallel start\r\n\t\t$$[$0-1].unshift({type: 'parStart', parText:yy.parseMessage($$[$0-2]), signalType: yy.LINETYPE.PAR_START});\r\n\t\t// Content in par is already in $$[$0-1]\r\n\t\t// End\r\n\t\t$$[$0-1].push({type: 'parEnd', signalType: yy.LINETYPE.PAR_END});\r\n\t\tthis.$=$$[$0-1];\nbreak;\ncase 38:\n this.$ = $$[$0-3].concat([{type: 'and', parText:yy.parseMessage($$[$0-1]), signalType: yy.LINETYPE.PAR_AND}, $$[$0]]); \nbreak;\ncase 40:\n this.$ = $$[$0-3].concat([{type: 'else', altText:yy.parseMessage($$[$0-1]), signalType: yy.LINETYPE.ALT_ELSE}, $$[$0]]); \nbreak;\ncase 41:\n\r\n\t\tthis.$ = [$$[$0-1], {type:'addNote', placement:$$[$0-2], actor:$$[$0-1].actor, text:$$[$0]}];\nbreak;\ncase 42:\n\r\n\t\t// Coerce actor_pair into a [to, from, ...] array\r\n\t\t$$[$0-2] = [].concat($$[$0-1], $$[$0-1]).slice(0, 2);\r\n\t\t$$[$0-2][0] = $$[$0-2][0].actor;\r\n\t\t$$[$0-2][1] = $$[$0-2][1].actor;\r\n\t\tthis.$ = [$$[$0-1], {type:'addNote', placement:yy.PLACEMENT.OVER, actor:$$[$0-2].slice(0, 2), text:$$[$0]}];\nbreak;\ncase 43:\n\r\n\t\tthis.$ = [$$[$0-1], {type:'addLinks', actor:$$[$0-1].actor, text:$$[$0]}];\r\n  \nbreak;\ncase 44:\n\r\n\t\tthis.$ = [$$[$0-1], {type:'addALink', actor:$$[$0-1].actor, text:$$[$0]}];\r\n  \nbreak;\ncase 45:\n\r\n\t\tthis.$ = [$$[$0-1], {type:'addProperties', actor:$$[$0-1].actor, text:$$[$0]}];\r\n  \nbreak;\ncase 46:\n\r\n\t\tthis.$ = [$$[$0-1], {type:'addDetails', actor:$$[$0-1].actor, text:$$[$0]}];\r\n  \nbreak;\ncase 49:\n this.$ = [$$[$0-2], $$[$0]]; \nbreak;\ncase 50:\n this.$ = $$[$0]; \nbreak;\ncase 51:\n this.$ = yy.PLACEMENT.LEFTOF; \nbreak;\ncase 52:\n this.$ = yy.PLACEMENT.RIGHTOF; \nbreak;\ncase 53:\n this.$ = [$$[$0-4],$$[$0-1],{type: 'addMessage', from:$$[$0-4].actor, to:$$[$0-1].actor, signalType:$$[$0-3], msg:$$[$0]},\r\n\t              {type: 'activeStart', signalType: yy.LINETYPE.ACTIVE_START, actor: $$[$0-1]}\r\n\t             ]\nbreak;\ncase 54:\n this.$ = [$$[$0-4],$$[$0-1],{type: 'addMessage', from:$$[$0-4].actor, to:$$[$0-1].actor, signalType:$$[$0-3], msg:$$[$0]},\r\n\t             {type: 'activeEnd', signalType: yy.LINETYPE.ACTIVE_END, actor: $$[$0-4]}\r\n\t             ]\nbreak;\ncase 55:\n this.$ = [$$[$0-3],$$[$0-1],{type: 'addMessage', from:$$[$0-3].actor, to:$$[$0-1].actor, signalType:$$[$0-2], msg:$$[$0]}]\nbreak;\ncase 56:\nthis.$={ type: 'addParticipant', actor:$$[$0]}\nbreak;\ncase 57:\n this.$ = yy.LINETYPE.SOLID_OPEN; \nbreak;\ncase 58:\n this.$ = yy.LINETYPE.DOTTED_OPEN; \nbreak;\ncase 59:\n this.$ = yy.LINETYPE.SOLID; \nbreak;\ncase 60:\n this.$ = yy.LINETYPE.DOTTED; \nbreak;\ncase 61:\n this.$ = yy.LINETYPE.SOLID_CROSS; \nbreak;\ncase 62:\n this.$ = yy.LINETYPE.DOTTED_CROSS; \nbreak;\ncase 63:\n this.$ = yy.LINETYPE.SOLID_POINT; \nbreak;\ncase 64:\n this.$ = yy.LINETYPE.DOTTED_POINT; \nbreak;\ncase 65:\nthis.$ = yy.parseMessage($$[$0].trim().substring(1)) \nbreak;\ncase 66:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 67:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 68:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 69:\n yy.parseDirective('}%%', 'close_directive', 'sequence'); \nbreak;\n}\n},\ntable: [{3:1,4:$V0,5:$V1,6:4,7:$V2,11:6,71:$V3},{1:[3]},{3:8,4:$V0,5:$V1,6:4,7:$V2,11:6,71:$V3},{3:9,4:$V0,5:$V1,6:4,7:$V2,11:6,71:$V3},{3:10,4:$V0,5:$V1,6:4,7:$V2,11:6,71:$V3},o([1,4,5,16,20,22,25,26,32,33,34,35,37,38,39,41,45,50,51,52,53,61,71],$V4,{8:11}),{12:12,72:[1,13]},{72:[2,66]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4],4:$V5,5:$V6,6:37,9:14,10:16,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,37:$Vg,38:$Vh,39:$Vi,41:$Vj,45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},{13:45,14:[1,46],74:$Vq},o([14,74],[2,67]),o($Vr,[2,6]),{6:37,10:48,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,37:$Vg,38:$Vh,39:$Vi,41:$Vj,45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},o($Vr,[2,8]),o($Vr,[2,9]),{17:49,61:$Vp},{17:50,61:$Vp},{5:[1,51]},{5:[1,54],23:[1,52],24:[1,53]},{17:55,61:$Vp},{17:56,61:$Vp},{5:[1,57]},{5:[1,58]},{5:[1,59]},{5:[1,60]},{5:[1,61]},o($Vr,[2,28]),o($Vr,[2,29]),o($Vr,[2,30]),{19:[1,62]},{19:[1,63]},{19:[1,64]},{19:[1,65]},{19:[1,66]},o($Vr,[2,36]),{58:67,62:[1,68],63:[1,69],64:[1,70],65:[1,71],66:[1,72],67:[1,73],68:[1,74],69:[1,75]},{46:76,48:[1,77],56:[1,78],57:[1,79]},{17:80,61:$Vp},{17:81,61:$Vp},{17:82,61:$Vp},{17:83,61:$Vp},o([5,18,55,62,63,64,65,66,67,68,69,70],[2,56]),{5:[1,84]},{15:85,73:[1,86]},{5:[2,69]},o($Vr,[2,7]),{5:[1,88],18:[1,87]},{5:[1,90],18:[1,89]},o($Vr,[2,16]),{5:[1,92],23:[1,91]},{5:[1,93]},o($Vr,[2,20]),{5:[1,94]},{5:[1,95]},o($Vr,[2,23]),o($Vr,[2,24]),o($Vr,[2,25]),o($Vr,[2,26]),o($Vr,[2,27]),o($Vs,$V4,{8:96}),o($Vs,$V4,{8:97}),o($Vs,$V4,{8:98}),o($Vt,$V4,{40:99,8:100}),o($Vu,$V4,{42:101,8:102}),{17:105,59:[1,103],60:[1,104],61:$Vp},o($Vv,[2,57]),o($Vv,[2,58]),o($Vv,[2,59]),o($Vv,[2,60]),o($Vv,[2,61]),o($Vv,[2,62]),o($Vv,[2,63]),o($Vv,[2,64]),{17:106,61:$Vp},{17:108,49:107,61:$Vp},{61:[2,51]},{61:[2,52]},{47:109,70:$Vw},{47:111,70:$Vw},{47:112,70:$Vw},{47:113,70:$Vw},o($Vx,[2,10]),{13:114,74:$Vq},{74:[2,68]},{19:[1,115]},o($Vr,[2,13]),{19:[1,116]},o($Vr,[2,15]),{5:[1,117]},o($Vr,[2,18]),o($Vr,[2,19]),o($Vr,[2,21]),o($Vr,[2,22]),{4:$V5,5:$V6,6:37,9:14,10:16,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,36:[1,118],37:$Vg,38:$Vh,39:$Vi,41:$Vj,45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},{4:$V5,5:$V6,6:37,9:14,10:16,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,36:[1,119],37:$Vg,38:$Vh,39:$Vi,41:$Vj,45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},{4:$V5,5:$V6,6:37,9:14,10:16,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,36:[1,120],37:$Vg,38:$Vh,39:$Vi,41:$Vj,45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},{36:[1,121]},{4:$V5,5:$V6,6:37,9:14,10:16,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,36:[2,39],37:$Vg,38:$Vh,39:$Vi,41:$Vj,44:[1,122],45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},{36:[1,123]},{4:$V5,5:$V6,6:37,9:14,10:16,11:6,16:$V7,17:38,20:$V8,21:20,22:$V9,25:$Va,26:$Vb,27:24,28:25,29:26,30:27,31:28,32:$Vc,33:$Vd,34:$Ve,35:$Vf,36:[2,37],37:$Vg,38:$Vh,39:$Vi,41:$Vj,43:[1,124],45:$Vk,50:$Vl,51:$Vm,52:$Vn,53:$Vo,61:$Vp,71:$V3},{17:125,61:$Vp},{17:126,61:$Vp},{47:127,70:$Vw},{47:128,70:$Vw},{47:129,70:$Vw},{55:[1,130],70:[2,50]},{5:[2,43]},{5:[2,65]},{5:[2,44]},{5:[2,45]},{5:[2,46]},{5:[1,131]},{5:[1,132]},{5:[1,133]},o($Vr,[2,17]),o($Vr,[2,31]),o($Vr,[2,32]),o($Vr,[2,33]),o($Vr,[2,34]),{19:[1,134]},o($Vr,[2,35]),{19:[1,135]},{47:136,70:$Vw},{47:137,70:$Vw},{5:[2,55]},{5:[2,41]},{5:[2,42]},{17:138,61:$Vp},o($Vx,[2,11]),o($Vr,[2,12]),o($Vr,[2,14]),o($Vt,$V4,{8:100,40:139}),o($Vu,$V4,{8:102,42:140}),{5:[2,53]},{5:[2,54]},{70:[2,49]},{36:[2,40]},{36:[2,38]}],\ndefaultActions: {7:[2,66],8:[2,1],9:[2,2],10:[2,3],47:[2,69],78:[2,51],79:[2,52],86:[2,68],109:[2,43],110:[2,65],111:[2,44],112:[2,45],113:[2,46],127:[2,55],128:[2,41],129:[2,42],136:[2,53],137:[2,54],138:[2,49],139:[2,40],140:[2,38]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 71; \nbreak;\ncase 1: this.begin('type_directive'); return 72; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 14; \nbreak;\ncase 3: this.popState(); this.popState(); return 74; \nbreak;\ncase 4:return 73;\nbreak;\ncase 5:return 5;\nbreak;\ncase 6:/* skip all whitespace */\nbreak;\ncase 7:/* skip same-line whitespace */\nbreak;\ncase 8:/* skip comments */\nbreak;\ncase 9:/* skip comments */\nbreak;\ncase 10:/* skip comments */\nbreak;\ncase 11:return 23;\nbreak;\ncase 12: this.begin('ID'); return 16; \nbreak;\ncase 13: this.begin('ID'); return 20; \nbreak;\ncase 14: yy_.yytext = yy_.yytext.trim(); this.begin('ALIAS'); return 61; \nbreak;\ncase 15: this.popState(); this.popState(); this.begin('LINE'); return 18; \nbreak;\ncase 16: this.popState(); this.popState(); return 5; \nbreak;\ncase 17: this.begin('LINE'); return 35; \nbreak;\ncase 18: this.begin('LINE'); return 37; \nbreak;\ncase 19: this.begin('LINE'); return 38; \nbreak;\ncase 20: this.begin('LINE'); return 39; \nbreak;\ncase 21: this.begin('LINE'); return 44; \nbreak;\ncase 22: this.begin('LINE'); return 41; \nbreak;\ncase 23: this.begin('LINE'); return 43; \nbreak;\ncase 24: this.popState(); return 19; \nbreak;\ncase 25:return 36;\nbreak;\ncase 26:return 56;\nbreak;\ncase 27:return 57;\nbreak;\ncase 28:return 50;\nbreak;\ncase 29:return 51;\nbreak;\ncase 30:return 52;\nbreak;\ncase 31:return 53;\nbreak;\ncase 32:return 48;\nbreak;\ncase 33:return 45;\nbreak;\ncase 34: this.begin('ID'); return 25; \nbreak;\ncase 35: this.begin('ID'); return 26; \nbreak;\ncase 36:return 32;\nbreak;\ncase 37:return 33;\nbreak;\ncase 38:return 34;\nbreak;\ncase 39:return 7;\nbreak;\ncase 40:return 22;\nbreak;\ncase 41:return 24;\nbreak;\ncase 42:return 55;\nbreak;\ncase 43:return 5;\nbreak;\ncase 44: yy_.yytext = yy_.yytext.trim(); return 61; \nbreak;\ncase 45:return 64;\nbreak;\ncase 46:return 65;\nbreak;\ncase 47:return 62;\nbreak;\ncase 48:return 63;\nbreak;\ncase 49:return 66;\nbreak;\ncase 50:return 67;\nbreak;\ncase 51:return 68;\nbreak;\ncase 52:return 69;\nbreak;\ncase 53:return 70;\nbreak;\ncase 54:return 59;\nbreak;\ncase 55:return 60;\nbreak;\ncase 56:return 5;\nbreak;\ncase 57:return 'INVALID';\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:[\\n]+)/i,/^(?:\\s+)/i,/^(?:((?!\\n)\\s)+)/i,/^(?:#[^\\n]*)/i,/^(?:%(?!\\{)[^\\n]*)/i,/^(?:[^\\}]%%[^\\n]*)/i,/^(?:[0-9]+)/i,/^(?:participant\\b)/i,/^(?:actor\\b)/i,/^(?:[^\\->:\\n,;]+?(?=((?!\\n)\\s)+as(?!\\n)\\s|[#\\n;]|$))/i,/^(?:as\\b)/i,/^(?:(?:))/i,/^(?:loop\\b)/i,/^(?:rect\\b)/i,/^(?:opt\\b)/i,/^(?:alt\\b)/i,/^(?:else\\b)/i,/^(?:par\\b)/i,/^(?:and\\b)/i,/^(?:(?:[:]?(?:no)?wrap)?[^#\\n;]*)/i,/^(?:end\\b)/i,/^(?:left of\\b)/i,/^(?:right of\\b)/i,/^(?:links\\b)/i,/^(?:link\\b)/i,/^(?:properties\\b)/i,/^(?:details\\b)/i,/^(?:over\\b)/i,/^(?:note\\b)/i,/^(?:activate\\b)/i,/^(?:deactivate\\b)/i,/^(?:title\\s[^#\\n;]+)/i,/^(?:title:\\s[^#\\n;]+)/i,/^(?:accDescription\\s[^#\\n;]+)/i,/^(?:sequenceDiagram\\b)/i,/^(?:autonumber\\b)/i,/^(?:off\\b)/i,/^(?:,)/i,/^(?:;)/i,/^(?:[^\\+\\->:\\n,;]+((?!(-x|--x|-\\)|--\\)))[\\-]*[^\\+\\->:\\n,;]+)*)/i,/^(?:->>)/i,/^(?:-->>)/i,/^(?:->)/i,/^(?:-->)/i,/^(?:-[x])/i,/^(?:--[x])/i,/^(?:-[\\)])/i,/^(?:--[\\)])/i,/^(?::(?:(?:no)?wrap)?[^#\\n;]+)/i,/^(?:\\+)/i,/^(?:-)/i,/^(?:$)/i,/^(?:.)/i],\nconditions: {\"open_directive\":{\"rules\":[1,8],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3,8],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4,8],\"inclusive\":false},\"ID\":{\"rules\":[7,8,14],\"inclusive\":false},\"ALIAS\":{\"rules\":[7,8,15,16],\"inclusive\":false},\"LINE\":{\"rules\":[7,8,24],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,8,9,10,11,12,13,17,18,19,20,21,22,23,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,2],$V1=[1,3],$V2=[1,5],$V3=[1,7],$V4=[2,5],$V5=[1,15],$V6=[1,17],$V7=[1,19],$V8=[1,20],$V9=[1,21],$Va=[1,22],$Vb=[1,32],$Vc=[1,23],$Vd=[1,24],$Ve=[1,25],$Vf=[1,26],$Vg=[1,27],$Vh=[1,30],$Vi=[1,31],$Vj=[1,34],$Vk=[1,35],$Vl=[1,36],$Vm=[1,37],$Vn=[1,33],$Vo=[1,40],$Vp=[1,4,5,14,15,17,19,20,22,23,24,25,26,27,31,33,40,41,42,43,46,49],$Vq=[1,4,5,12,13,14,15,17,19,20,22,23,24,25,26,27,31,33,40,41,42,43,46,49],$Vr=[1,4,5,7,14,15,17,19,20,22,23,24,25,26,27,31,33,40,41,42,43,46,49],$Vs=[4,5,14,15,17,19,20,22,23,24,25,26,27,31,33,40,41,42,43,46,49];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"SPACE\":4,\"NL\":5,\"directive\":6,\"SD\":7,\"document\":8,\"line\":9,\"statement\":10,\"idStatement\":11,\"DESCR\":12,\"-->\":13,\"HIDE_EMPTY\":14,\"scale\":15,\"WIDTH\":16,\"COMPOSIT_STATE\":17,\"STRUCT_START\":18,\"STRUCT_STOP\":19,\"STATE_DESCR\":20,\"AS\":21,\"ID\":22,\"FORK\":23,\"JOIN\":24,\"CHOICE\":25,\"CONCURRENT\":26,\"note\":27,\"notePosition\":28,\"NOTE_TEXT\":29,\"direction\":30,\"title\":31,\"title_value\":32,\"accDescription\":33,\"description_value\":34,\"openDirective\":35,\"typeDirective\":36,\"closeDirective\":37,\":\":38,\"argDirective\":39,\"direction_tb\":40,\"direction_bt\":41,\"direction_rl\":42,\"direction_lr\":43,\"eol\":44,\";\":45,\"EDGE_STATE\":46,\"left_of\":47,\"right_of\":48,\"open_directive\":49,\"type_directive\":50,\"arg_directive\":51,\"close_directive\":52,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",4:\"SPACE\",5:\"NL\",7:\"SD\",12:\"DESCR\",13:\"-->\",14:\"HIDE_EMPTY\",15:\"scale\",16:\"WIDTH\",17:\"COMPOSIT_STATE\",18:\"STRUCT_START\",19:\"STRUCT_STOP\",20:\"STATE_DESCR\",21:\"AS\",22:\"ID\",23:\"FORK\",24:\"JOIN\",25:\"CHOICE\",26:\"CONCURRENT\",27:\"note\",29:\"NOTE_TEXT\",31:\"title\",32:\"title_value\",33:\"accDescription\",34:\"description_value\",38:\":\",40:\"direction_tb\",41:\"direction_bt\",42:\"direction_rl\",43:\"direction_lr\",45:\";\",46:\"EDGE_STATE\",47:\"left_of\",48:\"right_of\",49:\"open_directive\",50:\"type_directive\",51:\"arg_directive\",52:\"close_directive\"},\nproductions_: [0,[3,2],[3,2],[3,2],[3,2],[8,0],[8,2],[9,2],[9,1],[9,1],[10,1],[10,2],[10,3],[10,4],[10,1],[10,2],[10,1],[10,4],[10,3],[10,6],[10,1],[10,1],[10,1],[10,1],[10,4],[10,4],[10,1],[10,1],[10,2],[10,2],[6,3],[6,5],[30,1],[30,1],[30,1],[30,1],[44,1],[44,1],[11,1],[11,1],[28,1],[28,1],[35,1],[36,1],[39,1],[37,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 4:\n /*console.warn('Root document', $$[$0]);*/ yy.setRootDoc($$[$0]);return $$[$0]; \nbreak;\ncase 5:\n this.$ = [] \nbreak;\ncase 6:\n\r\n        if($$[$0]!='nl'){\r\n            $$[$0-1].push($$[$0]);this.$ = $$[$0-1]\r\n        }\r\n        // console.warn('Got document',$$[$0-1], $$[$0]);\r\n    \nbreak;\ncase 7: case 8:\n this.$ = $$[$0] \nbreak;\ncase 9:\n this.$='nl';\nbreak;\ncase 10:\n /*console.warn('got id and descr', $$[$0]);*/this.$={ stmt: 'state', id: $$[$0], type: 'default', description: ''};\nbreak;\ncase 11:\n /*console.warn('got id and descr', $$[$0-1], $$[$0].trim());*/this.$={ stmt: 'state', id: $$[$0-1], type: 'default', description: yy.trimColon($$[$0])};\nbreak;\ncase 12:\n\r\n        /*console.warn('got id', $$[$0-2]);yy.addRelation($$[$0-2], $$[$0]);*/\r\n        this.$={ stmt: 'relation', state1: { stmt: 'state', id: $$[$0-2], type: 'default', description: '' }, state2:{ stmt: 'state', id: $$[$0] ,type: 'default', description: ''}};\r\n    \nbreak;\ncase 13:\n\r\n        /*yy.addRelation($$[$0-3], $$[$0-1], $$[$0].substr(1).trim());*/\r\n        this.$={ stmt: 'relation', state1: { stmt: 'state', id: $$[$0-3], type: 'default', description: '' }, state2:{ stmt: 'state', id: $$[$0-1] ,type: 'default', description: ''}, description: $$[$0].substr(1).trim()};\r\n    \nbreak;\ncase 17:\n\r\n        /* console.warn('Adding document for state without id ', $$[$0-3]);*/\r\n        this.$={ stmt: 'state', id: $$[$0-3], type: 'default', description: '', doc: $$[$0-1] }\r\n    \nbreak;\ncase 18:\n\r\n        var id=$$[$0];\r\n        var description = $$[$0-2].trim();\r\n        if($$[$0].match(':')){\r\n            var parts = $$[$0].split(':');\r\n            id=parts[0];\r\n            description = [description, parts[1]];\r\n        }\r\n        this.$={stmt: 'state', id: id, type: 'default', description: description};\r\n\r\n    \nbreak;\ncase 19:\n\r\n         // console.warn('Adding document for state with id zxzx', $$[$0-3], $$[$0-2], yy.getDirection()); yy.addDocument($$[$0-3]);\r\n         this.$={ stmt: 'state', id: $$[$0-3], type: 'default', description: $$[$0-5], doc: $$[$0-1] }\r\n    \nbreak;\ncase 20:\n\r\n        this.$={ stmt: 'state', id: $$[$0], type: 'fork' }\r\n    \nbreak;\ncase 21:\n\r\n        this.$={ stmt: 'state', id: $$[$0], type: 'join' }\r\n    \nbreak;\ncase 22:\n\r\n        this.$={ stmt: 'state', id: $$[$0], type: 'choice' }\r\n    \nbreak;\ncase 23:\n\r\n        this.$={ stmt: 'state', id: yy.getDividerId(), type: 'divider' }\r\n    \nbreak;\ncase 24:\n\r\n        /* console.warn('got NOTE, position: ', $$[$0-2].trim(), 'id = ', $$[$0-1].trim(), 'note: ', $$[$0]);*/\r\n        this.$={ stmt: 'state', id: $$[$0-1].trim(), note:{position: $$[$0-2].trim(), text: $$[$0].trim()}};\r\n    \nbreak;\ncase 28:\n this.$=$$[$0].trim();yy.setTitle(this.$); \nbreak;\ncase 29:\n this.$=$$[$0].trim();yy.setAccDescription(this.$); \nbreak;\ncase 32:\n yy.setDirection('TB');this.$={stmt:'dir', value:'TB'};\nbreak;\ncase 33:\n yy.setDirection('BT');this.$={stmt:'dir', value:'BT'};\nbreak;\ncase 34:\n yy.setDirection('RL'); this.$={stmt:'dir', value:'RL'};\nbreak;\ncase 35:\n yy.setDirection('LR');this.$={stmt:'dir', value:'LR'};\nbreak;\ncase 38: case 39:\nthis.$=$$[$0];\nbreak;\ncase 42:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 43:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 44:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 45:\n yy.parseDirective('}%%', 'close_directive', 'state'); \nbreak;\n}\n},\ntable: [{3:1,4:$V0,5:$V1,6:4,7:$V2,35:6,49:$V3},{1:[3]},{3:8,4:$V0,5:$V1,6:4,7:$V2,35:6,49:$V3},{3:9,4:$V0,5:$V1,6:4,7:$V2,35:6,49:$V3},{3:10,4:$V0,5:$V1,6:4,7:$V2,35:6,49:$V3},o([1,4,5,14,15,17,20,22,23,24,25,26,27,31,33,40,41,42,43,46,49],$V4,{8:11}),{36:12,50:[1,13]},{50:[2,42]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4],4:$V5,5:$V6,6:28,9:14,10:16,11:18,14:$V7,15:$V8,17:$V9,20:$Va,22:$Vb,23:$Vc,24:$Vd,25:$Ve,26:$Vf,27:$Vg,30:29,31:$Vh,33:$Vi,35:6,40:$Vj,41:$Vk,42:$Vl,43:$Vm,46:$Vn,49:$V3},{37:38,38:[1,39],52:$Vo},o([38,52],[2,43]),o($Vp,[2,6]),{6:28,10:41,11:18,14:$V7,15:$V8,17:$V9,20:$Va,22:$Vb,23:$Vc,24:$Vd,25:$Ve,26:$Vf,27:$Vg,30:29,31:$Vh,33:$Vi,35:6,40:$Vj,41:$Vk,42:$Vl,43:$Vm,46:$Vn,49:$V3},o($Vp,[2,8]),o($Vp,[2,9]),o($Vp,[2,10],{12:[1,42],13:[1,43]}),o($Vp,[2,14]),{16:[1,44]},o($Vp,[2,16],{18:[1,45]}),{21:[1,46]},o($Vp,[2,20]),o($Vp,[2,21]),o($Vp,[2,22]),o($Vp,[2,23]),{28:47,29:[1,48],47:[1,49],48:[1,50]},o($Vp,[2,26]),o($Vp,[2,27]),{32:[1,51]},{34:[1,52]},o($Vq,[2,38]),o($Vq,[2,39]),o($Vp,[2,32]),o($Vp,[2,33]),o($Vp,[2,34]),o($Vp,[2,35]),o($Vr,[2,30]),{39:53,51:[1,54]},o($Vr,[2,45]),o($Vp,[2,7]),o($Vp,[2,11]),{11:55,22:$Vb,46:$Vn},o($Vp,[2,15]),o($Vs,$V4,{8:56}),{22:[1,57]},{22:[1,58]},{21:[1,59]},{22:[2,40]},{22:[2,41]},o($Vp,[2,28]),o($Vp,[2,29]),{37:60,52:$Vo},{52:[2,44]},o($Vp,[2,12],{12:[1,61]}),{4:$V5,5:$V6,6:28,9:14,10:16,11:18,14:$V7,15:$V8,17:$V9,19:[1,62],20:$Va,22:$Vb,23:$Vc,24:$Vd,25:$Ve,26:$Vf,27:$Vg,30:29,31:$Vh,33:$Vi,35:6,40:$Vj,41:$Vk,42:$Vl,43:$Vm,46:$Vn,49:$V3},o($Vp,[2,18],{18:[1,63]}),{29:[1,64]},{22:[1,65]},o($Vr,[2,31]),o($Vp,[2,13]),o($Vp,[2,17]),o($Vs,$V4,{8:66}),o($Vp,[2,24]),o($Vp,[2,25]),{4:$V5,5:$V6,6:28,9:14,10:16,11:18,14:$V7,15:$V8,17:$V9,19:[1,67],20:$Va,22:$Vb,23:$Vc,24:$Vd,25:$Ve,26:$Vf,27:$Vg,30:29,31:$Vh,33:$Vi,35:6,40:$Vj,41:$Vk,42:$Vl,43:$Vm,46:$Vn,49:$V3},o($Vp,[2,19])],\ndefaultActions: {7:[2,42],8:[2,1],9:[2,2],10:[2,3],49:[2,40],50:[2,41],54:[2,44]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:return 40;\nbreak;\ncase 1:return 41;\nbreak;\ncase 2:return 42;\nbreak;\ncase 3:return 43;\nbreak;\ncase 4: this.begin('open_directive'); return 49; \nbreak;\ncase 5: this.begin('type_directive'); return 50; \nbreak;\ncase 6: this.popState(); this.begin('arg_directive'); return 38; \nbreak;\ncase 7: this.popState(); this.popState(); return 52; \nbreak;\ncase 8:return 51;\nbreak;\ncase 9:/* skip comments */\nbreak;\ncase 10:/* skip comments */{ /*console.log('Crap after close');*/ }\nbreak;\ncase 11:return 5;\nbreak;\ncase 12:/* skip all whitespace */\nbreak;\ncase 13:/* skip same-line whitespace */\nbreak;\ncase 14:/* skip comments */\nbreak;\ncase 15:/* skip comments */\nbreak;\ncase 16: this.pushState('SCALE'); /* console.log('Got scale', yy_.yytext);*/ return 15; \nbreak;\ncase 17:return 16;\nbreak;\ncase 18:this.popState();\nbreak;\ncase 19: this.begin(\"title\");return 31; \nbreak;\ncase 20: this.popState(); return \"title_value\"; \nbreak;\ncase 21: this.begin(\"accDescription\");return 33; \nbreak;\ncase 22: this.popState(); return \"description_value\"; \nbreak;\ncase 23: /*console.log('Starting STATE zxzx'+yy.getDirection());*/this.pushState('STATE'); \nbreak;\ncase 24:this.popState();yy_.yytext=yy_.yytext.slice(0,-8).trim(); /*console.warn('Fork Fork: ',yy_.yytext);*/return 23;\nbreak;\ncase 25:this.popState();yy_.yytext=yy_.yytext.slice(0,-8).trim();/*console.warn('Fork Join: ',yy_.yytext);*/return 24;\nbreak;\ncase 26:this.popState();yy_.yytext=yy_.yytext.slice(0,-10).trim();/*console.warn('Fork Join: ',yy_.yytext);*/return 25;\nbreak;\ncase 27:this.popState();yy_.yytext=yy_.yytext.slice(0,-8).trim();/*console.warn('Fork Fork: ',yy_.yytext);*/return 23;\nbreak;\ncase 28:this.popState();yy_.yytext=yy_.yytext.slice(0,-8).trim();/*console.warn('Fork Join: ',yy_.yytext);*/return 24;\nbreak;\ncase 29:this.popState();yy_.yytext=yy_.yytext.slice(0,-10).trim();/*console.warn('Fork Join: ',yy_.yytext);*/return 25;\nbreak;\ncase 30: return 40;\nbreak;\ncase 31: return 41;\nbreak;\ncase 32: return 42;\nbreak;\ncase 33: return 43;\nbreak;\ncase 34: /*console.log('Starting STATE_STRING zxzx');*/this.begin(\"STATE_STRING\");\nbreak;\ncase 35:this.popState();this.pushState('STATE_ID');return \"AS\";\nbreak;\ncase 36:this.popState();/* console.log('STATE_ID', yy_.yytext);*/return \"ID\";\nbreak;\ncase 37:this.popState();\nbreak;\ncase 38: /*console.log('Long description:', yy_.yytext);*/return \"STATE_DESCR\";\nbreak;\ncase 39:/*console.log('COMPOSIT_STATE', yy_.yytext);*/return 17;\nbreak;\ncase 40:this.popState();\nbreak;\ncase 41:this.popState();this.pushState('struct'); /*console.log('begin struct', yy_.yytext);*/return 18;\nbreak;\ncase 42: /*console.log('Ending struct');*/ this.popState(); return 19;\nbreak;\ncase 43:/* nothing */\nbreak;\ncase 44: this.begin('NOTE'); return 27; \nbreak;\ncase 45: this.popState();this.pushState('NOTE_ID');return 47;\nbreak;\ncase 46: this.popState();this.pushState('NOTE_ID');return 48;\nbreak;\ncase 47: this.popState();this.pushState('FLOATING_NOTE');\nbreak;\ncase 48:this.popState();this.pushState('FLOATING_NOTE_ID');return \"AS\";\nbreak;\ncase 49:/**/\nbreak;\ncase 50: /*console.log('Floating note text: ', yy_.yytext);*/return \"NOTE_TEXT\";\nbreak;\ncase 51:this.popState();/*console.log('Floating note ID', yy_.yytext);*/return \"ID\";\nbreak;\ncase 52: this.popState();this.pushState('NOTE_TEXT');/*console.log('Got ID for note', yy_.yytext);*/return 22;\nbreak;\ncase 53: this.popState();/*console.log('Got NOTE_TEXT for note',yy_.yytext);*/yy_.yytext = yy_.yytext.substr(2).trim();return 29;\nbreak;\ncase 54: this.popState();/*console.log('Got NOTE_TEXT for note',yy_.yytext);*/yy_.yytext = yy_.yytext.slice(0,-8).trim();return 29;\nbreak;\ncase 55: /*console.log('Got state diagram', yy_.yytext,'#');*/return 7; \nbreak;\ncase 56: /*console.log('Got state diagram', yy_.yytext,'#');*/return 7; \nbreak;\ncase 57: /*console.log('HIDE_EMPTY', yy_.yytext,'#');*/return 14; \nbreak;\ncase 58: /*console.log('EDGE_STATE=',yy_.yytext);*/ return 46;\nbreak;\ncase 59: /*console.log('=>ID=',yy_.yytext);*/ return 22;\nbreak;\ncase 60: yy_.yytext = yy_.yytext.trim(); /*console.log('Descr = ', yy_.yytext);*/ return 12; \nbreak;\ncase 61:return 13;\nbreak;\ncase 62:return 26;\nbreak;\ncase 63:return 5;\nbreak;\ncase 64:return 'INVALID';\nbreak;\n}\n},\nrules: [/^(?:.*direction\\s+TB[^\\n]*)/i,/^(?:.*direction\\s+BT[^\\n]*)/i,/^(?:.*direction\\s+RL[^\\n]*)/i,/^(?:.*direction\\s+LR[^\\n]*)/i,/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:%%(?!\\{)[^\\n]*)/i,/^(?:[^\\}]%%[^\\n]*)/i,/^(?:[\\n]+)/i,/^(?:[\\s]+)/i,/^(?:((?!\\n)\\s)+)/i,/^(?:#[^\\n]*)/i,/^(?:%[^\\n]*)/i,/^(?:scale\\s+)/i,/^(?:\\d+)/i,/^(?:\\s+width\\b)/i,/^(?:title\\b)/i,/^(?:(?!\\n||)*[^\\n]*)/i,/^(?:accDescription\\b)/i,/^(?:(?!\\n||)*[^\\n]*)/i,/^(?:state\\s+)/i,/^(?:.*<<fork>>)/i,/^(?:.*<<join>>)/i,/^(?:.*<<choice>>)/i,/^(?:.*\\[\\[fork\\]\\])/i,/^(?:.*\\[\\[join\\]\\])/i,/^(?:.*\\[\\[choice\\]\\])/i,/^(?:.*direction\\s+TB[^\\n]*)/i,/^(?:.*direction\\s+BT[^\\n]*)/i,/^(?:.*direction\\s+RL[^\\n]*)/i,/^(?:.*direction\\s+LR[^\\n]*)/i,/^(?:[\"])/i,/^(?:\\s*as\\s+)/i,/^(?:[^\\n\\{]*)/i,/^(?:[\"])/i,/^(?:[^\"]*)/i,/^(?:[^\\n\\s\\{]+)/i,/^(?:\\n)/i,/^(?:\\{)/i,/^(?:\\})/i,/^(?:[\\n])/i,/^(?:note\\s+)/i,/^(?:left of\\b)/i,/^(?:right of\\b)/i,/^(?:\")/i,/^(?:\\s*as\\s*)/i,/^(?:[\"])/i,/^(?:[^\"]*)/i,/^(?:[^\\n]*)/i,/^(?:\\s*[^:\\n\\s\\-]+)/i,/^(?:\\s*:[^:\\n;]+)/i,/^(?:[\\s\\S]*?end note\\b)/i,/^(?:stateDiagram\\s+)/i,/^(?:stateDiagram-v2\\s+)/i,/^(?:hide empty description\\b)/i,/^(?:\\[\\*\\])/i,/^(?:[^:\\n\\s\\-\\{]+)/i,/^(?:\\s*:[^:\\n;]+)/i,/^(?:-->)/i,/^(?:--)/i,/^(?:$)/i,/^(?:.)/i],\nconditions: {\"LINE\":{\"rules\":[13,14],\"inclusive\":false},\"close_directive\":{\"rules\":[13,14],\"inclusive\":false},\"arg_directive\":{\"rules\":[7,8,13,14],\"inclusive\":false},\"type_directive\":{\"rules\":[6,7,13,14],\"inclusive\":false},\"open_directive\":{\"rules\":[5,13,14],\"inclusive\":false},\"struct\":{\"rules\":[13,14,23,30,31,32,33,42,43,44,58,59,60,61,62],\"inclusive\":false},\"FLOATING_NOTE_ID\":{\"rules\":[51],\"inclusive\":false},\"FLOATING_NOTE\":{\"rules\":[48,49,50],\"inclusive\":false},\"NOTE_TEXT\":{\"rules\":[53,54],\"inclusive\":false},\"NOTE_ID\":{\"rules\":[52],\"inclusive\":false},\"NOTE\":{\"rules\":[45,46,47],\"inclusive\":false},\"accDescription\":{\"rules\":[22],\"inclusive\":false},\"title\":{\"rules\":[20],\"inclusive\":false},\"SCALE\":{\"rules\":[17,18],\"inclusive\":false},\"ALIAS\":{\"rules\":[],\"inclusive\":false},\"STATE_ID\":{\"rules\":[36],\"inclusive\":false},\"STATE_STRING\":{\"rules\":[37,38],\"inclusive\":false},\"FORK_STATE\":{\"rules\":[],\"inclusive\":false},\"STATE\":{\"rules\":[13,14,24,25,26,27,28,29,34,35,39,40,41],\"inclusive\":false},\"ID\":{\"rules\":[13,14],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,1,2,3,4,9,10,11,12,14,15,16,19,21,23,41,44,55,56,57,58,59,60,61,63,64],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,2],$V1=[1,5],$V2=[6,9,11,17,18,19,20,22],$V3=[1,15],$V4=[1,16],$V5=[1,17],$V6=[1,18],$V7=[1,22],$V8=[4,6,9,11,17,18,19,20,22];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"start\":3,\"journey\":4,\"document\":5,\"EOF\":6,\"directive\":7,\"line\":8,\"SPACE\":9,\"statement\":10,\"NEWLINE\":11,\"openDirective\":12,\"typeDirective\":13,\"closeDirective\":14,\":\":15,\"argDirective\":16,\"title\":17,\"accDescription\":18,\"section\":19,\"taskName\":20,\"taskData\":21,\"open_directive\":22,\"type_directive\":23,\"arg_directive\":24,\"close_directive\":25,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",4:\"journey\",6:\"EOF\",9:\"SPACE\",11:\"NEWLINE\",15:\":\",17:\"title\",18:\"accDescription\",19:\"section\",20:\"taskName\",21:\"taskData\",22:\"open_directive\",23:\"type_directive\",24:\"arg_directive\",25:\"close_directive\"},\nproductions_: [0,[3,3],[3,2],[5,0],[5,2],[8,2],[8,1],[8,1],[8,1],[7,4],[7,6],[10,1],[10,1],[10,1],[10,2],[10,1],[12,1],[13,1],[16,1],[14,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:\n return $$[$0-1]; \nbreak;\ncase 3:\n this.$ = [] \nbreak;\ncase 4:\n$$[$0-1].push($$[$0]);this.$ = $$[$0-1]\nbreak;\ncase 5: case 6:\n this.$ = $$[$0] \nbreak;\ncase 7: case 8:\n this.$=[];\nbreak;\ncase 11:\nyy.setTitle($$[$0].substr(6));this.$=$$[$0].substr(6);\nbreak;\ncase 12:\nyy.setAccDescription($$[$0].substring(15));this.$=$$[$0].substring(15);\nbreak;\ncase 13:\nyy.addSection($$[$0].substr(8));this.$=$$[$0].substr(8);\nbreak;\ncase 14:\nyy.addTask($$[$0-1], $$[$0]);this.$='task';\nbreak;\ncase 16:\n yy.parseDirective('%%{', 'open_directive'); \nbreak;\ncase 17:\n yy.parseDirective($$[$0], 'type_directive'); \nbreak;\ncase 18:\n $$[$0] = $$[$0].trim().replace(/'/g, '\"'); yy.parseDirective($$[$0], 'arg_directive'); \nbreak;\ncase 19:\n yy.parseDirective('}%%', 'close_directive', 'journey'); \nbreak;\n}\n},\ntable: [{3:1,4:$V0,7:3,12:4,22:$V1},{1:[3]},o($V2,[2,3],{5:6}),{3:7,4:$V0,7:3,12:4,22:$V1},{13:8,23:[1,9]},{23:[2,16]},{6:[1,10],7:19,8:11,9:[1,12],10:13,11:[1,14],12:4,17:$V3,18:$V4,19:$V5,20:$V6,22:$V1},{1:[2,2]},{14:20,15:[1,21],25:$V7},o([15,25],[2,17]),o($V2,[2,8],{1:[2,1]}),o($V2,[2,4]),{7:19,10:23,12:4,17:$V3,18:$V4,19:$V5,20:$V6,22:$V1},o($V2,[2,6]),o($V2,[2,7]),o($V2,[2,11]),o($V2,[2,12]),o($V2,[2,13]),{21:[1,24]},o($V2,[2,15]),{11:[1,25]},{16:26,24:[1,27]},{11:[2,19]},o($V2,[2,5]),o($V2,[2,14]),o($V8,[2,9]),{14:28,25:$V7},{25:[2,18]},{11:[1,29]},o($V8,[2,10])],\ndefaultActions: {5:[2,16],7:[2,2],22:[2,19],27:[2,18]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n            function lex() {\n            var token;\n            token = tstack.pop() || lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                if (token instanceof Array) {\n                    tstack = token;\n                    token = tstack.pop();\n                }\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n        if (typeof action === 'undefined' || !action.length || !action[0]) {\n            var errStr = '';\n            expected = [];\n            for (p in table[state]) {\n                if (this.terminals_[p] && p > TERROR) {\n                    expected.push('\\'' + this.terminals_[p] + '\\'');\n                }\n            }\n            if (lexer.showPosition) {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n            } else {\n                errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n            }\n            this.parseError(errStr, {\n                text: lexer.match,\n                token: this.terminals_[symbol] || symbol,\n                line: lexer.yylineno,\n                loc: yyloc,\n                expected: expected\n            });\n        }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n\r\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"case-insensitive\":true},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0: this.begin('open_directive'); return 22; \nbreak;\ncase 1: this.begin('type_directive'); return 23; \nbreak;\ncase 2: this.popState(); this.begin('arg_directive'); return 15; \nbreak;\ncase 3: this.popState(); this.popState(); return 25; \nbreak;\ncase 4:return 24;\nbreak;\ncase 5:/* skip comments */\nbreak;\ncase 6:/* skip comments */\nbreak;\ncase 7:return 11;\nbreak;\ncase 8:/* skip whitespace */\nbreak;\ncase 9:/* skip comments */\nbreak;\ncase 10:return 4;\nbreak;\ncase 11:return 17;\nbreak;\ncase 12:return 18;\nbreak;\ncase 13:return 19;\nbreak;\ncase 14:return 20;\nbreak;\ncase 15:return 21;\nbreak;\ncase 16:return 15;\nbreak;\ncase 17:return 6;\nbreak;\ncase 18:return 'INVALID';\nbreak;\n}\n},\nrules: [/^(?:%%\\{)/i,/^(?:((?:(?!\\}%%)[^:.])*))/i,/^(?::)/i,/^(?:\\}%%)/i,/^(?:((?:(?!\\}%%).|\\n)*))/i,/^(?:%(?!\\{)[^\\n]*)/i,/^(?:[^\\}]%%[^\\n]*)/i,/^(?:[\\n]+)/i,/^(?:\\s+)/i,/^(?:#[^\\n]*)/i,/^(?:journey\\b)/i,/^(?:title\\s[^#\\n;]+)/i,/^(?:accDescription\\s[^#\\n;]+)/i,/^(?:section\\s[^#:\\n;]+)/i,/^(?:[^#:\\n;]+)/i,/^(?::[^#\\n;]+)/i,/^(?::)/i,/^(?:$)/i,/^(?:.)/i],\nconditions: {\"open_directive\":{\"rules\":[1],\"inclusive\":false},\"type_directive\":{\"rules\":[2,3],\"inclusive\":false},\"arg_directive\":{\"rules\":[3,4],\"inclusive\":false},\"INITIAL\":{\"rules\":[0,5,6,7,8,9,10,11,12,13,14,15,16,17,18],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain (args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}","/**\r\n * This method will add a basic title and description element to a chart. The yy parser will need to\r\n * respond to getTitle and getAccDescription, where the title is the title element on the chart,\r\n * which is generally not displayed and the accDescription is the description element on the chart,\r\n * which is never displayed.\r\n *\r\n * The following charts display their title as a visual and accessibility element: gantt\r\n *\r\n * @param yy_parser\r\n * @param svg\r\n * @param id\r\n */\r\nexport default function addSVGAccessibilityFields(yy_parser, svg, id) {\r\n  if (typeof svg.insert === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  let title_string = yy_parser.getTitle();\r\n  let description = yy_parser.getAccDescription();\r\n  svg.attr('role', 'img').attr('aria-labelledby', 'chart-title-' + id + ' chart-desc-' + id);\r\n  svg\r\n    .insert('desc', ':first-child')\r\n    .attr('id', 'chart-desc-' + id)\r\n    .text(description);\r\n  svg\r\n    .insert('title', ':first-child')\r\n    .attr('id', 'chart-title-' + id)\r\n    .text(title_string);\r\n}\r\n","import { assignWithDepth } from './utils';\r\nimport { log } from './logger';\r\nimport theme from './themes';\r\nimport config from './defaultConfig';\r\n\r\n// debugger;\r\n\r\nexport const defaultConfig = Object.freeze(config);\r\n\r\nlet siteConfig = assignWithDepth({}, defaultConfig);\r\nlet configFromInitialize;\r\nlet directives = [];\r\nlet currentConfig = assignWithDepth({}, defaultConfig);\r\n\r\nexport const updateCurrentConfig = (siteCfg, _directives) => {\r\n  // start with config beeing the siteConfig\r\n  let cfg = assignWithDepth({}, siteCfg);\r\n  // let sCfg = assignWithDepth(defaultConfig, siteConfigDelta);\r\n\r\n  // Join directives\r\n  let sumOfDirectives = {};\r\n  for (let i = 0; i < _directives.length; i++) {\r\n    const d = _directives[i];\r\n    sanitize(d);\r\n\r\n    // Apply the data from the directive where the the overrides the themeVaraibles\r\n    sumOfDirectives = assignWithDepth(sumOfDirectives, d);\r\n  }\r\n\r\n  cfg = assignWithDepth(cfg, sumOfDirectives);\r\n\r\n  if (sumOfDirectives.theme) {\r\n    const tmpConfigFromInitialize = assignWithDepth({}, configFromInitialize);\r\n    const themeVariables = assignWithDepth(\r\n      tmpConfigFromInitialize.themeVariables || {},\r\n      sumOfDirectives.themeVariables\r\n    );\r\n    cfg.themeVariables = theme[cfg.theme].getThemeVariables(themeVariables);\r\n  }\r\n\r\n  currentConfig = cfg;\r\n  return cfg;\r\n};\r\n\r\n/**\r\n * ## setSiteConfig\r\n *\r\n * | Function      | Description                           | Type        | Values                                  |\r\n * | ------------- | ------------------------------------- | ----------- | --------------------------------------- |\r\n * | setSiteConfig | Sets the siteConfig to desired values | Put Request | Any Values, except ones in secure array |\r\n *\r\n * **Notes:** Sets the siteConfig. The siteConfig is a protected configuration for repeat use. Calls\r\n * to reset() will reset the currentConfig to siteConfig. Calls to reset(configApi.defaultConfig)\r\n * will reset siteConfig and currentConfig to the defaultConfig Note: currentConfig is set in this\r\n * function _Default value: At default, will mirror Global Config_\r\n *\r\n * @param conf - The base currentConfig to use as siteConfig\r\n * @returns {object} - The siteConfig\r\n */\r\nexport const setSiteConfig = (conf) => {\r\n  siteConfig = assignWithDepth({}, defaultConfig);\r\n  siteConfig = assignWithDepth(siteConfig, conf);\r\n\r\n  if (conf.theme) {\r\n    siteConfig.themeVariables = theme[conf.theme].getThemeVariables(conf.themeVariables);\r\n  }\r\n\r\n  currentConfig = updateCurrentConfig(siteConfig, directives);\r\n  return siteConfig;\r\n};\r\n\r\nexport const saveConfigFromInitilize = (conf) => {\r\n  configFromInitialize = assignWithDepth({}, conf);\r\n};\r\n\r\nexport const updateSiteConfig = (conf) => {\r\n  siteConfig = assignWithDepth(siteConfig, conf);\r\n  updateCurrentConfig(siteConfig, directives);\r\n\r\n  return siteConfig;\r\n};\r\n/**\r\n * ## getSiteConfig\r\n *\r\n * | Function      | Description                                       | Type        | Values                           |\r\n * | ------------- | ------------------------------------------------- | ----------- | -------------------------------- |\r\n * | setSiteConfig | Returns the current siteConfig base configuration | Get Request | Returns Any Values in siteConfig |\r\n *\r\n * **Notes**: Returns **any** values in siteConfig.\r\n *\r\n * @returns {object} - The siteConfig\r\n */\r\nexport const getSiteConfig = () => {\r\n  return assignWithDepth({}, siteConfig);\r\n};\r\n/**\r\n * ## setConfig\r\n *\r\n * | Function      | Description                           | Type        | Values                                  |\r\n * | ------------- | ------------------------------------- | ----------- | --------------------------------------- |\r\n * | setSiteConfig | Sets the siteConfig to desired values | Put Request | Any Values, except ones in secure array |\r\n *\r\n * **Notes**: Sets the currentConfig. The parameter conf is sanitized based on the siteConfig.secure\r\n * keys. Any values found in conf with key found in siteConfig.secure will be replaced with the\r\n * corresponding siteConfig value.\r\n *\r\n * @param {any} conf - The potential currentConfig\r\n * @returns {any} - The currentConfig merged with the sanitized conf\r\n */\r\nexport const setConfig = (conf) => {\r\n  // sanitize(conf);\r\n  // Object.keys(conf).forEach(key => {\r\n  //   const manipulator = manipulators[key];\r\n  //   conf[key] = manipulator ? manipulator(conf[key]) : conf[key];\r\n  // });\r\n\r\n  assignWithDepth(currentConfig, conf);\r\n\r\n  return getConfig();\r\n};\r\n\r\n/**\r\n * ## getConfig\r\n *\r\n * | Function  | Description               | Type        | Return Values                  |\r\n * | --------- | ------------------------- | ----------- | ------------------------------ |\r\n * | getConfig | Obtains the currentConfig | Get Request | Any Values from current Config |\r\n *\r\n * **Notes**: Returns **any** the currentConfig\r\n *\r\n * @returns {any} - The currentConfig\r\n */\r\nexport const getConfig = () => {\r\n  return assignWithDepth({}, currentConfig);\r\n};\r\n/**\r\n * ## sanitize\r\n *\r\n * | Function | Description                            | Type        | Values |\r\n * | -------- | -------------------------------------- | ----------- | ------ |\r\n * | sanitize | Sets the siteConfig to desired values. | Put Request | None   |\r\n *\r\n * Ensures options parameter does not attempt to override siteConfig secure keys **Notes**: modifies\r\n * options in-place\r\n *\r\n * @param {any} options - The potential setConfig parameter\r\n */\r\nexport const sanitize = (options) => {\r\n  // Checking that options are not in the list of excluded options\r\n  Object.keys(siteConfig.secure).forEach((key) => {\r\n    if (typeof options[siteConfig.secure[key]] !== 'undefined') {\r\n      // DO NOT attempt to print options[siteConfig.secure[key]] within `${}` as a malicious script\r\n      // can exploit the logger's attempt to stringify the value and execute arbitrary code\r\n      log.debug(\r\n        `Denied attempt to modify a secure key ${siteConfig.secure[key]}`,\r\n        options[siteConfig.secure[key]]\r\n      );\r\n      delete options[siteConfig.secure[key]];\r\n    }\r\n  });\r\n\r\n  // Check that there no attempts of prototype pollution\r\n  Object.keys(options).forEach((key) => {\r\n    if (key.indexOf('__') === 0) {\r\n      delete options[key];\r\n    }\r\n  });\r\n  // Check that there no attempts of xss, there should be no tags at all in the directive\r\n  // blocking data urls as base64 urls can contain svgs with inline script tags\r\n  Object.keys(options).forEach((key) => {\r\n    if (typeof options[key] === 'string') {\r\n      if (\r\n        options[key].indexOf('<') > -1 ||\r\n        options[key].indexOf('>') > -1 ||\r\n        options[key].indexOf('url(data:') > -1\r\n      ) {\r\n        delete options[key];\r\n      }\r\n    }\r\n    if (typeof options[key] === 'object') {\r\n      sanitize(options[key]);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Pushes in a directive to the configuration\r\n *\r\n * @param {object} directive The directive to push in\r\n */\r\nexport const addDirective = (directive) => {\r\n  if (directive.fontFamily) {\r\n    if (!directive.themeVariables) {\r\n      directive.themeVariables = { fontFamily: directive.fontFamily };\r\n    } else {\r\n      if (!directive.themeVariables.fontFamily) {\r\n        directive.themeVariables = { fontFamily: directive.fontFamily };\r\n      }\r\n    }\r\n  }\r\n  directives.push(directive);\r\n  updateCurrentConfig(siteConfig, directives);\r\n};\r\n\r\n/**\r\n * ## reset\r\n *\r\n * | Function | Description                  | Type        | Required | Values |\r\n * | -------- | ---------------------------- | ----------- | -------- | ------ |\r\n * | reset    | Resets currentConfig to conf | Put Request | Required | None   |\r\n *\r\n * ## conf\r\n *\r\n * | Parameter | Description                                                   | Type       | Required | Values                                       |\r\n * | --------- | ------------------------------------------------------------- | ---------- | -------- | -------------------------------------------- |\r\n * | conf      | base set of values, which currentConfig coul be **reset** to. | Dictionary | Required | Any Values, with respect to the secure Array |\r\n *\r\n * **Notes**: (default: current siteConfig ) (optional, default `getSiteConfig()`)\r\n */\r\nexport const reset = () => {\r\n  // Replace current config with siteConfig\r\n  directives = [];\r\n  updateCurrentConfig(siteConfig, directives);\r\n};\r\n","import intersectRect from './intersect/intersect-rect';\r\nimport { log } from '../logger';\r\nimport createLabel from './createLabel';\r\nimport { select } from 'd3';\r\nimport { getConfig } from '../config';\r\nimport { evaluate } from '../diagrams/common/common';\r\n\r\nconst rect = (parent, node) => {\r\n  log.trace('Creating subgraph rect for ', node.id, node);\r\n\r\n  // Add outer g element\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', 'cluster' + (node.class ? ' ' + node.class : ''))\r\n    .attr('id', node.id);\r\n\r\n  // add the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n\r\n  // Create the label and insert it after the rect\r\n  const label = shapeSvg.insert('g').attr('class', 'cluster-label');\r\n\r\n  const text = label\r\n    .node()\r\n    .appendChild(createLabel(node.labelText, node.labelStyle, undefined, true));\r\n\r\n  // Get the size of the label\r\n  let bbox = text.getBBox();\r\n\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = text.children[0];\r\n    const dv = select(text);\r\n    bbox = div.getBoundingClientRect();\r\n    dv.attr('width', bbox.width);\r\n    dv.attr('height', bbox.height);\r\n  }\r\n\r\n  const padding = 0 * node.padding;\r\n  const halfPadding = padding / 2;\r\n\r\n  const width = node.width <= bbox.width + padding ? bbox.width + padding : node.width;\r\n  if (node.width <= bbox.width + padding) {\r\n    node.diff = (bbox.width - node.width) / 2;\r\n  } else {\r\n    node.diff = -node.padding / 2;\r\n  }\r\n\r\n  log.trace('Data ', node, JSON.stringify(node));\r\n  // center the rect around its coordinate\r\n  rect\r\n    .attr('style', node.style)\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('x', node.x - width / 2)\r\n    .attr('y', node.y - node.height / 2 - halfPadding)\r\n    .attr('width', width)\r\n    .attr('height', node.height + padding);\r\n\r\n  // Center the label\r\n  label.attr(\r\n    'transform',\r\n    'translate(' +\r\n      (node.x - bbox.width / 2) +\r\n      ', ' +\r\n      (node.y - node.height / 2 + node.padding / 3) +\r\n      ')'\r\n  );\r\n\r\n  const rectBox = rect.node().getBBox();\r\n  node.width = rectBox.width;\r\n  node.height = rectBox.height;\r\n\r\n  node.intersect = function (point) {\r\n    return intersectRect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\n/**\r\n * Non visiable cluster where the note is group with its\r\n *\r\n * @param {any} parent\r\n * @param {any} node\r\n * @returns {any} ShapeSvg\r\n */\r\nconst noteGroup = (parent, node) => {\r\n  // Add outer g element\r\n  const shapeSvg = parent.insert('g').attr('class', 'note-cluster').attr('id', node.id);\r\n\r\n  // add the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n\r\n  const padding = 0 * node.padding;\r\n  const halfPadding = padding / 2;\r\n\r\n  // center the rect around its coordinate\r\n  rect\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('x', node.x - node.width / 2 - halfPadding)\r\n    .attr('y', node.y - node.height / 2 - halfPadding)\r\n    .attr('width', node.width + padding)\r\n    .attr('height', node.height + padding)\r\n    .attr('fill', 'none');\r\n\r\n  const rectBox = rect.node().getBBox();\r\n  node.width = rectBox.width;\r\n  node.height = rectBox.height;\r\n\r\n  node.intersect = function (point) {\r\n    return intersectRect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\nconst roundedWithTitle = (parent, node) => {\r\n  // Add outer g element\r\n  const shapeSvg = parent.insert('g').attr('class', node.classes).attr('id', node.id);\r\n\r\n  // add the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n\r\n  // Create the label and insert it after the rect\r\n  const label = shapeSvg.insert('g').attr('class', 'cluster-label');\r\n  const innerRect = shapeSvg.append('rect');\r\n\r\n  const text = label\r\n    .node()\r\n    .appendChild(createLabel(node.labelText, node.labelStyle, undefined, true));\r\n\r\n  // Get the size of the label\r\n  let bbox = text.getBBox();\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = text.children[0];\r\n    const dv = select(text);\r\n    bbox = div.getBoundingClientRect();\r\n    dv.attr('width', bbox.width);\r\n    dv.attr('height', bbox.height);\r\n  }\r\n  bbox = text.getBBox();\r\n  const padding = 0 * node.padding;\r\n  const halfPadding = padding / 2;\r\n\r\n  const width = node.width <= bbox.width + node.padding ? bbox.width + node.padding : node.width;\r\n  if (node.width <= bbox.width + node.padding) {\r\n    node.diff = (bbox.width + node.padding * 0 - node.width) / 2;\r\n  } else {\r\n    node.diff = -node.padding / 2;\r\n  }\r\n\r\n  // center the rect around its coordinate\r\n  rect\r\n    .attr('class', 'outer')\r\n    .attr('x', node.x - width / 2 - halfPadding)\r\n    .attr('y', node.y - node.height / 2 - halfPadding)\r\n    .attr('width', width + padding)\r\n    .attr('height', node.height + padding);\r\n  innerRect\r\n    .attr('class', 'inner')\r\n    .attr('x', node.x - width / 2 - halfPadding)\r\n    .attr('y', node.y - node.height / 2 - halfPadding + bbox.height - 1)\r\n    .attr('width', width + padding)\r\n    .attr('height', node.height + padding - bbox.height - 3);\r\n\r\n  // Center the label\r\n  label.attr(\r\n    'transform',\r\n    'translate(' +\r\n      (node.x - bbox.width / 2) +\r\n      ', ' +\r\n      (node.y -\r\n        node.height / 2 -\r\n        node.padding / 3 +\r\n        (evaluate(getConfig().flowchart.htmlLabels) ? 5 : 3)) +\r\n      ')'\r\n  );\r\n\r\n  const rectBox = rect.node().getBBox();\r\n  node.height = rectBox.height;\r\n\r\n  node.intersect = function (point) {\r\n    return intersectRect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst divider = (parent, node) => {\r\n  // Add outer g element\r\n  const shapeSvg = parent.insert('g').attr('class', node.classes).attr('id', node.id);\r\n\r\n  // add the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n\r\n  const padding = 0 * node.padding;\r\n  const halfPadding = padding / 2;\r\n\r\n  // center the rect around its coordinate\r\n  rect\r\n    .attr('class', 'divider')\r\n    .attr('x', node.x - node.width / 2 - halfPadding)\r\n    .attr('y', node.y - node.height / 2)\r\n    .attr('width', node.width + padding)\r\n    .attr('height', node.height + padding);\r\n\r\n  const rectBox = rect.node().getBBox();\r\n  node.width = rectBox.width;\r\n  node.height = rectBox.height;\r\n  node.diff = -node.padding / 2;\r\n  node.intersect = function (point) {\r\n    return intersectRect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst shapes = { rect, roundedWithTitle, noteGroup, divider };\r\n\r\nlet clusterElems = {};\r\n\r\nexport const insertCluster = (elem, node) => {\r\n  log.trace('Inserting cluster');\r\n  const shape = node.shape || 'rect';\r\n  clusterElems[node.id] = shapes[shape](elem, node);\r\n};\r\nexport const getClusterTitleWidth = (elem, node) => {\r\n  const label = createLabel(node.labelText, node.labelStyle, undefined, true);\r\n  elem.node().appendChild(label);\r\n  const width = label.getBBox().width;\r\n  elem.node().removeChild(label);\r\n  return width;\r\n};\r\n\r\nexport const clear = () => {\r\n  clusterElems = {};\r\n};\r\n\r\nexport const positionCluster = (node) => {\r\n  log.info('Position cluster (' + node.id + ', ' + node.x + ', ' + node.y + ')');\r\n  const el = clusterElems[node.id];\r\n\r\n  el.attr('transform', 'translate(' + node.x + ', ' + node.y + ')');\r\n};\r\n","import { select } from 'd3';\r\nimport { log } from '../logger'; // eslint-disable-line\r\nimport { getConfig } from '../config';\r\nimport { sanitizeText, evaluate } from '../diagrams/common/common';\r\n\r\nconst sanitizeTxt = (txt) => sanitizeText(txt, getConfig());\r\n\r\n/**\r\n * @param dom\r\n * @param styleFn\r\n */\r\nfunction applyStyle(dom, styleFn) {\r\n  if (styleFn) {\r\n    dom.attr('style', styleFn);\r\n  }\r\n}\r\n\r\n/**\r\n * @param {any} node\r\n * @returns {SVGForeignObjectElement} Node\r\n */\r\nfunction addHtmlLabel(node) {\r\n  const fo = select(document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject'));\r\n  const div = fo.append('xhtml:div');\r\n\r\n  const label = node.label;\r\n  const labelClass = node.isNode ? 'nodeLabel' : 'edgeLabel';\r\n  div.html(\r\n    '<span class=\"' +\r\n      labelClass +\r\n      '\" ' +\r\n      (node.labelStyle ? 'style=\"' + node.labelStyle + '\"' : '') +\r\n      '>' +\r\n      label +\r\n      '</span>'\r\n  );\r\n\r\n  applyStyle(div, node.labelStyle);\r\n  div.style('display', 'inline-block');\r\n  // Fix for firefox\r\n  div.style('white-space', 'nowrap');\r\n  div.attr('xmlns', 'http://www.w3.org/1999/xhtml');\r\n  return fo.node();\r\n}\r\n\r\nconst createLabel = (_vertexText, style, isTitle, isNode) => {\r\n  let vertexText = _vertexText || '';\r\n  if (typeof vertexText === 'object') vertexText = vertexText[0];\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    // TODO: addHtmlLabel accepts a labelStyle. Do we possibly have that?\r\n    vertexText = vertexText.replace(/\\\\n|\\n/g, '<br />');\r\n    log.info('vertexText' + vertexText);\r\n    const node = {\r\n      isNode,\r\n      label: vertexText.replace(\r\n        /fa[lrsb]?:fa-[\\w-]+/g,\r\n        (s) => `<i class='${s.replace(':', ' ')}'></i>`\r\n      ),\r\n      labelStyle: style.replace('fill:', 'color:'),\r\n    };\r\n    let vertexNode = addHtmlLabel(node);\r\n    // vertexNode.parentNode.removeChild(vertexNode);\r\n    return vertexNode;\r\n  } else {\r\n    const svgLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n    svgLabel.setAttribute('style', style.replace('color:', 'fill:'));\r\n    let rows = [];\r\n    if (typeof vertexText === 'string') {\r\n      rows = vertexText.split(/\\\\n|\\n|<br\\s*\\/?>/gi);\r\n    } else if (Array.isArray(vertexText)) {\r\n      rows = vertexText;\r\n    } else {\r\n      rows = [];\r\n    }\r\n\r\n    for (let j = 0; j < rows.length; j++) {\r\n      const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\r\n      tspan.setAttributeNS('http://www.w3.org/XML/1998/namespace', 'xml:space', 'preserve');\r\n      tspan.setAttribute('dy', '1em');\r\n      tspan.setAttribute('x', '0');\r\n      if (isTitle) {\r\n        tspan.setAttribute('class', 'title-row');\r\n      } else {\r\n        tspan.setAttribute('class', 'row');\r\n      }\r\n      tspan.textContent = rows[j].trim();\r\n      svgLabel.appendChild(tspan);\r\n    }\r\n    return svgLabel;\r\n  }\r\n};\r\n\r\nexport default createLabel;\r\n","import { log } from '../logger'; // eslint-disable-line\r\nimport createLabel from './createLabel';\r\nimport { line, curveBasis, select } from 'd3';\r\nimport { getConfig } from '../config';\r\nimport utils from '../utils';\r\nimport { evaluate } from '../diagrams/common/common';\r\n\r\nlet edgeLabels = {};\r\nlet terminalLabels = {};\r\n\r\nexport const clear = () => {\r\n  edgeLabels = {};\r\n  terminalLabels = {};\r\n};\r\n\r\nexport const insertEdgeLabel = (elem, edge) => {\r\n  // Create the actual text element\r\n  const labelElement = createLabel(edge.label, edge.labelStyle);\r\n\r\n  // Create outer g, edgeLabel, this will be positioned after graph layout\r\n  const edgeLabel = elem.insert('g').attr('class', 'edgeLabel');\r\n\r\n  // Create inner g, label, this will be positioned now for centering the text\r\n  const label = edgeLabel.insert('g').attr('class', 'label');\r\n  label.node().appendChild(labelElement);\r\n\r\n  // Center the label\r\n  let bbox = labelElement.getBBox();\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = labelElement.children[0];\r\n    const dv = select(labelElement);\r\n    bbox = div.getBoundingClientRect();\r\n    dv.attr('width', bbox.width);\r\n    dv.attr('height', bbox.height);\r\n  }\r\n  label.attr('transform', 'translate(' + -bbox.width / 2 + ', ' + -bbox.height / 2 + ')');\r\n\r\n  // Make element accessible by id for positioning\r\n  edgeLabels[edge.id] = edgeLabel;\r\n\r\n  // Update the abstract data of the edge with the new information about its width and height\r\n  edge.width = bbox.width;\r\n  edge.height = bbox.height;\r\n\r\n  let fo;\r\n  if (edge.startLabelLeft) {\r\n    // Create the actual text element\r\n    const startLabelElement = createLabel(edge.startLabelLeft, edge.labelStyle);\r\n    const startEdgeLabelLeft = elem.insert('g').attr('class', 'edgeTerminals');\r\n    const inner = startEdgeLabelLeft.insert('g').attr('class', 'inner');\r\n    fo = inner.node().appendChild(startLabelElement);\r\n    const slBox = startLabelElement.getBBox();\r\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\r\n    if (!terminalLabels[edge.id]) {\r\n      terminalLabels[edge.id] = {};\r\n    }\r\n    terminalLabels[edge.id].startLeft = startEdgeLabelLeft;\r\n    setTerminalWidth(fo, edge.startLabelLeft);\r\n  }\r\n  if (edge.startLabelRight) {\r\n    // Create the actual text element\r\n    const startLabelElement = createLabel(edge.startLabelRight, edge.labelStyle);\r\n    const startEdgeLabelRight = elem.insert('g').attr('class', 'edgeTerminals');\r\n    const inner = startEdgeLabelRight.insert('g').attr('class', 'inner');\r\n    fo = startEdgeLabelRight.node().appendChild(startLabelElement);\r\n    inner.node().appendChild(startLabelElement);\r\n    const slBox = startLabelElement.getBBox();\r\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\r\n\r\n    if (!terminalLabels[edge.id]) {\r\n      terminalLabels[edge.id] = {};\r\n    }\r\n    terminalLabels[edge.id].startRight = startEdgeLabelRight;\r\n    setTerminalWidth(fo, edge.startLabelRight);\r\n  }\r\n  if (edge.endLabelLeft) {\r\n    // Create the actual text element\r\n    const endLabelElement = createLabel(edge.endLabelLeft, edge.labelStyle);\r\n    const endEdgeLabelLeft = elem.insert('g').attr('class', 'edgeTerminals');\r\n    const inner = endEdgeLabelLeft.insert('g').attr('class', 'inner');\r\n    fo = inner.node().appendChild(endLabelElement);\r\n    const slBox = endLabelElement.getBBox();\r\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\r\n\r\n    endEdgeLabelLeft.node().appendChild(endLabelElement);\r\n\r\n    if (!terminalLabels[edge.id]) {\r\n      terminalLabels[edge.id] = {};\r\n    }\r\n    terminalLabels[edge.id].endLeft = endEdgeLabelLeft;\r\n    setTerminalWidth(fo, edge.endLabelLeft);\r\n  }\r\n  if (edge.endLabelRight) {\r\n    // Create the actual text element\r\n    const endLabelElement = createLabel(edge.endLabelRight, edge.labelStyle);\r\n    const endEdgeLabelRight = elem.insert('g').attr('class', 'edgeTerminals');\r\n    const inner = endEdgeLabelRight.insert('g').attr('class', 'inner');\r\n\r\n    fo = inner.node().appendChild(endLabelElement);\r\n    const slBox = endLabelElement.getBBox();\r\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\r\n\r\n    endEdgeLabelRight.node().appendChild(endLabelElement);\r\n    if (!terminalLabels[edge.id]) {\r\n      terminalLabels[edge.id] = {};\r\n    }\r\n    terminalLabels[edge.id].endRight = endEdgeLabelRight;\r\n    setTerminalWidth(fo, edge.endLabelRight);\r\n  }\r\n};\r\n\r\n/**\r\n * @param {any} fo\r\n * @param {any} value\r\n */\r\nfunction setTerminalWidth(fo, value) {\r\n  if (getConfig().flowchart.htmlLabels && fo) {\r\n    fo.style.width = value.length * 9 + 'px';\r\n    fo.style.height = '12px';\r\n  }\r\n}\r\n\r\nexport const positionEdgeLabel = (edge, paths) => {\r\n  log.info('Moving label abc78 ', edge.id, edge.label, edgeLabels[edge.id]);\r\n  let path = paths.updatedPath ? paths.updatedPath : paths.originalPath;\r\n  if (edge.label) {\r\n    const el = edgeLabels[edge.id];\r\n    let x = edge.x;\r\n    let y = edge.y;\r\n    if (path) {\r\n      //   // debugger;\r\n      const pos = utils.calcLabelPosition(path);\r\n      log.info('Moving label from (', x, ',', y, ') to (', pos.x, ',', pos.y, ') abc78');\r\n      // x = pos.x;\r\n      // y = pos.y;\r\n    }\r\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\r\n  }\r\n\r\n  //let path = paths.updatedPath ? paths.updatedPath : paths.originalPath;\r\n  if (edge.startLabelLeft) {\r\n    const el = terminalLabels[edge.id].startLeft;\r\n    let x = edge.x;\r\n    let y = edge.y;\r\n    if (path) {\r\n      // debugger;\r\n      const pos = utils.calcTerminalLabelPosition(edge.arrowTypeStart ? 10 : 0, 'start_left', path);\r\n      x = pos.x;\r\n      y = pos.y;\r\n    }\r\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\r\n  }\r\n  if (edge.startLabelRight) {\r\n    const el = terminalLabels[edge.id].startRight;\r\n    let x = edge.x;\r\n    let y = edge.y;\r\n    if (path) {\r\n      // debugger;\r\n      const pos = utils.calcTerminalLabelPosition(\r\n        edge.arrowTypeStart ? 10 : 0,\r\n        'start_right',\r\n        path\r\n      );\r\n      x = pos.x;\r\n      y = pos.y;\r\n    }\r\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\r\n  }\r\n  if (edge.endLabelLeft) {\r\n    const el = terminalLabels[edge.id].endLeft;\r\n    let x = edge.x;\r\n    let y = edge.y;\r\n    if (path) {\r\n      // debugger;\r\n      const pos = utils.calcTerminalLabelPosition(edge.arrowTypeEnd ? 10 : 0, 'end_left', path);\r\n      x = pos.x;\r\n      y = pos.y;\r\n    }\r\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\r\n  }\r\n  if (edge.endLabelRight) {\r\n    const el = terminalLabels[edge.id].endRight;\r\n    let x = edge.x;\r\n    let y = edge.y;\r\n    if (path) {\r\n      // debugger;\r\n      const pos = utils.calcTerminalLabelPosition(edge.arrowTypeEnd ? 10 : 0, 'end_right', path);\r\n      x = pos.x;\r\n      y = pos.y;\r\n    }\r\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\r\n  }\r\n};\r\n\r\n// const getRelationType = function(type) {\r\n//   switch (type) {\r\n//     case stateDb.relationType.AGGREGATION:\r\n//       return 'aggregation';\r\n//     case stateDb.relationType.EXTENSION:\r\n//       return 'extension';\r\n//     case stateDb.relationType.COMPOSITION:\r\n//       return 'composition';\r\n//     case stateDb.relationType.DEPENDENCY:\r\n//       return 'dependency';\r\n//   }\r\n// };\r\n\r\nconst outsideNode = (node, point) => {\r\n  // log.warn('Checking bounds ', node, point);\r\n  const x = node.x;\r\n  const y = node.y;\r\n  const dx = Math.abs(point.x - x);\r\n  const dy = Math.abs(point.y - y);\r\n  const w = node.width / 2;\r\n  const h = node.height / 2;\r\n  if (dx >= w || dy >= h) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const intersection = (node, outsidePoint, insidePoint) => {\r\n  log.warn(`intersection calc abc89:\r\n  outsidePoint: ${JSON.stringify(outsidePoint)}\r\n  insidePoint : ${JSON.stringify(insidePoint)}\r\n  node        : x:${node.x} y:${node.y} w:${node.width} h:${node.height}`);\r\n  const x = node.x;\r\n  const y = node.y;\r\n\r\n  const dx = Math.abs(x - insidePoint.x);\r\n  // const dy = Math.abs(y - insidePoint.y);\r\n  const w = node.width / 2;\r\n  let r = insidePoint.x < outsidePoint.x ? w - dx : w + dx;\r\n  const h = node.height / 2;\r\n\r\n  // const edges = {\r\n  //   x1: x - w,\r\n  //   x2: x + w,\r\n  //   y1: y - h,\r\n  //   y2: y + h\r\n  // };\r\n\r\n  // if (\r\n  //   outsidePoint.x === edges.x1 ||\r\n  //   outsidePoint.x === edges.x2 ||\r\n  //   outsidePoint.y === edges.y1 ||\r\n  //   outsidePoint.y === edges.y2\r\n  // ) {\r\n  //   log.warn('abc89 calc equals on edge', outsidePoint, edges);\r\n  //   return outsidePoint;\r\n  // }\r\n\r\n  const Q = Math.abs(outsidePoint.y - insidePoint.y);\r\n  const R = Math.abs(outsidePoint.x - insidePoint.x);\r\n  // log.warn();\r\n  if (Math.abs(y - outsidePoint.y) * w > Math.abs(x - outsidePoint.x) * h) { // eslint-disable-line\r\n    // Intersection is top or bottom of rect.\r\n    // let q = insidePoint.y < outsidePoint.y ? outsidePoint.y - h - y : y - h - outsidePoint.y;\r\n    let q = insidePoint.y < outsidePoint.y ? outsidePoint.y - h - y : y - h - outsidePoint.y;\r\n    r = (R * q) / Q;\r\n    const res = {\r\n      x: insidePoint.x < outsidePoint.x ? insidePoint.x + r : insidePoint.x - R + r,\r\n      y: insidePoint.y < outsidePoint.y ? insidePoint.y + Q - q : insidePoint.y - Q + q,\r\n    };\r\n\r\n    if (r === 0) {\r\n      res.x = outsidePoint.x;\r\n      res.y = outsidePoint.y;\r\n    }\r\n    if (R === 0) {\r\n      res.x = outsidePoint.x;\r\n    }\r\n    if (Q === 0) {\r\n      res.y = outsidePoint.y;\r\n    }\r\n\r\n    log.warn(`abc89 topp/bott calc, Q ${Q}, q ${q}, R ${R}, r ${r}`, res);\r\n\r\n    return res;\r\n  } else {\r\n    // Intersection onn sides of rect\r\n    if (insidePoint.x < outsidePoint.x) {\r\n      r = outsidePoint.x - w - x;\r\n    } else {\r\n      // r = outsidePoint.x - w - x;\r\n      r = x - w - outsidePoint.x;\r\n    }\r\n    let q = (Q * r) / R;\r\n    //  OK let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : insidePoint.x + dx - w;\r\n    // OK let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : outsidePoint.x + r;\r\n    let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : insidePoint.x - R + r;\r\n    // let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : outsidePoint.x + r;\r\n    let _y = insidePoint.y < outsidePoint.y ? insidePoint.y + q : insidePoint.y - q;\r\n    log.warn(`sides calc abc89, Q ${Q}, q ${q}, R ${R}, r ${r}`, { _x, _y });\r\n    if (r === 0) {\r\n      _x = outsidePoint.x;\r\n      _y = outsidePoint.y;\r\n    }\r\n    if (R === 0) {\r\n      _x = outsidePoint.x;\r\n    }\r\n    if (Q === 0) {\r\n      _y = outsidePoint.y;\r\n    }\r\n\r\n    return { x: _x, y: _y };\r\n  }\r\n};\r\n/**\r\n * This function will page a path and node where the last point(s) in the path is inside the node\r\n * and return an update path ending by the border of the node.\r\n *\r\n * @param {Array} _points\r\n * @param {any} boundryNode\r\n * @returns {Array} Points\r\n */\r\nconst cutPathAtIntersect = (_points, boundryNode) => {\r\n  log.warn('abc88 cutPathAtIntersect', _points, boundryNode);\r\n  let points = [];\r\n  let lastPointOutside = _points[0];\r\n  let isInside = false;\r\n  _points.forEach((point) => {\r\n    // const node = clusterDb[edge.toCluster].node;\r\n    log.info('abc88 checking point', point, boundryNode);\r\n\r\n    // check if point is inside the boundry rect\r\n    if (!outsideNode(boundryNode, point) && !isInside) {\r\n      // First point inside the rect found\r\n      // Calc the intersection coord between the point anf the last opint ouside the rect\r\n      const inter = intersection(boundryNode, lastPointOutside, point);\r\n      log.warn('abc88 inside', point, lastPointOutside, inter);\r\n      log.warn('abc88 intersection', inter);\r\n\r\n      // // Check case where the intersection is the same as the last point\r\n      let pointPresent = false;\r\n      points.forEach((p) => {\r\n        pointPresent = pointPresent || (p.x === inter.x && p.y === inter.y);\r\n      });\r\n      // // if (!pointPresent) {\r\n      if (!points.find((e) => e.x === inter.x && e.y === inter.y)) {\r\n        points.push(inter);\r\n      } else {\r\n        log.warn('abc88 no intersect', inter, points);\r\n      }\r\n      // points.push(inter);\r\n      isInside = true;\r\n    } else {\r\n      // Outside\r\n      log.warn('abc88 outside', point, lastPointOutside);\r\n      lastPointOutside = point;\r\n      // points.push(point);\r\n      if (!isInside) points.push(point);\r\n    }\r\n  });\r\n  log.warn('abc88 returning points', points);\r\n  return points;\r\n};\r\n\r\n//(edgePaths, e, edge, clusterDb, diagramtype, graph)\r\nexport const insertEdge = function (elem, e, edge, clusterDb, diagramType, graph) {\r\n  let points = edge.points;\r\n  let pointsHasChanged = false;\r\n  const tail = graph.node(e.v);\r\n  var head = graph.node(e.w);\r\n\r\n  log.info('abc88 InsertEdge: ', edge);\r\n  if (head.intersect && tail.intersect) {\r\n    points = points.slice(1, edge.points.length - 1);\r\n    points.unshift(tail.intersect(points[0]));\r\n    log.info(\r\n      'Last point',\r\n      points[points.length - 1],\r\n      head,\r\n      head.intersect(points[points.length - 1])\r\n    );\r\n    points.push(head.intersect(points[points.length - 1]));\r\n  }\r\n  if (edge.toCluster) {\r\n    log.info('to cluster abc88', clusterDb[edge.toCluster]);\r\n    points = cutPathAtIntersect(edge.points, clusterDb[edge.toCluster].node);\r\n    // log.trace('edge', edge);\r\n    // points = [];\r\n    // let lastPointOutside; // = edge.points[0];\r\n    // let isInside = false;\r\n    // edge.points.forEach(point => {\r\n    //   const node = clusterDb[edge.toCluster].node;\r\n    //   log.warn('checking from', edge.fromCluster, point, node);\r\n\r\n    //   if (!outsideNode(node, point) && !isInside) {\r\n    //     log.trace('inside', edge.toCluster, point, lastPointOutside);\r\n\r\n    //     // First point inside the rect\r\n    //     const inter = intersection(node, lastPointOutside, point);\r\n\r\n    //     let pointPresent = false;\r\n    //     points.forEach(p => {\r\n    //       pointPresent = pointPresent || (p.x === inter.x && p.y === inter.y);\r\n    //     });\r\n    //     // if (!pointPresent) {\r\n    //     if (!points.find(e => e.x === inter.x && e.y === inter.y)) {\r\n    //       points.push(inter);\r\n    //     } else {\r\n    //       log.warn('no intersect', inter, points);\r\n    //     }\r\n    //     isInside = true;\r\n    // } else {\r\n    //   // outtside\r\n    //   lastPointOutside = point;\r\n    //   if (!isInside) points.push(point);\r\n    // }\r\n    // });\r\n    pointsHasChanged = true;\r\n  }\r\n\r\n  if (edge.fromCluster) {\r\n    log.info('from cluster abc88', clusterDb[edge.fromCluster]);\r\n    points = cutPathAtIntersect(points.reverse(), clusterDb[edge.fromCluster].node).reverse();\r\n    // log.warn('edge', edge);\r\n    // log.warn('from cluster', clusterDb[edge.fromCluster], points);\r\n    // const updatedPoints = [];\r\n    // let lastPointOutside = edge.points[edge.points.length - 1];\r\n    // let isInside = false;\r\n    // for (let i = points.length - 1; i >= 0; i--) {\r\n    //   const point = points[i];\r\n    //   const node = clusterDb[edge.fromCluster].node;\r\n    //   log.warn('checking to', edge.fromCluster, point, node);\r\n\r\n    //   if (!outsideNode(node, point) && !isInside) {\r\n    //     log.warn('inside', edge.fromCluster, point, node);\r\n\r\n    //     // First point inside the rect\r\n    //     const inter = intersection(node, lastPointOutside, point);\r\n    //     log.warn('intersect', intersection(node, lastPointOutside, point));\r\n    //     let pointPresent = false;\r\n    //     points.forEach(p => {\r\n    //       pointPresent = pointPresent || (p.x === inter.x && p.y === inter.y);\r\n    //     });\r\n    //     // if (!pointPresent) {\r\n    //     if (!points.find(e => e.x === inter.x && e.y === inter.y)) {\r\n    //       updatedPoints.unshift(inter);\r\n    //       log.warn('Adding point -updated = ', updatedPoints);\r\n    //     } else {\r\n    //       log.warn('no intersect', inter, points);\r\n    //     }\r\n    //     // points.push(insterection);\r\n    //     isInside = true;\r\n    //   } else {\r\n    //     // at the outside\r\n    //     // if (!isInside) updatedPoints.unshift(point);\r\n    //     updatedPoints.unshift(point);\r\n    //     log.warn('Outside point', point, updatedPoints);\r\n    //   }\r\n    //   lastPointOutside = point;\r\n    // }\r\n    // points = updatedPoints;\r\n    // points = edge.points;\r\n    pointsHasChanged = true;\r\n  }\r\n\r\n  // The data for our line\r\n  const lineData = points.filter((p) => !Number.isNaN(p.y));\r\n\r\n  // This is the accessor function we talked about above\r\n  let curve;\r\n  // Currently only flowcharts get the curve from the settings, perhaps this should\r\n  // be expanded to a common setting? Restricting it for now in order not to cause side-effects that\r\n  // have not been thought through\r\n  if (diagramType === 'graph' || diagramType === 'flowchart') {\r\n    curve = edge.curve || curveBasis;\r\n  } else {\r\n    curve = curveBasis;\r\n  }\r\n  // curve = curveLinear;\r\n  const lineFunction = line()\r\n    .x(function (d) {\r\n      return d.x;\r\n    })\r\n    .y(function (d) {\r\n      return d.y;\r\n    })\r\n    .curve(curve);\r\n\r\n  // Contruct stroke classes based on properties\r\n  let strokeClasses;\r\n  switch (edge.thickness) {\r\n    case 'normal':\r\n      strokeClasses = 'edge-thickness-normal';\r\n      break;\r\n    case 'thick':\r\n      strokeClasses = 'edge-thickness-thick';\r\n      break;\r\n    default:\r\n      strokeClasses = '';\r\n  }\r\n  switch (edge.pattern) {\r\n    case 'solid':\r\n      strokeClasses += ' edge-pattern-solid';\r\n      break;\r\n    case 'dotted':\r\n      strokeClasses += ' edge-pattern-dotted';\r\n      break;\r\n    case 'dashed':\r\n      strokeClasses += ' edge-pattern-dashed';\r\n      break;\r\n  }\r\n\r\n  const svgPath = elem\r\n    .append('path')\r\n    .attr('d', lineFunction(lineData))\r\n    .attr('id', edge.id)\r\n    .attr('class', ' ' + strokeClasses + (edge.classes ? ' ' + edge.classes : ''))\r\n    .attr('style', edge.style);\r\n\r\n  // DEBUG code, adds a red circle at each edge coordinate\r\n  // edge.points.forEach(point => {\r\n  //   elem\r\n  //     .append('circle')\r\n  //     .style('stroke', 'red')\r\n  //     .style('fill', 'red')\r\n  //     .attr('r', 1)\r\n  //     .attr('cx', point.x)\r\n  //     .attr('cy', point.y);\r\n  // });\r\n\r\n  let url = '';\r\n  if (getConfig().state.arrowMarkerAbsolute) {\r\n    url =\r\n      window.location.protocol +\r\n      '//' +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      window.location.search;\r\n    url = url.replace(/\\(/g, '\\\\(');\r\n    url = url.replace(/\\)/g, '\\\\)');\r\n  }\r\n  log.info('arrowTypeStart', edge.arrowTypeStart);\r\n  log.info('arrowTypeEnd', edge.arrowTypeEnd);\r\n\r\n  switch (edge.arrowTypeStart) {\r\n    case 'arrow_cross':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-crossStart' + ')');\r\n      break;\r\n    case 'arrow_point':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-pointStart' + ')');\r\n      break;\r\n    case 'arrow_barb':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-barbStart' + ')');\r\n      break;\r\n    case 'arrow_circle':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-circleStart' + ')');\r\n      break;\r\n    case 'aggregation':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-aggregationStart' + ')');\r\n      break;\r\n    case 'extension':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-extensionStart' + ')');\r\n      break;\r\n    case 'composition':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-compositionStart' + ')');\r\n      break;\r\n    case 'dependency':\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-dependencyStart' + ')');\r\n      break;\r\n    default:\r\n  }\r\n  switch (edge.arrowTypeEnd) {\r\n    case 'arrow_cross':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-crossEnd' + ')');\r\n      break;\r\n    case 'arrow_point':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-pointEnd' + ')');\r\n      break;\r\n    case 'arrow_barb':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-barbEnd' + ')');\r\n      break;\r\n    case 'arrow_circle':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-circleEnd' + ')');\r\n      break;\r\n    case 'aggregation':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-aggregationEnd' + ')');\r\n      break;\r\n    case 'extension':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-extensionEnd' + ')');\r\n      break;\r\n    case 'composition':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-compositionEnd' + ')');\r\n      break;\r\n    case 'dependency':\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-dependencyEnd' + ')');\r\n      break;\r\n    default:\r\n  }\r\n  let paths = {};\r\n  if (pointsHasChanged) {\r\n    paths.updatedPath = points;\r\n  }\r\n  paths.originalPath = edge.points;\r\n  return paths;\r\n};\r\n","import dagre from 'dagre';\r\nimport graphlib from 'graphlib';\r\nimport insertMarkers from './markers';\r\nimport { updateNodeBounds } from './shapes/util';\r\nimport {\r\n  clear as clearGraphlib,\r\n  clusterDb,\r\n  adjustClustersAndEdges,\r\n  findNonClusterChild,\r\n  sortNodesByHierarchy,\r\n} from './mermaid-graphlib';\r\nimport { insertNode, positionNode, clear as clearNodes, setNodeElem } from './nodes';\r\nimport { insertCluster, clear as clearClusters } from './clusters';\r\nimport { insertEdgeLabel, positionEdgeLabel, insertEdge, clear as clearEdges } from './edges';\r\nimport { log } from '../logger';\r\n\r\nconst recursiveRender = (_elem, graph, diagramtype, parentCluster) => {\r\n  log.info('Graph in recursive render: XXX', graphlib.json.write(graph), parentCluster);\r\n  const dir = graph.graph().rankdir;\r\n  log.trace('Dir in recursive render - dir:', dir);\r\n\r\n  const elem = _elem.insert('g').attr('class', 'root'); // eslint-disable-line\r\n  if (!graph.nodes()) {\r\n    log.info('No nodes found for', graph);\r\n  } else {\r\n    log.info('Recursive render XXX', graph.nodes());\r\n  }\r\n  if (graph.edges().length > 0) {\r\n    log.trace('Recursive edges', graph.edge(graph.edges()[0]));\r\n  }\r\n  const clusters = elem.insert('g').attr('class', 'clusters'); // eslint-disable-line\r\n  const edgePaths = elem.insert('g').attr('class', 'edgePaths');\r\n  const edgeLabels = elem.insert('g').attr('class', 'edgeLabels');\r\n  const nodes = elem.insert('g').attr('class', 'nodes');\r\n\r\n  // Insert nodes, this will insert them into the dom and each node will get a size. The size is updated\r\n  // to the abstract node and is later used by dagre for the layout\r\n  graph.nodes().forEach(function (v) {\r\n    const node = graph.node(v);\r\n    if (typeof parentCluster !== 'undefined') {\r\n      const data = JSON.parse(JSON.stringify(parentCluster.clusterData));\r\n      // data.clusterPositioning = true;\r\n      log.info('Setting data for cluster XXX (', v, ') ', data, parentCluster);\r\n      graph.setNode(parentCluster.id, data);\r\n      if (!graph.parent(v)) {\r\n        log.trace('Setting parent', v, parentCluster.id);\r\n        graph.setParent(v, parentCluster.id, data);\r\n      }\r\n    }\r\n    log.info('(Insert) Node XXX' + v + ': ' + JSON.stringify(graph.node(v)));\r\n    if (node && node.clusterNode) {\r\n      // const children = graph.children(v);\r\n      log.info('Cluster identified', v, node.width, graph.node(v));\r\n      const o = recursiveRender(nodes, node.graph, diagramtype, graph.node(v));\r\n      const newEl = o.elem;\r\n      updateNodeBounds(node, newEl);\r\n      node.diff = o.diff || 0;\r\n      log.info('Node bounds (abc123)', v, node, node.width, node.x, node.y);\r\n      setNodeElem(newEl, node);\r\n\r\n      log.warn('Recursive render complete ', newEl, node);\r\n    } else {\r\n      if (graph.children(v).length > 0) {\r\n        // This is a cluster but not to be rendered recusively\r\n        // Render as before\r\n        log.info('Cluster - the non recursive path XXX', v, node.id, node, graph);\r\n        log.info(findNonClusterChild(node.id, graph));\r\n        clusterDb[node.id] = { id: findNonClusterChild(node.id, graph), node };\r\n        // insertCluster(clusters, graph.node(v));\r\n      } else {\r\n        log.info('Node - the non recursive path', v, node.id, node);\r\n        insertNode(nodes, graph.node(v), dir);\r\n      }\r\n    }\r\n  });\r\n\r\n  // Insert labels, this will insert them into the dom so that the width can be calculated\r\n  // Also figure out which edges point to/from clusters and adjust them accordingly\r\n  // Edges from/to clusters really points to the first child in the cluster.\r\n  // TODO: pick optimal child in the cluster to us as link anchor\r\n  graph.edges().forEach(function (e) {\r\n    const edge = graph.edge(e.v, e.w, e.name);\r\n    log.info('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(e));\r\n    log.info('Edge ' + e.v + ' -> ' + e.w + ': ', e, ' ', JSON.stringify(graph.edge(e)));\r\n\r\n    // Check if link is either from or to a cluster\r\n    log.info('Fix', clusterDb, 'ids:', e.v, e.w, 'Translateing: ', clusterDb[e.v], clusterDb[e.w]);\r\n    insertEdgeLabel(edgeLabels, edge);\r\n  });\r\n\r\n  graph.edges().forEach(function (e) {\r\n    log.info('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(e));\r\n  });\r\n  log.info('#############################################');\r\n  log.info('###                Layout                 ###');\r\n  log.info('#############################################');\r\n  log.info(graph);\r\n  dagre.layout(graph);\r\n  log.info('Graph after layout:', graphlib.json.write(graph));\r\n  // Move the nodes to the correct place\r\n  let diff = 0;\r\n  sortNodesByHierarchy(graph).forEach(function (v) {\r\n    const node = graph.node(v);\r\n    log.info('Position ' + v + ': ' + JSON.stringify(graph.node(v)));\r\n    log.info(\r\n      'Position ' + v + ': (' + node.x,\r\n      ',' + node.y,\r\n      ') width: ',\r\n      node.width,\r\n      ' height: ',\r\n      node.height\r\n    );\r\n    if (node && node.clusterNode) {\r\n      // clusterDb[node.id].node = node;\r\n\r\n      positionNode(node);\r\n    } else {\r\n      // Non cluster node\r\n      if (graph.children(v).length > 0) {\r\n        // A cluster in the non-recurive way\r\n        // positionCluster(node);\r\n        insertCluster(clusters, node);\r\n        clusterDb[node.id].node = node;\r\n      } else {\r\n        positionNode(node);\r\n      }\r\n    }\r\n  });\r\n\r\n  // Move the edge labels to the correct place after layout\r\n  graph.edges().forEach(function (e) {\r\n    const edge = graph.edge(e);\r\n    log.info('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(edge), edge);\r\n\r\n    const paths = insertEdge(edgePaths, e, edge, clusterDb, diagramtype, graph);\r\n    positionEdgeLabel(edge, paths);\r\n  });\r\n\r\n  graph.nodes().forEach(function (v) {\r\n    const n = graph.node(v);\r\n    log.info(v, n.type, n.diff);\r\n    if (n.type === 'group') {\r\n      diff = n.diff;\r\n    }\r\n  });\r\n  return { elem, diff };\r\n};\r\n\r\nexport const render = (elem, graph, markers, diagramtype, id) => {\r\n  insertMarkers(elem, markers, diagramtype, id);\r\n  clearNodes();\r\n  clearEdges();\r\n  clearClusters();\r\n  clearGraphlib();\r\n\r\n  log.warn('Graph at first:', graphlib.json.write(graph));\r\n  adjustClustersAndEdges(graph);\r\n  log.warn('Graph after:', graphlib.json.write(graph));\r\n  // log.warn('Graph ever  after:', graphlib.json.write(graph.node('A').graph));\r\n  recursiveRender(elem, graph, diagramtype);\r\n};\r\n\r\n// const shapeDefinitions = {};\r\n// export const addShape = ({ shapeType: fun }) => {\r\n//   shapeDefinitions[shapeType] = fun;\r\n// };\r\n\r\n// const arrowDefinitions = {};\r\n// export const addArrow = ({ arrowType: fun }) => {\r\n//   arrowDefinitions[arrowType] = fun;\r\n// };\r\n","/*\r\n * Borrowed with love from from dagrge-d3. Many thanks to cpettitt!\r\n */\r\n\r\nimport node from './intersect-node.js';\r\nimport circle from './intersect-circle.js';\r\nimport ellipse from './intersect-ellipse.js';\r\nimport polygon from './intersect-polygon.js';\r\nimport rect from './intersect-rect.js';\r\n\r\nexport default {\r\n  node,\r\n  circle,\r\n  ellipse,\r\n  polygon,\r\n  rect,\r\n};\r\n","import intersectEllipse from './intersect-ellipse';\r\n\r\n/**\r\n * @param node\r\n * @param rx\r\n * @param point\r\n */\r\nfunction intersectCircle(node, rx, point) {\r\n  return intersectEllipse(node, rx, rx, point);\r\n}\r\n\r\nexport default intersectCircle;\r\n","/**\r\n * @param node\r\n * @param rx\r\n * @param ry\r\n * @param point\r\n */\r\nfunction intersectEllipse(node, rx, ry, point) {\r\n  // Formulae from: http://mathworld.wolfram.com/Ellipse-LineIntersection.html\r\n\r\n  var cx = node.x;\r\n  var cy = node.y;\r\n\r\n  var px = cx - point.x;\r\n  var py = cy - point.y;\r\n\r\n  var det = Math.sqrt(rx * rx * py * py + ry * ry * px * px);\r\n\r\n  var dx = Math.abs((rx * ry * px) / det);\r\n  if (point.x < cx) {\r\n    dx = -dx;\r\n  }\r\n  var dy = Math.abs((rx * ry * py) / det);\r\n  if (point.y < cy) {\r\n    dy = -dy;\r\n  }\r\n\r\n  return { x: cx + dx, y: cy + dy };\r\n}\r\n\r\nexport default intersectEllipse;\r\n","/**\r\n * Returns the point at which two lines, p and q, intersect or returns undefined if they do not intersect.\r\n *\r\n * @param p1\r\n * @param p2\r\n * @param q1\r\n * @param q2\r\n */\r\nfunction intersectLine(p1, p2, q1, q2) {\r\n  // Algorithm from J. Avro, (ed.) Graphics Gems, No 2, Morgan Kaufmann, 1994,\r\n  // p7 and p473.\r\n\r\n  var a1, a2, b1, b2, c1, c2;\r\n  var r1, r2, r3, r4;\r\n  var denom, offset, num;\r\n  var x, y;\r\n\r\n  // Compute a1, b1, c1, where line joining points 1 and 2 is F(x,y) = a1 x +\r\n  // b1 y + c1 = 0.\r\n  a1 = p2.y - p1.y;\r\n  b1 = p1.x - p2.x;\r\n  c1 = p2.x * p1.y - p1.x * p2.y;\r\n\r\n  // Compute r3 and r4.\r\n  r3 = a1 * q1.x + b1 * q1.y + c1;\r\n  r4 = a1 * q2.x + b1 * q2.y + c1;\r\n\r\n  // Check signs of r3 and r4. If both point 3 and point 4 lie on\r\n  // same side of line 1, the line segments do not intersect.\r\n  if (r3 !== 0 && r4 !== 0 && sameSign(r3, r4)) {\r\n    return /*DONT_INTERSECT*/;\r\n  }\r\n\r\n  // Compute a2, b2, c2 where line joining points 3 and 4 is G(x,y) = a2 x + b2 y + c2 = 0\r\n  a2 = q2.y - q1.y;\r\n  b2 = q1.x - q2.x;\r\n  c2 = q2.x * q1.y - q1.x * q2.y;\r\n\r\n  // Compute r1 and r2\r\n  r1 = a2 * p1.x + b2 * p1.y + c2;\r\n  r2 = a2 * p2.x + b2 * p2.y + c2;\r\n\r\n  // Check signs of r1 and r2. If both point 1 and point 2 lie\r\n  // on same side of second line segment, the line segments do\r\n  // not intersect.\r\n  if (r1 !== 0 && r2 !== 0 && sameSign(r1, r2)) {\r\n    return /*DONT_INTERSECT*/;\r\n  }\r\n\r\n  // Line segments intersect: compute intersection point.\r\n  denom = a1 * b2 - a2 * b1;\r\n  if (denom === 0) {\r\n    return /*COLLINEAR*/;\r\n  }\r\n\r\n  offset = Math.abs(denom / 2);\r\n\r\n  // The denom/2 is to get rounding instead of truncating. It\r\n  // is added or subtracted to the numerator, depending upon the\r\n  // sign of the numerator.\r\n  num = b1 * c2 - b2 * c1;\r\n  x = num < 0 ? (num - offset) / denom : (num + offset) / denom;\r\n\r\n  num = a2 * c1 - a1 * c2;\r\n  y = num < 0 ? (num - offset) / denom : (num + offset) / denom;\r\n\r\n  return { x: x, y: y };\r\n}\r\n\r\n/**\r\n * @param r1\r\n * @param r2\r\n */\r\nfunction sameSign(r1, r2) {\r\n  return r1 * r2 > 0;\r\n}\r\n\r\nexport default intersectLine;\r\n","module.exports = intersectNode;\r\n\r\n/**\r\n * @param node\r\n * @param point\r\n */\r\nfunction intersectNode(node, point) {\r\n  // console.info('Intersect Node');\r\n  return node.intersect(point);\r\n}\r\n","/* eslint \"no-console\": off */\r\n\r\nimport intersectLine from './intersect-line';\r\n\r\nexport default intersectPolygon;\r\n\r\n/**\r\n * Returns the point ({x, y}) at which the point argument intersects with the node argument assuming\r\n * that it has the shape specified by polygon.\r\n *\r\n * @param node\r\n * @param polyPoints\r\n * @param point\r\n */\r\nfunction intersectPolygon(node, polyPoints, point) {\r\n  var x1 = node.x;\r\n  var y1 = node.y;\r\n\r\n  var intersections = [];\r\n\r\n  var minX = Number.POSITIVE_INFINITY;\r\n  var minY = Number.POSITIVE_INFINITY;\r\n  if (typeof polyPoints.forEach === 'function') {\r\n    polyPoints.forEach(function (entry) {\r\n      minX = Math.min(minX, entry.x);\r\n      minY = Math.min(minY, entry.y);\r\n    });\r\n  } else {\r\n    minX = Math.min(minX, polyPoints.x);\r\n    minY = Math.min(minY, polyPoints.y);\r\n  }\r\n\r\n  var left = x1 - node.width / 2 - minX;\r\n  var top = y1 - node.height / 2 - minY;\r\n\r\n  for (var i = 0; i < polyPoints.length; i++) {\r\n    var p1 = polyPoints[i];\r\n    var p2 = polyPoints[i < polyPoints.length - 1 ? i + 1 : 0];\r\n    var intersect = intersectLine(\r\n      node,\r\n      point,\r\n      { x: left + p1.x, y: top + p1.y },\r\n      { x: left + p2.x, y: top + p2.y }\r\n    );\r\n    if (intersect) {\r\n      intersections.push(intersect);\r\n    }\r\n  }\r\n\r\n  if (!intersections.length) {\r\n    // console.log('NO INTERSECTION FOUND, RETURN NODE CENTER', node);\r\n    return node;\r\n  }\r\n\r\n  if (intersections.length > 1) {\r\n    // More intersections, find the one nearest to edge end point\r\n    intersections.sort(function (p, q) {\r\n      var pdx = p.x - point.x;\r\n      var pdy = p.y - point.y;\r\n      var distp = Math.sqrt(pdx * pdx + pdy * pdy);\r\n\r\n      var qdx = q.x - point.x;\r\n      var qdy = q.y - point.y;\r\n      var distq = Math.sqrt(qdx * qdx + qdy * qdy);\r\n\r\n      return distp < distq ? -1 : distp === distq ? 0 : 1;\r\n    });\r\n  }\r\n  return intersections[0];\r\n}\r\n","const intersectRect = (node, point) => {\r\n  var x = node.x;\r\n  var y = node.y;\r\n\r\n  // Rectangle intersection algorithm from:\r\n  // http://math.stackexchange.com/questions/108113/find-edge-between-two-boxes\r\n  var dx = point.x - x;\r\n  var dy = point.y - y;\r\n  var w = node.width / 2;\r\n  var h = node.height / 2;\r\n\r\n  var sx, sy;\r\n  if (Math.abs(dy) * w > Math.abs(dx) * h) {\r\n    // Intersection is top or bottom of rect.\r\n    if (dy < 0) {\r\n      h = -h;\r\n    }\r\n    sx = dy === 0 ? 0 : (h * dx) / dy;\r\n    sy = h;\r\n  } else {\r\n    // Intersection is left or right of rect.\r\n    if (dx < 0) {\r\n      w = -w;\r\n    }\r\n    sx = w;\r\n    sy = dx === 0 ? 0 : (w * dy) / dx;\r\n  }\r\n\r\n  return { x: x + sx, y: y + sy };\r\n};\r\n\r\nexport default intersectRect;\r\n","/** Setup arrow head and define the marker. The result is appended to the svg. */\r\n\r\nimport { log } from '../logger';\r\n\r\n// Only add the number of markers that the diagram needs\r\nconst insertMarkers = (elem, markerArray, type, id) => {\r\n  markerArray.forEach((markerName) => {\r\n    markers[markerName](elem, type, id);\r\n  });\r\n};\r\n\r\nconst extension = (elem, type, id) => {\r\n  log.trace('Making markers for ', id);\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-extensionStart')\r\n    .attr('class', 'marker extension ' + type)\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 1,7 L18,13 V 1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-extensionEnd')\r\n    .attr('class', 'marker extension ' + type)\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 1,1 V 13 L18,7 Z'); // this is actual shape for arrowhead\r\n};\r\n\r\nconst composition = (elem, type) => {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-compositionStart')\r\n    .attr('class', 'marker composition ' + type)\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-compositionEnd')\r\n    .attr('class', 'marker composition ' + type)\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n};\r\nconst aggregation = (elem, type) => {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-aggregationStart')\r\n    .attr('class', 'marker aggregation ' + type)\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-aggregationEnd')\r\n    .attr('class', 'marker aggregation ' + type)\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n};\r\nconst dependency = (elem, type) => {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-dependencyStart')\r\n    .attr('class', 'marker dependency ' + type)\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 5,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-dependencyEnd')\r\n    .attr('class', 'marker dependency ' + type)\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L14,7 L9,1 Z');\r\n};\r\nconst point = (elem, type) => {\r\n  elem\r\n    .append('marker')\r\n    .attr('id', type + '-pointEnd')\r\n    .attr('class', 'marker ' + type)\r\n    .attr('viewBox', '0 0 10 10')\r\n    .attr('refX', 9)\r\n    .attr('refY', 5)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 12)\r\n    .attr('markerHeight', 12)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 0 0 L 10 5 L 0 10 z')\r\n    .attr('class', 'arrowMarkerPath')\r\n    .style('stroke-width', 1)\r\n    .style('stroke-dasharray', '1,0');\r\n  elem\r\n    .append('marker')\r\n    .attr('id', type + '-pointStart')\r\n    .attr('class', 'marker ' + type)\r\n    .attr('viewBox', '0 0 10 10')\r\n    .attr('refX', 0)\r\n    .attr('refY', 5)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 12)\r\n    .attr('markerHeight', 12)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 0 5 L 10 10 L 10 0 z')\r\n    .attr('class', 'arrowMarkerPath')\r\n    .style('stroke-width', 1)\r\n    .style('stroke-dasharray', '1,0');\r\n};\r\nconst circle = (elem, type) => {\r\n  elem\r\n    .append('marker')\r\n    .attr('id', type + '-circleEnd')\r\n    .attr('class', 'marker ' + type)\r\n    .attr('viewBox', '0 0 10 10')\r\n    .attr('refX', 11)\r\n    .attr('refY', 5)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 11)\r\n    .attr('markerHeight', 11)\r\n    .attr('orient', 'auto')\r\n    .append('circle')\r\n    .attr('cx', '5')\r\n    .attr('cy', '5')\r\n    .attr('r', '5')\r\n    .attr('class', 'arrowMarkerPath')\r\n    .style('stroke-width', 1)\r\n    .style('stroke-dasharray', '1,0');\r\n\r\n  elem\r\n    .append('marker')\r\n    .attr('id', type + '-circleStart')\r\n    .attr('class', 'marker ' + type)\r\n    .attr('viewBox', '0 0 10 10')\r\n    .attr('refX', -1)\r\n    .attr('refY', 5)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 11)\r\n    .attr('markerHeight', 11)\r\n    .attr('orient', 'auto')\r\n    .append('circle')\r\n    .attr('cx', '5')\r\n    .attr('cy', '5')\r\n    .attr('r', '5')\r\n    .attr('class', 'arrowMarkerPath')\r\n    .style('stroke-width', 1)\r\n    .style('stroke-dasharray', '1,0');\r\n};\r\nconst cross = (elem, type) => {\r\n  elem\r\n    .append('marker')\r\n    .attr('id', type + '-crossEnd')\r\n    .attr('class', 'marker cross ' + type)\r\n    .attr('viewBox', '0 0 11 11')\r\n    .attr('refX', 12)\r\n    .attr('refY', 5.2)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 11)\r\n    .attr('markerHeight', 11)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    // .attr('stroke', 'black')\r\n    .attr('d', 'M 1,1 l 9,9 M 10,1 l -9,9')\r\n    .attr('class', 'arrowMarkerPath')\r\n    .style('stroke-width', 2)\r\n    .style('stroke-dasharray', '1,0');\r\n\r\n  elem\r\n    .append('marker')\r\n    .attr('id', type + '-crossStart')\r\n    .attr('class', 'marker cross ' + type)\r\n    .attr('viewBox', '0 0 11 11')\r\n    .attr('refX', -1)\r\n    .attr('refY', 5.2)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 11)\r\n    .attr('markerHeight', 11)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    // .attr('stroke', 'black')\r\n    .attr('d', 'M 1,1 l 9,9 M 10,1 l -9,9')\r\n    .attr('class', 'arrowMarkerPath')\r\n    .style('stroke-width', 2)\r\n    .style('stroke-dasharray', '1,0');\r\n};\r\nconst barb = (elem, type) => {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', type + '-barbEnd')\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 14)\r\n    .attr('markerUnits', 'strokeWidth')\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 19,7 L9,13 L14,7 L9,1 Z');\r\n};\r\n\r\n// TODO rename the class diagram markers to something shape descriptive and semanitc free\r\nconst markers = {\r\n  extension,\r\n  composition,\r\n  aggregation,\r\n  dependency,\r\n  point,\r\n  circle,\r\n  cross,\r\n  barb,\r\n};\r\nexport default insertMarkers;\r\n","/** Decorates with functions required by mermaids dagre-wrapper. */\r\nimport { log } from '../logger';\r\nimport graphlib from 'graphlib';\r\n\r\nexport let clusterDb = {};\r\nlet decendants = {};\r\nlet parents = {};\r\n\r\nexport const clear = () => {\r\n  decendants = {};\r\n  parents = {};\r\n  clusterDb = {};\r\n};\r\n\r\nconst isDecendant = (id, ancenstorId) => {\r\n  // if (id === ancenstorId) return true;\r\n\r\n  log.trace(\r\n    'In isDecendant',\r\n    ancenstorId,\r\n    ' ',\r\n    id,\r\n    ' = ',\r\n    decendants[ancenstorId].indexOf(id) >= 0\r\n  );\r\n  if (decendants[ancenstorId].indexOf(id) >= 0) return true;\r\n\r\n  return false;\r\n};\r\n\r\nconst edgeInCluster = (edge, clusterId) => {\r\n  log.info('Decendants of ', clusterId, ' is ', decendants[clusterId]);\r\n  log.info('Edge is ', edge);\r\n  // Edges to/from the cluster is not in the cluster, they are in the parent\r\n  if (edge.v === clusterId) return false;\r\n  if (edge.w === clusterId) return false;\r\n\r\n  if (!decendants[clusterId]) {\r\n    log.debug('Tilt, ', clusterId, ',not in decendants');\r\n    return false;\r\n  }\r\n  log.info('Here ');\r\n\r\n  if (decendants[clusterId].indexOf(edge.v) >= 0) return true;\r\n  if (isDecendant(edge.v, clusterId)) return true;\r\n  if (isDecendant(edge.w, clusterId)) return true;\r\n  if (decendants[clusterId].indexOf(edge.w) >= 0) return true;\r\n\r\n  return false;\r\n};\r\n\r\nconst copy = (clusterId, graph, newGraph, rootId) => {\r\n  log.warn(\r\n    'Copying children of ',\r\n    clusterId,\r\n    'root',\r\n    rootId,\r\n    'data',\r\n    graph.node(clusterId),\r\n    rootId\r\n  );\r\n  const nodes = graph.children(clusterId) || [];\r\n\r\n  // Include cluster node if it is not the root\r\n  if (clusterId !== rootId) {\r\n    nodes.push(clusterId);\r\n  }\r\n\r\n  log.warn('Copying (nodes) clusterId', clusterId, 'nodes', nodes);\r\n\r\n  nodes.forEach((node) => {\r\n    if (graph.children(node).length > 0) {\r\n      copy(node, graph, newGraph, rootId);\r\n    } else {\r\n      const data = graph.node(node);\r\n      log.info('cp ', node, ' to ', rootId, ' with parent ', clusterId); //,node, data, ' parent is ', clusterId);\r\n      newGraph.setNode(node, data);\r\n      if (rootId !== graph.parent(node)) {\r\n        log.warn('Setting parent', node, graph.parent(node));\r\n        newGraph.setParent(node, graph.parent(node));\r\n      }\r\n\r\n      if (clusterId !== rootId && node !== clusterId) {\r\n        log.debug('Setting parent', node, clusterId);\r\n        newGraph.setParent(node, clusterId);\r\n      } else {\r\n        log.info('In copy ', clusterId, 'root', rootId, 'data', graph.node(clusterId), rootId);\r\n        log.debug(\r\n          'Not Setting parent for node=',\r\n          node,\r\n          'cluster!==rootId',\r\n          clusterId !== rootId,\r\n          'node!==clusterId',\r\n          node !== clusterId\r\n        );\r\n      }\r\n      const edges = graph.edges(node);\r\n      log.debug('Copying Edges', edges);\r\n      edges.forEach((edge) => {\r\n        log.info('Edge', edge);\r\n        const data = graph.edge(edge.v, edge.w, edge.name);\r\n        log.info('Edge data', data, rootId);\r\n        try {\r\n          // Do not copy edges in and out of the root cluster, they belong to the parent graph\r\n          if (edgeInCluster(edge, rootId)) {\r\n            log.info('Copying as ', edge.v, edge.w, data, edge.name);\r\n            newGraph.setEdge(edge.v, edge.w, data, edge.name);\r\n            log.info('newGraph edges ', newGraph.edges(), newGraph.edge(newGraph.edges()[0]));\r\n          } else {\r\n            log.info(\r\n              'Skipping copy of edge ',\r\n              edge.v,\r\n              '-->',\r\n              edge.w,\r\n              ' rootId: ',\r\n              rootId,\r\n              ' clusterId:',\r\n              clusterId\r\n            );\r\n          }\r\n        } catch (e) {\r\n          log.error(e);\r\n        }\r\n      });\r\n    }\r\n    log.debug('Removing node', node);\r\n    graph.removeNode(node);\r\n  });\r\n};\r\nexport const extractDecendants = (id, graph) => {\r\n  // log.debug('Extracting ', id);\r\n  const children = graph.children(id);\r\n  let res = [].concat(children);\r\n\r\n  for (let i = 0; i < children.length; i++) {\r\n    parents[children[i]] = id;\r\n    res = res.concat(extractDecendants(children[i], graph));\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\n/**\r\n * Validates the graph, checking that all parent child relation points to existing nodes and that\r\n * edges between nodes also ia correct. When not correct the function logs the discrepancies.\r\n *\r\n * @param graph\r\n */\r\nexport const validate = (graph) => {\r\n  const edges = graph.edges();\r\n  log.trace('Edges: ', edges);\r\n  for (let i = 0; i < edges.length; i++) {\r\n    if (graph.children(edges[i].v).length > 0) {\r\n      log.trace('The node ', edges[i].v, ' is part of and edge even though it has children');\r\n      return false;\r\n    }\r\n    if (graph.children(edges[i].w).length > 0) {\r\n      log.trace('The node ', edges[i].w, ' is part of and edge even though it has children');\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n};\r\n\r\n/**\r\n * Finds a child that is not a cluster. When faking a edge between a node and a cluster.\r\n *\r\n * @param {Finds a} id\r\n * @param {any} graph\r\n */\r\nexport const findNonClusterChild = (id, graph) => {\r\n  // const node = graph.node(id);\r\n  log.trace('Searching', id);\r\n  // const children = graph.children(id).reverse();\r\n  const children = graph.children(id); //.reverse();\r\n  log.trace('Searching children of id ', id, children);\r\n  if (children.length < 1) {\r\n    log.trace('This is a valid node', id);\r\n    return id;\r\n  }\r\n  for (let i = 0; i < children.length; i++) {\r\n    const _id = findNonClusterChild(children[i], graph);\r\n    if (_id) {\r\n      log.trace('Found replacement for', id, ' => ', _id);\r\n      return _id;\r\n    }\r\n  }\r\n};\r\n\r\nconst getAnchorId = (id) => {\r\n  if (!clusterDb[id]) {\r\n    return id;\r\n  }\r\n  // If the cluster has no external connections\r\n  if (!clusterDb[id].externalConnections) {\r\n    return id;\r\n  }\r\n\r\n  // Return the replacement node\r\n  if (clusterDb[id]) {\r\n    return clusterDb[id].id;\r\n  }\r\n  return id;\r\n};\r\n\r\nexport const adjustClustersAndEdges = (graph, depth) => {\r\n  if (!graph || depth > 10) {\r\n    log.debug('Opting out, no graph ');\r\n    return;\r\n  } else {\r\n    log.debug('Opting in, graph ');\r\n  }\r\n  // Go through the nodes and for each cluster found, save a replacment node, this can be used when\r\n  // faking a link to a cluster\r\n  graph.nodes().forEach(function (id) {\r\n    const children = graph.children(id);\r\n    if (children.length > 0) {\r\n      log.warn(\r\n        'Cluster identified',\r\n        id,\r\n        ' Replacement id in edges: ',\r\n        findNonClusterChild(id, graph)\r\n      );\r\n      decendants[id] = extractDecendants(id, graph);\r\n      clusterDb[id] = { id: findNonClusterChild(id, graph), clusterData: graph.node(id) };\r\n    }\r\n  });\r\n\r\n  // Check incoming and outgoing edges for each cluster\r\n  graph.nodes().forEach(function (id) {\r\n    const children = graph.children(id);\r\n    const edges = graph.edges();\r\n    if (children.length > 0) {\r\n      log.debug('Cluster identified', id, decendants);\r\n      edges.forEach((edge) => {\r\n        // log.debug('Edge, decendants: ', edge, decendants[id]);\r\n\r\n        // Check if any edge leaves the cluster (not the actual cluster, thats a link from the box)\r\n        if (edge.v !== id && edge.w !== id) {\r\n          // Any edge where either the one of the nodes is decending to the cluster but not the other\r\n          // if (decendants[id].indexOf(edge.v) < 0 && decendants[id].indexOf(edge.w) < 0) {\r\n\r\n          const d1 = isDecendant(edge.v, id);\r\n          const d2 = isDecendant(edge.w, id);\r\n\r\n          // d1 xor d2 - if either d1 is true and d2 is false or the other way around\r\n          if (d1 ^ d2) {\r\n            log.warn('Edge: ', edge, ' leaves cluster ', id);\r\n            log.warn('Decendants of XXX ', id, ': ', decendants[id]);\r\n            clusterDb[id].externalConnections = true;\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      log.debug('Not a cluster ', id, decendants);\r\n    }\r\n  });\r\n\r\n  // For clusters with incoming and/or outgoing edges translate those edges to a real node\r\n  // in the cluster inorder to fake the edge\r\n  graph.edges().forEach(function (e) {\r\n    const edge = graph.edge(e);\r\n    log.warn('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(e));\r\n    log.warn('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(graph.edge(e)));\r\n\r\n    let v = e.v;\r\n    let w = e.w;\r\n    // Check if link is either from or to a cluster\r\n    log.warn(\r\n      'Fix XXX',\r\n      clusterDb,\r\n      'ids:',\r\n      e.v,\r\n      e.w,\r\n      'Translateing: ',\r\n      clusterDb[e.v],\r\n      ' --- ',\r\n      clusterDb[e.w]\r\n    );\r\n    if (clusterDb[e.v] || clusterDb[e.w]) {\r\n      log.warn('Fixing and trixing - removing XXX', e.v, e.w, e.name);\r\n      v = getAnchorId(e.v);\r\n      w = getAnchorId(e.w);\r\n      graph.removeEdge(e.v, e.w, e.name);\r\n      if (v !== e.v) edge.fromCluster = e.v;\r\n      if (w !== e.w) edge.toCluster = e.w;\r\n      log.warn('Fix Replacing with XXX', v, w, e.name);\r\n      graph.setEdge(v, w, edge, e.name);\r\n    }\r\n  });\r\n  log.warn('Adjusted Graph', graphlib.json.write(graph));\r\n  extractor(graph, 0);\r\n\r\n  log.trace(clusterDb);\r\n\r\n  // Remove references to extracted cluster\r\n  // graph.edges().forEach(edge => {\r\n  //   if (isDecendant(edge.v, clusterId) || isDecendant(edge.w, clusterId)) {\r\n  //     graph.removeEdge(edge);\r\n  //   }\r\n  // });\r\n};\r\n\r\nexport const extractor = (graph, depth) => {\r\n  log.warn('extractor - ', depth, graphlib.json.write(graph), graph.children('D'));\r\n  if (depth > 10) {\r\n    log.error('Bailing out');\r\n    return;\r\n  }\r\n  // For clusters without incoming and/or outgoing edges, create a new cluster-node\r\n  // containing the nodes and edges in the custer in a new graph\r\n  // for (let i = 0;)\r\n  let nodes = graph.nodes();\r\n  let hasChildren = false;\r\n  for (let i = 0; i < nodes.length; i++) {\r\n    const node = nodes[i];\r\n    const children = graph.children(node);\r\n    hasChildren = hasChildren || children.length > 0;\r\n  }\r\n\r\n  if (!hasChildren) {\r\n    log.debug('Done, no node has children', graph.nodes());\r\n    return;\r\n  }\r\n  // const clusters = Object.keys(clusterDb);\r\n  // clusters.forEach(clusterId => {\r\n  log.debug('Nodes = ', nodes, depth);\r\n  for (let i = 0; i < nodes.length; i++) {\r\n    const node = nodes[i];\r\n\r\n    log.debug(\r\n      'Extracting node',\r\n      node,\r\n      clusterDb,\r\n      clusterDb[node] && !clusterDb[node].externalConnections,\r\n      !graph.parent(node),\r\n      graph.node(node),\r\n      graph.children('D'),\r\n      ' Depth ',\r\n      depth\r\n    );\r\n    // Note that the node might have been removed after the Object.keys call so better check\r\n    // that it still is in the game\r\n    if (!clusterDb[node]) {\r\n      // Skip if the node is not a cluster\r\n      log.debug('Not a cluster', node, depth);\r\n      // break;\r\n    } else if (\r\n      !clusterDb[node].externalConnections &&\r\n      // !graph.parent(node) &&\r\n      graph.children(node) &&\r\n      graph.children(node).length > 0\r\n    ) {\r\n      log.warn(\r\n        'Cluster without external connections, without a parent and with children',\r\n        node,\r\n        depth\r\n      );\r\n\r\n      const graphSettings = graph.graph();\r\n      let dir = graphSettings.rankdir === 'TB' ? 'LR' : 'TB';\r\n      if (clusterDb[node]) {\r\n        if (clusterDb[node].clusterData && clusterDb[node].clusterData.dir) {\r\n          dir = clusterDb[node].clusterData.dir;\r\n          log.warn('Fixing dir', clusterDb[node].clusterData.dir, dir);\r\n        }\r\n      }\r\n\r\n      const clusterGraph = new graphlib.Graph({\r\n        multigraph: true,\r\n        compound: true,\r\n      })\r\n        .setGraph({\r\n          rankdir: dir, // Todo: set proper spacing\r\n          nodesep: 50,\r\n          ranksep: 50,\r\n          marginx: 8,\r\n          marginy: 8,\r\n        })\r\n        .setDefaultEdgeLabel(function () {\r\n          return {};\r\n        });\r\n\r\n      log.warn('Old graph before copy', graphlib.json.write(graph));\r\n      copy(node, graph, clusterGraph, node);\r\n      graph.setNode(node, {\r\n        clusterNode: true,\r\n        id: node,\r\n        clusterData: clusterDb[node].clusterData,\r\n        labelText: clusterDb[node].labelText,\r\n        graph: clusterGraph,\r\n      });\r\n      log.warn('New graph after copy node: (', node, ')', graphlib.json.write(clusterGraph));\r\n      log.debug('Old graph after copy', graphlib.json.write(graph));\r\n    } else {\r\n      log.warn(\r\n        'Cluster ** ',\r\n        node,\r\n        ' **not meeting the criteria !externalConnections:',\r\n        !clusterDb[node].externalConnections,\r\n        ' no parent: ',\r\n        !graph.parent(node),\r\n        ' children ',\r\n        graph.children(node) && graph.children(node).length > 0,\r\n        graph.children('D'),\r\n        depth\r\n      );\r\n      log.debug(clusterDb);\r\n    }\r\n  }\r\n\r\n  nodes = graph.nodes();\r\n  log.warn('New list of nodes', nodes);\r\n  for (let i = 0; i < nodes.length; i++) {\r\n    const node = nodes[i];\r\n    const data = graph.node(node);\r\n    log.warn(' Now next level', node, data);\r\n    if (data.clusterNode) {\r\n      extractor(data.graph, depth + 1);\r\n    }\r\n  }\r\n};\r\n\r\nconst sorter = (graph, nodes) => {\r\n  if (nodes.length === 0) return [];\r\n  let result = Object.assign(nodes);\r\n  nodes.forEach((node) => {\r\n    const children = graph.children(node);\r\n    const sorted = sorter(graph, children);\r\n    result = result.concat(sorted);\r\n  });\r\n\r\n  return result;\r\n};\r\n\r\nexport const sortNodesByHierarchy = (graph) => sorter(graph, graph.children());\r\n","import { select } from 'd3';\r\nimport { log } from '../logger'; // eslint-disable-line\r\nimport { labelHelper, updateNodeBounds, insertPolygonShape } from './shapes/util';\r\nimport { getConfig } from '../config';\r\nimport intersect from './intersect/index.js';\r\nimport createLabel from './createLabel';\r\nimport note from './shapes/note';\r\nimport { parseMember } from '../diagrams/class/svgDraw';\r\nimport { evaluate, sanitizeText as sanitize } from '../diagrams/common/common';\r\n\r\nconst sanitizeText = (txt) => sanitize(txt, getConfig());\r\n\r\nconst question = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const s = w + h;\r\n  const points = [\r\n    { x: s / 2, y: 0 },\r\n    { x: s, y: -s / 2 },\r\n    { x: s / 2, y: -s },\r\n    { x: 0, y: -s / 2 },\r\n  ];\r\n\r\n  log.info('Question main (Circle)');\r\n\r\n  const questionElem = insertPolygonShape(shapeSvg, s, s, points);\r\n  questionElem.attr('style', node.style);\r\n  updateNodeBounds(node, questionElem);\r\n\r\n  node.intersect = function (point) {\r\n    log.warn('Intersect called');\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst choice = (parent, node) => {\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', 'node default')\r\n    .attr('id', node.domId || node.id);\r\n\r\n  const s = 28;\r\n  const points = [\r\n    { x: 0, y: s / 2 },\r\n    { x: s / 2, y: 0 },\r\n    { x: 0, y: -s / 2 },\r\n    { x: -s / 2, y: 0 },\r\n  ];\r\n\r\n  const choice = shapeSvg.insert('polygon', ':first-child').attr(\r\n    'points',\r\n    points\r\n      .map(function (d) {\r\n        return d.x + ',' + d.y;\r\n      })\r\n      .join(' ')\r\n  );\r\n  // center the circle around its coordinate\r\n  choice.attr('class', 'state-start').attr('r', 7).attr('width', 28).attr('height', 28);\r\n  node.width = 28;\r\n  node.height = 28;\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.circle(node, 14, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst hexagon = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const f = 4;\r\n  const h = bbox.height + node.padding;\r\n  const m = h / f;\r\n  const w = bbox.width + 2 * m + node.padding;\r\n  const points = [\r\n    { x: m, y: 0 },\r\n    { x: w - m, y: 0 },\r\n    { x: w, y: -h / 2 },\r\n    { x: w - m, y: -h },\r\n    { x: m, y: -h },\r\n    { x: 0, y: -h / 2 },\r\n  ];\r\n\r\n  const hex = insertPolygonShape(shapeSvg, w, h, points);\r\n  hex.attr('style', node.style);\r\n  updateNodeBounds(node, hex);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst rect_left_inv_arrow = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: -h / 2, y: 0 },\r\n    { x: w, y: 0 },\r\n    { x: w, y: -h },\r\n    { x: -h / 2, y: -h },\r\n    { x: 0, y: -h / 2 },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n\r\n  node.width = w + h;\r\n  node.height = h;\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst lean_right = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: (-2 * h) / 6, y: 0 },\r\n    { x: w - h / 6, y: 0 },\r\n    { x: w + (2 * h) / 6, y: -h },\r\n    { x: h / 6, y: -h },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst lean_left = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: (2 * h) / 6, y: 0 },\r\n    { x: w + h / 6, y: 0 },\r\n    { x: w - (2 * h) / 6, y: -h },\r\n    { x: -h / 6, y: -h },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst trapezoid = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: (-2 * h) / 6, y: 0 },\r\n    { x: w + (2 * h) / 6, y: 0 },\r\n    { x: w - h / 6, y: -h },\r\n    { x: h / 6, y: -h },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst inv_trapezoid = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: h / 6, y: 0 },\r\n    { x: w - h / 6, y: 0 },\r\n    { x: w + (2 * h) / 6, y: -h },\r\n    { x: (-2 * h) / 6, y: -h },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst rect_right_inv_arrow = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: 0, y: 0 },\r\n    { x: w + h / 2, y: 0 },\r\n    { x: w, y: -h / 2 },\r\n    { x: w + h / 2, y: -h },\r\n    { x: 0, y: -h },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst cylinder = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const rx = w / 2;\r\n  const ry = rx / (2.5 + w / 50);\r\n  const h = bbox.height + ry + node.padding;\r\n\r\n  const shape =\r\n    'M 0,' +\r\n    ry +\r\n    ' a ' +\r\n    rx +\r\n    ',' +\r\n    ry +\r\n    ' 0,0,0 ' +\r\n    w +\r\n    ' 0 a ' +\r\n    rx +\r\n    ',' +\r\n    ry +\r\n    ' 0,0,0 ' +\r\n    -w +\r\n    ' 0 l 0,' +\r\n    h +\r\n    ' a ' +\r\n    rx +\r\n    ',' +\r\n    ry +\r\n    ' 0,0,0 ' +\r\n    w +\r\n    ' 0 l 0,' +\r\n    -h;\r\n\r\n  const el = shapeSvg\r\n    .attr('label-offset-y', ry)\r\n    .insert('path', ':first-child')\r\n    .attr('style', node.style)\r\n    .attr('d', shape)\r\n    .attr('transform', 'translate(' + -w / 2 + ',' + -(h / 2 + ry) + ')');\r\n\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    const pos = intersect.rect(node, point);\r\n    const x = pos.x - node.x;\r\n\r\n    if (\r\n      rx != 0 &&\r\n      (Math.abs(x) < node.width / 2 ||\r\n        (Math.abs(x) == node.width / 2 && Math.abs(pos.y - node.y) > node.height / 2 - ry))\r\n    ) {\r\n      // ellipsis equation: x*x / a*a + y*y / b*b = 1\r\n      // solve for y to get adjustion value for pos.y\r\n      let y = ry * ry * (1 - (x * x) / (rx * rx));\r\n      if (y != 0) y = Math.sqrt(y);\r\n      y = ry - y;\r\n      if (point.y - node.y > 0) y = -y;\r\n\r\n      pos.y += y;\r\n    }\r\n\r\n    return pos;\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst rect = (parent, node) => {\r\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, 'node ' + node.classes, true);\r\n\r\n  log.trace('Classes = ', node.classes);\r\n  // add the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n\r\n  const totalWidth = bbox.width + node.padding;\r\n  const totalHeight = bbox.height + node.padding;\r\n  rect\r\n    .attr('class', 'basic label-container')\r\n    .attr('style', node.style)\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('x', -bbox.width / 2 - halfPadding)\r\n    .attr('y', -bbox.height / 2 - halfPadding)\r\n    .attr('width', totalWidth)\r\n    .attr('height', totalHeight);\r\n\r\n  if (node.props) {\r\n    const propKeys = new Set(Object.keys(node.props));\r\n    if (node.props.borders) {\r\n      applyNodePropertyBorders(rect, node.props.borders, totalWidth, totalHeight);\r\n      propKeys.delete('borders');\r\n    }\r\n    propKeys.forEach((propKey) => {\r\n      log.warn(`Unknown node property ${propKey}`);\r\n    });\r\n  }\r\n\r\n  updateNodeBounds(node, rect);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.rect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\n/**\r\n * @param rect\r\n * @param borders\r\n * @param totalWidth\r\n * @param totalHeight\r\n */\r\nfunction applyNodePropertyBorders(rect, borders, totalWidth, totalHeight) {\r\n  const strokeDashArray = [];\r\n  const addBorder = (length) => {\r\n    strokeDashArray.push(length);\r\n    strokeDashArray.push(0);\r\n  };\r\n  const skipBorder = (length) => {\r\n    strokeDashArray.push(0);\r\n    strokeDashArray.push(length);\r\n  };\r\n  if (borders.includes('t')) {\r\n    log.debug('add top border');\r\n    addBorder(totalWidth);\r\n  } else {\r\n    skipBorder(totalWidth);\r\n  }\r\n  if (borders.includes('r')) {\r\n    log.debug('add right border');\r\n    addBorder(totalHeight);\r\n  } else {\r\n    skipBorder(totalHeight);\r\n  }\r\n  if (borders.includes('b')) {\r\n    log.debug('add bottom border');\r\n    addBorder(totalWidth);\r\n  } else {\r\n    skipBorder(totalWidth);\r\n  }\r\n  if (borders.includes('l')) {\r\n    log.debug('add left border');\r\n    addBorder(totalHeight);\r\n  } else {\r\n    skipBorder(totalHeight);\r\n  }\r\n  rect.attr('stroke-dasharray', strokeDashArray.join(' '));\r\n}\r\n\r\nconst rectWithTitle = (parent, node) => {\r\n  // const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, 'node ' + node.classes);\r\n\r\n  let classes;\r\n  if (!node.classes) {\r\n    classes = 'node default';\r\n  } else {\r\n    classes = 'node ' + node.classes;\r\n  }\r\n  // Add outer g element\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', classes)\r\n    .attr('id', node.domId || node.id);\r\n\r\n  // Create the title label and insert it after the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n  // const innerRect = shapeSvg.insert('rect');\r\n  const innerLine = shapeSvg.insert('line');\r\n\r\n  const label = shapeSvg.insert('g').attr('class', 'label');\r\n\r\n  const text2 = node.labelText.flat ? node.labelText.flat() : node.labelText;\r\n  // const text2 = typeof text2prim === 'object' ? text2prim[0] : text2prim;\r\n\r\n  let title = '';\r\n  if (typeof text2 === 'object') {\r\n    title = text2[0];\r\n  } else {\r\n    title = text2;\r\n  }\r\n  log.info('Label text abc79', title, text2, typeof text2 === 'object');\r\n\r\n  const text = label.node().appendChild(createLabel(title, node.labelStyle, true, true));\r\n  let bbox = { width: 0, height: 0 };\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = text.children[0];\r\n    const dv = select(text);\r\n    bbox = div.getBoundingClientRect();\r\n    dv.attr('width', bbox.width);\r\n    dv.attr('height', bbox.height);\r\n  }\r\n  log.info('Text 2', text2);\r\n  const textRows = text2.slice(1, text2.length);\r\n  let titleBox = text.getBBox();\r\n  const descr = label\r\n    .node()\r\n    .appendChild(\r\n      createLabel(textRows.join ? textRows.join('<br/>') : textRows, node.labelStyle, true, true)\r\n    );\r\n\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = descr.children[0];\r\n    const dv = select(descr);\r\n    bbox = div.getBoundingClientRect();\r\n    dv.attr('width', bbox.width);\r\n    dv.attr('height', bbox.height);\r\n  }\r\n  // bbox = label.getBBox();\r\n  // log.info(descr);\r\n  const halfPadding = node.padding / 2;\r\n  select(descr).attr(\r\n    'transform',\r\n    'translate( ' +\r\n      // (titleBox.width - bbox.width) / 2 +\r\n      (bbox.width > titleBox.width ? 0 : (titleBox.width - bbox.width) / 2) +\r\n      ', ' +\r\n      (titleBox.height + halfPadding + 5) +\r\n      ')'\r\n  );\r\n  select(text).attr(\r\n    'transform',\r\n    'translate( ' +\r\n      // (titleBox.width - bbox.width) / 2 +\r\n      (bbox.width < titleBox.width ? 0 : -(titleBox.width - bbox.width) / 2) +\r\n      ', ' +\r\n      0 +\r\n      ')'\r\n  );\r\n  // Get the size of the label\r\n\r\n  // Bounding box for title and text\r\n  bbox = label.node().getBBox();\r\n\r\n  // Center the label\r\n  label.attr(\r\n    'transform',\r\n    'translate(' + -bbox.width / 2 + ', ' + (-bbox.height / 2 - halfPadding + 3) + ')'\r\n  );\r\n\r\n  rect\r\n    .attr('class', 'outer title-state')\r\n    .attr('x', -bbox.width / 2 - halfPadding)\r\n    .attr('y', -bbox.height / 2 - halfPadding)\r\n    .attr('width', bbox.width + node.padding)\r\n    .attr('height', bbox.height + node.padding);\r\n\r\n  innerLine\r\n    .attr('class', 'divider')\r\n    .attr('x1', -bbox.width / 2 - halfPadding)\r\n    .attr('x2', bbox.width / 2 + halfPadding)\r\n    .attr('y1', -bbox.height / 2 - halfPadding + titleBox.height + halfPadding)\r\n    .attr('y2', -bbox.height / 2 - halfPadding + titleBox.height + halfPadding);\r\n\r\n  updateNodeBounds(node, rect);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.rect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst stadium = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const h = bbox.height + node.padding;\r\n  const w = bbox.width + h / 4 + node.padding;\r\n\r\n  // add the rect\r\n  const rect = shapeSvg\r\n    .insert('rect', ':first-child')\r\n    .attr('style', node.style)\r\n    .attr('rx', h / 2)\r\n    .attr('ry', h / 2)\r\n    .attr('x', -w / 2)\r\n    .attr('y', -h / 2)\r\n    .attr('width', w)\r\n    .attr('height', h);\r\n\r\n  updateNodeBounds(node, rect);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.rect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst circle = (parent, node) => {\r\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, undefined, true);\r\n  const circle = shapeSvg.insert('circle', ':first-child');\r\n\r\n  // center the circle around its coordinate\r\n  circle\r\n    .attr('style', node.style)\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('r', bbox.width / 2 + halfPadding)\r\n    .attr('width', bbox.width + node.padding)\r\n    .attr('height', bbox.height + node.padding);\r\n\r\n  log.info('Circle main');\r\n\r\n  updateNodeBounds(node, circle);\r\n\r\n  node.intersect = function (point) {\r\n    log.info('Circle intersect', node, bbox.width / 2 + halfPadding, point);\r\n    return intersect.circle(node, bbox.width / 2 + halfPadding, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst doublecircle = (parent, node) => {\r\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, undefined, true);\r\n  const gap = 5;\r\n  const circleGroup = shapeSvg.insert('g', ':first-child');\r\n  const outerCircle = circleGroup.insert('circle');\r\n  const innerCircle = circleGroup.insert('circle');\r\n\r\n  // center the circle around its coordinate\r\n  outerCircle\r\n    .attr('style', node.style)\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('r', bbox.width / 2 + halfPadding + gap)\r\n    .attr('width', bbox.width + node.padding + gap * 2)\r\n    .attr('height', bbox.height + node.padding + gap * 2);\r\n\r\n  innerCircle\r\n    .attr('style', node.style)\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('r', bbox.width / 2 + halfPadding)\r\n    .attr('width', bbox.width + node.padding)\r\n    .attr('height', bbox.height + node.padding);\r\n\r\n  log.info('DoubleCircle main');\r\n\r\n  updateNodeBounds(node, outerCircle);\r\n\r\n  node.intersect = function (point) {\r\n    log.info('DoubleCircle intersect', node, bbox.width / 2 + halfPadding + gap, point);\r\n    return intersect.circle(node, bbox.width / 2 + halfPadding + gap, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst subroutine = (parent, node) => {\r\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\r\n\r\n  const w = bbox.width + node.padding;\r\n  const h = bbox.height + node.padding;\r\n  const points = [\r\n    { x: 0, y: 0 },\r\n    { x: w, y: 0 },\r\n    { x: w, y: -h },\r\n    { x: 0, y: -h },\r\n    { x: 0, y: 0 },\r\n    { x: -8, y: 0 },\r\n    { x: w + 8, y: 0 },\r\n    { x: w + 8, y: -h },\r\n    { x: -8, y: -h },\r\n    { x: -8, y: 0 },\r\n  ];\r\n\r\n  const el = insertPolygonShape(shapeSvg, w, h, points);\r\n  el.attr('style', node.style);\r\n  updateNodeBounds(node, el);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.polygon(node, points, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst start = (parent, node) => {\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', 'node default')\r\n    .attr('id', node.domId || node.id);\r\n  const circle = shapeSvg.insert('circle', ':first-child');\r\n\r\n  // center the circle around its coordinate\r\n  circle.attr('class', 'state-start').attr('r', 7).attr('width', 14).attr('height', 14);\r\n\r\n  updateNodeBounds(node, circle);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.circle(node, 7, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst forkJoin = (parent, node, dir) => {\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', 'node default')\r\n    .attr('id', node.domId || node.id);\r\n\r\n  let width = 70;\r\n  let height = 10;\r\n\r\n  if (dir === 'LR') {\r\n    width = 10;\r\n    height = 70;\r\n  }\r\n\r\n  const shape = shapeSvg\r\n    .append('rect')\r\n    .attr('x', (-1 * width) / 2)\r\n    .attr('y', (-1 * height) / 2)\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .attr('class', 'fork-join');\r\n\r\n  updateNodeBounds(node, shape);\r\n  node.height = node.height + node.padding / 2;\r\n  node.width = node.width + node.padding / 2;\r\n  node.intersect = function (point) {\r\n    return intersect.rect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst end = (parent, node) => {\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', 'node default')\r\n    .attr('id', node.domId || node.id);\r\n  const innerCircle = shapeSvg.insert('circle', ':first-child');\r\n  const circle = shapeSvg.insert('circle', ':first-child');\r\n\r\n  circle.attr('class', 'state-start').attr('r', 7).attr('width', 14).attr('height', 14);\r\n\r\n  innerCircle.attr('class', 'state-end').attr('r', 5).attr('width', 10).attr('height', 10);\r\n\r\n  updateNodeBounds(node, circle);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.circle(node, 7, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst class_box = (parent, node) => {\r\n  const halfPadding = node.padding / 2;\r\n  const rowPadding = 4;\r\n  const lineHeight = 8;\r\n\r\n  let classes;\r\n  if (!node.classes) {\r\n    classes = 'node default';\r\n  } else {\r\n    classes = 'node ' + node.classes;\r\n  }\r\n  // Add outer g element\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', classes)\r\n    .attr('id', node.domId || node.id);\r\n\r\n  // Create the title label and insert it after the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n  const topLine = shapeSvg.insert('line');\r\n  const bottomLine = shapeSvg.insert('line');\r\n  let maxWidth = 0;\r\n  let maxHeight = rowPadding;\r\n\r\n  const labelContainer = shapeSvg.insert('g').attr('class', 'label');\r\n  let verticalPos = 0;\r\n  const hasInterface = node.classData.annotations && node.classData.annotations[0];\r\n\r\n  // 1. Create the labels\r\n  const interfaceLabelText = node.classData.annotations[0]\r\n    ? '' + node.classData.annotations[0] + ''\r\n    : '';\r\n  const interfaceLabel = labelContainer\r\n    .node()\r\n    .appendChild(createLabel(interfaceLabelText, node.labelStyle, true, true));\r\n  let interfaceBBox = interfaceLabel.getBBox();\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = interfaceLabel.children[0];\r\n    const dv = select(interfaceLabel);\r\n    interfaceBBox = div.getBoundingClientRect();\r\n    dv.attr('width', interfaceBBox.width);\r\n    dv.attr('height', interfaceBBox.height);\r\n  }\r\n  if (node.classData.annotations[0]) {\r\n    maxHeight += interfaceBBox.height + rowPadding;\r\n    maxWidth += interfaceBBox.width;\r\n  }\r\n\r\n  let classTitleString = node.classData.id;\r\n\r\n  if (node.classData.type !== undefined && node.classData.type !== '') {\r\n    if (getConfig().flowchart.htmlLabels) {\r\n      classTitleString += '&lt;' + node.classData.type + '&gt;';\r\n    } else {\r\n      classTitleString += '<' + node.classData.type + '>';\r\n    }\r\n  }\r\n  const classTitleLabel = labelContainer\r\n    .node()\r\n    .appendChild(createLabel(classTitleString, node.labelStyle, true, true));\r\n  select(classTitleLabel).attr('class', 'classTitle');\r\n  let classTitleBBox = classTitleLabel.getBBox();\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = classTitleLabel.children[0];\r\n    const dv = select(classTitleLabel);\r\n    classTitleBBox = div.getBoundingClientRect();\r\n    dv.attr('width', classTitleBBox.width);\r\n    dv.attr('height', classTitleBBox.height);\r\n  }\r\n  maxHeight += classTitleBBox.height + rowPadding;\r\n  if (classTitleBBox.width > maxWidth) {\r\n    maxWidth = classTitleBBox.width;\r\n  }\r\n  const classAttributes = [];\r\n  node.classData.members.forEach((str) => {\r\n    const parsedInfo = parseMember(str);\r\n    let parsedText = parsedInfo.displayText;\r\n    if (getConfig().flowchart.htmlLabels) {\r\n      parsedText = parsedText.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    const lbl = labelContainer\r\n      .node()\r\n      .appendChild(\r\n        createLabel(\r\n          parsedText,\r\n          parsedInfo.cssStyle ? parsedInfo.cssStyle : node.labelStyle,\r\n          true,\r\n          true\r\n        )\r\n      );\r\n    let bbox = lbl.getBBox();\r\n    if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n      const div = lbl.children[0];\r\n      const dv = select(lbl);\r\n      bbox = div.getBoundingClientRect();\r\n      dv.attr('width', bbox.width);\r\n      dv.attr('height', bbox.height);\r\n    }\r\n    if (bbox.width > maxWidth) {\r\n      maxWidth = bbox.width;\r\n    }\r\n    maxHeight += bbox.height + rowPadding;\r\n    classAttributes.push(lbl);\r\n  });\r\n\r\n  maxHeight += lineHeight;\r\n\r\n  const classMethods = [];\r\n  node.classData.methods.forEach((str) => {\r\n    const parsedInfo = parseMember(str);\r\n    let displayText = parsedInfo.displayText;\r\n    if (getConfig().flowchart.htmlLabels) {\r\n      displayText = displayText.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    const lbl = labelContainer\r\n      .node()\r\n      .appendChild(\r\n        createLabel(\r\n          displayText,\r\n          parsedInfo.cssStyle ? parsedInfo.cssStyle : node.labelStyle,\r\n          true,\r\n          true\r\n        )\r\n      );\r\n    let bbox = lbl.getBBox();\r\n    if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n      const div = lbl.children[0];\r\n      const dv = select(lbl);\r\n      bbox = div.getBoundingClientRect();\r\n      dv.attr('width', bbox.width);\r\n      dv.attr('height', bbox.height);\r\n    }\r\n    if (bbox.width > maxWidth) {\r\n      maxWidth = bbox.width;\r\n    }\r\n    maxHeight += bbox.height + rowPadding;\r\n\r\n    classMethods.push(lbl);\r\n  });\r\n\r\n  maxHeight += lineHeight;\r\n\r\n  // 2. Position the labels\r\n\r\n  // position the interface label\r\n  if (hasInterface) {\r\n    let diffX = (maxWidth - interfaceBBox.width) / 2;\r\n    select(interfaceLabel).attr(\r\n      'transform',\r\n      'translate( ' + ((-1 * maxWidth) / 2 + diffX) + ', ' + (-1 * maxHeight) / 2 + ')'\r\n    );\r\n    verticalPos = interfaceBBox.height + rowPadding;\r\n  }\r\n  // Positin the class title label\r\n  let diffX = (maxWidth - classTitleBBox.width) / 2;\r\n  select(classTitleLabel).attr(\r\n    'transform',\r\n    'translate( ' +\r\n      ((-1 * maxWidth) / 2 + diffX) +\r\n      ', ' +\r\n      ((-1 * maxHeight) / 2 + verticalPos) +\r\n      ')'\r\n  );\r\n  verticalPos += classTitleBBox.height + rowPadding;\r\n\r\n  topLine\r\n    .attr('class', 'divider')\r\n    .attr('x1', -maxWidth / 2 - halfPadding)\r\n    .attr('x2', maxWidth / 2 + halfPadding)\r\n    .attr('y1', -maxHeight / 2 - halfPadding + lineHeight + verticalPos)\r\n    .attr('y2', -maxHeight / 2 - halfPadding + lineHeight + verticalPos);\r\n\r\n  verticalPos += lineHeight;\r\n\r\n  classAttributes.forEach((lbl) => {\r\n    select(lbl).attr(\r\n      'transform',\r\n      'translate( ' +\r\n        -maxWidth / 2 +\r\n        ', ' +\r\n        ((-1 * maxHeight) / 2 + verticalPos + lineHeight / 2) +\r\n        ')'\r\n    );\r\n    verticalPos += classTitleBBox.height + rowPadding;\r\n  });\r\n\r\n  verticalPos += lineHeight;\r\n  bottomLine\r\n    .attr('class', 'divider')\r\n    .attr('x1', -maxWidth / 2 - halfPadding)\r\n    .attr('x2', maxWidth / 2 + halfPadding)\r\n    .attr('y1', -maxHeight / 2 - halfPadding + lineHeight + verticalPos)\r\n    .attr('y2', -maxHeight / 2 - halfPadding + lineHeight + verticalPos);\r\n\r\n  verticalPos += lineHeight;\r\n\r\n  classMethods.forEach((lbl) => {\r\n    select(lbl).attr(\r\n      'transform',\r\n      'translate( ' + -maxWidth / 2 + ', ' + ((-1 * maxHeight) / 2 + verticalPos) + ')'\r\n    );\r\n    verticalPos += classTitleBBox.height + rowPadding;\r\n  });\r\n  //\r\n  // let bbox;\r\n  // if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n  //   const div = interfaceLabel.children[0];\r\n  //   const dv = select(interfaceLabel);\r\n  //   bbox = div.getBoundingClientRect();\r\n  //   dv.attr('width', bbox.width);\r\n  //   dv.attr('height', bbox.height);\r\n  // }\r\n  // bbox = labelContainer.getBBox();\r\n\r\n  // log.info('Text 2', text2);\r\n  // const textRows = text2.slice(1, text2.length);\r\n  // let titleBox = text.getBBox();\r\n  // const descr = label\r\n  //   .node()\r\n  //   .appendChild(createLabel(textRows.join('<br/>'), node.labelStyle, true, true));\r\n\r\n  // if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n  //   const div = descr.children[0];\r\n  //   const dv = select(descr);\r\n  //   bbox = div.getBoundingClientRect();\r\n  //   dv.attr('width', bbox.width);\r\n  //   dv.attr('height', bbox.height);\r\n  // }\r\n  // // bbox = label.getBBox();\r\n  // // log.info(descr);\r\n  // select(descr).attr(\r\n  //   'transform',\r\n  //   'translate( ' +\r\n  //     // (titleBox.width - bbox.width) / 2 +\r\n  //     (bbox.width > titleBox.width ? 0 : (titleBox.width - bbox.width) / 2) +\r\n  //     ', ' +\r\n  //     (titleBox.height + halfPadding + 5) +\r\n  //     ')'\r\n  // );\r\n  // select(text).attr(\r\n  //   'transform',\r\n  //   'translate( ' +\r\n  //     // (titleBox.width - bbox.width) / 2 +\r\n  //     (bbox.width < titleBox.width ? 0 : -(titleBox.width - bbox.width) / 2) +\r\n  //     ', ' +\r\n  //     0 +\r\n  //     ')'\r\n  // );\r\n  // // Get the size of the label\r\n\r\n  // // Bounding box for title and text\r\n  // bbox = label.node().getBBox();\r\n\r\n  // // Center the label\r\n  // label.attr(\r\n  //   'transform',\r\n  //   'translate(' + -bbox.width / 2 + ', ' + (-bbox.height / 2 - halfPadding + 3) + ')'\r\n  // );\r\n\r\n  rect\r\n    .attr('class', 'outer title-state')\r\n    .attr('x', -maxWidth / 2 - halfPadding)\r\n    .attr('y', -(maxHeight / 2) - halfPadding)\r\n    .attr('width', maxWidth + node.padding)\r\n    .attr('height', maxHeight + node.padding);\r\n\r\n  // innerLine\r\n  //   .attr('class', 'divider')\r\n  //   .attr('x1', -bbox.width / 2 - halfPadding)\r\n  //   .attr('x2', bbox.width / 2 + halfPadding)\r\n  //   .attr('y1', -bbox.height / 2 - halfPadding + titleBox.height + halfPadding)\r\n  //   .attr('y2', -bbox.height / 2 - halfPadding + titleBox.height + halfPadding);\r\n\r\n  updateNodeBounds(node, rect);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.rect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nconst shapes = {\r\n  question,\r\n  rect,\r\n  rectWithTitle,\r\n  choice,\r\n  circle,\r\n  doublecircle,\r\n  stadium,\r\n  hexagon,\r\n  rect_left_inv_arrow,\r\n  lean_right,\r\n  lean_left,\r\n  trapezoid,\r\n  inv_trapezoid,\r\n  rect_right_inv_arrow,\r\n  cylinder,\r\n  start,\r\n  end,\r\n  note,\r\n  subroutine,\r\n  fork: forkJoin,\r\n  join: forkJoin,\r\n  class_box,\r\n};\r\n\r\nlet nodeElems = {};\r\n\r\nexport const insertNode = (elem, node, dir) => {\r\n  let newEl;\r\n  let el;\r\n\r\n  // Add link when appropriate\r\n  if (node.link) {\r\n    let target;\r\n    if (getConfig().securityLevel === 'sandbox') {\r\n      target = '_top';\r\n    } else if (node.linkTarget) {\r\n      target = node.linkTarget || '_blank';\r\n    }\r\n    newEl = elem.insert('svg:a').attr('xlink:href', node.link).attr('target', target);\r\n    el = shapes[node.shape](newEl, node, dir);\r\n  } else {\r\n    el = shapes[node.shape](elem, node, dir);\r\n    newEl = el;\r\n  }\r\n  if (node.tooltip) {\r\n    el.attr('title', node.tooltip);\r\n  }\r\n  if (node.class) {\r\n    el.attr('class', 'node default ' + node.class);\r\n  }\r\n\r\n  nodeElems[node.id] = newEl;\r\n\r\n  if (node.haveCallback) {\r\n    nodeElems[node.id].attr('class', nodeElems[node.id].attr('class') + ' clickable');\r\n  }\r\n};\r\nexport const setNodeElem = (elem, node) => {\r\n  nodeElems[node.id] = elem;\r\n};\r\nexport const clear = () => {\r\n  nodeElems = {};\r\n};\r\n\r\nexport const positionNode = (node) => {\r\n  const el = nodeElems[node.id];\r\n  log.trace(\r\n    'Transforming node',\r\n    node.diff,\r\n    node,\r\n    'translate(' + (node.x - node.width / 2 - 5) + ', ' + node.width / 2 + ')'\r\n  );\r\n  const padding = 8;\r\n  const diff = node.diff || 0;\r\n  if (node.clusterNode) {\r\n    el.attr(\r\n      'transform',\r\n      'translate(' +\r\n        (node.x + diff - node.width / 2) +\r\n        ', ' +\r\n        (node.y - node.height / 2 - padding) +\r\n        ')'\r\n    );\r\n  } else {\r\n    el.attr('transform', 'translate(' + node.x + ', ' + node.y + ')');\r\n  }\r\n  return diff;\r\n};\r\n","import { updateNodeBounds, labelHelper } from './util';\r\nimport { log } from '../../logger'; // eslint-disable-line\r\nimport intersect from '../intersect/index.js';\r\n\r\nconst note = (parent, node) => {\r\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, 'node ' + node.classes, true);\r\n\r\n  log.info('Classes = ', node.classes);\r\n  // add the rect\r\n  const rect = shapeSvg.insert('rect', ':first-child');\r\n\r\n  rect\r\n    .attr('rx', node.rx)\r\n    .attr('ry', node.ry)\r\n    .attr('x', -bbox.width / 2 - halfPadding)\r\n    .attr('y', -bbox.height / 2 - halfPadding)\r\n    .attr('width', bbox.width + node.padding)\r\n    .attr('height', bbox.height + node.padding);\r\n\r\n  updateNodeBounds(node, rect);\r\n\r\n  node.intersect = function (point) {\r\n    return intersect.rect(node, point);\r\n  };\r\n\r\n  return shapeSvg;\r\n};\r\n\r\nexport default note;\r\n","import createLabel from '../createLabel';\r\nimport { getConfig } from '../../config';\r\nimport { decodeEntities } from '../../mermaidAPI';\r\nimport { select } from 'd3';\r\nimport { evaluate, sanitizeText } from '../../diagrams/common/common';\r\nexport const labelHelper = (parent, node, _classes, isNode) => {\r\n  let classes;\r\n  if (!_classes) {\r\n    classes = 'node default';\r\n  } else {\r\n    classes = _classes;\r\n  }\r\n  // Add outer g element\r\n  const shapeSvg = parent\r\n    .insert('g')\r\n    .attr('class', classes)\r\n    .attr('id', node.domId || node.id);\r\n\r\n  // Create the label and insert it after the rect\r\n  const label = shapeSvg.insert('g').attr('class', 'label').attr('style', node.labelStyle);\r\n\r\n  const labelText = typeof node.labelText === 'string' ? node.labelText : node.labelText[0];\r\n\r\n  const text = label\r\n    .node()\r\n    .appendChild(\r\n      createLabel(\r\n        sanitizeText(decodeEntities(labelText), getConfig()),\r\n        node.labelStyle,\r\n        false,\r\n        isNode\r\n      )\r\n    );\r\n\r\n  // Get the size of the label\r\n  let bbox = text.getBBox();\r\n\r\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    const div = text.children[0];\r\n    const dv = select(text);\r\n    bbox = div.getBoundingClientRect();\r\n    dv.attr('width', bbox.width);\r\n    dv.attr('height', bbox.height);\r\n  }\r\n\r\n  const halfPadding = node.padding / 2;\r\n\r\n  // Center the label\r\n  label.attr('transform', 'translate(' + -bbox.width / 2 + ', ' + -bbox.height / 2 + ')');\r\n\r\n  return { shapeSvg, bbox, halfPadding, label };\r\n};\r\n\r\nexport const updateNodeBounds = (node, element) => {\r\n  const bbox = element.node().getBBox();\r\n  node.width = bbox.width;\r\n  node.height = bbox.height;\r\n};\r\n\r\n/**\r\n * @param parent\r\n * @param w\r\n * @param h\r\n * @param points\r\n */\r\nexport function insertPolygonShape(parent, w, h, points) {\r\n  return parent\r\n    .insert('polygon', ':first-child')\r\n    .attr(\r\n      'points',\r\n      points\r\n        .map(function (d) {\r\n          return d.x + ',' + d.y;\r\n        })\r\n        .join(' ')\r\n    )\r\n    .attr('class', 'label-container')\r\n    .attr('transform', 'translate(' + -w / 2 + ',' + h / 2 + ')');\r\n}\r\n","import theme from './themes';\r\n/**\r\n * **Configuration methods in Mermaid version 8.6.0 have been updated, to learn more[[click\r\n * here](8.6.0_docs.md)].**\r\n *\r\n * ## **What follows are config instructions for older versions**\r\n *\r\n * These are the default options which can be overridden with the initialization call like so:\r\n *\r\n * **Example 1:**<pre> mermaid.initialize({ flowchart:{ htmlLabels: false } }); </pre>\r\n *\r\n * **Example 2:**<pre> <script> var config = { startOnLoad:true, flowchart:{ useMaxWidth:true,\r\n * htmlLabels:true, curve:'cardinal', },\r\n *\r\n *     securityLevel:'loose',\r\n *\r\n * }; mermaid.initialize(config); </script> </pre>\r\n *\r\n * A summary of all options and their defaults is found [here](#mermaidapi-configuration-defaults).\r\n * A description of each option follows below.\r\n *\r\n * @name Configuration\r\n */\r\nconst config = {\r\n  /**\r\n   * Theme , the CSS style sheet\r\n   *\r\n   * | Parameter | Description     | Type   | Required | Values                                         |\r\n   * | --------- | --------------- | ------ | -------- | ---------------------------------------------- |\r\n   * | theme     | Built in Themes | string | Optional | 'default', 'forest', 'dark', 'neutral', 'null' |\r\n   *\r\n   * **Notes:** To disable any pre-defined mermaid theme, use \"null\".<pre> \"theme\": \"forest\",\r\n   * \"themeCSS\": \".node rect { fill: red; }\" </pre>\r\n   */\r\n  theme: 'default',\r\n  themeVariables: theme['default'].getThemeVariables(),\r\n  themeCSS: undefined,\r\n  /* **maxTextSize** - The maximum allowed size of the users text diagram */\r\n  maxTextSize: 50000,\r\n  darkMode: false,\r\n\r\n  /**\r\n   * | Parameter  | Description                                            | Type   | Required | Values                      |\r\n   * | ---------- | ------------------------------------------------------ | ------ | -------- | --------------------------- |\r\n   * | fontFamily | specifies the font to be used in the rendered diagrams | string | Required | Any Possible CSS FontFamily |\r\n   *\r\n   * **Notes:** Default value: '\"trebuchet ms\", verdana, arial, sans-serif;'.\r\n   */\r\n  fontFamily: '\"trebuchet ms\", verdana, arial, sans-serif;',\r\n\r\n  /**\r\n   * | Parameter | Description                                           | Type             | Required | Values        |\r\n   * | --------- | ----------------------------------------------------- | ---------------- | -------- | ------------- |\r\n   * | logLevel  | This option decides the amount of logging to be used. | string \\| number | Required | 1, 2, 3, 4, 5 |\r\n   *\r\n   * **Notes:**\r\n   *\r\n   * - Debug: 1\r\n   * - Info: 2\r\n   * - Warn: 3\r\n   * - Error: 4\r\n   * - Fatal: 5 (default)\r\n   */\r\n  logLevel: 5,\r\n\r\n  /**\r\n   * | Parameter     | Description                       | Type   | Required | Values                          |\r\n   * | ------------- | --------------------------------- | ------ | -------- | ------------------------------- |\r\n   * | securitylevel | Level of trust for parsed diagram | string | Required | 'strict', 'loose', 'antiscript' |\r\n   *\r\n   * **Notes**:\r\n   *\r\n   * - **strict**: (**default**) tags in text are encoded, click functionality is disabled\r\n   * - **loose**: tags in text are allowed, click functionality is enabled\r\n   * - **antiscript**: html tags in text are allowed, (only script element is removed), click\r\n   *   functionality is enabled\r\n   */\r\n  securityLevel: 'strict',\r\n\r\n  /**\r\n   * | Parameter   | Description                                  | Type    | Required | Values      |\r\n   * | ----------- | -------------------------------------------- | ------- | -------- | ----------- |\r\n   * | startOnLoad | Dictates whether mermaid starts on Page load | boolean | Required | true, false |\r\n   *\r\n   * **Notes:** Default value: true\r\n   */\r\n  startOnLoad: true,\r\n\r\n  /**\r\n   * | Parameter           | Description                                                                  | Type    | Required | Values      |\r\n   * | ------------------- | ---------------------------------------------------------------------------- | ------- | -------- | ----------- |\r\n   * | arrowMarkerAbsolute | Controls whether or arrow markers in html code are absolute paths or anchors | boolean | Required | true, false |\r\n   *\r\n   * **Notes**:\r\n   *\r\n   * This matters if you are using base tag settings.\r\n   *\r\n   * Default value: false\r\n   */\r\n  arrowMarkerAbsolute: false,\r\n\r\n  /**\r\n   * This option controls which currentConfig keys are considered _secure_ and can only be changed\r\n   * via call to mermaidAPI.initialize. Calls to mermaidAPI.reinitialize cannot make changes to the\r\n   * `secure` keys in the current currentConfig. This prevents malicious graph directives from\r\n   * overriding a site's default security.\r\n   *\r\n   * **Notes**:\r\n   *\r\n   * Default value: ['secure', 'securityLevel', 'startOnLoad', 'maxTextSize']\r\n   */\r\n  secure: ['secure', 'securityLevel', 'startOnLoad', 'maxTextSize'],\r\n\r\n  /**\r\n   * This option controls if the generated ids of nodes in the SVG are generated randomly or based\r\n   * on a seed. If set to false, the IDs are generated based on the current date and thus are not\r\n   * deterministic. This is the default behaviour.\r\n   *\r\n   * **Notes**:\r\n   *\r\n   * This matters if your files are checked into sourcecontrol e.g. git and should not change unless\r\n   * content is changed.\r\n   *\r\n   * Default value: false\r\n   */\r\n  deterministicIds: false,\r\n\r\n  /**\r\n   * This option is the optional seed for deterministic ids. if set to undefined but\r\n   * deterministicIds is true, a simple number iterator is used. You can set this attribute to base\r\n   * the seed on a static string.\r\n   */\r\n  deterministicIDSeed: undefined,\r\n\r\n  /** The object containing configurations specific for flowcharts */\r\n  flowchart: {\r\n    /**\r\n     * | Parameter      | Description                                     | Type    | Required | Values             |\r\n     * | -------------- | ----------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | diagramPadding | Amount of padding around the diagram as a whole | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * The amount of padding around the diagram as a whole so that embedded diagrams have margins,\r\n     * expressed in pixels\r\n     *\r\n     * Default value: 8\r\n     */\r\n    diagramPadding: 8,\r\n\r\n    /**\r\n     * | Parameter  | Description                                                                                  | Type    | Required | Values      |\r\n     * | ---------- | -------------------------------------------------------------------------------------------- | ------- | -------- | ----------- |\r\n     * | htmlLabels | Flag for setting whether or not a html tag should be used for rendering labels on the edges. | boolean | Required | true, false |\r\n     *\r\n     * **Notes:** Default value: true.\r\n     */\r\n    htmlLabels: true,\r\n\r\n    /**\r\n     * | Parameter   | Description                                         | Type    | Required | Values              |\r\n     * | ----------- | --------------------------------------------------- | ------- | -------- | ------------------- |\r\n     * | nodeSpacing | Defines the spacing between nodes on the same level | Integer | Required | Any positive Number |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Pertains to horizontal spacing for TB (top to bottom) or BT (bottom to top) graphs, and the\r\n     * vertical spacing for LR as well as RL graphs.**\r\n     *\r\n     * Default value: 50\r\n     */\r\n    nodeSpacing: 50,\r\n\r\n    /**\r\n     * | Parameter   | Description                                           | Type    | Required | Values              |\r\n     * | ----------- | ----------------------------------------------------- | ------- | -------- | ------------------- |\r\n     * | rankSpacing | Defines the spacing between nodes on different levels | Integer | Required | Any Positive Number |\r\n     *\r\n     * **Notes**:\r\n     *\r\n     * Pertains to vertical spacing for TB (top to bottom) or BT (bottom to top), and the horizontal\r\n     * spacing for LR as well as RL graphs.\r\n     *\r\n     * Default value 50\r\n     */\r\n    rankSpacing: 50,\r\n\r\n    /**\r\n     * | Parameter | Description                                        | Type   | Required | Values                        |\r\n     * | --------- | -------------------------------------------------- | ------ | -------- | ----------------------------- |\r\n     * | curve     | Defines how mermaid renders curves for flowcharts. | string | Required | 'basis', 'linear', 'cardinal' |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Default Value: 'basis'\r\n     */\r\n    curve: 'basis',\r\n    // Only used in new experimental rendering\r\n    // represents the padding between the labels and the shape\r\n    padding: 15,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See notes   | boolean | 4        | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set the height and width is set to 100% and is then scaling with the\r\n     * available space if not the absolute space required is used.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n\r\n    /**\r\n     * | Parameter       | Description | Type    | Required | Values                  |\r\n     * | --------------- | ----------- | ------- | -------- | ----------------------- |\r\n     * | defaultRenderer | See notes   | boolean | 4        | dagre-d3, dagre-wrapper |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Decides which rendering engine that is to be used for the rendering. Legal values are:\r\n     * dagre-d3 dagre-wrapper - wrapper for dagre implemented in mermaid\r\n     *\r\n     * Default value: 'dagre-d3'\r\n     */\r\n    defaultRenderer: 'dagre-d3',\r\n  },\r\n\r\n  /** The object containing configurations specific for sequence diagrams */\r\n  sequence: {\r\n    /**\r\n     * | Parameter       | Description                  | Type    | Required | Values             |\r\n     * | --------------- | ---------------------------- | ------- | -------- | ------------------ |\r\n     * | activationWidth | Width of the activation rect | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value :10\r\n     */\r\n    activationWidth: 10,\r\n\r\n    /**\r\n     * | Parameter      | Description                                          | Type    | Required | Values             |\r\n     * | -------------- | ---------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | diagramMarginX | Margin to the right and left of the sequence diagram | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 50\r\n     */\r\n    diagramMarginX: 50,\r\n\r\n    /**\r\n     * | Parameter      | Description                                       | Type    | Required | Values             |\r\n     * | -------------- | ------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | diagramMarginY | Margin to the over and under the sequence diagram | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 10\r\n     */\r\n    diagramMarginY: 10,\r\n\r\n    /**\r\n     * | Parameter   | Description           | Type    | Required | Values             |\r\n     * | ----------- | --------------------- | ------- | -------- | ------------------ |\r\n     * | actorMargin | Margin between actors | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 50\r\n     */\r\n    actorMargin: 50,\r\n\r\n    /**\r\n     * | Parameter | Description          | Type    | Required | Values             |\r\n     * | --------- | -------------------- | ------- | -------- | ------------------ |\r\n     * | width     | Width of actor boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 150\r\n     */\r\n    width: 150,\r\n\r\n    /**\r\n     * | Parameter | Description           | Type    | Required | Values             |\r\n     * | --------- | --------------------- | ------- | -------- | ------------------ |\r\n     * | height    | Height of actor boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 65\r\n     */\r\n    height: 65,\r\n\r\n    /**\r\n     * | Parameter | Description              | Type    | Required | Values             |\r\n     * | --------- | ------------------------ | ------- | -------- | ------------------ |\r\n     * | boxMargin | Margin around loop boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 10\r\n     */\r\n    boxMargin: 10,\r\n\r\n    /**\r\n     * | Parameter     | Description                                  | Type    | Required | Values             |\r\n     * | ------------- | -------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | boxTextMargin | Margin around the text in loop/alt/opt boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 5\r\n     */\r\n    boxTextMargin: 5,\r\n\r\n    /**\r\n     * | Parameter  | Description         | Type    | Required | Values             |\r\n     * | ---------- | ------------------- | ------- | -------- | ------------------ |\r\n     * | noteMargin | margin around notes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 10\r\n     */\r\n    noteMargin: 10,\r\n\r\n    /**\r\n     * | Parameter     | Description            | Type    | Required | Values             |\r\n     * | ------------- | ---------------------- | ------- | -------- | ------------------ |\r\n     * | messageMargin | Space between messages | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 35\r\n     */\r\n    messageMargin: 35,\r\n\r\n    /**\r\n     * | Parameter    | Description                 | Type   | Required | Values                    |\r\n     * | ------------ | --------------------------- | ------ | -------- | ------------------------- |\r\n     * | messageAlign | Multiline message alignment | string | Required | 'left', 'center', 'right' |\r\n     *\r\n     * **Notes:** Default value: 'center'\r\n     */\r\n    messageAlign: 'center',\r\n\r\n    /**\r\n     * | Parameter    | Description                 | Type    | Required | Values      |\r\n     * | ------------ | --------------------------- | ------- | -------- | ----------- |\r\n     * | mirrorActors | Mirror actors under diagram | boolean | Required | true, false |\r\n     *\r\n     * **Notes:** Default value: true\r\n     */\r\n    mirrorActors: true,\r\n\r\n    /**\r\n     * | Parameter  | Description                                                             | Type    | Required | Values      |\r\n     * | ---------- | ----------------------------------------------------------------------- | ------- | -------- | ----------- |\r\n     * | forceMenus | forces actor popup menus to always be visible (to support E2E testing). | Boolean | Required | True, False |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Default value: false.\r\n     */\r\n    forceMenus: false,\r\n\r\n    /**\r\n     * | Parameter       | Description                                | Type    | Required | Values             |\r\n     * | --------------- | ------------------------------------------ | ------- | -------- | ------------------ |\r\n     * | bottomMarginAdj | Prolongs the edge of the diagram downwards | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Depending on css styling this might need adjustment.\r\n     *\r\n     * Default value: 1\r\n     */\r\n    bottomMarginAdj: 1,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See Notes   | boolean | Required | true, false |\r\n     *\r\n     * **Notes:** When this flag is set to true, the height and width is set to 100% and is then\r\n     * scaling with the available space. If set to false, the absolute space required is used.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n\r\n    /**\r\n     * | Parameter   | Description                          | Type    | Required | Values      |\r\n     * | ----------- | ------------------------------------ | ------- | -------- | ----------- |\r\n     * | rightAngles | display curve arrows as right angles | boolean | Required | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * This will display arrows that start and begin at the same node as right angles, rather than a curve\r\n     *\r\n     * Default value: false\r\n     */\r\n    rightAngles: false,\r\n\r\n    /**\r\n     * | Parameter           | Description                     | Type    | Required | Values      |\r\n     * | ------------------- | ------------------------------- | ------- | -------- | ----------- |\r\n     * | showSequenceNumbers | This will show the node numbers | boolean | Required | true, false |\r\n     *\r\n     * **Notes:** Default value: false\r\n     */\r\n    showSequenceNumbers: false,\r\n\r\n    /**\r\n     * | Parameter     | Description                                        | Type    | Required | Values             |\r\n     * | ------------- | -------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | actorFontSize | This sets the font size of the actor's description | Integer | Require  | Any Positive Value |\r\n     *\r\n     * **Notes:** **Default value 14**..\r\n     */\r\n    actorFontSize: 14,\r\n\r\n    /**\r\n     * | Parameter       | Description                                          | Type   | Required | Values                      |\r\n     * | --------------- | ---------------------------------------------------- | ------ | -------- | --------------------------- |\r\n     * | actorFontFamily | This sets the font family of the actor's description | string | Required | Any Possible CSS FontFamily |\r\n     *\r\n     * **Notes:** Default value: \"'Open Sans\", sans-serif'\r\n     */\r\n    actorFontFamily: '\"Open Sans\", sans-serif',\r\n\r\n    /**\r\n     * This sets the font weight of the actor's description\r\n     *\r\n     * **Notes:** Default value: 400.\r\n     */\r\n    actorFontWeight: 400,\r\n\r\n    /**\r\n     * | Parameter    | Description                                     | Type    | Required | Values             |\r\n     * | ------------ | ----------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | noteFontSize | This sets the font size of actor-attached notes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 14\r\n     */\r\n    noteFontSize: 14,\r\n\r\n    /**\r\n     * | Parameter      | Description                                        | Type   | Required | Values                      |\r\n     * | -------------- | -------------------------------------------------- | ------ | -------- | --------------------------- |\r\n     * | noteFontFamily | This sets the font family of actor-attached notes. | string | Required | Any Possible CSS FontFamily |\r\n     *\r\n     * **Notes:** Default value: ''\"trebuchet ms\", verdana, arial, sans-serif'\r\n     */\r\n    noteFontFamily: '\"trebuchet ms\", verdana, arial, sans-serif',\r\n\r\n    /**\r\n     * This sets the font weight of the note's description\r\n     *\r\n     * **Notes:** Default value: 400\r\n     */\r\n    noteFontWeight: 400,\r\n\r\n    /**\r\n     * | Parameter | Description                                          | Type   | Required | Values                    |\r\n     * | --------- | ---------------------------------------------------- | ------ | -------- | ------------------------- |\r\n     * | noteAlign | This sets the text alignment of actor-attached notes | string | required | 'left', 'center', 'right' |\r\n     *\r\n     * **Notes:** Default value: 'center'\r\n     */\r\n    noteAlign: 'center',\r\n\r\n    /**\r\n     * | Parameter       | Description                               | Type    | Required | Values              |\r\n     * | --------------- | ----------------------------------------- | ------- | -------- | ------------------- |\r\n     * | messageFontSize | This sets the font size of actor messages | Integer | Required | Any Positive Number |\r\n     *\r\n     * **Notes:** Default value: 16\r\n     */\r\n    messageFontSize: 16,\r\n\r\n    /**\r\n     * | Parameter         | Description                                 | Type   | Required | Values                      |\r\n     * | ----------------- | ------------------------------------------- | ------ | -------- | --------------------------- |\r\n     * | messageFontFamily | This sets the font family of actor messages | string | Required | Any Possible CSS FontFamily |\r\n     *\r\n     * **Notes:** Default value: '\"trebuchet ms\", verdana, arial, sans-serif'\r\n     */\r\n    messageFontFamily: '\"trebuchet ms\", verdana, arial, sans-serif',\r\n\r\n    /**\r\n     * This sets the font weight of the message's description\r\n     *\r\n     * **Notes:** Default value: 400.\r\n     */\r\n    messageFontWeight: 400,\r\n\r\n    /**\r\n     * This sets the auto-wrap state for the diagram\r\n     *\r\n     * **Notes:** Default value: false.\r\n     */\r\n    wrap: false,\r\n\r\n    /**\r\n     * This sets the auto-wrap padding for the diagram (sides only)\r\n     *\r\n     * **Notes:** Default value: 0.\r\n     */\r\n    wrapPadding: 10,\r\n\r\n    /**\r\n     * This sets the width of the loop-box (loop, alt, opt, par)\r\n     *\r\n     * **Notes:** Default value: 50.\r\n     */\r\n    labelBoxWidth: 50,\r\n\r\n    /**\r\n     * This sets the height of the loop-box (loop, alt, opt, par)\r\n     *\r\n     * **Notes:** Default value: 20.\r\n     */\r\n    labelBoxHeight: 20,\r\n\r\n    messageFont: function () {\r\n      return {\r\n        fontFamily: this.messageFontFamily,\r\n        fontSize: this.messageFontSize,\r\n        fontWeight: this.messageFontWeight,\r\n      };\r\n    },\r\n    noteFont: function () {\r\n      return {\r\n        fontFamily: this.noteFontFamily,\r\n        fontSize: this.noteFontSize,\r\n        fontWeight: this.noteFontWeight,\r\n      };\r\n    },\r\n    actorFont: function () {\r\n      return {\r\n        fontFamily: this.actorFontFamily,\r\n        fontSize: this.actorFontSize,\r\n        fontWeight: this.actorFontWeight,\r\n      };\r\n    },\r\n  },\r\n\r\n  /** The object containing configurations specific for gantt diagrams */\r\n  gantt: {\r\n    /**\r\n     * ### titleTopMargin\r\n     *\r\n     * | Parameter      | Description                                    | Type    | Required | Values             |\r\n     * | -------------- | ---------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | titleTopMargin | Margin top for the text over the gantt diagram | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 25\r\n     */\r\n    titleTopMargin: 25,\r\n\r\n    /**\r\n     * | Parameter | Description                         | Type    | Required | Values             |\r\n     * | --------- | ----------------------------------- | ------- | -------- | ------------------ |\r\n     * | barHeight | The height of the bars in the graph | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 20\r\n     */\r\n    barHeight: 20,\r\n\r\n    /**\r\n     * | Parameter | Description                                                      | Type    | Required | Values             |\r\n     * | --------- | ---------------------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | barGap    | The margin between the different activities in the gantt diagram | Integer | Optional | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 4\r\n     */\r\n    barGap: 4,\r\n\r\n    /**\r\n     * | Parameter  | Description                                                                | Type    | Required | Values             |\r\n     * | ---------- | -------------------------------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | topPadding | Margin between title and gantt diagram and between axis and gantt diagram. | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 50\r\n     */\r\n    topPadding: 50,\r\n\r\n    /**\r\n     * | Parameter    | Description                                                             | Type    | Required | Values             |\r\n     * | ------------ | ----------------------------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | rightPadding | The space allocated for the section name to the right of the activities | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 75\r\n     */\r\n    rightPadding: 75,\r\n\r\n    /**\r\n     * | Parameter   | Description                                                            | Type    | Required | Values             |\r\n     * | ----------- | ---------------------------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | leftPadding | The space allocated for the section name to the left of the activities | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 75\r\n     */\r\n    leftPadding: 75,\r\n\r\n    /**\r\n     * | Parameter            | Description                                  | Type    | Required | Values             |\r\n     * | -------------------- | -------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | gridLineStartPadding | Vertical starting position of the grid lines | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 35\r\n     */\r\n    gridLineStartPadding: 35,\r\n\r\n    /**\r\n     * | Parameter | Description | Type    | Required | Values             |\r\n     * | --------- | ----------- | ------- | -------- | ------------------ |\r\n     * | fontSize  | Font size   | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 11\r\n     */\r\n    fontSize: 11,\r\n\r\n    /**\r\n     * | Parameter       | Description            | Type    | Required | Values             |\r\n     * | --------------- | ---------------------- | ------- | -------- | ------------------ |\r\n     * | sectionFontSize | Font size for sections | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 11\r\n     */\r\n    sectionFontSize: 11,\r\n\r\n    /**\r\n     * | Parameter           | Description                              | Type    | Required | Values             |\r\n     * | ------------------- | ---------------------------------------- | ------- | -------- | ------------------ |\r\n     * | numberSectionStyles | The number of alternating section styles | Integer | 4        | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 4\r\n     */\r\n    numberSectionStyles: 4,\r\n\r\n    /**\r\n     * | Parameter  | Description                 | Type | Required | Values           |\r\n     * | ---------- | --------------------------- | ---- | -------- | ---------------- |\r\n     * | axisFormat | Datetime format of the axis | 3    | Required | Date in yy-mm-dd |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * This might need adjustment to match your locale and preferences\r\n     *\r\n     * Default value: '%Y-%m-%d'.\r\n     */\r\n    axisFormat: '%Y-%m-%d',\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See notes   | boolean | 4        | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set the height and width is set to 100% and is then scaling with the\r\n     * available space if not the absolute space required is used.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n\r\n    /**\r\n     * | Parameter | Description | Type    | Required | Values      |\r\n     * | --------- | ----------- | ------- | -------- | ----------- |\r\n     * | topAxis   | See notes   | Boolean | 4        | True, False |\r\n     *\r\n     * **Notes:** when this flag is set date labels will be added to the top of the chart\r\n     *\r\n     * **Default value false**.\r\n     */\r\n    topAxis: false,\r\n\r\n    useWidth: undefined,\r\n  },\r\n\r\n  /** The object containing configurations specific for journey diagrams */\r\n  journey: {\r\n    /**\r\n     * | Parameter      | Description                                          | Type    | Required | Values             |\r\n     * | -------------- | ---------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | diagramMarginX | Margin to the right and left of the sequence diagram | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 50\r\n     */\r\n    diagramMarginX: 50,\r\n\r\n    /**\r\n     * | Parameter      | Description                                        | Type    | Required | Values             |\r\n     * | -------------- | -------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | diagramMarginY | Margin to the over and under the sequence diagram. | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 10\r\n     */\r\n    diagramMarginY: 10,\r\n\r\n    /**\r\n     * | Parameter   | Description           | Type    | Required | Values             |\r\n     * | ----------- | --------------------- | ------- | -------- | ------------------ |\r\n     * | actorMargin | Margin between actors | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 50\r\n     */\r\n    leftMargin: 150,\r\n\r\n    /**\r\n     * | Parameter | Description          | Type    | Required | Values             |\r\n     * | --------- | -------------------- | ------- | -------- | ------------------ |\r\n     * | width     | Width of actor boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 150\r\n     */\r\n    width: 150,\r\n\r\n    /**\r\n     * | Parameter | Description           | Type    | Required | Values             |\r\n     * | --------- | --------------------- | ------- | -------- | ------------------ |\r\n     * | height    | Height of actor boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 65\r\n     */\r\n    height: 50,\r\n\r\n    /**\r\n     * | Parameter | Description              | Type    | Required | Values             |\r\n     * | --------- | ------------------------ | ------- | -------- | ------------------ |\r\n     * | boxMargin | Margin around loop boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 10\r\n     */\r\n    boxMargin: 10,\r\n\r\n    /**\r\n     * | Parameter     | Description                                  | Type    | Required | Values             |\r\n     * | ------------- | -------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | boxTextMargin | Margin around the text in loop/alt/opt boxes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 5\r\n     */\r\n    boxTextMargin: 5,\r\n\r\n    /**\r\n     * | Parameter  | Description         | Type    | Required | Values             |\r\n     * | ---------- | ------------------- | ------- | -------- | ------------------ |\r\n     * | noteMargin | Margin around notes | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Default value: 10\r\n     */\r\n    noteMargin: 10,\r\n\r\n    /**\r\n     * | Parameter     | Description             | Type    | Required | Values             |\r\n     * | ------------- | ----------------------- | ------- | -------- | ------------------ |\r\n     * | messageMargin | Space between messages. | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Space between messages.\r\n     *\r\n     * Default value: 35\r\n     */\r\n    messageMargin: 35,\r\n\r\n    /**\r\n     * | Parameter    | Description                 | Type | Required | Values                    |\r\n     * | ------------ | --------------------------- | ---- | -------- | ------------------------- |\r\n     * | messageAlign | Multiline message alignment | 3    | 4        | 'left', 'center', 'right' |\r\n     *\r\n     * **Notes:** Default value: 'center'\r\n     */\r\n    messageAlign: 'center',\r\n\r\n    /**\r\n     * | Parameter       | Description                                | Type    | Required | Values             |\r\n     * | --------------- | ------------------------------------------ | ------- | -------- | ------------------ |\r\n     * | bottomMarginAdj | Prolongs the edge of the diagram downwards | Integer | 4        | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Depending on css styling this might need adjustment.\r\n     *\r\n     * Default value: 1\r\n     */\r\n    bottomMarginAdj: 1,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See notes   | boolean | 4        | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set the height and width is set to 100% and is then scaling with the\r\n     * available space if not the absolute space required is used.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n\r\n    /**\r\n     * | Parameter   | Description                       | Type | Required | Values      |\r\n     * | ----------- | --------------------------------- | ---- | -------- | ----------- |\r\n     * | rightAngles | Curved Arrows become Right Angles | 3    | 4        | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * This will display arrows that start and begin at the same node as right angles, rather than a curves\r\n     *\r\n     * Default value: false\r\n     */\r\n    rightAngles: false,\r\n    taskFontSize: 14,\r\n    taskFontFamily: '\"Open Sans\", sans-serif',\r\n    taskMargin: 50,\r\n    // width of activation box\r\n    activationWidth: 10,\r\n\r\n    // text placement as: tspan | fo | old only text as before\r\n    textPlacement: 'fo',\r\n    actorColours: ['#8FBC8F', '#7CFC00', '#00FFFF', '#20B2AA', '#B0E0E6', '#FFFFE0'],\r\n\r\n    sectionFills: ['#191970', '#8B008B', '#4B0082', '#2F4F4F', '#800000', '#8B4513', '#00008B'],\r\n    sectionColours: ['#fff'],\r\n  },\r\n  class: {\r\n    arrowMarkerAbsolute: false,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See notes   | boolean | 4        | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set the height and width is set to 100% and is then scaling with the\r\n     * available space if not the absolute space required is used.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n    /**\r\n     * | Parameter       | Description | Type    | Required | Values                  |\r\n     * | --------------- | ----------- | ------- | -------- | ----------------------- |\r\n     * | defaultRenderer | See notes   | boolean | 4        | dagre-d3, dagre-wrapper |\r\n     *\r\n     * **Notes**:\r\n     *\r\n     * Decides which rendering engine that is to be used for the rendering. Legal values are:\r\n     * dagre-d3 dagre-wrapper - wrapper for dagre implemented in mermaid\r\n     *\r\n     * Default value: 'dagre-d3'\r\n     */\r\n    defaultRenderer: 'dagre-wrapper',\r\n  },\r\n  state: {\r\n    dividerMargin: 10,\r\n    sizeUnit: 5,\r\n    padding: 8,\r\n    textHeight: 10,\r\n    titleShift: -15,\r\n    noteMargin: 10,\r\n    forkWidth: 70,\r\n    forkHeight: 7,\r\n    // Used\r\n    miniPadding: 2,\r\n    // Font size factor, this is used to guess the width of the edges labels before rendering by dagre\r\n    // layout. This might need updating if/when switching font\r\n    fontSizeFactor: 5.02,\r\n    fontSize: 24,\r\n    labelHeight: 16,\r\n    edgeLengthFactor: '20',\r\n    compositTitleSize: 35,\r\n    radius: 5,\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See notes   | boolean | 4        | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set the height and width is set to 100% and is then scaling with the\r\n     * available space if not the absolute space required is used.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n    /**\r\n     * | Parameter       | Description | Type    | Required | Values                  |\r\n     * | --------------- | ----------- | ------- | -------- | ----------------------- |\r\n     * | defaultRenderer | See notes   | boolean | 4        | dagre-d3, dagre-wrapper |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Decides which rendering engine that is to be used for the rendering. Legal values are:\r\n     * dagre-d3 dagre-wrapper - wrapper for dagre implemented in mermaid\r\n     *\r\n     * Default value: 'dagre-d3'\r\n     */\r\n    defaultRenderer: 'dagre-wrapper',\r\n  },\r\n\r\n  /** The object containing configurations specific for entity relationship diagrams */\r\n  er: {\r\n    /**\r\n     * | Parameter      | Description                                     | Type    | Required | Values             |\r\n     * | -------------- | ----------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | diagramPadding | Amount of padding around the diagram as a whole | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * The amount of padding around the diagram as a whole so that embedded diagrams have margins,\r\n     * expressed in pixels\r\n     *\r\n     * Default value: 20\r\n     */\r\n    diagramPadding: 20,\r\n\r\n    /**\r\n     * | Parameter       | Description                              | Type   | Required | Values                 |\r\n     * | --------------- | ---------------------------------------- | ------ | -------- | ---------------------- |\r\n     * | layoutDirection | Directional bias for layout of entities. | string | Required | \"TB\", \"BT\", \"LR\", \"RL\" |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * 'TB' for Top-Bottom, 'BT'for Bottom-Top, 'LR' for Left-Right, or 'RL' for Right to Left.\r\n     *\r\n     * T = top, B = bottom, L = left, and R = right.\r\n     *\r\n     * Default value: 'TB'\r\n     */\r\n    layoutDirection: 'TB',\r\n\r\n    /**\r\n     * | Parameter      | Description                        | Type    | Required | Values             |\r\n     * | -------------- | ---------------------------------- | ------- | -------- | ------------------ |\r\n     * | minEntityWidth | The minimum width of an entity box | Integer | Required | Any Positive Value |\r\n     *\r\n     * **Notes:** Expressed in pixels. Default value: 100\r\n     */\r\n    minEntityWidth: 100,\r\n\r\n    /**\r\n     * | Parameter       | Description                         | Type    | Required | Values             |\r\n     * | --------------- | ----------------------------------- | ------- | -------- | ------------------ |\r\n     * | minEntityHeight | The minimum height of an entity box | Integer | 4        | Any Positive Value |\r\n     *\r\n     * **Notes:** Expressed in pixels Default value: 75\r\n     */\r\n    minEntityHeight: 75,\r\n\r\n    /**\r\n     * | Parameter     | Description                                                 | Type    | Required | Values             |\r\n     * | ------------- | ----------------------------------------------------------- | ------- | -------- | ------------------ |\r\n     * | entityPadding | Minimum internal padding betweentext in box and box borders | Integer | 4        | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * The minimum internal padding betweentext in an entity box and the enclosing box borders,\r\n     * expressed in pixels.\r\n     *\r\n     * Default value: 15\r\n     */\r\n    entityPadding: 15,\r\n\r\n    /**\r\n     * | Parameter | Description                         | Type   | Required | Values               |\r\n     * | --------- | ----------------------------------- | ------ | -------- | -------------------- |\r\n     * | stroke    | Stroke color of box edges and lines | string | 4        | Any recognized color |\r\n     *\r\n     * **Notes:** Default value: 'gray'\r\n     */\r\n    stroke: 'gray',\r\n\r\n    /**\r\n     * | Parameter | Description                | Type   | Required | Values               |\r\n     * | --------- | -------------------------- | ------ | -------- | -------------------- |\r\n     * | fill      | Fill color of entity boxes | string | 4        | Any recognized color |\r\n     *\r\n     * **Notes:** Default value: 'honeydew'\r\n     */\r\n    fill: 'honeydew',\r\n\r\n    /**\r\n     * | Parameter | Description         | Type    | Required | Values             |\r\n     * | --------- | ------------------- | ------- | -------- | ------------------ |\r\n     * | fontSize  | Font Size in pixels | Integer |          | Any Positive Value |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * Font size (expressed as an integer representing a number of pixels) Default value: 12\r\n     */\r\n    fontSize: 12,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See Notes   | boolean | Required | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set to true, the diagram width is locked to 100% and scaled based on\r\n     * available space. If set to false, the diagram reserves its absolute width.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n  },\r\n\r\n  /** The object containing configurations specific for pie diagrams */\r\n  pie: {\r\n    useWidth: undefined,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See Notes   | boolean | Required | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set to true, the diagram width is locked to 100% and scaled based on\r\n     * available space. If set to false, the diagram reserves its absolute width.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n  },\r\n\r\n  /** The object containing configurations specific for req diagrams */\r\n  requirement: {\r\n    useWidth: undefined,\r\n\r\n    /**\r\n     * | Parameter   | Description | Type    | Required | Values      |\r\n     * | ----------- | ----------- | ------- | -------- | ----------- |\r\n     * | useMaxWidth | See Notes   | boolean | Required | true, false |\r\n     *\r\n     * **Notes:**\r\n     *\r\n     * When this flag is set to true, the diagram width is locked to 100% and scaled based on\r\n     * available space. If set to false, the diagram reserves its absolute width.\r\n     *\r\n     * Default value: true\r\n     */\r\n    useMaxWidth: true,\r\n\r\n    rect_fill: '#f9f9f9',\r\n    text_color: '#333',\r\n    rect_border_size: '0.5px',\r\n    rect_border_color: '#bbb',\r\n    rect_min_width: 200,\r\n    rect_min_height: 200,\r\n    fontSize: 14,\r\n    rect_padding: 10,\r\n    line_height: 20,\r\n  },\r\n  gitGraph: {\r\n    diagramPadding: 8,\r\n    nodeLabel: {\r\n      width: 75,\r\n      height: 100,\r\n      x: -25,\r\n      y: 0,\r\n    },\r\n    mainBranchName: 'main',\r\n    showCommitLabel: true,\r\n    showBranches: true,\r\n  },\r\n};\r\n\r\nconfig.class.arrowMarkerAbsolute = config.arrowMarkerAbsolute;\r\nconfig.gitGraph.arrowMarkerAbsolute = config.arrowMarkerAbsolute;\r\n\r\nconst keyify = (obj, prefix = '') =>\r\n  Object.keys(obj).reduce((res, el) => {\r\n    if (Array.isArray(obj[el])) {\r\n      return res;\r\n    } else if (typeof obj[el] === 'object' && obj[el] !== null) {\r\n      return [...res, prefix + el, ...keyify(obj[el], '')];\r\n    }\r\n    return [...res, prefix + el];\r\n  }, []);\r\n\r\nexport const configKeys = keyify(config, '');\r\nexport default config;\r\n","import { select } from 'd3';\r\nimport { log } from '../../logger';\r\nimport * as configApi from '../../config';\r\nimport common from '../common/common';\r\nimport utils from '../../utils';\r\nimport mermaidAPI from '../../mermaidAPI';\r\n\r\nconst MERMAID_DOM_ID_PREFIX = 'classid-';\r\n\r\nlet relations = [];\r\nlet classes = {};\r\nlet classCounter = 0;\r\n\r\nlet funs = [];\r\n\r\nconst sanitizeText = (txt) => common.sanitizeText(txt, configApi.getConfig());\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nconst splitClassNameAndType = function (id) {\r\n  let genericType = '';\r\n  let className = id;\r\n\r\n  if (id.indexOf('~') > 0) {\r\n    let split = id.split('~');\r\n    className = split[0];\r\n\r\n    genericType = common.sanitizeText(split[1], configApi.getConfig());\r\n  }\r\n\r\n  return { className: className, type: genericType };\r\n};\r\n\r\n/**\r\n * Function called by parser when a node definition has been found.\r\n *\r\n * @param id\r\n * @public\r\n */\r\nexport const addClass = function (id) {\r\n  let classId = splitClassNameAndType(id);\r\n  // Only add class if not exists\r\n  if (typeof classes[classId.className] !== 'undefined') return;\r\n\r\n  classes[classId.className] = {\r\n    id: classId.className,\r\n    type: classId.type,\r\n    cssClasses: [],\r\n    methods: [],\r\n    members: [],\r\n    annotations: [],\r\n    domId: MERMAID_DOM_ID_PREFIX + classId.className + '-' + classCounter,\r\n  };\r\n\r\n  classCounter++;\r\n};\r\n\r\n/**\r\n * Function to lookup domId from id in the graph definition.\r\n *\r\n * @param id\r\n * @public\r\n */\r\nexport const lookUpDomId = function (id) {\r\n  const classKeys = Object.keys(classes);\r\n  for (let i = 0; i < classKeys.length; i++) {\r\n    if (classes[classKeys[i]].id === id) {\r\n      return classes[classKeys[i]].domId;\r\n    }\r\n  }\r\n};\r\n\r\nexport const clear = function () {\r\n  relations = [];\r\n  classes = {};\r\n  funs = [];\r\n  funs.push(setupToolTips);\r\n};\r\n\r\nexport const getClass = function (id) {\r\n  return classes[id];\r\n};\r\nexport const getClasses = function () {\r\n  return classes;\r\n};\r\n\r\nexport const getRelations = function () {\r\n  return relations;\r\n};\r\n\r\nexport const addRelation = function (relation) {\r\n  log.debug('Adding relation: ' + JSON.stringify(relation));\r\n  addClass(relation.id1);\r\n  addClass(relation.id2);\r\n\r\n  relation.id1 = splitClassNameAndType(relation.id1).className;\r\n  relation.id2 = splitClassNameAndType(relation.id2).className;\r\n\r\n  relation.relationTitle1 = common.sanitizeText(\r\n    relation.relationTitle1.trim(),\r\n    configApi.getConfig()\r\n  );\r\n\r\n  relation.relationTitle2 = common.sanitizeText(\r\n    relation.relationTitle2.trim(),\r\n    configApi.getConfig()\r\n  );\r\n\r\n  relations.push(relation);\r\n};\r\n\r\n/**\r\n * Adds an annotation to the specified class Annotations mark special properties of the given type\r\n * (like 'interface' or 'service')\r\n *\r\n * @param className The class name\r\n * @param annotation The name of the annotation without any brackets\r\n * @public\r\n */\r\nexport const addAnnotation = function (className, annotation) {\r\n  const validatedClassName = splitClassNameAndType(className).className;\r\n  classes[validatedClassName].annotations.push(annotation);\r\n};\r\n\r\n/**\r\n * Adds a member to the specified class\r\n *\r\n * @param className The class name\r\n * @param member The full name of the member. If the member is enclosed in <<brackets>> it is\r\n *   treated as an annotation If the member is ending with a closing bracket ) it is treated as a\r\n *   method Otherwise the member will be treated as a normal property\r\n * @public\r\n */\r\nexport const addMember = function (className, member) {\r\n  const validatedClassName = splitClassNameAndType(className).className;\r\n  const theClass = classes[validatedClassName];\r\n\r\n  if (typeof member === 'string') {\r\n    // Member can contain white spaces, we trim them out\r\n    const memberString = member.trim();\r\n\r\n    if (memberString.startsWith('<<') && memberString.endsWith('>>')) {\r\n      // Remove leading and trailing brackets\r\n      // theClass.annotations.push(memberString.substring(2, memberString.length - 2));\r\n      theClass.annotations.push(sanitizeText(memberString.substring(2, memberString.length - 2)));\r\n    } else if (memberString.indexOf(')') > 0) {\r\n      theClass.methods.push(sanitizeText(memberString));\r\n    } else if (memberString) {\r\n      theClass.members.push(sanitizeText(memberString));\r\n    }\r\n  }\r\n};\r\n\r\nexport const addMembers = function (className, members) {\r\n  if (Array.isArray(members)) {\r\n    members.reverse();\r\n    members.forEach((member) => addMember(className, member));\r\n  }\r\n};\r\n\r\nexport const cleanupLabel = function (label) {\r\n  if (label.substring(0, 1) === ':') {\r\n    return common.sanitizeText(label.substr(1).trim(), configApi.getConfig());\r\n  } else {\r\n    return sanitizeText(label.trim());\r\n  }\r\n};\r\n\r\n/**\r\n * Called by parser when a special node is found, e.g. a clickable element.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param className Class to add\r\n */\r\nexport const setCssClass = function (ids, className) {\r\n  ids.split(',').forEach(function (_id) {\r\n    let id = _id;\r\n    if (_id[0].match(/\\d/)) id = MERMAID_DOM_ID_PREFIX + id;\r\n    if (typeof classes[id] !== 'undefined') {\r\n      classes[id].cssClasses.push(className);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Called by parser when a tooltip is found, e.g. a clickable element.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param tooltip Tooltip to add\r\n */\r\nconst setTooltip = function (ids, tooltip) {\r\n  const config = configApi.getConfig();\r\n  ids.split(',').forEach(function (id) {\r\n    if (typeof tooltip !== 'undefined') {\r\n      classes[id].tooltip = common.sanitizeText(tooltip, config);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Called by parser when a link is found. Adds the URL to the vertex data.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param linkStr URL to create a link for\r\n * @param target Target of the link, _blank by default as originally defined in the svgDraw.js file\r\n */\r\nexport const setLink = function (ids, linkStr, target) {\r\n  const config = configApi.getConfig();\r\n  ids.split(',').forEach(function (_id) {\r\n    let id = _id;\r\n    if (_id[0].match(/\\d/)) id = MERMAID_DOM_ID_PREFIX + id;\r\n    if (typeof classes[id] !== 'undefined') {\r\n      classes[id].link = utils.formatUrl(linkStr, config);\r\n      if (config.securityLevel === 'sandbox') {\r\n        classes[id].linkTarget = '_top';\r\n      } else if (typeof target === 'string') {\r\n        classes[id].linkTarget = sanitizeText(target);\r\n      } else {\r\n        classes[id].linkTarget = '_blank';\r\n      }\r\n    }\r\n  });\r\n  setCssClass(ids, 'clickable');\r\n};\r\n\r\n/**\r\n * Called by parser when a click definition is found. Registers an event handler.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param functionName Function to be called on click\r\n * @param functionArgs Function args the function should be called with\r\n */\r\nexport const setClickEvent = function (ids, functionName, functionArgs) {\r\n  ids.split(',').forEach(function (id) {\r\n    setClickFunc(id, functionName, functionArgs);\r\n    classes[id].haveCallback = true;\r\n  });\r\n  setCssClass(ids, 'clickable');\r\n};\r\n\r\nconst setClickFunc = function (domId, functionName, functionArgs) {\r\n  const config = configApi.getConfig();\r\n  let id = domId;\r\n  let elemId = lookUpDomId(id);\r\n\r\n  if (config.securityLevel !== 'loose') {\r\n    return;\r\n  }\r\n  if (typeof functionName === 'undefined') {\r\n    return;\r\n  }\r\n  if (typeof classes[id] !== 'undefined') {\r\n    let argList = [];\r\n    if (typeof functionArgs === 'string') {\r\n      /* Splits functionArgs by ',', ignoring all ',' in double quoted strings */\r\n      argList = functionArgs.split(/,(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/);\r\n      for (let i = 0; i < argList.length; i++) {\r\n        let item = argList[i].trim();\r\n        /* Removes all double quotes at the start and end of an argument */\r\n        /* This preserves all starting and ending whitespace inside */\r\n        if (item.charAt(0) === '\"' && item.charAt(item.length - 1) === '\"') {\r\n          item = item.substr(1, item.length - 2);\r\n        }\r\n        argList[i] = item;\r\n      }\r\n    }\r\n\r\n    /* if no arguments passed into callback, default to passing in id */\r\n    if (argList.length === 0) {\r\n      argList.push(elemId);\r\n    }\r\n\r\n    funs.push(function () {\r\n      const elem = document.querySelector(`[id=\"${elemId}\"]`);\r\n      if (elem !== null) {\r\n        elem.addEventListener(\r\n          'click',\r\n          function () {\r\n            utils.runFunc(functionName, ...argList);\r\n          },\r\n          false\r\n        );\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\nexport const bindFunctions = function (element) {\r\n  funs.forEach(function (fun) {\r\n    fun(element);\r\n  });\r\n};\r\n\r\nexport const lineType = {\r\n  LINE: 0,\r\n  DOTTED_LINE: 1,\r\n};\r\n\r\nexport const relationType = {\r\n  AGGREGATION: 0,\r\n  EXTENSION: 1,\r\n  COMPOSITION: 2,\r\n  DEPENDENCY: 3,\r\n};\r\n\r\nconst setupToolTips = function (element) {\r\n  let tooltipElem = select('.mermaidTooltip');\r\n  if ((tooltipElem._groups || tooltipElem)[0][0] === null) {\r\n    tooltipElem = select('body').append('div').attr('class', 'mermaidTooltip').style('opacity', 0);\r\n  }\r\n\r\n  const svg = select(element).select('svg');\r\n\r\n  const nodes = svg.selectAll('g.node');\r\n  nodes\r\n    .on('mouseover', function () {\r\n      const el = select(this);\r\n      const title = el.attr('title');\r\n      // Dont try to draw a tooltip if no data is provided\r\n      if (title === null) {\r\n        return;\r\n      }\r\n      const rect = this.getBoundingClientRect();\r\n\r\n      tooltipElem.transition().duration(200).style('opacity', '.9');\r\n      tooltipElem\r\n        .html(el.attr('title'))\r\n        .style('left', window.scrollX + rect.left + (rect.right - rect.left) / 2 + 'px')\r\n        .style('top', window.scrollY + rect.top - 14 + document.body.scrollTop + 'px');\r\n      el.classed('hover', true);\r\n    })\r\n    .on('mouseout', function () {\r\n      tooltipElem.transition().duration(500).style('opacity', 0);\r\n      const el = select(this);\r\n      el.classed('hover', false);\r\n    });\r\n};\r\nfuns.push(setupToolTips);\r\n\r\nlet direction = 'TB';\r\nconst getDirection = () => direction;\r\nconst setDirection = (dir) => {\r\n  direction = dir;\r\n};\r\n\r\nlet title = '';\r\n\r\nexport const setTitle = function (txt) {\r\n  let sanitizedText = sanitizeText(txt, configApi.getConfig());\r\n  title = sanitizedText;\r\n};\r\n\r\nexport const getTitle = function () {\r\n  return title;\r\n};\r\n\r\nlet accDescription = '';\r\n\r\nexport const setAccDescription = function (txt) {\r\n  let sanitizedText = sanitizeText(txt, configApi.getConfig());\r\n  accDescription = sanitizedText;\r\n};\r\n\r\nexport const getAccDescription = function () {\r\n  return accDescription;\r\n};\r\n\r\nexport default {\r\n  parseDirective,\r\n  setTitle,\r\n  getTitle,\r\n  getAccDescription,\r\n  setAccDescription,\r\n  getConfig: () => configApi.getConfig().class,\r\n  addClass,\r\n  bindFunctions,\r\n  clear,\r\n  getClass,\r\n  getClasses,\r\n  addAnnotation,\r\n  getRelations,\r\n  addRelation,\r\n  getDirection,\r\n  setDirection,\r\n  addMember,\r\n  addMembers,\r\n  cleanupLabel,\r\n  lineType,\r\n  relationType,\r\n  setClickEvent,\r\n  setCssClass,\r\n  setLink,\r\n  setTooltip,\r\n  lookUpDomId,\r\n};\r\n","import { select } from 'd3';\r\nimport dagre from 'dagre';\r\nimport graphlib from 'graphlib';\r\nimport { log } from '../../logger';\r\nimport classDb, { lookUpDomId } from './classDb';\r\nimport { parser } from './parser/classDiagram';\r\nimport svgDraw from './svgDraw';\r\nimport { getConfig } from '../../config';\r\nimport { render } from '../../dagre-wrapper/index.js';\r\n// import addHtmlLabel from 'dagre-d3/lib/label/add-html-label.js';\r\nimport { curveLinear } from 'd3';\r\nimport { interpolateToCurve, getStylesFromArray, configureSvgSize } from '../../utils';\r\nimport common from '../common/common';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nparser.yy = classDb;\r\n\r\nlet idCache = {};\r\nconst padding = 20;\r\n\r\nconst sanitizeText = (txt) => common.sanitizeText(txt, getConfig());\r\n\r\nconst conf = {\r\n  dividerMargin: 10,\r\n  padding: 5,\r\n  textHeight: 10,\r\n};\r\n\r\n/**\r\n * Function that adds the vertices found during parsing to the graph to be rendered.\r\n *\r\n * @param {Object<\r\n *   string,\r\n *   { cssClasses: string[]; text: string; id: string; type: string; domId: string }\r\n * >} classes\r\n *   Object containing the vertices.\r\n * @param {SVGGElement} g The graph that is to be drawn.\r\n */\r\nexport const addClasses = function (classes, g) {\r\n  // const svg = select(`[id=\"${svgId}\"]`);\r\n  const keys = Object.keys(classes);\r\n  log.info('keys:', keys);\r\n  log.info(classes);\r\n\r\n  // Iterate through each item in the vertex object (containing all the vertices found) in the graph definition\r\n  keys.forEach(function (id) {\r\n    const vertex = classes[id];\r\n\r\n    /**\r\n     * Variable for storing the classes for the vertex\r\n     *\r\n     * @type {string}\r\n     */\r\n    let cssClassStr = '';\r\n    if (vertex.cssClasses.length > 0) {\r\n      cssClassStr = cssClassStr + ' ' + vertex.cssClasses.join(' ');\r\n    }\r\n    // if (vertex.classes.length > 0) {\r\n    //   classStr = vertex.classes.join(' ');\r\n    // }\r\n\r\n    const styles = { labelStyle: '' }; //getStylesFromArray(vertex.styles);\r\n\r\n    // Use vertex id as text in the box if no text is provided by the graph definition\r\n    let vertexText = vertex.text !== undefined ? vertex.text : vertex.id;\r\n\r\n    // We create a SVG label, either by delegating to addHtmlLabel or manually\r\n    // let vertexNode;\r\n    // if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n    //   const node = {\r\n    //     label: vertexText.replace(\r\n    //       /fa[lrsb]?:fa-[\\w-]+/g,\r\n    //       s => `<i class='${s.replace(':', ' ')}'></i>`\r\n    //     )\r\n    //   };\r\n    //   vertexNode = addHtmlLabel(svg, node).node();\r\n    //   vertexNode.parentNode.removeChild(vertexNode);\r\n    // } else {\r\n    //   const svgLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n    //   svgLabel.setAttribute('style', styles.labelStyle.replace('color:', 'fill:'));\r\n\r\n    //   const rows = vertexText.split(common.lineBreakRegex);\r\n\r\n    //   for (let j = 0; j < rows.length; j++) {\r\n    //     const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\r\n    //     tspan.setAttributeNS('http://www.w3.org/XML/1998/namespace', 'xml:space', 'preserve');\r\n    //     tspan.setAttribute('dy', '1em');\r\n    //     tspan.setAttribute('x', '1');\r\n    //     tspan.textContent = rows[j];\r\n    //     svgLabel.appendChild(tspan);\r\n    //   }\r\n    //   vertexNode = svgLabel;\r\n    // }\r\n\r\n    let radious = 0;\r\n    let _shape = '';\r\n    // Set the shape based parameters\r\n    switch (vertex.type) {\r\n      case 'class':\r\n        _shape = 'class_box';\r\n        break;\r\n      default:\r\n        _shape = 'class_box';\r\n    }\r\n    // Add the node\r\n    g.setNode(vertex.id, {\r\n      labelStyle: styles.labelStyle,\r\n      shape: _shape,\r\n      labelText: sanitizeText(vertexText),\r\n      classData: vertex,\r\n      rx: radious,\r\n      ry: radious,\r\n      class: cssClassStr,\r\n      style: styles.style,\r\n      id: vertex.id,\r\n      domId: vertex.domId,\r\n      haveCallback: vertex.haveCallback,\r\n      link: vertex.link,\r\n      width: vertex.type === 'group' ? 500 : undefined,\r\n      type: vertex.type,\r\n      padding: getConfig().flowchart.padding,\r\n    });\r\n\r\n    log.info('setNode', {\r\n      labelStyle: styles.labelStyle,\r\n      shape: _shape,\r\n      labelText: vertexText,\r\n      rx: radious,\r\n      ry: radious,\r\n      class: cssClassStr,\r\n      style: styles.style,\r\n      id: vertex.id,\r\n      width: vertex.type === 'group' ? 500 : undefined,\r\n      type: vertex.type,\r\n      padding: getConfig().flowchart.padding,\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * Add edges to graph based on parsed graph defninition\r\n *\r\n * @param relations\r\n * @param {object} g The graph object\r\n */\r\nexport const addRelations = function (relations, g) {\r\n  let cnt = 0;\r\n\r\n  let defaultStyle;\r\n  let defaultLabelStyle;\r\n\r\n  // if (typeof relations.defaultStyle !== 'undefined') {\r\n  //   const defaultStyles = getStylesFromArray(relations.defaultStyle);\r\n  //   defaultStyle = defaultStyles.style;\r\n  //   defaultLabelStyle = defaultStyles.labelStyle;\r\n  // }\r\n\r\n  relations.forEach(function (edge) {\r\n    cnt++;\r\n    const edgeData = {};\r\n    //Set relationship style and line type\r\n    edgeData.classes = 'relation';\r\n    edgeData.pattern = edge.relation.lineType == 1 ? 'dashed' : 'solid';\r\n\r\n    edgeData.id = 'id' + cnt;\r\n    // Set link type for rendering\r\n    if (edge.type === 'arrow_open') {\r\n      edgeData.arrowhead = 'none';\r\n    } else {\r\n      edgeData.arrowhead = 'normal';\r\n    }\r\n\r\n    log.info(edgeData, edge);\r\n    //Set edge extra labels\r\n    //edgeData.startLabelLeft = edge.relationTitle1;\r\n    edgeData.startLabelRight = edge.relationTitle1 === 'none' ? '' : edge.relationTitle1;\r\n    edgeData.endLabelLeft = edge.relationTitle2 === 'none' ? '' : edge.relationTitle2;\r\n    //edgeData.endLabelRight = edge.relationTitle2;\r\n\r\n    //Set relation arrow types\r\n    edgeData.arrowTypeStart = getArrowMarker(edge.relation.type1);\r\n    edgeData.arrowTypeEnd = getArrowMarker(edge.relation.type2);\r\n    let style = '';\r\n    let labelStyle = '';\r\n\r\n    if (typeof edge.style !== 'undefined') {\r\n      const styles = getStylesFromArray(edge.style);\r\n      style = styles.style;\r\n      labelStyle = styles.labelStyle;\r\n    } else {\r\n      style = 'fill:none';\r\n      if (typeof defaultStyle !== 'undefined') {\r\n        style = defaultStyle;\r\n      }\r\n      if (typeof defaultLabelStyle !== 'undefined') {\r\n        labelStyle = defaultLabelStyle;\r\n      }\r\n    }\r\n\r\n    edgeData.style = style;\r\n    edgeData.labelStyle = labelStyle;\r\n\r\n    if (typeof edge.interpolate !== 'undefined') {\r\n      edgeData.curve = interpolateToCurve(edge.interpolate, curveLinear);\r\n    } else if (typeof relations.defaultInterpolate !== 'undefined') {\r\n      edgeData.curve = interpolateToCurve(relations.defaultInterpolate, curveLinear);\r\n    } else {\r\n      edgeData.curve = interpolateToCurve(conf.curve, curveLinear);\r\n    }\r\n\r\n    edge.text = edge.title;\r\n    if (typeof edge.text === 'undefined') {\r\n      if (typeof edge.style !== 'undefined') {\r\n        edgeData.arrowheadStyle = 'fill: #333';\r\n      }\r\n    } else {\r\n      edgeData.arrowheadStyle = 'fill: #333';\r\n      edgeData.labelpos = 'c';\r\n\r\n      if (getConfig().flowchart.htmlLabels) {\r\n        // eslint-disable-line\r\n        edgeData.labelType = 'html';\r\n        edgeData.label = '<span class=\"edgeLabel\">' + edge.text + '</span>';\r\n      } else {\r\n        edgeData.labelType = 'text';\r\n        edgeData.label = edge.text.replace(common.lineBreakRegex, '\\n');\r\n\r\n        if (typeof edge.style === 'undefined') {\r\n          edgeData.style = edgeData.style || 'stroke: #333; stroke-width: 1.5px;fill:none';\r\n        }\r\n\r\n        edgeData.labelStyle = edgeData.labelStyle.replace('color:', 'fill:');\r\n      }\r\n    }\r\n    // Add the edge to the graph\r\n    g.setEdge(edge.id1, edge.id2, edgeData, cnt);\r\n  });\r\n};\r\n\r\n/**\r\n * Gets the ID with the same label as in the cache\r\n *\r\n * @param {string} label The label to look for\r\n * @returns {string} The resulting ID\r\n */\r\nconst getGraphId = function (label) {\r\n  const foundEntry = Object.entries(idCache).find((entry) => entry[1].label === label);\r\n\r\n  if (foundEntry) {\r\n    return foundEntry[0];\r\n  }\r\n};\r\n\r\n/**\r\n * Merges the value of `conf` with the passed `cnf`\r\n *\r\n * @param {object} cnf Config to merge\r\n */\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n\r\n  keys.forEach(function (key) {\r\n    conf[key] = cnf[key];\r\n  });\r\n};\r\n\r\n/**\r\n * Draws a flowchart in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {string} text\r\n * @param {string} id\r\n */\r\nexport const draw = function (text, id) {\r\n  log.info('Drawing class - ', id);\r\n  classDb.clear();\r\n  // const parser = classDb.parser;\r\n  // parser.yy = classDb;\r\n\r\n  // Parse the graph definition\r\n  // try {\r\n  parser.parse(text);\r\n  // } catch (err) {\r\n  // log.debug('Parsing failed');\r\n  // }\r\n\r\n  // Fetch the default direction, use TD if none was found\r\n  //let dir = 'TD';\r\n\r\n  const conf = getConfig().flowchart;\r\n  const securityLevel = getConfig().securityLevel;\r\n  log.info('config:', conf);\r\n  const nodeSpacing = conf.nodeSpacing || 50;\r\n  const rankSpacing = conf.rankSpacing || 50;\r\n\r\n  // Create the input mermaid.graph\r\n  const g = new graphlib.Graph({\r\n    multigraph: true,\r\n    compound: true,\r\n  })\r\n    .setGraph({\r\n      rankdir: classDb.getDirection(),\r\n      nodesep: nodeSpacing,\r\n      ranksep: rankSpacing,\r\n      marginx: 8,\r\n      marginy: 8,\r\n    })\r\n    .setDefaultEdgeLabel(function () {\r\n      return {};\r\n    });\r\n\r\n  // let subG;\r\n  // const subGraphs = flowDb.getSubGraphs();\r\n  // log.info('Subgraphs - ', subGraphs);\r\n  // for (let i = subGraphs.length - 1; i >= 0; i--) {\r\n  //   subG = subGraphs[i];\r\n  //   log.info('Subgraph - ', subG);\r\n  //   flowDb.addVertex(subG.id, subG.title, 'group', undefined, subG.classes);\r\n  // }\r\n\r\n  // Fetch the verices/nodes and edges/links from the parsed graph definition\r\n  const classes = classDb.getClasses();\r\n  const relations = classDb.getRelations();\r\n\r\n  log.info(relations);\r\n  // let i = 0;\r\n  // for (i = subGraphs.length - 1; i >= 0; i--) {\r\n  //   subG = subGraphs[i];\r\n\r\n  //   selectAll('cluster').append('text');\r\n\r\n  //   for (let j = 0; j < subG.nodes.length; j++) {\r\n  //     g.setParent(subG.nodes[j], subG.id);\r\n  //   }\r\n  // }\r\n  addClasses(classes, g, id);\r\n  addRelations(relations, g);\r\n\r\n  // Add custom shapes\r\n  // flowChartShapes.addToRenderV2(addShape);\r\n\r\n  // Set up an SVG group so that we can translate the final graph.\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const svg = root.select(`[id=\"${id}\"]`);\r\n  svg.attr('xmlns:xlink', 'http://www.w3.org/1999/xlink');\r\n\r\n  // Run the renderer. This is what draws the final graph.\r\n  const element = root.select('#' + id + ' g');\r\n  render(element, g, ['aggregation', 'extension', 'composition', 'dependency'], 'classDiagram', id);\r\n\r\n  // element.selectAll('g.node').attr('title', function() {\r\n  //   return flowDb.getTooltip(this.id);\r\n  // });\r\n\r\n  const padding = 8;\r\n  const svgBounds = svg.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n  log.debug(\r\n    `new ViewBox 0 0 ${width} ${height}`,\r\n    `translate(${padding - g._label.marginx}, ${padding - g._label.marginy})`\r\n  );\r\n\r\n  configureSvgSize(svg, height, width, conf.useMaxWidth);\r\n\r\n  svg.attr('viewBox', `0 0 ${width} ${height}`);\r\n  svg\r\n    .select('g')\r\n    .attr('transform', `translate(${padding - g._label.marginx}, ${padding - svgBounds.y})`);\r\n\r\n  // Index nodes\r\n  // flowDb.indexNodes('subGraph' + i);\r\n\r\n  // Add label rects for non html labels\r\n  if (!conf.htmlLabels) {\r\n    const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n    const labels = doc.querySelectorAll('[id=\"' + id + '\"] .edgeLabel .label');\r\n    for (let k = 0; k < labels.length; k++) {\r\n      const label = labels[k];\r\n\r\n      // Get dimensions of label\r\n      const dim = label.getBBox();\r\n\r\n      const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n      rect.setAttribute('rx', 0);\r\n      rect.setAttribute('ry', 0);\r\n      rect.setAttribute('width', dim.width);\r\n      rect.setAttribute('height', dim.height);\r\n      // rect.setAttribute('style', 'fill:#e8e8e8;');\r\n\r\n      label.insertBefore(rect, label.firstChild);\r\n    }\r\n  }\r\n\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n  // If node has a link, wrap it in an anchor SVG object.\r\n  // const keys = Object.keys(classes);\r\n  // keys.forEach(function(key) {\r\n  //   const vertex = classes[key];\r\n\r\n  //   if (vertex.link) {\r\n  //     const node = select('#' + id + ' [id=\"' + key + '\"]');\r\n  //     if (node) {\r\n  //       const link = document.createElementNS('http://www.w3.org/2000/svg', 'a');\r\n  //       link.setAttributeNS('http://www.w3.org/2000/svg', 'class', vertex.classes.join(' '));\r\n  //       link.setAttributeNS('http://www.w3.org/2000/svg', 'href', vertex.link);\r\n  //       link.setAttributeNS('http://www.w3.org/2000/svg', 'rel', 'noopener');\r\n\r\n  //       const linkNode = node.insert(function() {\r\n  //         return link;\r\n  //       }, ':first-child');\r\n\r\n  //       const shape = node.select('.label-container');\r\n  //       if (shape) {\r\n  //         linkNode.append(function() {\r\n  //           return shape.node();\r\n  //         });\r\n  //       }\r\n\r\n  //       const label = node.select('.label');\r\n  //       if (label) {\r\n  //         linkNode.append(function() {\r\n  //           return label.node();\r\n  //         });\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // });\r\n};\r\n\r\n/**\r\n * Gets the arrow marker for a type index\r\n *\r\n * @param {number} type The type to look for\r\n * @returns {'aggregation' | 'extension' | 'composition' | 'dependency'} The arrow marker\r\n */\r\nfunction getArrowMarker(type) {\r\n  let marker;\r\n  switch (type) {\r\n    case 0:\r\n      marker = 'aggregation';\r\n      break;\r\n    case 1:\r\n      marker = 'extension';\r\n      break;\r\n    case 2:\r\n      marker = 'composition';\r\n      break;\r\n    case 3:\r\n      marker = 'dependency';\r\n      break;\r\n    default:\r\n      marker = 'none';\r\n  }\r\n  return marker;\r\n}\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","import { select } from 'd3';\r\nimport dagre from 'dagre';\r\nimport graphlib from 'graphlib';\r\nimport { log } from '../../logger';\r\nimport classDb, { lookUpDomId } from './classDb';\r\nimport { parser } from './parser/classDiagram';\r\nimport svgDraw from './svgDraw';\r\nimport { configureSvgSize } from '../../utils';\r\nimport { getConfig } from '../../config';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nparser.yy = classDb;\r\n\r\nlet idCache = {};\r\nconst padding = 20;\r\n\r\nconst conf = {\r\n  dividerMargin: 10,\r\n  padding: 5,\r\n  textHeight: 10,\r\n};\r\n\r\n/**\r\n * Gets the ID with the same label as in the cache\r\n *\r\n * @param {string} label The label to look for\r\n * @returns {string} The resulting ID\r\n */\r\nconst getGraphId = function (label) {\r\n  const foundEntry = Object.entries(idCache).find((entry) => entry[1].label === label);\r\n\r\n  if (foundEntry) {\r\n    return foundEntry[0];\r\n  }\r\n};\r\n\r\n/**\r\n * Setup arrow head and define the marker. The result is appended to the svg.\r\n *\r\n * @param {SVGSVGElement} elem The SVG element to append to\r\n */\r\nconst insertMarkers = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'extensionStart')\r\n    .attr('class', 'extension')\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 1,7 L18,13 V 1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'extensionEnd')\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 1,1 V 13 L18,7 Z'); // this is actual shape for arrowhead\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'compositionStart')\r\n    .attr('class', 'extension')\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'compositionEnd')\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'aggregationStart')\r\n    .attr('class', 'extension')\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'aggregationEnd')\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'dependencyStart')\r\n    .attr('class', 'extension')\r\n    .attr('refX', 0)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 190)\r\n    .attr('markerHeight', 240)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 5,7 L9,13 L1,7 L9,1 Z');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'dependencyEnd')\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L14,7 L9,1 Z');\r\n};\r\n\r\n/**\r\n * Merges the value of `conf` with the passed `cnf`\r\n *\r\n * @param {object} cnf Config to merge\r\n */\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n\r\n  keys.forEach(function (key) {\r\n    conf[key] = cnf[key];\r\n  });\r\n};\r\n\r\n/**\r\n * Draws a flowchart in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {string} text\r\n * @param {string} id\r\n */\r\nexport const draw = function (text, id) {\r\n  idCache = {};\r\n  parser.yy.clear();\r\n  parser.parse(text);\r\n\r\n  log.info('Rendering diagram ' + text);\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and ocument for when rendering in sanbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  // Fetch the default direction, use TD if none was found\r\n  const diagram = root.select(`[id='${id}']`);\r\n  diagram.attr('xmlns:xlink', 'http://www.w3.org/1999/xlink');\r\n  insertMarkers(diagram);\r\n\r\n  // Layout graph, Create a new directed graph\r\n  const g = new graphlib.Graph({\r\n    multigraph: true,\r\n  });\r\n\r\n  // Set an object for the graph label\r\n  g.setGraph({\r\n    isMultiGraph: true,\r\n  });\r\n\r\n  // Default to assigning a new object as a label for each new edge.\r\n  g.setDefaultEdgeLabel(function () {\r\n    return {};\r\n  });\r\n\r\n  const classes = classDb.getClasses();\r\n  const keys = Object.keys(classes);\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const classDef = classes[keys[i]];\r\n    const node = svgDraw.drawClass(diagram, classDef, conf);\r\n    idCache[node.id] = node;\r\n\r\n    // Add nodes to the graph. The first argument is the node id. The second is\r\n    // metadata about the node. In this case we're going to add labels to each of\r\n    // our nodes.\r\n    g.setNode(node.id, node);\r\n\r\n    log.info('Org height: ' + node.height);\r\n  }\r\n\r\n  const relations = classDb.getRelations();\r\n  relations.forEach(function (relation) {\r\n    log.info(\r\n      'tjoho' + getGraphId(relation.id1) + getGraphId(relation.id2) + JSON.stringify(relation)\r\n    );\r\n    g.setEdge(\r\n      getGraphId(relation.id1),\r\n      getGraphId(relation.id2),\r\n      {\r\n        relation: relation,\r\n      },\r\n      relation.title || 'DEFAULT'\r\n    );\r\n  });\r\n\r\n  dagre.layout(g);\r\n  g.nodes().forEach(function (v) {\r\n    if (typeof v !== 'undefined' && typeof g.node(v) !== 'undefined') {\r\n      log.debug('Node ' + v + ': ' + JSON.stringify(g.node(v)));\r\n      root\r\n        .select('#' + lookUpDomId(v))\r\n        .attr(\r\n          'transform',\r\n          'translate(' +\r\n            (g.node(v).x - g.node(v).width / 2) +\r\n            ',' +\r\n            (g.node(v).y - g.node(v).height / 2) +\r\n            ' )'\r\n        );\r\n    }\r\n  });\r\n\r\n  g.edges().forEach(function (e) {\r\n    if (typeof e !== 'undefined' && typeof g.edge(e) !== 'undefined') {\r\n      log.debug('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(g.edge(e)));\r\n      svgDraw.drawEdge(diagram, g.edge(e), g.edge(e).relation, conf);\r\n    }\r\n  });\r\n\r\n  const svgBounds = diagram.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n\r\n  configureSvgSize(diagram, height, width, conf.useMaxWidth);\r\n\r\n  // Ensure the viewBox includes the whole svgBounds area with extra space for padding\r\n  const vBox = `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`;\r\n  log.debug(`viewBox ${vBox}`);\r\n  diagram.attr('viewBox', vBox);\r\n  addSVGAccessibilityFields(parser.yy, diagram, id);\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `g.classGroup text {\r\n  fill: ${options.nodeBorder};\r\n  fill: ${options.classText};\r\n  stroke: none;\r\n  font-family: ${options.fontFamily};\r\n  font-size: 10px;\r\n\r\n  .title {\r\n    font-weight: bolder;\r\n  }\r\n\r\n}\r\n\r\n.nodeLabel, .edgeLabel {\r\n  color: ${options.classText};\r\n}\r\n.edgeLabel .label rect {\r\n  fill: ${options.mainBkg};\r\n}\r\n.label text {\r\n  fill: ${options.classText};\r\n}\r\n.edgeLabel .label span {\r\n  background: ${options.mainBkg};\r\n}\r\n\r\n.classTitle {\r\n  font-weight: bolder;\r\n}\r\n.node rect,\r\n  .node circle,\r\n  .node ellipse,\r\n  .node polygon,\r\n  .node path {\r\n    fill: ${options.mainBkg};\r\n    stroke: ${options.nodeBorder};\r\n    stroke-width: 1px;\r\n  }\r\n\r\n\r\n.divider {\r\n  stroke: ${options.nodeBorder};\r\n  stroke: 1;\r\n}\r\n\r\ng.clickable {\r\n  cursor: pointer;\r\n}\r\n\r\ng.classGroup rect {\r\n  fill: ${options.mainBkg};\r\n  stroke: ${options.nodeBorder};\r\n}\r\n\r\ng.classGroup line {\r\n  stroke: ${options.nodeBorder};\r\n  stroke-width: 1;\r\n}\r\n\r\n.classLabel .box {\r\n  stroke: none;\r\n  stroke-width: 0;\r\n  fill: ${options.mainBkg};\r\n  opacity: 0.5;\r\n}\r\n\r\n.classLabel .label {\r\n  fill: ${options.nodeBorder};\r\n  font-size: 10px;\r\n}\r\n\r\n.relation {\r\n  stroke: ${options.lineColor};\r\n  stroke-width: 1;\r\n  fill: none;\r\n}\r\n\r\n.dashed-line{\r\n  stroke-dasharray: 3;\r\n}\r\n\r\n#compositionStart, .composition {\r\n  fill: ${options.lineColor} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#compositionEnd, .composition {\r\n  fill: ${options.lineColor} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#dependencyStart, .dependency {\r\n  fill: ${options.lineColor} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#dependencyStart, .dependency {\r\n  fill: ${options.lineColor} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#extensionStart, .extension {\r\n  fill: ${options.lineColor} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#extensionEnd, .extension {\r\n  fill: ${options.lineColor} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#aggregationStart, .aggregation {\r\n  fill: ${options.mainBkg} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n#aggregationEnd, .aggregation {\r\n  fill: ${options.mainBkg} !important;\r\n  stroke: ${options.lineColor} !important;\r\n  stroke-width: 1;\r\n}\r\n\r\n.edgeTerminals {\r\n  font-size: 11px;\r\n}\r\n\r\n`;\r\n\r\nexport default getStyles;\r\n","import { line, curveBasis } from 'd3';\r\nimport { lookUpDomId, relationType } from './classDb';\r\nimport utils from '../../utils';\r\nimport { log } from '../../logger';\r\n\r\nlet edgeCount = 0;\r\nexport const drawEdge = function (elem, path, relation, conf) {\r\n  const getRelationType = function (type) {\r\n    switch (type) {\r\n      case relationType.AGGREGATION:\r\n        return 'aggregation';\r\n      case relationType.EXTENSION:\r\n        return 'extension';\r\n      case relationType.COMPOSITION:\r\n        return 'composition';\r\n      case relationType.DEPENDENCY:\r\n        return 'dependency';\r\n    }\r\n  };\r\n\r\n  path.points = path.points.filter((p) => !Number.isNaN(p.y));\r\n\r\n  // The data for our line\r\n  const lineData = path.points;\r\n\r\n  // This is the accessor function we talked about above\r\n  const lineFunction = line()\r\n    .x(function (d) {\r\n      return d.x;\r\n    })\r\n    .y(function (d) {\r\n      return d.y;\r\n    })\r\n    .curve(curveBasis);\r\n\r\n  const svgPath = elem\r\n    .append('path')\r\n    .attr('d', lineFunction(lineData))\r\n    .attr('id', 'edge' + edgeCount)\r\n    .attr('class', 'relation');\r\n  let url = '';\r\n  if (conf.arrowMarkerAbsolute) {\r\n    url =\r\n      window.location.protocol +\r\n      '//' +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      window.location.search;\r\n    url = url.replace(/\\(/g, '\\\\(');\r\n    url = url.replace(/\\)/g, '\\\\)');\r\n  }\r\n\r\n  if (relation.relation.lineType == 1) {\r\n    svgPath.attr('class', 'relation dashed-line');\r\n  }\r\n  if (relation.relation.type1 !== 'none') {\r\n    svgPath.attr(\r\n      'marker-start',\r\n      'url(' + url + '#' + getRelationType(relation.relation.type1) + 'Start' + ')'\r\n    );\r\n  }\r\n  if (relation.relation.type2 !== 'none') {\r\n    svgPath.attr(\r\n      'marker-end',\r\n      'url(' + url + '#' + getRelationType(relation.relation.type2) + 'End' + ')'\r\n    );\r\n  }\r\n\r\n  let x, y;\r\n  const l = path.points.length;\r\n  // Calculate Label position\r\n  let labelPosition = utils.calcLabelPosition(path.points);\r\n  x = labelPosition.x;\r\n  y = labelPosition.y;\r\n\r\n  let p1_card_x, p1_card_y;\r\n  let p2_card_x, p2_card_y;\r\n\r\n  if (l % 2 !== 0 && l > 1) {\r\n    let cardinality_1_point = utils.calcCardinalityPosition(\r\n      relation.relation.type1 !== 'none',\r\n      path.points,\r\n      path.points[0]\r\n    );\r\n    let cardinality_2_point = utils.calcCardinalityPosition(\r\n      relation.relation.type2 !== 'none',\r\n      path.points,\r\n      path.points[l - 1]\r\n    );\r\n\r\n    log.debug('cardinality_1_point ' + JSON.stringify(cardinality_1_point));\r\n    log.debug('cardinality_2_point ' + JSON.stringify(cardinality_2_point));\r\n\r\n    p1_card_x = cardinality_1_point.x;\r\n    p1_card_y = cardinality_1_point.y;\r\n    p2_card_x = cardinality_2_point.x;\r\n    p2_card_y = cardinality_2_point.y;\r\n  }\r\n\r\n  if (typeof relation.title !== 'undefined') {\r\n    const g = elem.append('g').attr('class', 'classLabel');\r\n    const label = g\r\n      .append('text')\r\n      .attr('class', 'label')\r\n      .attr('x', x)\r\n      .attr('y', y)\r\n      .attr('fill', 'red')\r\n      .attr('text-anchor', 'middle')\r\n      .text(relation.title);\r\n\r\n    window.label = label;\r\n    const bounds = label.node().getBBox();\r\n\r\n    g.insert('rect', ':first-child')\r\n      .attr('class', 'box')\r\n      .attr('x', bounds.x - conf.padding / 2)\r\n      .attr('y', bounds.y - conf.padding / 2)\r\n      .attr('width', bounds.width + conf.padding)\r\n      .attr('height', bounds.height + conf.padding);\r\n  }\r\n\r\n  log.info('Rendering relation ' + JSON.stringify(relation));\r\n  if (typeof relation.relationTitle1 !== 'undefined' && relation.relationTitle1 !== 'none') {\r\n    const g = elem.append('g').attr('class', 'cardinality');\r\n    g.append('text')\r\n      .attr('class', 'type1')\r\n      .attr('x', p1_card_x)\r\n      .attr('y', p1_card_y)\r\n      .attr('fill', 'black')\r\n      .attr('font-size', '6')\r\n      .text(relation.relationTitle1);\r\n  }\r\n  if (typeof relation.relationTitle2 !== 'undefined' && relation.relationTitle2 !== 'none') {\r\n    const g = elem.append('g').attr('class', 'cardinality');\r\n    g.append('text')\r\n      .attr('class', 'type2')\r\n      .attr('x', p2_card_x)\r\n      .attr('y', p2_card_y)\r\n      .attr('fill', 'black')\r\n      .attr('font-size', '6')\r\n      .text(relation.relationTitle2);\r\n  }\r\n\r\n  edgeCount++;\r\n};\r\n\r\n/**\r\n * Renders a class diagram\r\n *\r\n * @param {SVGSVGElement} elem The element to draw it into\r\n * @param classDef\r\n * @param conf\r\n * @todo Add more information in the JSDOC here\r\n */\r\nexport const drawClass = function (elem, classDef, conf) {\r\n  log.info('Rendering class ' + classDef);\r\n\r\n  const id = classDef.id;\r\n  const classInfo = {\r\n    id: id,\r\n    label: classDef.id,\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n\r\n  // add class group\r\n  const g = elem.append('g').attr('id', lookUpDomId(id)).attr('class', 'classGroup');\r\n\r\n  // add title\r\n  let title;\r\n  if (classDef.link) {\r\n    title = g\r\n      .append('svg:a')\r\n      .attr('xlink:href', classDef.link)\r\n      .attr('target', classDef.linkTarget)\r\n      .append('text')\r\n      .attr('y', conf.textHeight + conf.padding)\r\n      .attr('x', 0);\r\n  } else {\r\n    title = g\r\n      .append('text')\r\n      .attr('y', conf.textHeight + conf.padding)\r\n      .attr('x', 0);\r\n  }\r\n\r\n  // add annotations\r\n  let isFirst = true;\r\n  classDef.annotations.forEach(function (member) {\r\n    const titleText2 = title.append('tspan').text('' + member + '');\r\n    if (!isFirst) titleText2.attr('dy', conf.textHeight);\r\n    isFirst = false;\r\n  });\r\n\r\n  let classTitleString = classDef.id;\r\n\r\n  if (classDef.type !== undefined && classDef.type !== '') {\r\n    classTitleString += '<' + classDef.type + '>';\r\n  }\r\n\r\n  const classTitle = title.append('tspan').text(classTitleString).attr('class', 'title');\r\n\r\n  // If class has annotations the title needs to have an offset of the text height\r\n  if (!isFirst) classTitle.attr('dy', conf.textHeight);\r\n\r\n  const titleHeight = title.node().getBBox().height;\r\n\r\n  const membersLine = g\r\n    .append('line') // text label for the x axis\r\n    .attr('x1', 0)\r\n    .attr('y1', conf.padding + titleHeight + conf.dividerMargin / 2)\r\n    .attr('y2', conf.padding + titleHeight + conf.dividerMargin / 2);\r\n\r\n  const members = g\r\n    .append('text') // text label for the x axis\r\n    .attr('x', conf.padding)\r\n    .attr('y', titleHeight + conf.dividerMargin + conf.textHeight)\r\n    .attr('fill', 'white')\r\n    .attr('class', 'classText');\r\n\r\n  isFirst = true;\r\n  classDef.members.forEach(function (member) {\r\n    addTspan(members, member, isFirst, conf);\r\n    isFirst = false;\r\n  });\r\n\r\n  const membersBox = members.node().getBBox();\r\n\r\n  const methodsLine = g\r\n    .append('line') // text label for the x axis\r\n    .attr('x1', 0)\r\n    .attr('y1', conf.padding + titleHeight + conf.dividerMargin + membersBox.height)\r\n    .attr('y2', conf.padding + titleHeight + conf.dividerMargin + membersBox.height);\r\n\r\n  const methods = g\r\n    .append('text') // text label for the x axis\r\n    .attr('x', conf.padding)\r\n    .attr('y', titleHeight + 2 * conf.dividerMargin + membersBox.height + conf.textHeight)\r\n    .attr('fill', 'white')\r\n    .attr('class', 'classText');\r\n\r\n  isFirst = true;\r\n\r\n  classDef.methods.forEach(function (method) {\r\n    addTspan(methods, method, isFirst, conf);\r\n    isFirst = false;\r\n  });\r\n\r\n  const classBox = g.node().getBBox();\r\n  var cssClassStr = ' ';\r\n\r\n  if (classDef.cssClasses.length > 0) {\r\n    cssClassStr = cssClassStr + classDef.cssClasses.join(' ');\r\n  }\r\n\r\n  const rect = g\r\n    .insert('rect', ':first-child')\r\n    .attr('x', 0)\r\n    .attr('y', 0)\r\n    .attr('width', classBox.width + 2 * conf.padding)\r\n    .attr('height', classBox.height + conf.padding + 0.5 * conf.dividerMargin)\r\n    .attr('class', cssClassStr);\r\n\r\n  const rectWidth = rect.node().getBBox().width;\r\n\r\n  // Center title\r\n  // We subtract the width of each text element from the class box width and divide it by 2\r\n  title.node().childNodes.forEach(function (x) {\r\n    x.setAttribute('x', (rectWidth - x.getBBox().width) / 2);\r\n  });\r\n\r\n  if (classDef.tooltip) {\r\n    title.insert('title').text(classDef.tooltip);\r\n  }\r\n\r\n  membersLine.attr('x2', rectWidth);\r\n  methodsLine.attr('x2', rectWidth);\r\n\r\n  classInfo.width = rectWidth;\r\n  classInfo.height = classBox.height + conf.padding + 0.5 * conf.dividerMargin;\r\n\r\n  return classInfo;\r\n};\r\n\r\nexport const parseMember = function (text) {\r\n  const fieldRegEx = /^(\\+|-|~|#)?(\\w+)(~\\w+~|\\[\\])?\\s+(\\w+) *(\\*|\\$)?$/;\r\n  const methodRegEx = /^([+|\\-|~|#])?(\\w+) *\\( *(.*)\\) *(\\*|\\$)? *(\\w*[~|[\\]]*\\s*\\w*~?)$/;\r\n\r\n  let fieldMatch = text.match(fieldRegEx);\r\n  let methodMatch = text.match(methodRegEx);\r\n\r\n  if (fieldMatch && !methodMatch) {\r\n    return buildFieldDisplay(fieldMatch);\r\n  } else if (methodMatch) {\r\n    return buildMethodDisplay(methodMatch);\r\n  } else {\r\n    return buildLegacyDisplay(text);\r\n  }\r\n};\r\n\r\nconst buildFieldDisplay = function (parsedText) {\r\n  let cssStyle = '';\r\n  let displayText = '';\r\n\r\n  try {\r\n    let visibility = parsedText[1] ? parsedText[1].trim() : '';\r\n    let fieldType = parsedText[2] ? parsedText[2].trim() : '';\r\n    let genericType = parsedText[3] ? parseGenericTypes(parsedText[3].trim()) : '';\r\n    let fieldName = parsedText[4] ? parsedText[4].trim() : '';\r\n    let classifier = parsedText[5] ? parsedText[5].trim() : '';\r\n\r\n    displayText = visibility + fieldType + genericType + ' ' + fieldName;\r\n    cssStyle = parseClassifier(classifier);\r\n  } catch (err) {\r\n    displayText = parsedText;\r\n  }\r\n\r\n  return {\r\n    displayText: displayText,\r\n    cssStyle: cssStyle,\r\n  };\r\n};\r\n\r\nconst buildMethodDisplay = function (parsedText) {\r\n  let cssStyle = '';\r\n  let displayText = '';\r\n\r\n  try {\r\n    let visibility = parsedText[1] ? parsedText[1].trim() : '';\r\n    let methodName = parsedText[2] ? parsedText[2].trim() : '';\r\n    let parameters = parsedText[3] ? parseGenericTypes(parsedText[3].trim()) : '';\r\n    let classifier = parsedText[4] ? parsedText[4].trim() : '';\r\n    let returnType = parsedText[5] ? ' : ' + parseGenericTypes(parsedText[5]).trim() : '';\r\n\r\n    displayText = visibility + methodName + '(' + parameters + ')' + returnType;\r\n    cssStyle = parseClassifier(classifier);\r\n  } catch (err) {\r\n    displayText = parsedText;\r\n  }\r\n\r\n  return {\r\n    displayText: displayText,\r\n    cssStyle: cssStyle,\r\n  };\r\n};\r\n\r\nconst buildLegacyDisplay = function (text) {\r\n  // if for some reason we dont have any match, use old format to parse text\r\n  let displayText = '';\r\n  let cssStyle = '';\r\n  let memberText = '';\r\n  let returnType = '';\r\n  let methodStart = text.indexOf('(');\r\n  let methodEnd = text.indexOf(')');\r\n\r\n  if (methodStart > 1 && methodEnd > methodStart && methodEnd <= text.length) {\r\n    let visibility = '';\r\n    let methodName = '';\r\n\r\n    let firstChar = text.substring(0, 1);\r\n    if (firstChar.match(/\\w/)) {\r\n      methodName = text.substring(0, methodStart).trim();\r\n    } else {\r\n      if (firstChar.match(/\\+|-|~|#/)) {\r\n        visibility = firstChar;\r\n      }\r\n\r\n      methodName = text.substring(1, methodStart).trim();\r\n    }\r\n\r\n    let parameters = text.substring(methodStart + 1, methodEnd);\r\n    let classifier = text.substring(methodEnd + 1, 1);\r\n    cssStyle = parseClassifier(classifier);\r\n\r\n    displayText = visibility + methodName + '(' + parseGenericTypes(parameters.trim()) + ')';\r\n\r\n    if (methodEnd < memberText.length) {\r\n      returnType = text.substring(methodEnd + 2).trim();\r\n      if (returnType !== '') {\r\n        returnType = ' : ' + parseGenericTypes(returnType);\r\n      }\r\n    }\r\n  } else {\r\n    // finally - if all else fails, just send the text back as written (other than parsing for generic types)\r\n    displayText = parseGenericTypes(text);\r\n  }\r\n\r\n  return {\r\n    displayText: displayText,\r\n    cssStyle: cssStyle,\r\n  };\r\n};\r\n\r\n/**\r\n * Adds a <tspan> for a member in a diagram\r\n *\r\n * @param {SVGElement} textEl The element to append to\r\n * @param {string} txt The member\r\n * @param {boolean} isFirst\r\n * @param {{ padding: string; textHeight: string }} conf The configuration for the member\r\n */\r\nconst addTspan = function (textEl, txt, isFirst, conf) {\r\n  let member = parseMember(txt);\r\n\r\n  const tSpan = textEl.append('tspan').attr('x', conf.padding).text(member.displayText);\r\n\r\n  if (member.cssStyle !== '') {\r\n    tSpan.attr('style', member.cssStyle);\r\n  }\r\n\r\n  if (!isFirst) {\r\n    tSpan.attr('dy', conf.textHeight);\r\n  }\r\n};\r\n\r\n/**\r\n * Makes generics in typescript syntax\r\n *\r\n * @example <caption>Array of array of strings in typescript syntax</caption>\r\n *   // returns \"Array<Array<string>>\"\r\n *   parseGenericTypes('Array~Array~string~~');\r\n *\r\n * @param {string} text The text to convert\r\n * @returns {string} The converted string\r\n */\r\nconst parseGenericTypes = function (text) {\r\n  let cleanedText = text;\r\n\r\n  if (text.indexOf('~') != -1) {\r\n    cleanedText = cleanedText.replace('~', '<');\r\n    cleanedText = cleanedText.replace('~', '>');\r\n\r\n    return parseGenericTypes(cleanedText);\r\n  } else {\r\n    return cleanedText;\r\n  }\r\n};\r\n\r\n/**\r\n * Gives the styles for a classifier\r\n *\r\n * @param {'+' | '-' | '#' | '~' | '*' | '$'} classifier The classifier string\r\n * @returns {string} Styling for the classifier\r\n */\r\nconst parseClassifier = function (classifier) {\r\n  switch (classifier) {\r\n    case '*':\r\n      return 'font-style:italic;';\r\n    case '$':\r\n      return 'text-decoration:underline;';\r\n    default:\r\n      return '';\r\n  }\r\n};\r\n\r\nexport default {\r\n  drawClass,\r\n  drawEdge,\r\n  parseMember,\r\n};\r\n","import DOMPurify from 'dompurify';\r\n\r\n/**\r\n * Gets the number of lines in a string\r\n *\r\n * @param {string | undefined} s The string to check the lines for\r\n * @returns {number} The number of lines in that string\r\n */\r\nexport const getRows = (s) => {\r\n  if (!s) return 1;\r\n  let str = breakToPlaceholder(s);\r\n  str = str.replace(/\\\\n/g, '#br#');\r\n  return str.split('#br#');\r\n};\r\n\r\nexport const removeEscapes = (text) => {\r\n  let newStr = text.replace(/\\\\u[\\dA-F]{4}/gi, function (match) {\r\n    return String.fromCharCode(parseInt(match.replace(/\\\\u/g, ''), 16));\r\n  });\r\n\r\n  newStr = newStr.replace(/\\\\x([0-9a-f]{2})/gi, (_, c) => String.fromCharCode(parseInt(c, 16)));\r\n  newStr = newStr.replace(/\\\\[\\d\\d\\d]{3}/gi, function (match) {\r\n    return String.fromCharCode(parseInt(match.replace(/\\\\/g, ''), 8));\r\n  });\r\n  newStr = newStr.replace(/\\\\[\\d\\d\\d]{2}/gi, function (match) {\r\n    return String.fromCharCode(parseInt(match.replace(/\\\\/g, ''), 8));\r\n  });\r\n\r\n  return newStr;\r\n};\r\n\r\n/**\r\n * Removes script tags from a text\r\n *\r\n * @param {string} txt The text to sanitize\r\n * @returns {string} The safer text\r\n */\r\nexport const removeScript = (txt) => {\r\n  var rs = '';\r\n  var idx = 0;\r\n\r\n  while (idx >= 0) {\r\n    idx = txt.indexOf('<script');\r\n    if (idx >= 0) {\r\n      rs += txt.substr(0, idx);\r\n      txt = txt.substr(idx + 1);\r\n\r\n      idx = txt.indexOf('</script>');\r\n      if (idx >= 0) {\r\n        idx += 9;\r\n        txt = txt.substr(idx);\r\n      }\r\n    } else {\r\n      rs += txt;\r\n      idx = -1;\r\n      break;\r\n    }\r\n  }\r\n  let decodedText = removeEscapes(rs);\r\n  decodedText = decodedText.replace(/script>/gi, '#');\r\n  decodedText = decodedText.replace(/javascript:/gi, '#');\r\n  decodedText = decodedText.replace(/onerror=/gi, 'onerror:');\r\n  decodedText = decodedText.replace(/<iframe/gi, '');\r\n  return decodedText;\r\n};\r\n\r\nconst sanitizeMore = (text, config) => {\r\n  let txt = text;\r\n  let htmlLabels = true;\r\n  if (\r\n    config.flowchart &&\r\n    (config.flowchart.htmlLabels === false || config.flowchart.htmlLabels === 'false')\r\n  ) {\r\n    htmlLabels = false;\r\n  }\r\n\r\n  if (htmlLabels) {\r\n    const level = config.securityLevel;\r\n\r\n    if (level === 'antiscript' || level === 'strict') {\r\n      txt = removeScript(txt);\r\n    } else if (level !== 'loose') {\r\n      // eslint-disable-line\r\n      txt = breakToPlaceholder(txt);\r\n      txt = txt.replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n      txt = txt.replace(/=/g, '&equals;');\r\n      txt = placeholderToBreak(txt);\r\n    }\r\n  }\r\n\r\n  return txt;\r\n};\r\n\r\nexport const sanitizeText = (text, config) => {\r\n  if (!text) return text;\r\n  let txt = '';\r\n  if (config['dompurifyConfig']) {\r\n    txt = DOMPurify.sanitize(sanitizeMore(text, config), config['dompurifyConfig']);\r\n  } else {\r\n    txt = DOMPurify.sanitize(sanitizeMore(text, config));\r\n  }\r\n  return txt;\r\n};\r\n\r\nexport const sanitizeTextOrArray = (a, config) => {\r\n  if (typeof a === 'string') return sanitizeText(a, config);\r\n\r\n  const f = (x) => sanitizeText(x, config);\r\n  return a.flat().map(f);\r\n};\r\n\r\nexport const lineBreakRegex = /<br\\s*\\/?>/gi;\r\n\r\n/**\r\n * Whether or not a text has any linebreaks\r\n *\r\n * @param {string} text The text to test\r\n * @returns {boolean} Whether or not the text has breaks\r\n */\r\nexport const hasBreaks = (text) => {\r\n  return lineBreakRegex.test(text);\r\n};\r\n\r\n/**\r\n * Splits on <br> tags\r\n *\r\n * @param {string} text Text to split\r\n * @returns {string[]} List of lines as strings\r\n */\r\nexport const splitBreaks = (text) => {\r\n  return text.split(lineBreakRegex);\r\n};\r\n\r\n/**\r\n * Converts placeholders to linebreaks in HTML\r\n *\r\n * @param {string} s HTML with placeholders\r\n * @returns {string} HTML with breaks instead of placeholders\r\n */\r\nconst placeholderToBreak = (s) => {\r\n  return s.replace(/#br#/g, '<br/>');\r\n};\r\n\r\n/**\r\n * Opposite of `placeholderToBreak`, converts breaks to placeholders\r\n *\r\n * @param {string} s HTML string\r\n * @returns {string} String with placeholders\r\n */\r\nconst breakToPlaceholder = (s) => {\r\n  return s.replace(lineBreakRegex, '#br#');\r\n};\r\n\r\n/**\r\n * Gets the current URL\r\n *\r\n * @param {boolean} useAbsolute Whether to return the absolute URL or not\r\n * @returns {string} The current URL\r\n */\r\nconst getUrl = (useAbsolute) => {\r\n  let url = '';\r\n  if (useAbsolute) {\r\n    url =\r\n      window.location.protocol +\r\n      '//' +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      window.location.search;\r\n    url = url.replace(/\\(/g, '\\\\(');\r\n    url = url.replace(/\\)/g, '\\\\)');\r\n  }\r\n\r\n  return url;\r\n};\r\n\r\n/**\r\n * Converts a string/boolean into a boolean\r\n *\r\n * @param {string | boolean} val String or boolean to convert\r\n * @returns {boolean} The result from the input\r\n */\r\nexport const evaluate = (val) => (val === 'false' || val === false ? false : true);\r\n\r\nexport default {\r\n  getRows,\r\n  sanitizeText,\r\n  sanitizeTextOrArray,\r\n  hasBreaks,\r\n  splitBreaks,\r\n  lineBreakRegex,\r\n  removeScript,\r\n  getUrl,\r\n  evaluate,\r\n  removeEscapes,\r\n};\r\n","import { log } from '../../logger';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport * as configApi from '../../config';\r\nimport common from '../common/common';\r\n\r\nlet entities = {};\r\nlet relationships = [];\r\nlet title = '';\r\nlet description = '';\r\n\r\nconst Cardinality = {\r\n  ZERO_OR_ONE: 'ZERO_OR_ONE',\r\n  ZERO_OR_MORE: 'ZERO_OR_MORE',\r\n  ONE_OR_MORE: 'ONE_OR_MORE',\r\n  ONLY_ONE: 'ONLY_ONE',\r\n};\r\n\r\nconst Identification = {\r\n  NON_IDENTIFYING: 'NON_IDENTIFYING',\r\n  IDENTIFYING: 'IDENTIFYING',\r\n};\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nconst addEntity = function (name) {\r\n  if (typeof entities[name] === 'undefined') {\r\n    entities[name] = { attributes: [] };\r\n    log.info('Added new entity :', name);\r\n  }\r\n\r\n  return entities[name];\r\n};\r\n\r\nconst getEntities = () => entities;\r\n\r\nconst addAttributes = function (entityName, attribs) {\r\n  let entity = addEntity(entityName); // May do nothing (if entity has already been added)\r\n\r\n  // Process attribs in reverse order due to effect of recursive construction (last attribute is first)\r\n  let i;\r\n  for (i = attribs.length - 1; i >= 0; i--) {\r\n    entity.attributes.push(attribs[i]);\r\n    log.debug('Added attribute ', attribs[i].attributeName);\r\n  }\r\n};\r\n\r\n/**\r\n * Add a relationship\r\n *\r\n * @param entA The first entity in the relationship\r\n * @param rolA The role played by the first entity in relation to the second\r\n * @param entB The second entity in the relationship\r\n * @param rSpec The details of the relationship between the two entities\r\n */\r\nconst addRelationship = function (entA, rolA, entB, rSpec) {\r\n  let rel = {\r\n    entityA: entA,\r\n    roleA: rolA,\r\n    entityB: entB,\r\n    relSpec: rSpec,\r\n  };\r\n\r\n  relationships.push(rel);\r\n  log.debug('Added new relationship :', rel);\r\n};\r\n\r\nconst getRelationships = () => relationships;\r\n\r\n// Keep this - TODO: revisit...allow the diagram to have a title\r\nconst setTitle = function (txt) {\r\n  let sanitizedText = common.sanitizeText(txt, configApi.getConfig());\r\n  title = sanitizedText;\r\n};\r\n\r\nconst getTitle = function () {\r\n  return title;\r\n};\r\n\r\nconst setAccDescription = function (txt) {\r\n  let sanitizedText = common.sanitizeText(txt, configApi.getConfig());\r\n  description = sanitizedText;\r\n};\r\n\r\nconst getAccDescription = function () {\r\n  return description;\r\n};\r\n\r\nconst clear = function () {\r\n  entities = {};\r\n  relationships = [];\r\n  title = '';\r\n};\r\n\r\nexport default {\r\n  Cardinality,\r\n  Identification,\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().er,\r\n  addEntity,\r\n  addAttributes,\r\n  getEntities,\r\n  addRelationship,\r\n  getRelationships,\r\n  clear,\r\n  setTitle,\r\n  getTitle,\r\n  setAccDescription,\r\n  getAccDescription,\r\n};\r\n","const ERMarkers = {\r\n  ONLY_ONE_START: 'ONLY_ONE_START',\r\n  ONLY_ONE_END: 'ONLY_ONE_END',\r\n  ZERO_OR_ONE_START: 'ZERO_OR_ONE_START',\r\n  ZERO_OR_ONE_END: 'ZERO_OR_ONE_END',\r\n  ONE_OR_MORE_START: 'ONE_OR_MORE_START',\r\n  ONE_OR_MORE_END: 'ONE_OR_MORE_END',\r\n  ZERO_OR_MORE_START: 'ZERO_OR_MORE_START',\r\n  ZERO_OR_MORE_END: 'ZERO_OR_MORE_END',\r\n};\r\n\r\n/**\r\n * Put the markers into the svg DOM for later use with edge paths\r\n *\r\n * @param elem\r\n * @param conf\r\n */\r\nconst insertMarkers = function (elem, conf) {\r\n  let marker;\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ONLY_ONE_START)\r\n    .attr('refX', 0)\r\n    .attr('refY', 9)\r\n    .attr('markerWidth', 18)\r\n    .attr('markerHeight', 18)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none')\r\n    .attr('d', 'M9,0 L9,18 M15,0 L15,18');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ONLY_ONE_END)\r\n    .attr('refX', 18)\r\n    .attr('refY', 9)\r\n    .attr('markerWidth', 18)\r\n    .attr('markerHeight', 18)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none')\r\n    .attr('d', 'M3,0 L3,18 M9,0 L9,18');\r\n\r\n  marker = elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ZERO_OR_ONE_START)\r\n    .attr('refX', 0)\r\n    .attr('refY', 9)\r\n    .attr('markerWidth', 30)\r\n    .attr('markerHeight', 18)\r\n    .attr('orient', 'auto');\r\n  marker\r\n    .append('circle')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'white')\r\n    .attr('cx', 21)\r\n    .attr('cy', 9)\r\n    .attr('r', 6);\r\n  marker.append('path').attr('stroke', conf.stroke).attr('fill', 'none').attr('d', 'M9,0 L9,18');\r\n\r\n  marker = elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ZERO_OR_ONE_END)\r\n    .attr('refX', 30)\r\n    .attr('refY', 9)\r\n    .attr('markerWidth', 30)\r\n    .attr('markerHeight', 18)\r\n    .attr('orient', 'auto');\r\n  marker\r\n    .append('circle')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'white')\r\n    .attr('cx', 9)\r\n    .attr('cy', 9)\r\n    .attr('r', 6);\r\n  marker.append('path').attr('stroke', conf.stroke).attr('fill', 'none').attr('d', 'M21,0 L21,18');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ONE_OR_MORE_START)\r\n    .attr('refX', 18)\r\n    .attr('refY', 18)\r\n    .attr('markerWidth', 45)\r\n    .attr('markerHeight', 36)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none')\r\n    .attr('d', 'M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27');\r\n\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ONE_OR_MORE_END)\r\n    .attr('refX', 27)\r\n    .attr('refY', 18)\r\n    .attr('markerWidth', 45)\r\n    .attr('markerHeight', 36)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none')\r\n    .attr('d', 'M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18');\r\n\r\n  marker = elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ZERO_OR_MORE_START)\r\n    .attr('refX', 18)\r\n    .attr('refY', 18)\r\n    .attr('markerWidth', 57)\r\n    .attr('markerHeight', 36)\r\n    .attr('orient', 'auto');\r\n  marker\r\n    .append('circle')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'white')\r\n    .attr('cx', 48)\r\n    .attr('cy', 18)\r\n    .attr('r', 6);\r\n  marker\r\n    .append('path')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none')\r\n    .attr('d', 'M0,18 Q18,0 36,18 Q18,36 0,18');\r\n\r\n  marker = elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ERMarkers.ZERO_OR_MORE_END)\r\n    .attr('refX', 39)\r\n    .attr('refY', 18)\r\n    .attr('markerWidth', 57)\r\n    .attr('markerHeight', 36)\r\n    .attr('orient', 'auto');\r\n  marker\r\n    .append('circle')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'white')\r\n    .attr('cx', 9)\r\n    .attr('cy', 18)\r\n    .attr('r', 6);\r\n  marker\r\n    .append('path')\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none')\r\n    .attr('d', 'M21,18 Q39,0 57,18 Q39,36 21,18');\r\n\r\n  return;\r\n};\r\n\r\nexport default {\r\n  ERMarkers,\r\n  insertMarkers,\r\n};\r\n","import graphlib from 'graphlib';\r\nimport { line, curveBasis, select } from 'd3';\r\nimport erDb from './erDb';\r\nimport erParser from './parser/erDiagram';\r\nimport dagre from 'dagre';\r\nimport { getConfig } from '../../config';\r\nimport { log } from '../../logger';\r\nimport erMarkers from './erMarkers';\r\nimport { configureSvgSize } from '../../utils';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nconst conf = {};\r\n\r\n/**\r\n * Allows the top-level API module to inject config specific to this renderer, storing it in the\r\n * local conf object. Note that generic config still needs to be retrieved using getConfig()\r\n * imported from the config module\r\n *\r\n * @param cnf\r\n */\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    conf[keys[i]] = cnf[keys[i]];\r\n  }\r\n};\r\n\r\n/**\r\n * Draw attributes for an entity\r\n *\r\n * @param groupNode The svg group node for the entity\r\n * @param entityTextNode The svg node for the entity label text\r\n * @param attributes An array of attributes defined for the entity (each attribute has a type and a name)\r\n * @returns The bounding box of the entity, after attributes have been added\r\n */\r\nconst drawAttributes = (groupNode, entityTextNode, attributes) => {\r\n  const heightPadding = conf.entityPadding / 3; // Padding internal to attribute boxes\r\n  const widthPadding = conf.entityPadding / 3; // Ditto\r\n  const attrFontSize = conf.fontSize * 0.85;\r\n  const labelBBox = entityTextNode.node().getBBox();\r\n  const attributeNodes = []; // Intermediate storage for attribute nodes created so that we can do a second pass\r\n  let hasKeyType = false;\r\n  let hasComment = false;\r\n  let maxTypeWidth = 0;\r\n  let maxNameWidth = 0;\r\n  let maxKeyWidth = 0;\r\n  let maxCommentWidth = 0;\r\n  let cumulativeHeight = labelBBox.height + heightPadding * 2;\r\n  let attrNum = 1;\r\n\r\n  // Check to see if any of the attributes has a key or a comment\r\n  attributes.forEach((item) => {\r\n    if (item.attributeKeyType !== undefined) {\r\n      hasKeyType = true;\r\n    }\r\n\r\n    if (item.attributeComment !== undefined) {\r\n      hasComment = true;\r\n    }\r\n  });\r\n\r\n  attributes.forEach((item) => {\r\n    const attrPrefix = `${entityTextNode.node().id}-attr-${attrNum}`;\r\n    let nodeHeight = 0;\r\n\r\n    // Add a text node for the attribute type\r\n    const typeNode = groupNode\r\n      .append('text')\r\n      .attr('class', 'er entityLabel')\r\n      .attr('id', `${attrPrefix}-type`)\r\n      .attr('x', 0)\r\n      .attr('y', 0)\r\n      .attr('dominant-baseline', 'middle')\r\n      .attr('text-anchor', 'left')\r\n      .attr(\r\n        'style',\r\n        'font-family: ' + getConfig().fontFamily + '; font-size: ' + attrFontSize + 'px'\r\n      )\r\n      .text(item.attributeType);\r\n\r\n    // Add a text node for the attribute name\r\n    const nameNode = groupNode\r\n      .append('text')\r\n      .attr('class', 'er entityLabel')\r\n      .attr('id', `${attrPrefix}-name`)\r\n      .attr('x', 0)\r\n      .attr('y', 0)\r\n      .attr('dominant-baseline', 'middle')\r\n      .attr('text-anchor', 'left')\r\n      .attr(\r\n        'style',\r\n        'font-family: ' + getConfig().fontFamily + '; font-size: ' + attrFontSize + 'px'\r\n      )\r\n      .text(item.attributeName);\r\n\r\n    const attributeNode = {};\r\n    attributeNode.tn = typeNode;\r\n    attributeNode.nn = nameNode;\r\n\r\n    const typeBBox = typeNode.node().getBBox();\r\n    const nameBBox = nameNode.node().getBBox();\r\n    maxTypeWidth = Math.max(maxTypeWidth, typeBBox.width);\r\n    maxNameWidth = Math.max(maxNameWidth, nameBBox.width);\r\n\r\n    nodeHeight = Math.max(typeBBox.height, nameBBox.height);\r\n\r\n    if (hasKeyType) {\r\n      const keyTypeNode = groupNode\r\n        .append('text')\r\n        .attr('class', 'er entityLabel')\r\n        .attr('id', `${attrPrefix}-key`)\r\n        .attr('x', 0)\r\n        .attr('y', 0)\r\n        .attr('dominant-baseline', 'middle')\r\n        .attr('text-anchor', 'left')\r\n        .attr(\r\n          'style',\r\n          'font-family: ' + getConfig().fontFamily + '; font-size: ' + attrFontSize + 'px'\r\n        )\r\n        .text(item.attributeKeyType || '');\r\n\r\n      attributeNode.kn = keyTypeNode;\r\n      const keyTypeBBox = keyTypeNode.node().getBBox();\r\n      maxKeyWidth = Math.max(maxKeyWidth, keyTypeBBox.width);\r\n      nodeHeight = Math.max(nodeHeight, keyTypeBBox.height);\r\n    }\r\n\r\n    if (hasComment) {\r\n      const commentNode = groupNode\r\n        .append('text')\r\n        .attr('class', 'er entityLabel')\r\n        .attr('id', `${attrPrefix}-comment`)\r\n        .attr('x', 0)\r\n        .attr('y', 0)\r\n        .attr('dominant-baseline', 'middle')\r\n        .attr('text-anchor', 'left')\r\n        .attr(\r\n          'style',\r\n          'font-family: ' + getConfig().fontFamily + '; font-size: ' + attrFontSize + 'px'\r\n        )\r\n        .text(item.attributeComment || '');\r\n\r\n      attributeNode.cn = commentNode;\r\n      const commentNodeBBox = commentNode.node().getBBox();\r\n      maxCommentWidth = Math.max(maxCommentWidth, commentNodeBBox.width);\r\n      nodeHeight = Math.max(nodeHeight, commentNodeBBox.height);\r\n    }\r\n\r\n    attributeNode.height = nodeHeight;\r\n    // Keep a reference to the nodes so that we can iterate through them later\r\n    attributeNodes.push(attributeNode);\r\n    cumulativeHeight += nodeHeight + heightPadding * 2;\r\n    attrNum += 1;\r\n  });\r\n\r\n  let widthPaddingFactor = 4;\r\n  if (hasKeyType) {\r\n    widthPaddingFactor += 2;\r\n  }\r\n  if (hasComment) {\r\n    widthPaddingFactor += 2;\r\n  }\r\n\r\n  const maxWidth = maxTypeWidth + maxNameWidth + maxKeyWidth + maxCommentWidth;\r\n\r\n  // Calculate the new bounding box of the overall entity, now that attributes have been added\r\n  const bBox = {\r\n    width: Math.max(\r\n      conf.minEntityWidth,\r\n      Math.max(\r\n        labelBBox.width + conf.entityPadding * 2,\r\n        maxWidth + widthPadding * widthPaddingFactor\r\n      )\r\n    ),\r\n    height:\r\n      attributes.length > 0\r\n        ? cumulativeHeight\r\n        : Math.max(conf.minEntityHeight, labelBBox.height + conf.entityPadding * 2),\r\n  };\r\n\r\n  if (attributes.length > 0) {\r\n    // There might be some spare width for padding out attributes if the entity name is very long\r\n    const spareColumnWidth = Math.max(\r\n      0,\r\n      (bBox.width - maxWidth - widthPadding * widthPaddingFactor) / (widthPaddingFactor / 2)\r\n    );\r\n\r\n    // Position the entity label near the top of the entity bounding box\r\n    entityTextNode.attr(\r\n      'transform',\r\n      'translate(' + bBox.width / 2 + ',' + (heightPadding + labelBBox.height / 2) + ')'\r\n    );\r\n\r\n    // Add rectangular boxes for the attribute types/names\r\n    let heightOffset = labelBBox.height + heightPadding * 2; // Start at the bottom of the entity label\r\n    let attribStyle = 'attributeBoxOdd'; // We will flip the style on alternate rows to achieve a banded effect\r\n\r\n    attributeNodes.forEach((attributeNode) => {\r\n      // Calculate the alignment y co-ordinate for the type/name of the attribute\r\n      const alignY = heightOffset + heightPadding + attributeNode.height / 2;\r\n\r\n      // Position the type attribute\r\n      attributeNode.tn.attr('transform', 'translate(' + widthPadding + ',' + alignY + ')');\r\n\r\n      // TODO Handle spareWidth in attr('width')\r\n      // Insert a rectangle for the type\r\n      const typeRect = groupNode\r\n        .insert('rect', '#' + attributeNode.tn.node().id)\r\n        .attr('class', `er ${attribStyle}`)\r\n        .attr('fill', conf.fill)\r\n        .attr('fill-opacity', '100%')\r\n        .attr('stroke', conf.stroke)\r\n        .attr('x', 0)\r\n        .attr('y', heightOffset)\r\n        .attr('width', maxTypeWidth + widthPadding * 2 + spareColumnWidth)\r\n        .attr('height', attributeNode.height + heightPadding * 2);\r\n\r\n      const nameXOffset = parseFloat(typeRect.attr('x')) + parseFloat(typeRect.attr('width'));\r\n\r\n      // Position the name attribute\r\n      attributeNode.nn.attr(\r\n        'transform',\r\n        'translate(' + (nameXOffset + widthPadding) + ',' + alignY + ')'\r\n      );\r\n\r\n      // Insert a rectangle for the name\r\n      const nameRect = groupNode\r\n        .insert('rect', '#' + attributeNode.nn.node().id)\r\n        .attr('class', `er ${attribStyle}`)\r\n        .attr('fill', conf.fill)\r\n        .attr('fill-opacity', '100%')\r\n        .attr('stroke', conf.stroke)\r\n        .attr('x', nameXOffset)\r\n        .attr('y', heightOffset)\r\n        .attr('width', maxNameWidth + widthPadding * 2 + spareColumnWidth)\r\n        .attr('height', attributeNode.height + heightPadding * 2);\r\n\r\n      let keyTypeAndCommentXOffset =\r\n        parseFloat(nameRect.attr('x')) + parseFloat(nameRect.attr('width'));\r\n\r\n      if (hasKeyType) {\r\n        // Position the key type attribute\r\n        attributeNode.kn.attr(\r\n          'transform',\r\n          'translate(' + (keyTypeAndCommentXOffset + widthPadding) + ',' + alignY + ')'\r\n        );\r\n\r\n        // Insert a rectangle for the key type\r\n        const keyTypeRect = groupNode\r\n          .insert('rect', '#' + attributeNode.kn.node().id)\r\n          .attr('class', `er ${attribStyle}`)\r\n          .attr('fill', conf.fill)\r\n          .attr('fill-opacity', '100%')\r\n          .attr('stroke', conf.stroke)\r\n          .attr('x', keyTypeAndCommentXOffset)\r\n          .attr('y', heightOffset)\r\n          .attr('width', maxKeyWidth + widthPadding * 2 + spareColumnWidth)\r\n          .attr('height', attributeNode.height + heightPadding * 2);\r\n\r\n        keyTypeAndCommentXOffset =\r\n          parseFloat(keyTypeRect.attr('x')) + parseFloat(keyTypeRect.attr('width'));\r\n      }\r\n\r\n      if (hasComment) {\r\n        // Position the comment attribute\r\n        attributeNode.cn.attr(\r\n          'transform',\r\n          'translate(' + (keyTypeAndCommentXOffset + widthPadding) + ',' + alignY + ')'\r\n        );\r\n\r\n        // Insert a rectangle for the comment\r\n        groupNode\r\n          .insert('rect', '#' + attributeNode.cn.node().id)\r\n          .attr('class', `er ${attribStyle}`)\r\n          .attr('fill', conf.fill)\r\n          .attr('fill-opacity', '100%')\r\n          .attr('stroke', conf.stroke)\r\n          .attr('x', keyTypeAndCommentXOffset)\r\n          .attr('y', heightOffset)\r\n          .attr('width', maxCommentWidth + widthPadding * 2 + spareColumnWidth)\r\n          .attr('height', attributeNode.height + heightPadding * 2);\r\n      }\r\n\r\n      // Increment the height offset to move to the next row\r\n      heightOffset += attributeNode.height + heightPadding * 2;\r\n\r\n      // Flip the attribute style for row banding\r\n      attribStyle = attribStyle == 'attributeBoxOdd' ? 'attributeBoxEven' : 'attributeBoxOdd';\r\n    });\r\n  } else {\r\n    // Ensure the entity box is a decent size without any attributes\r\n    bBox.height = Math.max(conf.minEntityHeight, cumulativeHeight);\r\n\r\n    // Position the entity label in the middle of the box\r\n    entityTextNode.attr('transform', 'translate(' + bBox.width / 2 + ',' + bBox.height / 2 + ')');\r\n  }\r\n\r\n  return bBox;\r\n};\r\n\r\n/**\r\n * Use D3 to construct the svg elements for the entities\r\n *\r\n * @param svgNode The svg node that contains the diagram\r\n * @param entities The entities to be drawn\r\n * @param graph The graph that contains the vertex and edge definitions post-layout\r\n * @returns The first entity that was inserted\r\n */\r\nconst drawEntities = function (svgNode, entities, graph) {\r\n  const keys = Object.keys(entities);\r\n  let firstOne;\r\n\r\n  keys.forEach(function (id) {\r\n    // Create a group for each entity\r\n    const groupNode = svgNode.append('g').attr('id', id);\r\n\r\n    firstOne = firstOne === undefined ? id : firstOne;\r\n\r\n    // Label the entity - this is done first so that we can get the bounding box\r\n    // which then determines the size of the rectangle\r\n    const textId = 'entity-' + id;\r\n    const textNode = groupNode\r\n      .append('text')\r\n      .attr('class', 'er entityLabel')\r\n      .attr('id', textId)\r\n      .attr('x', 0)\r\n      .attr('y', 0)\r\n      .attr('dominant-baseline', 'middle')\r\n      .attr('text-anchor', 'middle')\r\n      .attr(\r\n        'style',\r\n        'font-family: ' + getConfig().fontFamily + '; font-size: ' + conf.fontSize + 'px'\r\n      )\r\n      .text(id);\r\n\r\n    const { width: entityWidth, height: entityHeight } = drawAttributes(\r\n      groupNode,\r\n      textNode,\r\n      entities[id].attributes\r\n    );\r\n\r\n    // Draw the rectangle - insert it before the text so that the text is not obscured\r\n    const rectNode = groupNode\r\n      .insert('rect', '#' + textId)\r\n      .attr('class', 'er entityBox')\r\n      .attr('fill', conf.fill)\r\n      .attr('fill-opacity', '100%')\r\n      .attr('stroke', conf.stroke)\r\n      .attr('x', 0)\r\n      .attr('y', 0)\r\n      .attr('width', entityWidth)\r\n      .attr('height', entityHeight);\r\n\r\n    const rectBBox = rectNode.node().getBBox();\r\n\r\n    // Add the entity to the graph\r\n    graph.setNode(id, {\r\n      width: rectBBox.width,\r\n      height: rectBBox.height,\r\n      shape: 'rect',\r\n      id: id,\r\n    });\r\n  });\r\n  return firstOne;\r\n}; // drawEntities\r\n\r\nconst adjustEntities = function (svgNode, graph) {\r\n  graph.nodes().forEach(function (v) {\r\n    if (typeof v !== 'undefined' && typeof graph.node(v) !== 'undefined') {\r\n      svgNode\r\n        .select('#' + v)\r\n        .attr(\r\n          'transform',\r\n          'translate(' +\r\n            (graph.node(v).x - graph.node(v).width / 2) +\r\n            ',' +\r\n            (graph.node(v).y - graph.node(v).height / 2) +\r\n            ' )'\r\n        );\r\n    }\r\n  });\r\n  return;\r\n};\r\n\r\nconst getEdgeName = function (rel) {\r\n  return (rel.entityA + rel.roleA + rel.entityB).replace(/\\s/g, '');\r\n};\r\n\r\n/**\r\n * Add each relationship to the graph\r\n *\r\n * @param relationships The relationships to be added\r\n * @param g The graph\r\n * @returns {Array} The array of relationships\r\n */\r\nconst addRelationships = function (relationships, g) {\r\n  relationships.forEach(function (r) {\r\n    g.setEdge(r.entityA, r.entityB, { relationship: r }, getEdgeName(r));\r\n  });\r\n  return relationships;\r\n}; // addRelationships\r\n\r\nlet relCnt = 0;\r\n/**\r\n * Draw a relationship using edge information from the graph\r\n *\r\n * @param svg The svg node\r\n * @param rel The relationship to draw in the svg\r\n * @param g The graph containing the edge information\r\n * @param insert The insertion point in the svg DOM (because relationships have markers that need to\r\n *   sit 'behind' opaque entity boxes)\r\n */\r\nconst drawRelationshipFromLayout = function (svg, rel, g, insert) {\r\n  relCnt++;\r\n\r\n  // Find the edge relating to this relationship\r\n  const edge = g.edge(rel.entityA, rel.entityB, getEdgeName(rel));\r\n\r\n  // Get a function that will generate the line path\r\n  const lineFunction = line()\r\n    .x(function (d) {\r\n      return d.x;\r\n    })\r\n    .y(function (d) {\r\n      return d.y;\r\n    })\r\n    .curve(curveBasis);\r\n\r\n  // Insert the line at the right place\r\n  const svgPath = svg\r\n    .insert('path', '#' + insert)\r\n    .attr('class', 'er relationshipLine')\r\n    .attr('d', lineFunction(edge.points))\r\n    .attr('stroke', conf.stroke)\r\n    .attr('fill', 'none');\r\n\r\n  // ...and with dashes if necessary\r\n  if (rel.relSpec.relType === erDb.Identification.NON_IDENTIFYING) {\r\n    svgPath.attr('stroke-dasharray', '8,8');\r\n  }\r\n\r\n  // TODO: Understand this better\r\n  let url = '';\r\n  if (conf.arrowMarkerAbsolute) {\r\n    url =\r\n      window.location.protocol +\r\n      '//' +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      window.location.search;\r\n    url = url.replace(/\\(/g, '\\\\(');\r\n    url = url.replace(/\\)/g, '\\\\)');\r\n  }\r\n\r\n  // Decide which start and end markers it needs. It may be possible to be more concise here\r\n  // by reversing a start marker to make an end marker...but this will do for now\r\n\r\n  // Note that the 'A' entity's marker is at the end of the relationship and the 'B' entity's marker is at the start\r\n  switch (rel.relSpec.cardA) {\r\n    case erDb.Cardinality.ZERO_OR_ONE:\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + erMarkers.ERMarkers.ZERO_OR_ONE_END + ')');\r\n      break;\r\n    case erDb.Cardinality.ZERO_OR_MORE:\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + erMarkers.ERMarkers.ZERO_OR_MORE_END + ')');\r\n      break;\r\n    case erDb.Cardinality.ONE_OR_MORE:\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + erMarkers.ERMarkers.ONE_OR_MORE_END + ')');\r\n      break;\r\n    case erDb.Cardinality.ONLY_ONE:\r\n      svgPath.attr('marker-end', 'url(' + url + '#' + erMarkers.ERMarkers.ONLY_ONE_END + ')');\r\n      break;\r\n  }\r\n\r\n  switch (rel.relSpec.cardB) {\r\n    case erDb.Cardinality.ZERO_OR_ONE:\r\n      svgPath.attr(\r\n        'marker-start',\r\n        'url(' + url + '#' + erMarkers.ERMarkers.ZERO_OR_ONE_START + ')'\r\n      );\r\n      break;\r\n    case erDb.Cardinality.ZERO_OR_MORE:\r\n      svgPath.attr(\r\n        'marker-start',\r\n        'url(' + url + '#' + erMarkers.ERMarkers.ZERO_OR_MORE_START + ')'\r\n      );\r\n      break;\r\n    case erDb.Cardinality.ONE_OR_MORE:\r\n      svgPath.attr(\r\n        'marker-start',\r\n        'url(' + url + '#' + erMarkers.ERMarkers.ONE_OR_MORE_START + ')'\r\n      );\r\n      break;\r\n    case erDb.Cardinality.ONLY_ONE:\r\n      svgPath.attr('marker-start', 'url(' + url + '#' + erMarkers.ERMarkers.ONLY_ONE_START + ')');\r\n      break;\r\n  }\r\n\r\n  // Now label the relationship\r\n\r\n  // Find the half-way point\r\n  const len = svgPath.node().getTotalLength();\r\n  const labelPoint = svgPath.node().getPointAtLength(len * 0.5);\r\n\r\n  // Append a text node containing the label\r\n  const labelId = 'rel' + relCnt;\r\n\r\n  const labelNode = svg\r\n    .append('text')\r\n    .attr('class', 'er relationshipLabel')\r\n    .attr('id', labelId)\r\n    .attr('x', labelPoint.x)\r\n    .attr('y', labelPoint.y)\r\n    .attr('text-anchor', 'middle')\r\n    .attr('dominant-baseline', 'middle')\r\n    .attr(\r\n      'style',\r\n      'font-family: ' + getConfig().fontFamily + '; font-size: ' + conf.fontSize + 'px'\r\n    )\r\n    .text(rel.roleA);\r\n\r\n  // Figure out how big the opaque 'container' rectangle needs to be\r\n  const labelBBox = labelNode.node().getBBox();\r\n\r\n  // Insert the opaque rectangle before the text label\r\n  svg\r\n    .insert('rect', '#' + labelId)\r\n    .attr('class', 'er relationshipLabelBox')\r\n    .attr('x', labelPoint.x - labelBBox.width / 2)\r\n    .attr('y', labelPoint.y - labelBBox.height / 2)\r\n    .attr('width', labelBBox.width)\r\n    .attr('height', labelBBox.height)\r\n    .attr('fill', 'white')\r\n    .attr('fill-opacity', '85%');\r\n\r\n  return;\r\n};\r\n\r\n/**\r\n * Draw en E-R diagram in the tag with id: id based on the text definition of the diagram\r\n *\r\n * @param text The text of the diagram\r\n * @param id The unique id of the DOM node that contains the diagram\r\n */\r\nexport const draw = function (text, id) {\r\n  log.info('Drawing ER diagram');\r\n  erDb.clear();\r\n  const parser = erParser.parser;\r\n  parser.yy = erDb;\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and ocument for when rendering in sanbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  // Parse the text to populate erDb\r\n  try {\r\n    parser.parse(text);\r\n  } catch (err) {\r\n    log.debug('Parsing failed');\r\n  }\r\n\r\n  // Get a reference to the svg node that contains the text\r\n  const svg = root.select(`[id='${id}']`);\r\n\r\n  // Add cardinality marker definitions to the svg\r\n  erMarkers.insertMarkers(svg, conf);\r\n\r\n  // Now we have to construct the diagram in a specific way:\r\n  // ---\r\n  // 1. Create all the entities in the svg node at 0,0, but with the correct dimensions (allowing for text content)\r\n  // 2. Make sure they are all added to the graph\r\n  // 3. Add all the edges (relationships) to the graph aswell\r\n  // 4. Let dagre do its magic to layout the graph.  This assigns:\r\n  //    - the centre co-ordinates for each node, bearing in mind the dimensions and edge relationships\r\n  //    - the path co-ordinates for each edge\r\n  //    But it has no impact on the svg child nodes - the diagram remains with every entity rooted at 0,0\r\n  // 5. Now assign a transform to each entity in the svg node so that it gets drawn in the correct place, as determined by\r\n  //    its centre point, which is obtained from the graph, and it's width and height\r\n  // 6. And finally, create all the edges in the svg node using information from the graph\r\n  // ---\r\n\r\n  // Create the graph\r\n  let g;\r\n\r\n  // TODO: Explore directed vs undirected graphs, and how the layout is affected\r\n  // An E-R diagram could be said to be undirected, but there is merit in setting\r\n  // the direction from parent to child in a one-to-many as this influences graphlib to\r\n  // put the parent above the child (does it?), which is intuitive.  Most relationships\r\n  // in ER diagrams are one-to-many.\r\n  g = new graphlib.Graph({\r\n    multigraph: true,\r\n    directed: true,\r\n    compound: false,\r\n  })\r\n    .setGraph({\r\n      rankdir: conf.layoutDirection,\r\n      marginx: 20,\r\n      marginy: 20,\r\n      nodesep: 100,\r\n      edgesep: 100,\r\n      ranksep: 100,\r\n    })\r\n    .setDefaultEdgeLabel(function () {\r\n      return {};\r\n    });\r\n\r\n  // Draw the entities (at 0,0), returning the first svg node that got\r\n  // inserted - this represents the insertion point for relationship paths\r\n  const firstEntity = drawEntities(svg, erDb.getEntities(), g);\r\n\r\n  // TODO: externalise the addition of entities to the graph - it's a bit 'buried' in the above\r\n\r\n  // Add all the relationships to the graph\r\n  const relationships = addRelationships(erDb.getRelationships(), g);\r\n\r\n  dagre.layout(g); // Node and edge positions will be updated\r\n\r\n  // Adjust the positions of the entities so that they adhere to the layout\r\n  adjustEntities(svg, g);\r\n\r\n  // Draw the relationships\r\n  relationships.forEach(function (rel) {\r\n    drawRelationshipFromLayout(svg, rel, g, firstEntity);\r\n  });\r\n\r\n  const padding = conf.diagramPadding;\r\n\r\n  const svgBounds = svg.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n\r\n  configureSvgSize(svg, height, width, conf.useMaxWidth);\r\n\r\n  svg.attr('viewBox', `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`);\r\n\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n}; // draw\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `\r\n  .entityBox {\r\n    fill: ${options.mainBkg};\r\n    stroke: ${options.nodeBorder};\r\n  }\r\n\r\n  .attributeBoxOdd {\r\n    fill: #ffffff;\r\n    stroke: ${options.nodeBorder};\r\n  }\r\n\r\n  .attributeBoxEven {\r\n    fill: #f2f2f2;\r\n    stroke: ${options.nodeBorder};\r\n  }\r\n\r\n  .relationshipLabelBox {\r\n    fill: ${options.tertiaryColor};\r\n    opacity: 0.7;\r\n    background-color: ${options.tertiaryColor};\r\n      rect {\r\n        opacity: 0.5;\r\n      }\r\n  }\r\n\r\n    .relationshipLine {\r\n      stroke: ${options.lineColor};\r\n    }\r\n`;\r\n\r\nexport default getStyles;\r\n","import dagreD3 from 'dagre-d3';\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction question(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const s = (w + h) * 0.9;\r\n  const points = [\r\n    { x: s / 2, y: 0 },\r\n    { x: s, y: -s / 2 },\r\n    { x: s / 2, y: -s },\r\n    { x: 0, y: -s / 2 },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, s, s, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction hexagon(parent, bbox, node) {\r\n  const f = 4;\r\n  const h = bbox.height;\r\n  const m = h / f;\r\n  const w = bbox.width + 2 * m;\r\n  const points = [\r\n    { x: m, y: 0 },\r\n    { x: w - m, y: 0 },\r\n    { x: w, y: -h / 2 },\r\n    { x: w - m, y: -h },\r\n    { x: m, y: -h },\r\n    { x: 0, y: -h / 2 },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction rect_left_inv_arrow(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: -h / 2, y: 0 },\r\n    { x: w, y: 0 },\r\n    { x: w, y: -h },\r\n    { x: -h / 2, y: -h },\r\n    { x: 0, y: -h / 2 },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction lean_right(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: (-2 * h) / 6, y: 0 },\r\n    { x: w - h / 6, y: 0 },\r\n    { x: w + (2 * h) / 6, y: -h },\r\n    { x: h / 6, y: -h },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction lean_left(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: (2 * h) / 6, y: 0 },\r\n    { x: w + h / 6, y: 0 },\r\n    { x: w - (2 * h) / 6, y: -h },\r\n    { x: -h / 6, y: -h },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction trapezoid(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: (-2 * h) / 6, y: 0 },\r\n    { x: w + (2 * h) / 6, y: 0 },\r\n    { x: w - h / 6, y: -h },\r\n    { x: h / 6, y: -h },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction inv_trapezoid(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: h / 6, y: 0 },\r\n    { x: w - h / 6, y: 0 },\r\n    { x: w + (2 * h) / 6, y: -h },\r\n    { x: (-2 * h) / 6, y: -h },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction rect_right_inv_arrow(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: 0, y: 0 },\r\n    { x: w + h / 2, y: 0 },\r\n    { x: w, y: -h / 2 },\r\n    { x: w + h / 2, y: -h },\r\n    { x: 0, y: -h },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction stadium(parent, bbox, node) {\r\n  const h = bbox.height;\r\n  const w = bbox.width + h / 4;\r\n\r\n  const shapeSvg = parent\r\n    .insert('rect', ':first-child')\r\n    .attr('rx', h / 2)\r\n    .attr('ry', h / 2)\r\n    .attr('x', -w / 2)\r\n    .attr('y', -h / 2)\r\n    .attr('width', w)\r\n    .attr('height', h);\r\n\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.rect(node, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction subroutine(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const h = bbox.height;\r\n  const points = [\r\n    { x: 0, y: 0 },\r\n    { x: w, y: 0 },\r\n    { x: w, y: -h },\r\n    { x: 0, y: -h },\r\n    { x: 0, y: 0 },\r\n    { x: -8, y: 0 },\r\n    { x: w + 8, y: 0 },\r\n    { x: w + 8, y: -h },\r\n    { x: -8, y: -h },\r\n    { x: -8, y: 0 },\r\n  ];\r\n  const shapeSvg = insertPolygonShape(parent, w, h, points);\r\n  node.intersect = function (point) {\r\n    return dagreD3.intersect.polygon(node, points, point);\r\n  };\r\n  return shapeSvg;\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param bbox\r\n * @param node\r\n */\r\nfunction cylinder(parent, bbox, node) {\r\n  const w = bbox.width;\r\n  const rx = w / 2;\r\n  const ry = rx / (2.5 + w / 50);\r\n  const h = bbox.height + ry;\r\n\r\n  const shape =\r\n    'M 0,' +\r\n    ry +\r\n    ' a ' +\r\n    rx +\r\n    ',' +\r\n    ry +\r\n    ' 0,0,0 ' +\r\n    w +\r\n    ' 0 a ' +\r\n    rx +\r\n    ',' +\r\n    ry +\r\n    ' 0,0,0 ' +\r\n    -w +\r\n    ' 0 l 0,' +\r\n    h +\r\n    ' a ' +\r\n    rx +\r\n    ',' +\r\n    ry +\r\n    ' 0,0,0 ' +\r\n    w +\r\n    ' 0 l 0,' +\r\n    -h;\r\n\r\n  const shapeSvg = parent\r\n    .attr('label-offset-y', ry)\r\n    .insert('path', ':first-child')\r\n    .attr('d', shape)\r\n    .attr('transform', 'translate(' + -w / 2 + ',' + -(h / 2 + ry) + ')');\r\n\r\n  node.intersect = function (point) {\r\n    const pos = dagreD3.intersect.rect(node, point);\r\n    const x = pos.x - node.x;\r\n\r\n    if (\r\n      rx != 0 &&\r\n      (Math.abs(x) < node.width / 2 ||\r\n        (Math.abs(x) == node.width / 2 && Math.abs(pos.y - node.y) > node.height / 2 - ry))\r\n    ) {\r\n      // ellipsis equation: x*x / a*a + y*y / b*b = 1\r\n      // solve for y to get adjustion value for pos.y\r\n      let y = ry * ry * (1 - (x * x) / (rx * rx));\r\n      if (y != 0) y = Math.sqrt(y);\r\n      y = ry - y;\r\n      if (point.y - node.y > 0) y = -y;\r\n\r\n      pos.y += y;\r\n    }\r\n\r\n    return pos;\r\n  };\r\n\r\n  return shapeSvg;\r\n}\r\n\r\n/** @param render */\r\nexport function addToRender(render) {\r\n  render.shapes().question = question;\r\n  render.shapes().hexagon = hexagon;\r\n  render.shapes().stadium = stadium;\r\n  render.shapes().subroutine = subroutine;\r\n  render.shapes().cylinder = cylinder;\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  render.shapes().rect_left_inv_arrow = rect_left_inv_arrow;\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  render.shapes().lean_right = lean_right;\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  render.shapes().lean_left = lean_left;\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  render.shapes().trapezoid = trapezoid;\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  render.shapes().inv_trapezoid = inv_trapezoid;\r\n\r\n  // Add custom shape for box with inverted arrow on right side\r\n  render.shapes().rect_right_inv_arrow = rect_right_inv_arrow;\r\n}\r\n\r\n/** @param addShape */\r\nexport function addToRenderV2(addShape) {\r\n  addShape({ question });\r\n  addShape({ hexagon });\r\n  addShape({ stadium });\r\n  addShape({ subroutine });\r\n  addShape({ cylinder });\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  addShape({ rect_left_inv_arrow });\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  addShape({ lean_right });\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  addShape({ lean_left });\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  addShape({ trapezoid });\r\n\r\n  // Add custom shape for box with inverted arrow on left side\r\n  addShape({ inv_trapezoid });\r\n\r\n  // Add custom shape for box with inverted arrow on right side\r\n  addShape({ rect_right_inv_arrow });\r\n}\r\n\r\n/**\r\n * @param parent\r\n * @param w\r\n * @param h\r\n * @param points\r\n */\r\nfunction insertPolygonShape(parent, w, h, points) {\r\n  return parent\r\n    .insert('polygon', ':first-child')\r\n    .attr(\r\n      'points',\r\n      points\r\n        .map(function (d) {\r\n          return d.x + ',' + d.y;\r\n        })\r\n        .join(' ')\r\n    )\r\n    .attr('transform', 'translate(' + -w / 2 + ',' + h / 2 + ')');\r\n}\r\n\r\nexport default {\r\n  addToRender,\r\n  addToRenderV2,\r\n};\r\n","import { select } from 'd3';\r\nimport utils from '../../utils';\r\nimport * as configApi from '../../config';\r\nimport common from '../common/common';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport { log } from '../../logger';\r\n\r\nconst MERMAID_DOM_ID_PREFIX = 'flowchart-';\r\nlet vertexCounter = 0;\r\nlet config = configApi.getConfig();\r\nlet vertices = {};\r\nlet edges = [];\r\nlet classes = [];\r\nlet subGraphs = [];\r\nlet subGraphLookup = {};\r\nlet tooltips = {};\r\nlet subCount = 0;\r\nlet firstGraphFlag = true;\r\nlet direction;\r\nlet title = 'Flow chart';\r\nlet description = '';\r\n\r\nlet version; // As in graph\r\n\r\n// Functions to be run after graph rendering\r\nlet funs = [];\r\n\r\nconst sanitizeText = (txt) => common.sanitizeText(txt, config);\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nconst setTitle = function (txt) {\r\n  title = sanitizeText(txt);\r\n};\r\n\r\nconst getTitle = function () {\r\n  return title;\r\n};\r\n\r\nconst setAccDescription = function (txt) {\r\n  description = sanitizeText(txt);\r\n};\r\n\r\nconst getAccDescription = function () {\r\n  return description;\r\n};\r\n\r\n/**\r\n * Function to lookup domId from id in the graph definition.\r\n *\r\n * @param id\r\n * @public\r\n */\r\nexport const lookUpDomId = function (id) {\r\n  const veritceKeys = Object.keys(vertices);\r\n  for (let i = 0; i < veritceKeys.length; i++) {\r\n    if (vertices[veritceKeys[i]].id === id) {\r\n      return vertices[veritceKeys[i]].domId;\r\n    }\r\n  }\r\n  return id;\r\n};\r\n\r\n/**\r\n * Function called by parser when a node definition has been found\r\n *\r\n * @param _id\r\n * @param text\r\n * @param type\r\n * @param style\r\n * @param classes\r\n * @param dir\r\n * @param props\r\n */\r\nexport const addVertex = function (_id, text, type, style, classes, dir, props = {}) {\r\n  let txt;\r\n  let id = _id;\r\n  if (typeof id === 'undefined') {\r\n    return;\r\n  }\r\n  if (id.trim().length === 0) {\r\n    return;\r\n  }\r\n\r\n  // if (id[0].match(/\\d/)) id = MERMAID_DOM_ID_PREFIX + id;\r\n\r\n  if (typeof vertices[id] === 'undefined') {\r\n    vertices[id] = {\r\n      id: id,\r\n      domId: MERMAID_DOM_ID_PREFIX + id + '-' + vertexCounter,\r\n      styles: [],\r\n      classes: [],\r\n    };\r\n  }\r\n  vertexCounter++;\r\n  if (typeof text !== 'undefined') {\r\n    config = configApi.getConfig();\r\n    txt = sanitizeText(text.trim());\r\n\r\n    // strip quotes if string starts and ends with a quote\r\n    if (txt[0] === '\"' && txt[txt.length - 1] === '\"') {\r\n      txt = txt.substring(1, txt.length - 1);\r\n    }\r\n\r\n    vertices[id].text = txt;\r\n  } else {\r\n    if (typeof vertices[id].text === 'undefined') {\r\n      vertices[id].text = _id;\r\n    }\r\n  }\r\n  if (typeof type !== 'undefined') {\r\n    vertices[id].type = type;\r\n  }\r\n  if (typeof style !== 'undefined') {\r\n    if (style !== null) {\r\n      style.forEach(function (s) {\r\n        vertices[id].styles.push(s);\r\n      });\r\n    }\r\n  }\r\n  if (typeof classes !== 'undefined') {\r\n    if (classes !== null) {\r\n      classes.forEach(function (s) {\r\n        vertices[id].classes.push(s);\r\n      });\r\n    }\r\n  }\r\n  if (typeof dir !== 'undefined') {\r\n    vertices[id].dir = dir;\r\n  }\r\n  vertices[id].props = props;\r\n};\r\n\r\n/**\r\n * Function called by parser when a link/edge definition has been found\r\n *\r\n * @param _start\r\n * @param _end\r\n * @param type\r\n * @param linktext\r\n */\r\nexport const addSingleLink = function (_start, _end, type, linktext) {\r\n  let start = _start;\r\n  let end = _end;\r\n  // if (start[0].match(/\\d/)) start = MERMAID_DOM_ID_PREFIX + start;\r\n  // if (end[0].match(/\\d/)) end = MERMAID_DOM_ID_PREFIX + end;\r\n  // log.info('Got edge...', start, end);\r\n\r\n  const edge = { start: start, end: end, type: undefined, text: '' };\r\n  linktext = type.text;\r\n\r\n  if (typeof linktext !== 'undefined') {\r\n    edge.text = sanitizeText(linktext.trim());\r\n\r\n    // strip quotes if string starts and exnds with a quote\r\n    if (edge.text[0] === '\"' && edge.text[edge.text.length - 1] === '\"') {\r\n      edge.text = edge.text.substring(1, edge.text.length - 1);\r\n    }\r\n  }\r\n\r\n  if (typeof type !== 'undefined') {\r\n    edge.type = type.type;\r\n    edge.stroke = type.stroke;\r\n    edge.length = type.length;\r\n  }\r\n  edges.push(edge);\r\n};\r\nexport const addLink = function (_start, _end, type, linktext) {\r\n  let i, j;\r\n  for (i = 0; i < _start.length; i++) {\r\n    for (j = 0; j < _end.length; j++) {\r\n      addSingleLink(_start[i], _end[j], type, linktext);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Updates a link's line interpolation algorithm\r\n *\r\n * @param positions\r\n * @param interp\r\n */\r\nexport const updateLinkInterpolate = function (positions, interp) {\r\n  positions.forEach(function (pos) {\r\n    if (pos === 'default') {\r\n      edges.defaultInterpolate = interp;\r\n    } else {\r\n      edges[pos].interpolate = interp;\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Updates a link with a style\r\n *\r\n * @param positions\r\n * @param style\r\n */\r\nexport const updateLink = function (positions, style) {\r\n  positions.forEach(function (pos) {\r\n    if (pos === 'default') {\r\n      edges.defaultStyle = style;\r\n    } else {\r\n      if (utils.isSubstringInArray('fill', style) === -1) {\r\n        style.push('fill:none');\r\n      }\r\n      edges[pos].style = style;\r\n    }\r\n  });\r\n};\r\n\r\nexport const addClass = function (id, style) {\r\n  if (typeof classes[id] === 'undefined') {\r\n    classes[id] = { id: id, styles: [], textStyles: [] };\r\n  }\r\n\r\n  if (typeof style !== 'undefined') {\r\n    if (style !== null) {\r\n      style.forEach(function (s) {\r\n        if (s.match('color')) {\r\n          const newStyle1 = s.replace('fill', 'bgFill');\r\n          const newStyle2 = newStyle1.replace('color', 'fill');\r\n          classes[id].textStyles.push(newStyle2);\r\n        }\r\n        classes[id].styles.push(s);\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Called by parser when a graph definition is found, stores the direction of the chart.\r\n *\r\n * @param dir\r\n */\r\nexport const setDirection = function (dir) {\r\n  direction = dir;\r\n  if (direction.match(/.*</)) {\r\n    direction = 'RL';\r\n  }\r\n  if (direction.match(/.*\\^/)) {\r\n    direction = 'BT';\r\n  }\r\n  if (direction.match(/.*>/)) {\r\n    direction = 'LR';\r\n  }\r\n  if (direction.match(/.*v/)) {\r\n    direction = 'TB';\r\n  }\r\n};\r\n\r\n/**\r\n * Called by parser when a special node is found, e.g. a clickable element.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param className Class to add\r\n */\r\nexport const setClass = function (ids, className) {\r\n  ids.split(',').forEach(function (_id) {\r\n    // let id = version === 'gen-2' ? lookUpDomId(_id) : _id;\r\n    let id = _id;\r\n    // if (_id[0].match(/\\d/)) id = MERMAID_DOM_ID_PREFIX + id;\r\n    if (typeof vertices[id] !== 'undefined') {\r\n      vertices[id].classes.push(className);\r\n    }\r\n\r\n    if (typeof subGraphLookup[id] !== 'undefined') {\r\n      subGraphLookup[id].classes.push(className);\r\n    }\r\n  });\r\n};\r\n\r\nconst setTooltip = function (ids, tooltip) {\r\n  ids.split(',').forEach(function (id) {\r\n    if (typeof tooltip !== 'undefined') {\r\n      tooltips[version === 'gen-1' ? lookUpDomId(id) : id] = sanitizeText(tooltip);\r\n    }\r\n  });\r\n};\r\n\r\nconst setClickFun = function (id, functionName, functionArgs) {\r\n  let domId = lookUpDomId(id);\r\n  // if (_id[0].match(/\\d/)) id = MERMAID_DOM_ID_PREFIX + id;\r\n  if (configApi.getConfig().securityLevel !== 'loose') {\r\n    return;\r\n  }\r\n  if (typeof functionName === 'undefined') {\r\n    return;\r\n  }\r\n  let argList = [];\r\n  if (typeof functionArgs === 'string') {\r\n    /* Splits functionArgs by ',', ignoring all ',' in double quoted strings */\r\n    argList = functionArgs.split(/,(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/);\r\n    for (let i = 0; i < argList.length; i++) {\r\n      let item = argList[i].trim();\r\n      /* Removes all double quotes at the start and end of an argument */\r\n      /* This preserves all starting and ending whitespace inside */\r\n      if (item.charAt(0) === '\"' && item.charAt(item.length - 1) === '\"') {\r\n        item = item.substr(1, item.length - 2);\r\n      }\r\n      argList[i] = item;\r\n    }\r\n  }\r\n\r\n  /* if no arguments passed into callback, default to passing in id */\r\n  if (argList.length === 0) {\r\n    argList.push(id);\r\n  }\r\n\r\n  if (typeof vertices[id] !== 'undefined') {\r\n    vertices[id].haveCallback = true;\r\n    funs.push(function () {\r\n      const elem = document.querySelector(`[id=\"${domId}\"]`);\r\n      if (elem !== null) {\r\n        elem.addEventListener(\r\n          'click',\r\n          function () {\r\n            utils.runFunc(functionName, ...argList);\r\n          },\r\n          false\r\n        );\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Called by parser when a link is found. Adds the URL to the vertex data.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param linkStr URL to create a link for\r\n * @param target\r\n */\r\nexport const setLink = function (ids, linkStr, target) {\r\n  ids.split(',').forEach(function (id) {\r\n    if (typeof vertices[id] !== 'undefined') {\r\n      vertices[id].link = utils.formatUrl(linkStr, config);\r\n      vertices[id].linkTarget = target;\r\n    }\r\n  });\r\n  setClass(ids, 'clickable');\r\n};\r\nexport const getTooltip = function (id) {\r\n  return tooltips[id];\r\n};\r\n\r\n/**\r\n * Called by parser when a click definition is found. Registers an event handler.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param functionName Function to be called on click\r\n * @param functionArgs\r\n */\r\nexport const setClickEvent = function (ids, functionName, functionArgs) {\r\n  ids.split(',').forEach(function (id) {\r\n    setClickFun(id, functionName, functionArgs);\r\n  });\r\n  setClass(ids, 'clickable');\r\n};\r\n\r\nexport const bindFunctions = function (element) {\r\n  funs.forEach(function (fun) {\r\n    fun(element);\r\n  });\r\n};\r\nexport const getDirection = function () {\r\n  return direction.trim();\r\n};\r\n/**\r\n * Retrieval function for fetching the found nodes after parsing has completed.\r\n *\r\n * @returns {{} | any | vertices}\r\n */\r\nexport const getVertices = function () {\r\n  return vertices;\r\n};\r\n\r\n/**\r\n * Retrieval function for fetching the found links after parsing has completed.\r\n *\r\n * @returns {{} | any | edges}\r\n */\r\nexport const getEdges = function () {\r\n  return edges;\r\n};\r\n\r\n/**\r\n * Retrieval function for fetching the found class definitions after parsing has completed.\r\n *\r\n * @returns {{} | any | classes}\r\n */\r\nexport const getClasses = function () {\r\n  return classes;\r\n};\r\n\r\nconst setupToolTips = function (element) {\r\n  let tooltipElem = select('.mermaidTooltip');\r\n  if ((tooltipElem._groups || tooltipElem)[0][0] === null) {\r\n    tooltipElem = select('body').append('div').attr('class', 'mermaidTooltip').style('opacity', 0);\r\n  }\r\n\r\n  const svg = select(element).select('svg');\r\n\r\n  const nodes = svg.selectAll('g.node');\r\n  nodes\r\n    .on('mouseover', function () {\r\n      const el = select(this);\r\n      const title = el.attr('title');\r\n\r\n      // Dont try to draw a tooltip if no data is provided\r\n      if (title === null) {\r\n        return;\r\n      }\r\n      const rect = this.getBoundingClientRect();\r\n\r\n      tooltipElem.transition().duration(200).style('opacity', '.9');\r\n      tooltipElem\r\n        .html(el.attr('title'))\r\n        .style('left', window.scrollX + rect.left + (rect.right - rect.left) / 2 + 'px')\r\n        .style('top', window.scrollY + rect.top - 14 + document.body.scrollTop + 'px');\r\n      el.classed('hover', true);\r\n    })\r\n    .on('mouseout', function () {\r\n      tooltipElem.transition().duration(500).style('opacity', 0);\r\n      const el = select(this);\r\n      el.classed('hover', false);\r\n    });\r\n};\r\nfuns.push(setupToolTips);\r\n\r\n/**\r\n * Clears the internal graph db so that a new graph can be parsed.\r\n *\r\n * @param ver\r\n */\r\nexport const clear = function (ver) {\r\n  vertices = {};\r\n  classes = {};\r\n  edges = [];\r\n  funs = [];\r\n  funs.push(setupToolTips);\r\n  subGraphs = [];\r\n  subGraphLookup = {};\r\n  subCount = 0;\r\n  tooltips = [];\r\n  firstGraphFlag = true;\r\n  version = ver || 'gen-1';\r\n};\r\nexport const setGen = (ver) => {\r\n  version = ver || 'gen-1';\r\n};\r\n/** @returns {string} */\r\nexport const defaultStyle = function () {\r\n  return 'fill:#ffa;stroke: #f66; stroke-width: 3px; stroke-dasharray: 5, 5;fill:#ffa;stroke: #666;';\r\n};\r\n\r\n/**\r\n * Clears the internal graph db so that a new graph can be parsed.\r\n *\r\n * @param _id\r\n * @param list\r\n * @param _title\r\n */\r\nexport const addSubGraph = function (_id, list, _title) {\r\n  // console.log('addSubGraph', _id, list, _title);\r\n  let id = _id.trim();\r\n  let title = _title;\r\n  if (_id === _title && _title.match(/\\s/)) {\r\n    id = undefined;\r\n  }\r\n  /** @param a */\r\n  function uniq(a) {\r\n    const prims = { boolean: {}, number: {}, string: {} };\r\n    const objs = [];\r\n\r\n    let dir; //  = unbdefined; direction.trim();\r\n    const nodeList = a.filter(function (item) {\r\n      const type = typeof item;\r\n      if (item.stmt && item.stmt === 'dir') {\r\n        dir = item.value;\r\n        return false;\r\n      }\r\n      if (item.trim() === '') {\r\n        return false;\r\n      }\r\n      if (type in prims) {\r\n        return prims[type].hasOwnProperty(item) ? false : (prims[type][item] = true); // eslint-disable-line\r\n      } else {\r\n        return objs.indexOf(item) >= 0 ? false : objs.push(item);\r\n      }\r\n    });\r\n    return { nodeList, dir };\r\n  }\r\n\r\n  let nodeList = [];\r\n\r\n  const { nodeList: nl, dir } = uniq(nodeList.concat.apply(nodeList, list));\r\n  nodeList = nl;\r\n  if (version === 'gen-1') {\r\n    log.warn('LOOKING UP');\r\n    for (let i = 0; i < nodeList.length; i++) {\r\n      nodeList[i] = lookUpDomId(nodeList[i]);\r\n    }\r\n  }\r\n\r\n  id = id || 'subGraph' + subCount;\r\n  // if (id[0].match(/\\d/)) id = lookUpDomId(id);\r\n  title = title || '';\r\n  title = sanitizeText(title);\r\n  subCount = subCount + 1;\r\n  const subGraph = { id: id, nodes: nodeList, title: title.trim(), classes: [], dir };\r\n\r\n  log.info('Adding', subGraph.id, subGraph.nodes, subGraph.dir);\r\n\r\n  /** Deletes an id from all subgraphs */\r\n  // const del = _id => {\r\n  //   subGraphs.forEach(sg => {\r\n  //     const pos = sg.nodes.indexOf(_id);\r\n  //     if (pos >= 0) {\r\n  //       sg.nodes.splice(pos, 1);\r\n  //     }\r\n  //   });\r\n  // };\r\n\r\n  // // Removes the members of this subgraph from any other subgraphs, a node only belong to one subgraph\r\n  // subGraph.nodes.forEach(_id => del(_id));\r\n\r\n  // Remove the members in the new subgraph if they already belong to another subgraph\r\n  subGraph.nodes = makeUniq(subGraph, subGraphs).nodes;\r\n  subGraphs.push(subGraph);\r\n  subGraphLookup[id] = subGraph;\r\n  return id;\r\n};\r\n\r\nconst getPosForId = function (id) {\r\n  for (let i = 0; i < subGraphs.length; i++) {\r\n    if (subGraphs[i].id === id) {\r\n      return i;\r\n    }\r\n  }\r\n  return -1;\r\n};\r\nlet secCount = -1;\r\nconst posCrossRef = [];\r\nconst indexNodes2 = function (id, pos) {\r\n  const nodes = subGraphs[pos].nodes;\r\n  secCount = secCount + 1;\r\n  if (secCount > 2000) {\r\n    return;\r\n  }\r\n  posCrossRef[secCount] = pos;\r\n  // Check if match\r\n  if (subGraphs[pos].id === id) {\r\n    return {\r\n      result: true,\r\n      count: 0,\r\n    };\r\n  }\r\n\r\n  let count = 0;\r\n  let posCount = 1;\r\n  while (count < nodes.length) {\r\n    const childPos = getPosForId(nodes[count]);\r\n    // Ignore regular nodes (pos will be -1)\r\n    if (childPos >= 0) {\r\n      const res = indexNodes2(id, childPos);\r\n      if (res.result) {\r\n        return {\r\n          result: true,\r\n          count: posCount + res.count,\r\n        };\r\n      } else {\r\n        posCount = posCount + res.count;\r\n      }\r\n    }\r\n    count = count + 1;\r\n  }\r\n\r\n  return {\r\n    result: false,\r\n    count: posCount,\r\n  };\r\n};\r\n\r\nexport const getDepthFirstPos = function (pos) {\r\n  return posCrossRef[pos];\r\n};\r\nexport const indexNodes = function () {\r\n  secCount = -1;\r\n  if (subGraphs.length > 0) {\r\n    indexNodes2('none', subGraphs.length - 1, 0);\r\n  }\r\n};\r\n\r\nexport const getSubGraphs = function () {\r\n  return subGraphs;\r\n};\r\n\r\nexport const firstGraph = () => {\r\n  if (firstGraphFlag) {\r\n    firstGraphFlag = false;\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nconst destructStartLink = (_str) => {\r\n  let str = _str.trim();\r\n  let type = 'arrow_open';\r\n\r\n  switch (str[0]) {\r\n    case '<':\r\n      type = 'arrow_point';\r\n      str = str.slice(1);\r\n      break;\r\n    case 'x':\r\n      type = 'arrow_cross';\r\n      str = str.slice(1);\r\n      break;\r\n    case 'o':\r\n      type = 'arrow_circle';\r\n      str = str.slice(1);\r\n      break;\r\n  }\r\n\r\n  let stroke = 'normal';\r\n\r\n  if (str.indexOf('=') !== -1) {\r\n    stroke = 'thick';\r\n  }\r\n\r\n  if (str.indexOf('.') !== -1) {\r\n    stroke = 'dotted';\r\n  }\r\n\r\n  return { type, stroke };\r\n};\r\n\r\nconst countChar = (char, str) => {\r\n  const length = str.length;\r\n  let count = 0;\r\n  for (let i = 0; i < length; ++i) {\r\n    if (str[i] === char) {\r\n      ++count;\r\n    }\r\n  }\r\n  return count;\r\n};\r\n\r\nconst destructEndLink = (_str) => {\r\n  const str = _str.trim();\r\n  let line = str.slice(0, -1);\r\n  let type = 'arrow_open';\r\n\r\n  switch (str.slice(-1)) {\r\n    case 'x':\r\n      type = 'arrow_cross';\r\n      if (str[0] === 'x') {\r\n        type = 'double_' + type;\r\n        line = line.slice(1);\r\n      }\r\n      break;\r\n    case '>':\r\n      type = 'arrow_point';\r\n      if (str[0] === '<') {\r\n        type = 'double_' + type;\r\n        line = line.slice(1);\r\n      }\r\n      break;\r\n    case 'o':\r\n      type = 'arrow_circle';\r\n      if (str[0] === 'o') {\r\n        type = 'double_' + type;\r\n        line = line.slice(1);\r\n      }\r\n      break;\r\n  }\r\n\r\n  let stroke = 'normal';\r\n  let length = line.length - 1;\r\n\r\n  if (line[0] === '=') {\r\n    stroke = 'thick';\r\n  }\r\n\r\n  let dots = countChar('.', line);\r\n\r\n  if (dots) {\r\n    stroke = 'dotted';\r\n    length = dots;\r\n  }\r\n\r\n  return { type, stroke, length };\r\n};\r\n\r\nconst destructLink = (_str, _startStr) => {\r\n  const info = destructEndLink(_str);\r\n  let startInfo;\r\n  if (_startStr) {\r\n    startInfo = destructStartLink(_startStr);\r\n\r\n    if (startInfo.stroke !== info.stroke) {\r\n      return { type: 'INVALID', stroke: 'INVALID' };\r\n    }\r\n\r\n    if (startInfo.type === 'arrow_open') {\r\n      // -- xyz -->  - take arrow type from ending\r\n      startInfo.type = info.type;\r\n    } else {\r\n      // x-- xyz -->  - not supported\r\n      if (startInfo.type !== info.type) return { type: 'INVALID', stroke: 'INVALID' };\r\n\r\n      startInfo.type = 'double_' + startInfo.type;\r\n    }\r\n\r\n    if (startInfo.type === 'double_arrow') {\r\n      startInfo.type = 'double_arrow_point';\r\n    }\r\n\r\n    startInfo.length = info.length;\r\n    return startInfo;\r\n  }\r\n\r\n  return info;\r\n};\r\n\r\n// Todo optimizer this by caching existing nodes\r\nconst exists = (allSgs, _id) => {\r\n  let res = false;\r\n  allSgs.forEach((sg) => {\r\n    const pos = sg.nodes.indexOf(_id);\r\n    if (pos >= 0) {\r\n      res = true;\r\n    }\r\n  });\r\n  return res;\r\n};\r\n/**\r\n * Deletes an id from all subgraphs\r\n *\r\n * @param sg\r\n * @param allSubgraphs\r\n */\r\nconst makeUniq = (sg, allSubgraphs) => {\r\n  const res = [];\r\n  sg.nodes.forEach((_id, pos) => {\r\n    if (!exists(allSubgraphs, _id)) {\r\n      res.push(sg.nodes[pos]);\r\n    }\r\n  });\r\n  return { nodes: res };\r\n};\r\n\r\nexport default {\r\n  parseDirective,\r\n  defaultConfig: () => configApi.defaultConfig.flowchart,\r\n  setTitle,\r\n  getTitle,\r\n  getAccDescription,\r\n  setAccDescription,\r\n  addVertex,\r\n  lookUpDomId,\r\n  addLink,\r\n  updateLinkInterpolate,\r\n  updateLink,\r\n  addClass,\r\n  setDirection,\r\n  setClass,\r\n  setTooltip,\r\n  getTooltip,\r\n  setClickEvent,\r\n  setLink,\r\n  bindFunctions,\r\n  getDirection,\r\n  getVertices,\r\n  getEdges,\r\n  getClasses,\r\n  clear,\r\n  setGen,\r\n  defaultStyle,\r\n  addSubGraph,\r\n  getDepthFirstPos,\r\n  indexNodes,\r\n  getSubGraphs,\r\n  destructLink,\r\n  lex: {\r\n    firstGraph,\r\n  },\r\n  exists,\r\n  makeUniq,\r\n};\r\n","import graphlib from 'graphlib';\r\nimport { select, curveLinear, selectAll } from 'd3';\r\n\r\nimport flowDb from './flowDb';\r\nimport flow from './parser/flow';\r\nimport { getConfig } from '../../config';\r\n\r\nimport { render } from '../../dagre-wrapper/index.js';\r\nimport addHtmlLabel from 'dagre-d3/lib/label/add-html-label.js';\r\nimport { log } from '../../logger';\r\nimport common, { evaluate } from '../common/common';\r\nimport { interpolateToCurve, getStylesFromArray, configureSvgSize } from '../../utils';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nconst conf = {};\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    conf[keys[i]] = cnf[keys[i]];\r\n  }\r\n};\r\n\r\n/**\r\n * Function that adds the vertices found during parsing to the graph to be rendered.\r\n *\r\n * @param vert Object containing the vertices.\r\n * @param g The graph that is to be drawn.\r\n * @param svgId\r\n * @param root\r\n * @param doc\r\n */\r\nexport const addVertices = function (vert, g, svgId, root, doc) {\r\n  const svg = root.select(`[id=\"${svgId}\"]`);\r\n  const keys = Object.keys(vert);\r\n\r\n  // Iterate through each item in the vertex object (containing all the vertices found) in the graph definition\r\n  keys.forEach(function (id) {\r\n    const vertex = vert[id];\r\n\r\n    /**\r\n     * Variable for storing the classes for the vertex\r\n     *\r\n     * @type {string}\r\n     */\r\n    let classStr = 'default';\r\n    if (vertex.classes.length > 0) {\r\n      classStr = vertex.classes.join(' ');\r\n    }\r\n\r\n    const styles = getStylesFromArray(vertex.styles);\r\n\r\n    // Use vertex id as text in the box if no text is provided by the graph definition\r\n    let vertexText = vertex.text !== undefined ? vertex.text : vertex.id;\r\n\r\n    // We create a SVG label, either by delegating to addHtmlLabel or manually\r\n    let vertexNode;\r\n    if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n      // TODO: addHtmlLabel accepts a labelStyle. Do we possibly have that?\r\n      const node = {\r\n        label: vertexText.replace(\r\n          /fa[lrsb]?:fa-[\\w-]+/g,\r\n          (s) => `<i class='${s.replace(':', ' ')}'></i>`\r\n        ),\r\n      };\r\n      vertexNode = addHtmlLabel(svg, node).node();\r\n      vertexNode.parentNode.removeChild(vertexNode);\r\n    } else {\r\n      const svgLabel = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n      svgLabel.setAttribute('style', styles.labelStyle.replace('color:', 'fill:'));\r\n\r\n      const rows = vertexText.split(common.lineBreakRegex);\r\n\r\n      for (let j = 0; j < rows.length; j++) {\r\n        const tspan = doc.createElementNS('http://www.w3.org/2000/svg', 'tspan');\r\n        tspan.setAttributeNS('http://www.w3.org/XML/1998/namespace', 'xml:space', 'preserve');\r\n        tspan.setAttribute('dy', '1em');\r\n        tspan.setAttribute('x', '1');\r\n        tspan.textContent = rows[j];\r\n        svgLabel.appendChild(tspan);\r\n      }\r\n      vertexNode = svgLabel;\r\n    }\r\n\r\n    let radious = 0;\r\n    let _shape = '';\r\n    // Set the shape based parameters\r\n    switch (vertex.type) {\r\n      case 'round':\r\n        radious = 5;\r\n        _shape = 'rect';\r\n        break;\r\n      case 'square':\r\n        _shape = 'rect';\r\n        break;\r\n      case 'diamond':\r\n        _shape = 'question';\r\n        break;\r\n      case 'hexagon':\r\n        _shape = 'hexagon';\r\n        break;\r\n      case 'odd':\r\n        _shape = 'rect_left_inv_arrow';\r\n        break;\r\n      case 'lean_right':\r\n        _shape = 'lean_right';\r\n        break;\r\n      case 'lean_left':\r\n        _shape = 'lean_left';\r\n        break;\r\n      case 'trapezoid':\r\n        _shape = 'trapezoid';\r\n        break;\r\n      case 'inv_trapezoid':\r\n        _shape = 'inv_trapezoid';\r\n        break;\r\n      case 'odd_right':\r\n        _shape = 'rect_left_inv_arrow';\r\n        break;\r\n      case 'circle':\r\n        _shape = 'circle';\r\n        break;\r\n      case 'ellipse':\r\n        _shape = 'ellipse';\r\n        break;\r\n      case 'stadium':\r\n        _shape = 'stadium';\r\n        break;\r\n      case 'subroutine':\r\n        _shape = 'subroutine';\r\n        break;\r\n      case 'cylinder':\r\n        _shape = 'cylinder';\r\n        break;\r\n      case 'group':\r\n        _shape = 'rect';\r\n        break;\r\n      case 'doublecircle':\r\n        _shape = 'doublecircle';\r\n        break;\r\n      default:\r\n        _shape = 'rect';\r\n    }\r\n    // Add the node\r\n    g.setNode(vertex.id, {\r\n      labelStyle: styles.labelStyle,\r\n      shape: _shape,\r\n      labelText: vertexText,\r\n      rx: radious,\r\n      ry: radious,\r\n      class: classStr,\r\n      style: styles.style,\r\n      id: vertex.id,\r\n      link: vertex.link,\r\n      linkTarget: vertex.linkTarget,\r\n      tooltip: flowDb.getTooltip(vertex.id) || '',\r\n      domId: flowDb.lookUpDomId(vertex.id),\r\n      haveCallback: vertex.haveCallback,\r\n      width: vertex.type === 'group' ? 500 : undefined,\r\n      dir: vertex.dir,\r\n      type: vertex.type,\r\n      props: vertex.props,\r\n      padding: getConfig().flowchart.padding,\r\n    });\r\n\r\n    log.info('setNode', {\r\n      labelStyle: styles.labelStyle,\r\n      shape: _shape,\r\n      labelText: vertexText,\r\n      rx: radious,\r\n      ry: radious,\r\n      class: classStr,\r\n      style: styles.style,\r\n      id: vertex.id,\r\n      domId: flowDb.lookUpDomId(vertex.id),\r\n      width: vertex.type === 'group' ? 500 : undefined,\r\n      type: vertex.type,\r\n      dir: vertex.dir,\r\n      props: vertex.props,\r\n      padding: getConfig().flowchart.padding,\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * Add edges to graph based on parsed graph definition\r\n *\r\n * @param {object} edges The edges to add to the graph\r\n * @param {object} g The graph object\r\n */\r\nexport const addEdges = function (edges, g) {\r\n  log.info('abc78 edges = ', edges);\r\n  let cnt = 0;\r\n  let linkIdCnt = {};\r\n\r\n  let defaultStyle;\r\n  let defaultLabelStyle;\r\n\r\n  if (typeof edges.defaultStyle !== 'undefined') {\r\n    const defaultStyles = getStylesFromArray(edges.defaultStyle);\r\n    defaultStyle = defaultStyles.style;\r\n    defaultLabelStyle = defaultStyles.labelStyle;\r\n  }\r\n\r\n  edges.forEach(function (edge) {\r\n    cnt++;\r\n\r\n    // Identify Link\r\n    var linkIdBase = 'L-' + edge.start + '-' + edge.end;\r\n    // count the links from+to the same node to give unique id\r\n    if (typeof linkIdCnt[linkIdBase] === 'undefined') {\r\n      linkIdCnt[linkIdBase] = 0;\r\n      log.info('abc78 new entry', linkIdBase, linkIdCnt[linkIdBase]);\r\n    } else {\r\n      linkIdCnt[linkIdBase]++;\r\n      log.info('abc78 new entry', linkIdBase, linkIdCnt[linkIdBase]);\r\n    }\r\n    let linkId = linkIdBase + '-' + linkIdCnt[linkIdBase];\r\n    log.info('abc78 new link id to be used is', linkIdBase, linkId, linkIdCnt[linkIdBase]);\r\n    var linkNameStart = 'LS-' + edge.start;\r\n    var linkNameEnd = 'LE-' + edge.end;\r\n\r\n    const edgeData = { style: '', labelStyle: '' };\r\n    edgeData.minlen = edge.length || 1;\r\n    //edgeData.id = 'id' + cnt;\r\n\r\n    // Set link type for rendering\r\n    if (edge.type === 'arrow_open') {\r\n      edgeData.arrowhead = 'none';\r\n    } else {\r\n      edgeData.arrowhead = 'normal';\r\n    }\r\n\r\n    // Check of arrow types, placed here in order not to break old rendering\r\n    edgeData.arrowTypeStart = 'arrow_open';\r\n    edgeData.arrowTypeEnd = 'arrow_open';\r\n\r\n    /* eslint-disable no-fallthrough */\r\n    switch (edge.type) {\r\n      case 'double_arrow_cross':\r\n        edgeData.arrowTypeStart = 'arrow_cross';\r\n      case 'arrow_cross':\r\n        edgeData.arrowTypeEnd = 'arrow_cross';\r\n        break;\r\n      case 'double_arrow_point':\r\n        edgeData.arrowTypeStart = 'arrow_point';\r\n      case 'arrow_point':\r\n        edgeData.arrowTypeEnd = 'arrow_point';\r\n        break;\r\n      case 'double_arrow_circle':\r\n        edgeData.arrowTypeStart = 'arrow_circle';\r\n      case 'arrow_circle':\r\n        edgeData.arrowTypeEnd = 'arrow_circle';\r\n        break;\r\n    }\r\n\r\n    let style = '';\r\n    let labelStyle = '';\r\n\r\n    switch (edge.stroke) {\r\n      case 'normal':\r\n        style = 'fill:none;';\r\n        if (typeof defaultStyle !== 'undefined') {\r\n          style = defaultStyle;\r\n        }\r\n        if (typeof defaultLabelStyle !== 'undefined') {\r\n          labelStyle = defaultLabelStyle;\r\n        }\r\n        edgeData.thickness = 'normal';\r\n        edgeData.pattern = 'solid';\r\n        break;\r\n      case 'dotted':\r\n        edgeData.thickness = 'normal';\r\n        edgeData.pattern = 'dotted';\r\n        edgeData.style = 'fill:none;stroke-width:2px;stroke-dasharray:3;';\r\n        break;\r\n      case 'thick':\r\n        edgeData.thickness = 'thick';\r\n        edgeData.pattern = 'solid';\r\n        edgeData.style = 'stroke-width: 3.5px;fill:none;';\r\n        break;\r\n    }\r\n    if (typeof edge.style !== 'undefined') {\r\n      const styles = getStylesFromArray(edge.style);\r\n      style = styles.style;\r\n      labelStyle = styles.labelStyle;\r\n    }\r\n\r\n    edgeData.style = edgeData.style += style;\r\n    edgeData.labelStyle = edgeData.labelStyle += labelStyle;\r\n\r\n    if (typeof edge.interpolate !== 'undefined') {\r\n      edgeData.curve = interpolateToCurve(edge.interpolate, curveLinear);\r\n    } else if (typeof edges.defaultInterpolate !== 'undefined') {\r\n      edgeData.curve = interpolateToCurve(edges.defaultInterpolate, curveLinear);\r\n    } else {\r\n      edgeData.curve = interpolateToCurve(conf.curve, curveLinear);\r\n    }\r\n\r\n    if (typeof edge.text === 'undefined') {\r\n      if (typeof edge.style !== 'undefined') {\r\n        edgeData.arrowheadStyle = 'fill: #333';\r\n      }\r\n    } else {\r\n      edgeData.arrowheadStyle = 'fill: #333';\r\n      edgeData.labelpos = 'c';\r\n    }\r\n    // if (evaluate(getConfig().flowchart.htmlLabels) && false) {\r\n    //   // eslint-disable-line\r\n    //   edgeData.labelType = 'html';\r\n    //   edgeData.label = `<span id=\"L-${linkId}\" class=\"edgeLabel L-${linkNameStart}' L-${linkNameEnd}\">${edge.text}</span>`;\r\n    // } else {\r\n    edgeData.labelType = 'text';\r\n    edgeData.label = edge.text.replace(common.lineBreakRegex, '\\n');\r\n\r\n    if (typeof edge.style === 'undefined') {\r\n      edgeData.style = edgeData.style || 'stroke: #333; stroke-width: 1.5px;fill:none;';\r\n    }\r\n\r\n    edgeData.labelStyle = edgeData.labelStyle.replace('color:', 'fill:');\r\n    // }\r\n\r\n    edgeData.id = linkId;\r\n    edgeData.classes = 'flowchart-link ' + linkNameStart + ' ' + linkNameEnd;\r\n\r\n    // Add the edge to the graph\r\n    g.setEdge(edge.start, edge.end, edgeData, cnt);\r\n  });\r\n};\r\n\r\n/**\r\n * Returns the all the styles from classDef statements in the graph definition.\r\n *\r\n * @param text\r\n * @returns {object} ClassDef styles\r\n */\r\nexport const getClasses = function (text) {\r\n  log.info('Extracting classes');\r\n  flowDb.clear();\r\n  const parser = flow.parser;\r\n  parser.yy = flowDb;\r\n\r\n  try {\r\n    // Parse the graph definition\r\n    parser.parse(text);\r\n  } catch (e) {\r\n    return;\r\n  }\r\n\r\n  return flowDb.getClasses();\r\n};\r\n\r\n/**\r\n * Draws a flowchart in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param text\r\n * @param id\r\n */\r\n\r\nexport const draw = function (text, id) {\r\n  log.info('Drawing flowchart');\r\n  flowDb.clear();\r\n  flowDb.setGen('gen-2');\r\n  const parser = flow.parser;\r\n  parser.yy = flowDb;\r\n\r\n  // Parse the graph definition\r\n  // try {\r\n  parser.parse(text);\r\n  // } catch (err) {\r\n  // log.debug('Parsing failed');\r\n  // }\r\n\r\n  // Fetch the default direction, use TD if none was found\r\n  let dir = flowDb.getDirection();\r\n  if (typeof dir === 'undefined') {\r\n    dir = 'TD';\r\n  }\r\n\r\n  const conf = getConfig().flowchart;\r\n  const nodeSpacing = conf.nodeSpacing || 50;\r\n  const rankSpacing = conf.rankSpacing || 50;\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and document for when rendering in sandbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  // Create the input mermaid.graph\r\n  const g = new graphlib.Graph({\r\n    multigraph: true,\r\n    compound: true,\r\n  })\r\n    .setGraph({\r\n      rankdir: dir,\r\n      nodesep: nodeSpacing,\r\n      ranksep: rankSpacing,\r\n      marginx: 8,\r\n      marginy: 8,\r\n    })\r\n    .setDefaultEdgeLabel(function () {\r\n      return {};\r\n    });\r\n\r\n  let subG;\r\n  const subGraphs = flowDb.getSubGraphs();\r\n  log.info('Subgraphs - ', subGraphs);\r\n  for (let i = subGraphs.length - 1; i >= 0; i--) {\r\n    subG = subGraphs[i];\r\n    log.info('Subgraph - ', subG);\r\n    flowDb.addVertex(subG.id, subG.title, 'group', undefined, subG.classes, subG.dir);\r\n  }\r\n\r\n  // Fetch the vertices/nodes and edges/links from the parsed graph definition\r\n  const vert = flowDb.getVertices();\r\n\r\n  const edges = flowDb.getEdges();\r\n\r\n  log.info(edges);\r\n  let i = 0;\r\n  for (i = subGraphs.length - 1; i >= 0; i--) {\r\n    // for (let i = 0; i < subGraphs.length; i++) {\r\n    subG = subGraphs[i];\r\n\r\n    selectAll('cluster').append('text');\r\n\r\n    for (let j = 0; j < subG.nodes.length; j++) {\r\n      log.info('Setting up subgraphs', subG.nodes[j], subG.id);\r\n      g.setParent(subG.nodes[j], subG.id);\r\n    }\r\n  }\r\n  addVertices(vert, g, id, root, doc);\r\n  addEdges(edges, g);\r\n\r\n  // Add custom shapes\r\n  // flowChartShapes.addToRenderV2(addShape);\r\n\r\n  // Set up an SVG group so that we can translate the final graph.\r\n  const svg = root.select(`[id=\"${id}\"]`);\r\n  svg.attr('xmlns:xlink', 'http://www.w3.org/1999/xlink');\r\n\r\n  // Adds title and description to the flow chart\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n\r\n  // Run the renderer. This is what draws the final graph.\r\n  const element = root.select('#' + id + ' g');\r\n  render(element, g, ['point', 'circle', 'cross'], 'flowchart', id);\r\n\r\n  const padding = conf.diagramPadding;\r\n  const svgBounds = svg.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n  log.debug(\r\n    `new ViewBox 0 0 ${width} ${height}`,\r\n    `translate(${padding - g._label.marginx}, ${padding - g._label.marginy})`\r\n  );\r\n\r\n  configureSvgSize(svg, height, width, conf.useMaxWidth);\r\n\r\n  svg.attr('viewBox', `0 0 ${width} ${height}`);\r\n  svg\r\n    .select('g')\r\n    .attr('transform', `translate(${padding - g._label.marginx}, ${padding - svgBounds.y})`);\r\n\r\n  // Index nodes\r\n  flowDb.indexNodes('subGraph' + i);\r\n\r\n  // Add label rects for non html labels\r\n  if (!conf.htmlLabels) {\r\n    const labels = doc.querySelectorAll('[id=\"' + id + '\"] .edgeLabel .label');\r\n    for (let k = 0; k < labels.length; k++) {\r\n      const label = labels[k];\r\n\r\n      // Get dimensions of label\r\n      const dim = label.getBBox();\r\n\r\n      const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n      rect.setAttribute('rx', 0);\r\n      rect.setAttribute('ry', 0);\r\n      rect.setAttribute('width', dim.width);\r\n      rect.setAttribute('height', dim.height);\r\n      // rect.setAttribute('style', 'fill:#e8e8e8;');\r\n\r\n      label.insertBefore(rect, label.firstChild);\r\n    }\r\n  }\r\n\r\n  // If node has a link, wrap it in an anchor SVG object.\r\n  const keys = Object.keys(vert);\r\n  keys.forEach(function (key) {\r\n    const vertex = vert[key];\r\n\r\n    if (vertex.link) {\r\n      const node = select('#' + id + ' [id=\"' + key + '\"]');\r\n      if (node) {\r\n        const link = doc.createElementNS('http://www.w3.org/2000/svg', 'a');\r\n        link.setAttributeNS('http://www.w3.org/2000/svg', 'class', vertex.classes.join(' '));\r\n        link.setAttributeNS('http://www.w3.org/2000/svg', 'href', vertex.link);\r\n        link.setAttributeNS('http://www.w3.org/2000/svg', 'rel', 'noopener');\r\n        if (securityLevel === 'sandbox') {\r\n          link.setAttributeNS('http://www.w3.org/2000/svg', 'target', '_top');\r\n        } else if (vertex.linkTarget) {\r\n          link.setAttributeNS('http://www.w3.org/2000/svg', 'target', vertex.linkTarget);\r\n        }\r\n\r\n        const linkNode = node.insert(function () {\r\n          return link;\r\n        }, ':first-child');\r\n\r\n        const shape = node.select('.label-container');\r\n        if (shape) {\r\n          linkNode.append(function () {\r\n            return shape.node();\r\n          });\r\n        }\r\n\r\n        const label = node.select('.label');\r\n        if (label) {\r\n          linkNode.append(function () {\r\n            return label.node();\r\n          });\r\n        }\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  addVertices,\r\n  addEdges,\r\n  getClasses,\r\n  draw,\r\n};\r\n","import graphlib from 'graphlib';\r\nimport { select, curveLinear, selectAll } from 'd3';\r\n\r\nimport flowDb from './flowDb';\r\nimport flow from './parser/flow';\r\nimport { getConfig } from '../../config';\r\n\r\nimport dagreD3 from 'dagre-d3';\r\nimport addHtmlLabel from 'dagre-d3/lib/label/add-html-label.js';\r\nimport { log } from '../../logger';\r\nimport common, { evaluate } from '../common/common';\r\nimport { interpolateToCurve, getStylesFromArray, configureSvgSize } from '../../utils';\r\nimport flowChartShapes from './flowChartShapes';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nconst conf = {};\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    conf[keys[i]] = cnf[keys[i]];\r\n  }\r\n};\r\n\r\n/**\r\n * Function that adds the vertices found in the graph definition to the graph to be rendered.\r\n *\r\n * @param vert Object containing the vertices.\r\n * @param g The graph that is to be drawn.\r\n * @param svgId\r\n * @param root\r\n * @param doc\r\n * @param _doc\r\n */\r\nexport const addVertices = function (vert, g, svgId, root, _doc) {\r\n  const securityLevel = getConfig().securityLevel;\r\n\r\n  const svg = !root ? select(`[id=\"${svgId}\"]`) : root.select(`[id=\"${svgId}\"]`);\r\n  const doc = !_doc ? document : _doc;\r\n  const keys = Object.keys(vert);\r\n\r\n  // Iterate through each item in the vertex object (containing all the vertices found) in the graph definition\r\n  keys.forEach(function (id) {\r\n    const vertex = vert[id];\r\n\r\n    /**\r\n     * Variable for storing the classes for the vertex\r\n     *\r\n     * @type {string}\r\n     */\r\n    let classStr = 'default';\r\n    if (vertex.classes.length > 0) {\r\n      classStr = vertex.classes.join(' ');\r\n    }\r\n\r\n    const styles = getStylesFromArray(vertex.styles);\r\n\r\n    // Use vertex id as text in the box if no text is provided by the graph definition\r\n    let vertexText = vertex.text !== undefined ? vertex.text : vertex.id;\r\n\r\n    // We create a SVG label, either by delegating to addHtmlLabel or manually\r\n    let vertexNode;\r\n    if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n      // TODO: addHtmlLabel accepts a labelStyle. Do we possibly have that?\r\n      const node = {\r\n        label: vertexText.replace(\r\n          /fa[lrsb]?:fa-[\\w-]+/g,\r\n          (s) => `<i class='${s.replace(':', ' ')}'></i>`\r\n        ),\r\n      };\r\n      vertexNode = addHtmlLabel(svg, node).node();\r\n      vertexNode.parentNode.removeChild(vertexNode);\r\n    } else {\r\n      const svgLabel = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n      svgLabel.setAttribute('style', styles.labelStyle.replace('color:', 'fill:'));\r\n\r\n      const rows = vertexText.split(common.lineBreakRegex);\r\n\r\n      for (let j = 0; j < rows.length; j++) {\r\n        const tspan = doc.createElementNS('http://www.w3.org/2000/svg', 'tspan');\r\n        tspan.setAttributeNS('http://www.w3.org/XML/1998/namespace', 'xml:space', 'preserve');\r\n        tspan.setAttribute('dy', '1em');\r\n        tspan.setAttribute('x', '1');\r\n        tspan.textContent = rows[j];\r\n        svgLabel.appendChild(tspan);\r\n      }\r\n      vertexNode = svgLabel;\r\n    }\r\n\r\n    let radious = 0;\r\n    let _shape = '';\r\n    // Set the shape based parameters\r\n    switch (vertex.type) {\r\n      case 'round':\r\n        radious = 5;\r\n        _shape = 'rect';\r\n        break;\r\n      case 'square':\r\n        _shape = 'rect';\r\n        break;\r\n      case 'diamond':\r\n        _shape = 'question';\r\n        break;\r\n      case 'hexagon':\r\n        _shape = 'hexagon';\r\n        break;\r\n      case 'odd':\r\n        _shape = 'rect_left_inv_arrow';\r\n        break;\r\n      case 'lean_right':\r\n        _shape = 'lean_right';\r\n        break;\r\n      case 'lean_left':\r\n        _shape = 'lean_left';\r\n        break;\r\n      case 'trapezoid':\r\n        _shape = 'trapezoid';\r\n        break;\r\n      case 'inv_trapezoid':\r\n        _shape = 'inv_trapezoid';\r\n        break;\r\n      case 'odd_right':\r\n        _shape = 'rect_left_inv_arrow';\r\n        break;\r\n      case 'circle':\r\n        _shape = 'circle';\r\n        break;\r\n      case 'ellipse':\r\n        _shape = 'ellipse';\r\n        break;\r\n      case 'stadium':\r\n        _shape = 'stadium';\r\n        break;\r\n      case 'subroutine':\r\n        _shape = 'subroutine';\r\n        break;\r\n      case 'cylinder':\r\n        _shape = 'cylinder';\r\n        break;\r\n      case 'group':\r\n        _shape = 'rect';\r\n        break;\r\n      default:\r\n        _shape = 'rect';\r\n    }\r\n    // Add the node\r\n    log.warn('Adding node', vertex.id, vertex.domId);\r\n    g.setNode(flowDb.lookUpDomId(vertex.id), {\r\n      labelType: 'svg',\r\n      labelStyle: styles.labelStyle,\r\n      shape: _shape,\r\n      label: vertexNode,\r\n      rx: radious,\r\n      ry: radious,\r\n      class: classStr,\r\n      style: styles.style,\r\n      id: flowDb.lookUpDomId(vertex.id),\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * Add edges to graph based on parsed graph definition\r\n *\r\n * @param {object} edges The edges to add to the graph\r\n * @param {object} g The graph object\r\n */\r\nexport const addEdges = function (edges, g) {\r\n  let cnt = 0;\r\n\r\n  let defaultStyle;\r\n  let defaultLabelStyle;\r\n\r\n  if (typeof edges.defaultStyle !== 'undefined') {\r\n    const defaultStyles = getStylesFromArray(edges.defaultStyle);\r\n    defaultStyle = defaultStyles.style;\r\n    defaultLabelStyle = defaultStyles.labelStyle;\r\n  }\r\n\r\n  edges.forEach(function (edge) {\r\n    cnt++;\r\n\r\n    // Identify Link\r\n    var linkId = 'L-' + edge.start + '-' + edge.end;\r\n    var linkNameStart = 'LS-' + edge.start;\r\n    var linkNameEnd = 'LE-' + edge.end;\r\n\r\n    const edgeData = {};\r\n\r\n    // Set link type for rendering\r\n    if (edge.type === 'arrow_open') {\r\n      edgeData.arrowhead = 'none';\r\n    } else {\r\n      edgeData.arrowhead = 'normal';\r\n    }\r\n\r\n    let style = '';\r\n    let labelStyle = '';\r\n\r\n    if (typeof edge.style !== 'undefined') {\r\n      const styles = getStylesFromArray(edge.style);\r\n      style = styles.style;\r\n      labelStyle = styles.labelStyle;\r\n    } else {\r\n      switch (edge.stroke) {\r\n        case 'normal':\r\n          style = 'fill:none';\r\n          if (typeof defaultStyle !== 'undefined') {\r\n            style = defaultStyle;\r\n          }\r\n          if (typeof defaultLabelStyle !== 'undefined') {\r\n            labelStyle = defaultLabelStyle;\r\n          }\r\n          break;\r\n        case 'dotted':\r\n          style = 'fill:none;stroke-width:2px;stroke-dasharray:3;';\r\n          break;\r\n        case 'thick':\r\n          style = ' stroke-width: 3.5px;fill:none';\r\n          break;\r\n      }\r\n    }\r\n\r\n    edgeData.style = style;\r\n    edgeData.labelStyle = labelStyle;\r\n\r\n    if (typeof edge.interpolate !== 'undefined') {\r\n      edgeData.curve = interpolateToCurve(edge.interpolate, curveLinear);\r\n    } else if (typeof edges.defaultInterpolate !== 'undefined') {\r\n      edgeData.curve = interpolateToCurve(edges.defaultInterpolate, curveLinear);\r\n    } else {\r\n      edgeData.curve = interpolateToCurve(conf.curve, curveLinear);\r\n    }\r\n\r\n    if (typeof edge.text === 'undefined') {\r\n      if (typeof edge.style !== 'undefined') {\r\n        edgeData.arrowheadStyle = 'fill: #333';\r\n      }\r\n    } else {\r\n      edgeData.arrowheadStyle = 'fill: #333';\r\n      edgeData.labelpos = 'c';\r\n\r\n      if (evaluate(getConfig().flowchart.htmlLabels)) {\r\n        edgeData.labelType = 'html';\r\n        edgeData.label = `<span id=\"L-${linkId}\" class=\"edgeLabel L-${linkNameStart}' L-${linkNameEnd}\">${edge.text.replace(\r\n          /fa[lrsb]?:fa-[\\w-]+/g,\r\n          (s) => `<i class='${s.replace(':', ' ')}'></i>`\r\n        )}</span>`;\r\n      } else {\r\n        edgeData.labelType = 'text';\r\n        edgeData.label = edge.text.replace(common.lineBreakRegex, '\\n');\r\n\r\n        if (typeof edge.style === 'undefined') {\r\n          edgeData.style = edgeData.style || 'stroke: #333; stroke-width: 1.5px;fill:none';\r\n        }\r\n\r\n        edgeData.labelStyle = edgeData.labelStyle.replace('color:', 'fill:');\r\n      }\r\n    }\r\n\r\n    edgeData.id = linkId;\r\n    edgeData.class = linkNameStart + ' ' + linkNameEnd;\r\n    edgeData.minlen = edge.length || 1;\r\n\r\n    // Add the edge to the graph\r\n    g.setEdge(flowDb.lookUpDomId(edge.start), flowDb.lookUpDomId(edge.end), edgeData, cnt);\r\n  });\r\n};\r\n\r\n/**\r\n * Returns the all the styles from classDef statements in the graph definition.\r\n *\r\n * @param text\r\n * @returns {object} ClassDef styles\r\n */\r\nexport const getClasses = function (text) {\r\n  log.info('Extracting classes');\r\n  flowDb.clear();\r\n  try {\r\n    const parser = flow.parser;\r\n    parser.yy = flowDb;\r\n\r\n    // Parse the graph definition\r\n    parser.parse(text);\r\n    return flowDb.getClasses();\r\n  } catch (e) {\r\n    return;\r\n  }\r\n};\r\n\r\n/**\r\n * Draws a flowchart in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param text\r\n * @param id\r\n */\r\nexport const draw = function (text, id) {\r\n  log.info('Drawing flowchart');\r\n  flowDb.clear();\r\n  flowDb.setGen('gen-1');\r\n  const parser = flow.parser;\r\n  parser.yy = flowDb;\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  // Parse the graph definition\r\n  // try {\r\n  parser.parse(text);\r\n  // } catch (err) {\r\n  // log.debug('Parsing failed');\r\n  // }\r\n\r\n  // Fetch the default direction, use TD if none was found\r\n  let dir = flowDb.getDirection();\r\n  if (typeof dir === 'undefined') {\r\n    dir = 'TD';\r\n  }\r\n\r\n  const conf = getConfig().flowchart;\r\n  const nodeSpacing = conf.nodeSpacing || 50;\r\n  const rankSpacing = conf.rankSpacing || 50;\r\n\r\n  // Create the input mermaid.graph\r\n  const g = new graphlib.Graph({\r\n    multigraph: true,\r\n    compound: true,\r\n  })\r\n    .setGraph({\r\n      rankdir: dir,\r\n      nodesep: nodeSpacing,\r\n      ranksep: rankSpacing,\r\n      marginx: 8,\r\n      marginy: 8,\r\n    })\r\n    .setDefaultEdgeLabel(function () {\r\n      return {};\r\n    });\r\n\r\n  let subG;\r\n  const subGraphs = flowDb.getSubGraphs();\r\n  for (let i = subGraphs.length - 1; i >= 0; i--) {\r\n    subG = subGraphs[i];\r\n    flowDb.addVertex(subG.id, subG.title, 'group', undefined, subG.classes);\r\n  }\r\n\r\n  // Fetch the vertices/nodes and edges/links from the parsed graph definition\r\n  const vert = flowDb.getVertices();\r\n  log.warn('Get vertices', vert);\r\n\r\n  const edges = flowDb.getEdges();\r\n\r\n  let i = 0;\r\n  for (i = subGraphs.length - 1; i >= 0; i--) {\r\n    subG = subGraphs[i];\r\n\r\n    selectAll('cluster').append('text');\r\n\r\n    for (let j = 0; j < subG.nodes.length; j++) {\r\n      log.warn(\r\n        'Setting subgraph',\r\n        subG.nodes[j],\r\n        flowDb.lookUpDomId(subG.nodes[j]),\r\n        flowDb.lookUpDomId(subG.id)\r\n      );\r\n      g.setParent(flowDb.lookUpDomId(subG.nodes[j]), flowDb.lookUpDomId(subG.id));\r\n    }\r\n  }\r\n  addVertices(vert, g, id, root, doc);\r\n  addEdges(edges, g);\r\n\r\n  // Create the renderer\r\n  const Render = dagreD3.render;\r\n  const render = new Render();\r\n\r\n  // Add custom shapes\r\n  flowChartShapes.addToRender(render);\r\n\r\n  // Add our custom arrow - an empty arrowhead\r\n  render.arrows().none = function normal(parent, id, edge, type) {\r\n    const marker = parent\r\n      .append('marker')\r\n      .attr('id', id)\r\n      .attr('viewBox', '0 0 10 10')\r\n      .attr('refX', 9)\r\n      .attr('refY', 5)\r\n      .attr('markerUnits', 'strokeWidth')\r\n      .attr('markerWidth', 8)\r\n      .attr('markerHeight', 6)\r\n      .attr('orient', 'auto');\r\n\r\n    const path = marker.append('path').attr('d', 'M 0 0 L 0 0 L 0 0 z');\r\n    dagreD3.util.applyStyle(path, edge[type + 'Style']);\r\n  };\r\n\r\n  // Override normal arrowhead defined in d3. Remove style & add class to allow css styling.\r\n  render.arrows().normal = function normal(parent, id) {\r\n    const marker = parent\r\n      .append('marker')\r\n      .attr('id', id)\r\n      .attr('viewBox', '0 0 10 10')\r\n      .attr('refX', 9)\r\n      .attr('refY', 5)\r\n      .attr('markerUnits', 'strokeWidth')\r\n      .attr('markerWidth', 8)\r\n      .attr('markerHeight', 6)\r\n      .attr('orient', 'auto');\r\n\r\n    marker\r\n      .append('path')\r\n      .attr('d', 'M 0 0 L 10 5 L 0 10 z')\r\n      .attr('class', 'arrowheadPath')\r\n      .style('stroke-width', 1)\r\n      .style('stroke-dasharray', '1,0');\r\n  };\r\n\r\n  // Set up an SVG group so that we can translate the final graph.\r\n  const svg = root.select(`[id=\"${id}\"]`);\r\n  svg.attr('xmlns:xlink', 'http://www.w3.org/1999/xlink');\r\n\r\n  log.warn(g);\r\n\r\n  // Adds title and description to the flow chart\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n\r\n  // Run the renderer. This is what draws the final graph.\r\n  const element = root.select('#' + id + ' g');\r\n  render(element, g);\r\n\r\n  element.selectAll('g.node').attr('title', function () {\r\n    return flowDb.getTooltip(this.id);\r\n  });\r\n\r\n  const padding = conf.diagramPadding;\r\n  const svgBounds = svg.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n\r\n  configureSvgSize(svg, height, width, conf.useMaxWidth);\r\n\r\n  // Ensure the viewBox includes the whole svgBounds area with extra space for padding\r\n  const vBox = `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`;\r\n  log.debug(`viewBox ${vBox}`);\r\n  svg.attr('viewBox', vBox);\r\n\r\n  // Index nodes\r\n  flowDb.indexNodes('subGraph' + i);\r\n\r\n  // reposition labels\r\n  for (i = 0; i < subGraphs.length; i++) {\r\n    subG = subGraphs[i];\r\n    if (subG.title !== 'undefined') {\r\n      const clusterRects = doc.querySelectorAll(\r\n        '#' + id + ' [id=\"' + flowDb.lookUpDomId(subG.id) + '\"] rect'\r\n      );\r\n      const clusterEl = doc.querySelectorAll(\r\n        '#' + id + ' [id=\"' + flowDb.lookUpDomId(subG.id) + '\"]'\r\n      );\r\n\r\n      const xPos = clusterRects[0].x.baseVal.value;\r\n      const yPos = clusterRects[0].y.baseVal.value;\r\n      const width = clusterRects[0].width.baseVal.value;\r\n      const cluster = select(clusterEl[0]);\r\n      const te = cluster.select('.label');\r\n      te.attr('transform', `translate(${xPos + width / 2}, ${yPos + 14})`);\r\n      te.attr('id', id + 'Text');\r\n\r\n      for (let j = 0; j < subG.classes.length; j++) {\r\n        clusterEl[0].classList.add(subG.classes[j]);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Add label rects for non html labels\r\n  if (!evaluate(conf.htmlLabels) || true) { // eslint-disable-line\r\n    const labels = doc.querySelectorAll('[id=\"' + id + '\"] .edgeLabel .label');\r\n    for (let k = 0; k < labels.length; k++) {\r\n      const label = labels[k];\r\n\r\n      // Get dimensions of label\r\n      const dim = label.getBBox();\r\n\r\n      const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n      rect.setAttribute('rx', 0);\r\n      rect.setAttribute('ry', 0);\r\n      rect.setAttribute('width', dim.width);\r\n      rect.setAttribute('height', dim.height);\r\n      // rect.setAttribute('style', 'fill:#e8e8e8;');\r\n\r\n      label.insertBefore(rect, label.firstChild);\r\n    }\r\n  }\r\n\r\n  // If node has a link, wrap it in an anchor SVG object.\r\n  const keys = Object.keys(vert);\r\n  keys.forEach(function (key) {\r\n    const vertex = vert[key];\r\n\r\n    if (vertex.link) {\r\n      const node = root.select('#' + id + ' [id=\"' + flowDb.lookUpDomId(key) + '\"]');\r\n      if (node) {\r\n        const link = doc.createElementNS('http://www.w3.org/2000/svg', 'a');\r\n        link.setAttributeNS('http://www.w3.org/2000/svg', 'class', vertex.classes.join(' '));\r\n        link.setAttributeNS('http://www.w3.org/2000/svg', 'href', vertex.link);\r\n        link.setAttributeNS('http://www.w3.org/2000/svg', 'rel', 'noopener');\r\n        if (securityLevel === 'sandbox') {\r\n          link.setAttributeNS('http://www.w3.org/2000/svg', 'target', '_top');\r\n        } else if (vertex.linkTarget) {\r\n          link.setAttributeNS('http://www.w3.org/2000/svg', 'target', vertex.linkTarget);\r\n        }\r\n\r\n        const linkNode = node.insert(function () {\r\n          return link;\r\n        }, ':first-child');\r\n\r\n        const shape = node.select('.label-container');\r\n        if (shape) {\r\n          linkNode.append(function () {\r\n            return shape.node();\r\n          });\r\n        }\r\n\r\n        const label = node.select('.label');\r\n        if (label) {\r\n          linkNode.append(function () {\r\n            return label.node();\r\n          });\r\n        }\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  addVertices,\r\n  addEdges,\r\n  getClasses,\r\n  draw,\r\n};\r\n","/**\r\n * Returns the styles given options\r\n *\r\n * @param {{\r\n *   fontFamily: string;\r\n *   nodeTextColor: string;\r\n *   textColor: string;\r\n *   titleColor: string;\r\n *   mainBkg: string;\r\n *   nodeBorder: string;\r\n *   arrowheadColor: string;\r\n *   lineColor: string;\r\n *   edgeLabelBackground: string;\r\n *   clusterBkg: string;\r\n *   clusterBorder: string;\r\n *   tertiaryColor: string;\r\n *   border2: string;\r\n * }} options\r\n *   The options for the styles\r\n * @returns {string} The resulting styles\r\n */\r\nconst getStyles = (options) =>\r\n  `.label {\r\n    font-family: ${options.fontFamily};\r\n    color: ${options.nodeTextColor || options.textColor};\r\n  }\r\n  .cluster-label text {\r\n    fill: ${options.titleColor};\r\n  }\r\n  .cluster-label span {\r\n    color: ${options.titleColor};\r\n  }\r\n\r\n  .label text,span {\r\n    fill: ${options.nodeTextColor || options.textColor};\r\n    color: ${options.nodeTextColor || options.textColor};\r\n  }\r\n\r\n  .node rect,\r\n  .node circle,\r\n  .node ellipse,\r\n  .node polygon,\r\n  .node path {\r\n    fill: ${options.mainBkg};\r\n    stroke: ${options.nodeBorder};\r\n    stroke-width: 1px;\r\n  }\r\n\r\n  .node .label {\r\n    text-align: center;\r\n  }\r\n  .node.clickable {\r\n    cursor: pointer;\r\n  }\r\n\r\n  .arrowheadPath {\r\n    fill: ${options.arrowheadColor};\r\n  }\r\n\r\n  .edgePath .path {\r\n    stroke: ${options.lineColor};\r\n    stroke-width: 2.0px;\r\n  }\r\n\r\n  .flowchart-link {\r\n    stroke: ${options.lineColor};\r\n    fill: none;\r\n  }\r\n\r\n  .edgeLabel {\r\n    background-color: ${options.edgeLabelBackground};\r\n    rect {\r\n      opacity: 0.5;\r\n      background-color: ${options.edgeLabelBackground};\r\n      fill: ${options.edgeLabelBackground};\r\n    }\r\n    text-align: center;\r\n  }\r\n\r\n  .cluster rect {\r\n    fill: ${options.clusterBkg};\r\n    stroke: ${options.clusterBorder};\r\n    stroke-width: 1px;\r\n  }\r\n\r\n  .cluster text {\r\n    fill: ${options.titleColor};\r\n  }\r\n\r\n  .cluster span {\r\n    color: ${options.titleColor};\r\n  }\r\n  /* .cluster div {\r\n    color: ${options.titleColor};\r\n  } */\r\n\r\n  div.mermaidTooltip {\r\n    position: absolute;\r\n    text-align: center;\r\n    max-width: 200px;\r\n    padding: 2px;\r\n    font-family: ${options.fontFamily};\r\n    font-size: 12px;\r\n    background: ${options.tertiaryColor};\r\n    border: 1px solid ${options.border2};\r\n    border-radius: 2px;\r\n    pointer-events: none;\r\n    z-index: 100;\r\n  }\r\n`;\r\n\r\nexport default getStyles;\r\n","import moment from 'moment-mini';\r\nimport { sanitizeUrl } from '@braintree/sanitize-url';\r\nimport { log } from '../../logger';\r\nimport * as configApi from '../../config';\r\nimport utils from '../../utils';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport common from '../common/common';\r\n\r\nlet dateFormat = '';\r\nlet axisFormat = '';\r\nlet todayMarker = '';\r\nlet includes = [];\r\nlet excludes = [];\r\nlet links = {};\r\nlet title = '';\r\nlet accDescription = '';\r\nlet sections = [];\r\nlet tasks = [];\r\nlet currentSection = '';\r\nconst tags = ['active', 'done', 'crit', 'milestone'];\r\nlet funs = [];\r\nlet inclusiveEndDates = false;\r\nlet topAxis = false;\r\n\r\n// The serial order of the task in the script\r\nlet lastOrder = 0;\r\n\r\nconst sanitizeText = function (txt) {\r\n  return common.sanitizeText(txt, configApi.getConfig());\r\n};\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nexport const clear = function () {\r\n  sections = [];\r\n  tasks = [];\r\n  currentSection = '';\r\n  funs = [];\r\n  title = '';\r\n  taskCnt = 0;\r\n  lastTask = undefined;\r\n  lastTaskID = undefined;\r\n  rawTasks = [];\r\n  dateFormat = '';\r\n  axisFormat = '';\r\n  todayMarker = '';\r\n  includes = [];\r\n  excludes = [];\r\n  inclusiveEndDates = false;\r\n  topAxis = false;\r\n  lastOrder = 0;\r\n  links = {};\r\n};\r\n\r\nexport const setAxisFormat = function (txt) {\r\n  axisFormat = txt;\r\n};\r\n\r\nexport const getAxisFormat = function () {\r\n  return axisFormat;\r\n};\r\n\r\nexport const setTodayMarker = function (txt) {\r\n  todayMarker = txt;\r\n};\r\n\r\nexport const getTodayMarker = function () {\r\n  return todayMarker;\r\n};\r\n\r\nexport const setDateFormat = function (txt) {\r\n  dateFormat = txt;\r\n};\r\n\r\nexport const enableInclusiveEndDates = function () {\r\n  inclusiveEndDates = true;\r\n};\r\n\r\nexport const endDatesAreInclusive = function () {\r\n  return inclusiveEndDates;\r\n};\r\n\r\nexport const enableTopAxis = function () {\r\n  topAxis = true;\r\n};\r\n\r\nexport const topAxisEnabled = function () {\r\n  return topAxis;\r\n};\r\n\r\nexport const getDateFormat = function () {\r\n  return dateFormat;\r\n};\r\n\r\nexport const setIncludes = function (txt) {\r\n  includes = txt.toLowerCase().split(/[\\s,]+/);\r\n};\r\n\r\nexport const getIncludes = function () {\r\n  return includes;\r\n};\r\nexport const setExcludes = function (txt) {\r\n  excludes = txt.toLowerCase().split(/[\\s,]+/);\r\n};\r\n\r\nexport const getExcludes = function () {\r\n  return excludes;\r\n};\r\n\r\nexport const getLinks = function () {\r\n  return links;\r\n};\r\n\r\nexport const setTitle = function (txt) {\r\n  title = sanitizeText(txt);\r\n};\r\n\r\nexport const getTitle = function () {\r\n  return title;\r\n};\r\n\r\nexport const setAccDescription = function (txt) {\r\n  accDescription = sanitizeText(txt);\r\n};\r\n\r\nexport const getAccDescription = function () {\r\n  return accDescription;\r\n};\r\n\r\nexport const addSection = function (txt) {\r\n  currentSection = txt;\r\n  sections.push(txt);\r\n};\r\n\r\nexport const getSections = function () {\r\n  return sections;\r\n};\r\n\r\nexport const getTasks = function () {\r\n  let allItemsPricessed = compileTasks();\r\n  const maxDepth = 10;\r\n  let iterationCount = 0;\r\n  while (!allItemsPricessed && iterationCount < maxDepth) {\r\n    allItemsPricessed = compileTasks();\r\n    iterationCount++;\r\n  }\r\n\r\n  tasks = rawTasks;\r\n\r\n  return tasks;\r\n};\r\n\r\nexport const isInvalidDate = function (date, dateFormat, excludes, includes) {\r\n  if (includes.indexOf(date.format(dateFormat.trim())) >= 0) {\r\n    return false;\r\n  }\r\n  if (date.isoWeekday() >= 6 && excludes.indexOf('weekends') >= 0) {\r\n    return true;\r\n  }\r\n  if (excludes.indexOf(date.format('dddd').toLowerCase()) >= 0) {\r\n    return true;\r\n  }\r\n  return excludes.indexOf(date.format(dateFormat.trim())) >= 0;\r\n};\r\n\r\nconst checkTaskDates = function (task, dateFormat, excludes, includes) {\r\n  if (!excludes.length || task.manualEndTime) return;\r\n  let startTime = moment(task.startTime, dateFormat, true);\r\n  startTime.add(1, 'd');\r\n  let endTime = moment(task.endTime, dateFormat, true);\r\n  let renderEndTime = fixTaskDates(startTime, endTime, dateFormat, excludes, includes);\r\n  task.endTime = endTime.toDate();\r\n  task.renderEndTime = renderEndTime;\r\n};\r\n\r\nconst fixTaskDates = function (startTime, endTime, dateFormat, excludes, includes) {\r\n  let invalid = false;\r\n  let renderEndTime = null;\r\n  while (startTime <= endTime) {\r\n    if (!invalid) {\r\n      renderEndTime = endTime.toDate();\r\n    }\r\n    invalid = isInvalidDate(startTime, dateFormat, excludes, includes);\r\n    if (invalid) {\r\n      endTime.add(1, 'd');\r\n    }\r\n    startTime.add(1, 'd');\r\n  }\r\n  return renderEndTime;\r\n};\r\n\r\nconst getStartDate = function (prevTime, dateFormat, str) {\r\n  str = str.trim();\r\n\r\n  // Test for after\r\n  const re = /^after\\s+([\\d\\w- ]+)/;\r\n  const afterStatement = re.exec(str.trim());\r\n\r\n  if (afterStatement !== null) {\r\n    // check all after ids and take the latest\r\n    let latestEndingTask = null;\r\n    afterStatement[1].split(' ').forEach(function (id) {\r\n      let task = findTaskById(id);\r\n      if (typeof task !== 'undefined') {\r\n        if (!latestEndingTask) {\r\n          latestEndingTask = task;\r\n        } else {\r\n          if (task.endTime > latestEndingTask.endTime) {\r\n            latestEndingTask = task;\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    if (!latestEndingTask) {\r\n      const dt = new Date();\r\n      dt.setHours(0, 0, 0, 0);\r\n      return dt;\r\n    } else {\r\n      return latestEndingTask.endTime;\r\n    }\r\n  }\r\n\r\n  // Check for actual date set\r\n  let mDate = moment(str, dateFormat.trim(), true);\r\n  if (mDate.isValid()) {\r\n    return mDate.toDate();\r\n  } else {\r\n    log.debug('Invalid date:' + str);\r\n    log.debug('With date format:' + dateFormat.trim());\r\n  }\r\n\r\n  // Default date - now\r\n  return new Date();\r\n};\r\n\r\nconst durationToDate = function (durationStatement, relativeTime) {\r\n  if (durationStatement !== null) {\r\n    switch (durationStatement[2]) {\r\n      case 's':\r\n        relativeTime.add(durationStatement[1], 'seconds');\r\n        break;\r\n      case 'm':\r\n        relativeTime.add(durationStatement[1], 'minutes');\r\n        break;\r\n      case 'h':\r\n        relativeTime.add(durationStatement[1], 'hours');\r\n        break;\r\n      case 'd':\r\n        relativeTime.add(durationStatement[1], 'days');\r\n        break;\r\n      case 'w':\r\n        relativeTime.add(durationStatement[1], 'weeks');\r\n        break;\r\n    }\r\n  }\r\n  // Default date - now\r\n  return relativeTime.toDate();\r\n};\r\n\r\nconst getEndDate = function (prevTime, dateFormat, str, inclusive) {\r\n  inclusive = inclusive || false;\r\n  str = str.trim();\r\n\r\n  // Check for actual date\r\n  let mDate = moment(str, dateFormat.trim(), true);\r\n  if (mDate.isValid()) {\r\n    if (inclusive) {\r\n      mDate.add(1, 'd');\r\n    }\r\n    return mDate.toDate();\r\n  }\r\n\r\n  return durationToDate(/^([\\d]+)([wdhms])/.exec(str.trim()), moment(prevTime));\r\n};\r\n\r\nlet taskCnt = 0;\r\nconst parseId = function (idStr) {\r\n  if (typeof idStr === 'undefined') {\r\n    taskCnt = taskCnt + 1;\r\n    return 'task' + taskCnt;\r\n  }\r\n  return idStr;\r\n};\r\n// id, startDate, endDate\r\n// id, startDate, length\r\n// id, after x, endDate\r\n// id, after x, length\r\n// startDate, endDate\r\n// startDate, length\r\n// after x, endDate\r\n// after x, length\r\n// endDate\r\n// length\r\n\r\nconst compileData = function (prevTask, dataStr) {\r\n  let ds;\r\n\r\n  if (dataStr.substr(0, 1) === ':') {\r\n    ds = dataStr.substr(1, dataStr.length);\r\n  } else {\r\n    ds = dataStr;\r\n  }\r\n\r\n  const data = ds.split(',');\r\n\r\n  const task = {};\r\n\r\n  // Get tags like active, done, crit and milestone\r\n  getTaskTags(data, task, tags);\r\n\r\n  for (let i = 0; i < data.length; i++) {\r\n    data[i] = data[i].trim();\r\n  }\r\n\r\n  let endTimeData = '';\r\n  switch (data.length) {\r\n    case 1:\r\n      task.id = parseId();\r\n      task.startTime = prevTask.endTime;\r\n      endTimeData = data[0];\r\n      break;\r\n    case 2:\r\n      task.id = parseId();\r\n      task.startTime = getStartDate(undefined, dateFormat, data[0]);\r\n      endTimeData = data[1];\r\n      break;\r\n    case 3:\r\n      task.id = parseId(data[0]);\r\n      task.startTime = getStartDate(undefined, dateFormat, data[1]);\r\n      endTimeData = data[2];\r\n      break;\r\n    default:\r\n  }\r\n\r\n  if (endTimeData) {\r\n    task.endTime = getEndDate(task.startTime, dateFormat, endTimeData, inclusiveEndDates);\r\n    task.manualEndTime = moment(endTimeData, 'YYYY-MM-DD', true).isValid();\r\n    checkTaskDates(task, dateFormat, excludes, includes);\r\n  }\r\n\r\n  return task;\r\n};\r\n\r\nconst parseData = function (prevTaskId, dataStr) {\r\n  let ds;\r\n  if (dataStr.substr(0, 1) === ':') {\r\n    ds = dataStr.substr(1, dataStr.length);\r\n  } else {\r\n    ds = dataStr;\r\n  }\r\n\r\n  const data = ds.split(',');\r\n\r\n  const task = {};\r\n\r\n  // Get tags like active, done, crit and milestone\r\n  getTaskTags(data, task, tags);\r\n\r\n  for (let i = 0; i < data.length; i++) {\r\n    data[i] = data[i].trim();\r\n  }\r\n\r\n  switch (data.length) {\r\n    case 1:\r\n      task.id = parseId();\r\n      task.startTime = {\r\n        type: 'prevTaskEnd',\r\n        id: prevTaskId,\r\n      };\r\n      task.endTime = {\r\n        data: data[0],\r\n      };\r\n      break;\r\n    case 2:\r\n      task.id = parseId();\r\n      task.startTime = {\r\n        type: 'getStartDate',\r\n        startData: data[0],\r\n      };\r\n      task.endTime = {\r\n        data: data[1],\r\n      };\r\n      break;\r\n    case 3:\r\n      task.id = parseId(data[0]);\r\n      task.startTime = {\r\n        type: 'getStartDate',\r\n        startData: data[1],\r\n      };\r\n      task.endTime = {\r\n        data: data[2],\r\n      };\r\n      break;\r\n    default:\r\n  }\r\n\r\n  return task;\r\n};\r\n\r\nlet lastTask;\r\nlet lastTaskID;\r\nlet rawTasks = [];\r\nconst taskDb = {};\r\nexport const addTask = function (descr, data) {\r\n  const rawTask = {\r\n    section: currentSection,\r\n    type: currentSection,\r\n    processed: false,\r\n    manualEndTime: false,\r\n    renderEndTime: null,\r\n    raw: { data: data },\r\n    task: descr,\r\n    classes: [],\r\n  };\r\n  const taskInfo = parseData(lastTaskID, data);\r\n  rawTask.raw.startTime = taskInfo.startTime;\r\n  rawTask.raw.endTime = taskInfo.endTime;\r\n  rawTask.id = taskInfo.id;\r\n  rawTask.prevTaskId = lastTaskID;\r\n  rawTask.active = taskInfo.active;\r\n  rawTask.done = taskInfo.done;\r\n  rawTask.crit = taskInfo.crit;\r\n  rawTask.milestone = taskInfo.milestone;\r\n  rawTask.order = lastOrder;\r\n\r\n  lastOrder++;\r\n\r\n  const pos = rawTasks.push(rawTask);\r\n\r\n  lastTaskID = rawTask.id;\r\n  // Store cross ref\r\n  taskDb[rawTask.id] = pos - 1;\r\n};\r\n\r\nexport const findTaskById = function (id) {\r\n  const pos = taskDb[id];\r\n  return rawTasks[pos];\r\n};\r\n\r\nexport const addTaskOrg = function (descr, data) {\r\n  const newTask = {\r\n    section: currentSection,\r\n    type: currentSection,\r\n    description: descr,\r\n    task: descr,\r\n    classes: [],\r\n  };\r\n  const taskInfo = compileData(lastTask, data);\r\n  newTask.startTime = taskInfo.startTime;\r\n  newTask.endTime = taskInfo.endTime;\r\n  newTask.id = taskInfo.id;\r\n  newTask.active = taskInfo.active;\r\n  newTask.done = taskInfo.done;\r\n  newTask.crit = taskInfo.crit;\r\n  newTask.milestone = taskInfo.milestone;\r\n  lastTask = newTask;\r\n  tasks.push(newTask);\r\n};\r\n\r\nconst compileTasks = function () {\r\n  const compileTask = function (pos) {\r\n    const task = rawTasks[pos];\r\n    let startTime = '';\r\n    switch (rawTasks[pos].raw.startTime.type) {\r\n      case 'prevTaskEnd': {\r\n        const prevTask = findTaskById(task.prevTaskId);\r\n        task.startTime = prevTask.endTime;\r\n        break;\r\n      }\r\n      case 'getStartDate':\r\n        startTime = getStartDate(undefined, dateFormat, rawTasks[pos].raw.startTime.startData);\r\n        if (startTime) {\r\n          rawTasks[pos].startTime = startTime;\r\n        }\r\n        break;\r\n    }\r\n\r\n    if (rawTasks[pos].startTime) {\r\n      rawTasks[pos].endTime = getEndDate(\r\n        rawTasks[pos].startTime,\r\n        dateFormat,\r\n        rawTasks[pos].raw.endTime.data,\r\n        inclusiveEndDates\r\n      );\r\n      if (rawTasks[pos].endTime) {\r\n        rawTasks[pos].processed = true;\r\n        rawTasks[pos].manualEndTime = moment(\r\n          rawTasks[pos].raw.endTime.data,\r\n          'YYYY-MM-DD',\r\n          true\r\n        ).isValid();\r\n        checkTaskDates(rawTasks[pos], dateFormat, excludes, includes);\r\n      }\r\n    }\r\n\r\n    return rawTasks[pos].processed;\r\n  };\r\n\r\n  let allProcessed = true;\r\n  for (let i = 0; i < rawTasks.length; i++) {\r\n    compileTask(i);\r\n\r\n    allProcessed = allProcessed && rawTasks[i].processed;\r\n  }\r\n  return allProcessed;\r\n};\r\n\r\n/**\r\n * Called by parser when a link is found. Adds the URL to the vertex data.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param _linkStr URL to create a link for\r\n */\r\nexport const setLink = function (ids, _linkStr) {\r\n  let linkStr = _linkStr;\r\n  if (configApi.getConfig().securityLevel !== 'loose') {\r\n    linkStr = sanitizeUrl(_linkStr);\r\n  }\r\n  ids.split(',').forEach(function (id) {\r\n    let rawTask = findTaskById(id);\r\n    if (typeof rawTask !== 'undefined') {\r\n      pushFun(id, () => {\r\n        window.open(linkStr, '_self');\r\n      });\r\n      links[id] = linkStr;\r\n    }\r\n  });\r\n  setClass(ids, 'clickable');\r\n};\r\n\r\n/**\r\n * Called by parser when a special node is found, e.g. a clickable element.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param className Class to add\r\n */\r\nexport const setClass = function (ids, className) {\r\n  ids.split(',').forEach(function (id) {\r\n    let rawTask = findTaskById(id);\r\n    if (typeof rawTask !== 'undefined') {\r\n      rawTask.classes.push(className);\r\n    }\r\n  });\r\n};\r\n\r\nconst setClickFun = function (id, functionName, functionArgs) {\r\n  if (configApi.getConfig().securityLevel !== 'loose') {\r\n    return;\r\n  }\r\n  if (typeof functionName === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  let argList = [];\r\n  if (typeof functionArgs === 'string') {\r\n    /* Splits functionArgs by ',', ignoring all ',' in double quoted strings */\r\n    argList = functionArgs.split(/,(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/);\r\n    for (let i = 0; i < argList.length; i++) {\r\n      let item = argList[i].trim();\r\n      /* Removes all double quotes at the start and end of an argument */\r\n      /* This preserves all starting and ending whitespace inside */\r\n      if (item.charAt(0) === '\"' && item.charAt(item.length - 1) === '\"') {\r\n        item = item.substr(1, item.length - 2);\r\n      }\r\n      argList[i] = item;\r\n    }\r\n  }\r\n\r\n  /* if no arguments passed into callback, default to passing in id */\r\n  if (argList.length === 0) {\r\n    argList.push(id);\r\n  }\r\n\r\n  let rawTask = findTaskById(id);\r\n  if (typeof rawTask !== 'undefined') {\r\n    pushFun(id, () => {\r\n      utils.runFunc(functionName, ...argList);\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * The callbackFunction is executed in a click event bound to the task with the specified id or the\r\n * task's assigned text\r\n *\r\n * @param id The task's id\r\n * @param callbackFunction A function to be executed when clicked on the task or the task's text\r\n */\r\nconst pushFun = function (id, callbackFunction) {\r\n  funs.push(function () {\r\n    // const elem = d3.select(element).select(`[id=\"${id}\"]`)\r\n    const elem = document.querySelector(`[id=\"${id}\"]`);\r\n    if (elem !== null) {\r\n      elem.addEventListener('click', function () {\r\n        callbackFunction();\r\n      });\r\n    }\r\n  });\r\n  funs.push(function () {\r\n    // const elem = d3.select(element).select(`[id=\"${id}-text\"]`)\r\n    const elem = document.querySelector(`[id=\"${id}-text\"]`);\r\n    if (elem !== null) {\r\n      elem.addEventListener('click', function () {\r\n        callbackFunction();\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Called by parser when a click definition is found. Registers an event handler.\r\n *\r\n * @param ids Comma separated list of ids\r\n * @param functionName Function to be called on click\r\n * @param functionArgs Function args the function should be called with\r\n */\r\nexport const setClickEvent = function (ids, functionName, functionArgs) {\r\n  ids.split(',').forEach(function (id) {\r\n    setClickFun(id, functionName, functionArgs);\r\n  });\r\n  setClass(ids, 'clickable');\r\n};\r\n\r\n/**\r\n * Binds all functions previously added to fun (specified through click) to the element\r\n *\r\n * @param element\r\n */\r\nexport const bindFunctions = function (element) {\r\n  funs.forEach(function (fun) {\r\n    fun(element);\r\n  });\r\n};\r\n\r\nexport default {\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().gantt,\r\n  clear,\r\n  setDateFormat,\r\n  getDateFormat,\r\n  enableInclusiveEndDates,\r\n  endDatesAreInclusive,\r\n  enableTopAxis,\r\n  topAxisEnabled,\r\n  setAxisFormat,\r\n  getAxisFormat,\r\n  setTodayMarker,\r\n  getTodayMarker,\r\n  setTitle,\r\n  getTitle,\r\n  setAccDescription,\r\n  getAccDescription,\r\n  addSection,\r\n  getSections,\r\n  getTasks,\r\n  addTask,\r\n  findTaskById,\r\n  addTaskOrg,\r\n  setIncludes,\r\n  getIncludes,\r\n  setExcludes,\r\n  getExcludes,\r\n  setClickEvent,\r\n  setLink,\r\n  getLinks,\r\n  bindFunctions,\r\n  durationToDate,\r\n  isInvalidDate,\r\n};\r\n\r\n/**\r\n * @param data\r\n * @param task\r\n * @param tags\r\n */\r\nfunction getTaskTags(data, task, tags) {\r\n  let matchFound = true;\r\n  while (matchFound) {\r\n    matchFound = false;\r\n    tags.forEach(function (t) {\r\n      const pattern = '^\\\\s*' + t + '\\\\s*$';\r\n      const regex = new RegExp(pattern);\r\n      if (data[0].match(regex)) {\r\n        task[t] = true;\r\n        data.shift(1);\r\n        matchFound = true;\r\n      }\r\n    });\r\n  }\r\n}\r\n","import moment from 'moment-mini';\r\nimport {\r\n  select,\r\n  scaleTime,\r\n  min,\r\n  max,\r\n  scaleLinear,\r\n  interpolateHcl,\r\n  axisBottom,\r\n  axisTop,\r\n  timeFormat,\r\n} from 'd3';\r\nimport { parser } from './parser/gantt';\r\nimport common from '../common/common';\r\nimport ganttDb from './ganttDb';\r\nimport { getConfig } from '../../config';\r\nimport { configureSvgSize } from '../../utils';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nparser.yy = ganttDb;\r\nexport const setConf = function () {\r\n  // const keys = Object.keys(cnf);\r\n  // keys.forEach(function(key) {\r\n  //   conf[key] = cnf[key];\r\n  // });\r\n};\r\nlet w;\r\nexport const draw = function (text, id) {\r\n  const conf = getConfig().gantt;\r\n  parser.yy.clear();\r\n  parser.parse(text);\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and ocument for when rendering in sanbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  const elem = doc.getElementById(id);\r\n  w = elem.parentElement.offsetWidth;\r\n\r\n  if (typeof w === 'undefined') {\r\n    w = 1200;\r\n  }\r\n\r\n  if (typeof conf.useWidth !== 'undefined') {\r\n    w = conf.useWidth;\r\n  }\r\n\r\n  const taskArray = parser.yy.getTasks();\r\n\r\n  // Set height based on number of tasks\r\n  const h = taskArray.length * (conf.barHeight + conf.barGap) + 2 * conf.topPadding;\r\n\r\n  // Set viewBox\r\n  elem.setAttribute('viewBox', '0 0 ' + w + ' ' + h);\r\n  const svg = root.select(`[id=\"${id}\"]`);\r\n\r\n  // Set timescale\r\n  const timeScale = scaleTime()\r\n    .domain([\r\n      min(taskArray, function (d) {\r\n        return d.startTime;\r\n      }),\r\n      max(taskArray, function (d) {\r\n        return d.endTime;\r\n      }),\r\n    ])\r\n    .rangeRound([0, w - conf.leftPadding - conf.rightPadding]);\r\n\r\n  let categories = [];\r\n\r\n  for (let i = 0; i < taskArray.length; i++) {\r\n    categories.push(taskArray[i].type);\r\n  }\r\n\r\n  const catsUnfiltered = categories; // for vert labels\r\n\r\n  categories = checkUnique(categories);\r\n\r\n  /**\r\n   * @param a\r\n   * @param b\r\n   */\r\n  function taskCompare(a, b) {\r\n    const taskA = a.startTime;\r\n    const taskB = b.startTime;\r\n    let result = 0;\r\n    if (taskA > taskB) {\r\n      result = 1;\r\n    } else if (taskA < taskB) {\r\n      result = -1;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  // Sort the task array using the above taskCompare() so that\r\n  // tasks are created based on their order of startTime\r\n  taskArray.sort(taskCompare);\r\n\r\n  makeGant(taskArray, w, h);\r\n\r\n  configureSvgSize(svg, h, w, conf.useMaxWidth);\r\n\r\n  svg\r\n    .append('text')\r\n    .text(parser.yy.getTitle())\r\n    .attr('x', w / 2)\r\n    .attr('y', conf.titleTopMargin)\r\n    .attr('class', 'titleText');\r\n\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n\r\n  /**\r\n   * @param tasks\r\n   * @param pageWidth\r\n   * @param pageHeight\r\n   */\r\n  function makeGant(tasks, pageWidth, pageHeight) {\r\n    const barHeight = conf.barHeight;\r\n    const gap = barHeight + conf.barGap;\r\n    const topPadding = conf.topPadding;\r\n    const leftPadding = conf.leftPadding;\r\n\r\n    const colorScale = scaleLinear()\r\n      .domain([0, categories.length])\r\n      .range(['#00B9FA', '#F95002'])\r\n      .interpolate(interpolateHcl);\r\n\r\n    drawExcludeDays(\r\n      gap,\r\n      topPadding,\r\n      leftPadding,\r\n      pageWidth,\r\n      pageHeight,\r\n      tasks,\r\n      parser.yy.getExcludes(),\r\n      parser.yy.getIncludes()\r\n    );\r\n    makeGrid(leftPadding, topPadding, pageWidth, pageHeight);\r\n    drawRects(tasks, gap, topPadding, leftPadding, barHeight, colorScale, pageWidth, pageHeight);\r\n    vertLabels(gap, topPadding, leftPadding, barHeight, colorScale);\r\n    drawToday(leftPadding, topPadding, pageWidth, pageHeight);\r\n  }\r\n\r\n  /**\r\n   * @param theArray\r\n   * @param theGap\r\n   * @param theTopPad\r\n   * @param theSidePad\r\n   * @param theBarHeight\r\n   * @param theColorScale\r\n   * @param w\r\n   */\r\n  function drawRects(theArray, theGap, theTopPad, theSidePad, theBarHeight, theColorScale, w) {\r\n    // Draw background rects covering the entire width of the graph, these form the section rows.\r\n    svg\r\n      .append('g')\r\n      .selectAll('rect')\r\n      .data(theArray)\r\n      .enter()\r\n      .append('rect')\r\n      .attr('x', 0)\r\n      .attr('y', function (d, i) {\r\n        // Ignore the incoming i value and use our order instead\r\n        i = d.order;\r\n        return i * theGap + theTopPad - 2;\r\n      })\r\n      .attr('width', function () {\r\n        return w - conf.rightPadding / 2;\r\n      })\r\n      .attr('height', theGap)\r\n      .attr('class', function (d) {\r\n        for (let i = 0; i < categories.length; i++) {\r\n          if (d.type === categories[i]) {\r\n            return 'section section' + (i % conf.numberSectionStyles);\r\n          }\r\n        }\r\n        return 'section section0';\r\n      });\r\n\r\n    // Draw the rects representing the tasks\r\n    const rectangles = svg.append('g').selectAll('rect').data(theArray).enter();\r\n\r\n    const links = ganttDb.getLinks();\r\n\r\n    // Render the tasks with links\r\n    // Render the other tasks\r\n    rectangles\r\n      .append('rect')\r\n      .attr('id', function (d) {\r\n        return d.id;\r\n      })\r\n      .attr('rx', 3)\r\n      .attr('ry', 3)\r\n      .attr('x', function (d) {\r\n        if (d.milestone) {\r\n          return (\r\n            timeScale(d.startTime) +\r\n            theSidePad +\r\n            0.5 * (timeScale(d.endTime) - timeScale(d.startTime)) -\r\n            0.5 * theBarHeight\r\n          );\r\n        }\r\n        return timeScale(d.startTime) + theSidePad;\r\n      })\r\n      .attr('y', function (d, i) {\r\n        // Ignore the incoming i value and use our order instead\r\n        i = d.order;\r\n        return i * theGap + theTopPad;\r\n      })\r\n      .attr('width', function (d) {\r\n        if (d.milestone) {\r\n          return theBarHeight;\r\n        }\r\n        return timeScale(d.renderEndTime || d.endTime) - timeScale(d.startTime);\r\n      })\r\n      .attr('height', theBarHeight)\r\n      .attr('transform-origin', function (d, i) {\r\n        // Ignore the incoming i value and use our order instead\r\n        i = d.order;\r\n\r\n        return (\r\n          (\r\n            timeScale(d.startTime) +\r\n            theSidePad +\r\n            0.5 * (timeScale(d.endTime) - timeScale(d.startTime))\r\n          ).toString() +\r\n          'px ' +\r\n          (i * theGap + theTopPad + 0.5 * theBarHeight).toString() +\r\n          'px'\r\n        );\r\n      })\r\n      .attr('class', function (d) {\r\n        const res = 'task';\r\n\r\n        let classStr = '';\r\n        if (d.classes.length > 0) {\r\n          classStr = d.classes.join(' ');\r\n        }\r\n\r\n        let secNum = 0;\r\n        for (let i = 0; i < categories.length; i++) {\r\n          if (d.type === categories[i]) {\r\n            secNum = i % conf.numberSectionStyles;\r\n          }\r\n        }\r\n\r\n        let taskClass = '';\r\n        if (d.active) {\r\n          if (d.crit) {\r\n            taskClass += ' activeCrit';\r\n          } else {\r\n            taskClass = ' active';\r\n          }\r\n        } else if (d.done) {\r\n          if (d.crit) {\r\n            taskClass = ' doneCrit';\r\n          } else {\r\n            taskClass = ' done';\r\n          }\r\n        } else {\r\n          if (d.crit) {\r\n            taskClass += ' crit';\r\n          }\r\n        }\r\n\r\n        if (taskClass.length === 0) {\r\n          taskClass = ' task';\r\n        }\r\n\r\n        if (d.milestone) {\r\n          taskClass = ' milestone ' + taskClass;\r\n        }\r\n\r\n        taskClass += secNum;\r\n\r\n        taskClass += ' ' + classStr;\r\n\r\n        return res + taskClass;\r\n      });\r\n\r\n    // Append task labels\r\n    rectangles\r\n      .append('text')\r\n      .attr('id', function (d) {\r\n        return d.id + '-text';\r\n      })\r\n      .text(function (d) {\r\n        return d.task;\r\n      })\r\n      .attr('font-size', conf.fontSize)\r\n      .attr('x', function (d) {\r\n        let startX = timeScale(d.startTime);\r\n        let endX = timeScale(d.renderEndTime || d.endTime);\r\n        if (d.milestone) {\r\n          startX += 0.5 * (timeScale(d.endTime) - timeScale(d.startTime)) - 0.5 * theBarHeight;\r\n        }\r\n        if (d.milestone) {\r\n          endX = startX + theBarHeight;\r\n        }\r\n        const textWidth = this.getBBox().width;\r\n\r\n        // Check id text width > width of rectangle\r\n        if (textWidth > endX - startX) {\r\n          if (endX + textWidth + 1.5 * conf.leftPadding > w) {\r\n            return startX + theSidePad - 5;\r\n          } else {\r\n            return endX + theSidePad + 5;\r\n          }\r\n        } else {\r\n          return (endX - startX) / 2 + startX + theSidePad;\r\n        }\r\n      })\r\n      .attr('y', function (d, i) {\r\n        // Ignore the incoming i value and use our order instead\r\n        i = d.order;\r\n        return i * theGap + conf.barHeight / 2 + (conf.fontSize / 2 - 2) + theTopPad;\r\n      })\r\n      .attr('text-height', theBarHeight)\r\n      .attr('class', function (d) {\r\n        const startX = timeScale(d.startTime);\r\n        let endX = timeScale(d.endTime);\r\n        if (d.milestone) {\r\n          endX = startX + theBarHeight;\r\n        }\r\n        const textWidth = this.getBBox().width;\r\n\r\n        let classStr = '';\r\n        if (d.classes.length > 0) {\r\n          classStr = d.classes.join(' ');\r\n        }\r\n\r\n        let secNum = 0;\r\n        for (let i = 0; i < categories.length; i++) {\r\n          if (d.type === categories[i]) {\r\n            secNum = i % conf.numberSectionStyles;\r\n          }\r\n        }\r\n\r\n        let taskType = '';\r\n        if (d.active) {\r\n          if (d.crit) {\r\n            taskType = 'activeCritText' + secNum;\r\n          } else {\r\n            taskType = 'activeText' + secNum;\r\n          }\r\n        }\r\n\r\n        if (d.done) {\r\n          if (d.crit) {\r\n            taskType = taskType + ' doneCritText' + secNum;\r\n          } else {\r\n            taskType = taskType + ' doneText' + secNum;\r\n          }\r\n        } else {\r\n          if (d.crit) {\r\n            taskType = taskType + ' critText' + secNum;\r\n          }\r\n        }\r\n\r\n        if (d.milestone) {\r\n          taskType += ' milestoneText';\r\n        }\r\n\r\n        // Check id text width > width of rectangle\r\n        if (textWidth > endX - startX) {\r\n          if (endX + textWidth + 1.5 * conf.leftPadding > w) {\r\n            return classStr + ' taskTextOutsideLeft taskTextOutside' + secNum + ' ' + taskType;\r\n          } else {\r\n            return (\r\n              classStr +\r\n              ' taskTextOutsideRight taskTextOutside' +\r\n              secNum +\r\n              ' ' +\r\n              taskType +\r\n              ' width-' +\r\n              textWidth\r\n            );\r\n          }\r\n        } else {\r\n          return classStr + ' taskText taskText' + secNum + ' ' + taskType + ' width-' + textWidth;\r\n        }\r\n      });\r\n\r\n    const securityLevel = getConfig().securityLevel;\r\n\r\n    // Wrap the tasks in an a tag for working links without javascript\r\n    if (securityLevel === 'sandbox') {\r\n      let sandboxElement;\r\n      sandboxElement = select('#i' + id);\r\n      const root = select(sandboxElement.nodes()[0].contentDocument.body);\r\n      const doc = sandboxElement.nodes()[0].contentDocument;\r\n\r\n      rectangles\r\n        .filter(function (d) {\r\n          return typeof links[d.id] !== 'undefined';\r\n        })\r\n        .each(function (o) {\r\n          var taskRect = doc.querySelector('#' + o.id);\r\n          var taskText = doc.querySelector('#' + o.id + '-text');\r\n          const oldParent = taskRect.parentNode;\r\n          var Link = doc.createElement('a');\r\n          Link.setAttribute('xlink:href', links[o.id]);\r\n          Link.setAttribute('target', '_top');\r\n          oldParent.appendChild(Link);\r\n          Link.appendChild(taskRect);\r\n          Link.appendChild(taskText);\r\n        });\r\n    }\r\n  }\r\n  /**\r\n   * @param theGap\r\n   * @param theTopPad\r\n   * @param theSidePad\r\n   * @param w\r\n   * @param h\r\n   * @param tasks\r\n   * @param excludes\r\n   * @param includes\r\n   */\r\n  function drawExcludeDays(theGap, theTopPad, theSidePad, w, h, tasks, excludes, includes) {\r\n    const minTime = tasks.reduce(\r\n      (min, { startTime }) => (min ? Math.min(min, startTime) : startTime),\r\n      0\r\n    );\r\n    const maxTime = tasks.reduce((max, { endTime }) => (max ? Math.max(max, endTime) : endTime), 0);\r\n    const dateFormat = parser.yy.getDateFormat();\r\n    if (!minTime || !maxTime) return;\r\n\r\n    const excludeRanges = [];\r\n    let range = null;\r\n    let d = moment(minTime);\r\n    while (d.valueOf() <= maxTime) {\r\n      if (parser.yy.isInvalidDate(d, dateFormat, excludes, includes)) {\r\n        if (!range) {\r\n          range = {\r\n            start: d.clone(),\r\n            end: d.clone(),\r\n          };\r\n        } else {\r\n          range.end = d.clone();\r\n        }\r\n      } else {\r\n        if (range) {\r\n          excludeRanges.push(range);\r\n          range = null;\r\n        }\r\n      }\r\n      d.add(1, 'd');\r\n    }\r\n\r\n    const rectangles = svg.append('g').selectAll('rect').data(excludeRanges).enter();\r\n\r\n    rectangles\r\n      .append('rect')\r\n      .attr('id', function (d) {\r\n        return 'exclude-' + d.start.format('YYYY-MM-DD');\r\n      })\r\n      .attr('x', function (d) {\r\n        return timeScale(d.start) + theSidePad;\r\n      })\r\n      .attr('y', conf.gridLineStartPadding)\r\n      .attr('width', function (d) {\r\n        const renderEnd = d.end.clone().add(1, 'day');\r\n        return timeScale(renderEnd) - timeScale(d.start);\r\n      })\r\n      .attr('height', h - theTopPad - conf.gridLineStartPadding)\r\n      .attr('transform-origin', function (d, i) {\r\n        return (\r\n          (\r\n            timeScale(d.start) +\r\n            theSidePad +\r\n            0.5 * (timeScale(d.end) - timeScale(d.start))\r\n          ).toString() +\r\n          'px ' +\r\n          (i * theGap + 0.5 * h).toString() +\r\n          'px'\r\n        );\r\n      })\r\n      .attr('class', 'exclude-range');\r\n  }\r\n\r\n  /**\r\n   * @param theSidePad\r\n   * @param theTopPad\r\n   * @param w\r\n   * @param h\r\n   */\r\n  function makeGrid(theSidePad, theTopPad, w, h) {\r\n    let bottomXAxis = axisBottom(timeScale)\r\n      .tickSize(-h + theTopPad + conf.gridLineStartPadding)\r\n      .tickFormat(timeFormat(parser.yy.getAxisFormat() || conf.axisFormat || '%Y-%m-%d'));\r\n\r\n    svg\r\n      .append('g')\r\n      .attr('class', 'grid')\r\n      .attr('transform', 'translate(' + theSidePad + ', ' + (h - 50) + ')')\r\n      .call(bottomXAxis)\r\n      .selectAll('text')\r\n      .style('text-anchor', 'middle')\r\n      .attr('fill', '#000')\r\n      .attr('stroke', 'none')\r\n      .attr('font-size', 10)\r\n      .attr('dy', '1em');\r\n\r\n    if (ganttDb.topAxisEnabled() || conf.topAxis) {\r\n      let topXAxis = axisTop(timeScale)\r\n        .tickSize(-h + theTopPad + conf.gridLineStartPadding)\r\n        .tickFormat(timeFormat(parser.yy.getAxisFormat() || conf.axisFormat || '%Y-%m-%d'));\r\n\r\n      svg\r\n        .append('g')\r\n        .attr('class', 'grid')\r\n        .attr('transform', 'translate(' + theSidePad + ', ' + theTopPad + ')')\r\n        .call(topXAxis)\r\n        .selectAll('text')\r\n        .style('text-anchor', 'middle')\r\n        .attr('fill', '#000')\r\n        .attr('stroke', 'none')\r\n        .attr('font-size', 10);\r\n      // .attr('dy', '1em');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param theGap\r\n   * @param theTopPad\r\n   */\r\n  function vertLabels(theGap, theTopPad) {\r\n    const numOccurances = [];\r\n    let prevGap = 0;\r\n\r\n    for (let i = 0; i < categories.length; i++) {\r\n      numOccurances[i] = [categories[i], getCount(categories[i], catsUnfiltered)];\r\n    }\r\n\r\n    svg\r\n      .append('g') // without doing this, impossible to put grid lines behind text\r\n      .selectAll('text')\r\n      .data(numOccurances)\r\n      .enter()\r\n      .append(function (d) {\r\n        const rows = d[0].split(common.lineBreakRegex);\r\n        const dy = -(rows.length - 1) / 2;\r\n\r\n        const svgLabel = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n        svgLabel.setAttribute('dy', dy + 'em');\r\n\r\n        for (let j = 0; j < rows.length; j++) {\r\n          const tspan = doc.createElementNS('http://www.w3.org/2000/svg', 'tspan');\r\n          tspan.setAttribute('alignment-baseline', 'central');\r\n          tspan.setAttribute('x', '10');\r\n          if (j > 0) tspan.setAttribute('dy', '1em');\r\n          tspan.textContent = rows[j];\r\n          svgLabel.appendChild(tspan);\r\n        }\r\n        return svgLabel;\r\n      })\r\n      .attr('x', 10)\r\n      .attr('y', function (d, i) {\r\n        if (i > 0) {\r\n          for (let j = 0; j < i; j++) {\r\n            prevGap += numOccurances[i - 1][1];\r\n            return (d[1] * theGap) / 2 + prevGap * theGap + theTopPad;\r\n          }\r\n        } else {\r\n          return (d[1] * theGap) / 2 + theTopPad;\r\n        }\r\n      })\r\n      .attr('font-size', conf.sectionFontSize)\r\n      .attr('font-size', conf.sectionFontSize)\r\n      .attr('class', function (d) {\r\n        for (let i = 0; i < categories.length; i++) {\r\n          if (d[0] === categories[i]) {\r\n            return 'sectionTitle sectionTitle' + (i % conf.numberSectionStyles);\r\n          }\r\n        }\r\n        return 'sectionTitle';\r\n      });\r\n  }\r\n\r\n  /**\r\n   * @param theSidePad\r\n   * @param theTopPad\r\n   * @param w\r\n   * @param h\r\n   */\r\n  function drawToday(theSidePad, theTopPad, w, h) {\r\n    const todayMarker = ganttDb.getTodayMarker();\r\n    if (todayMarker === 'off') {\r\n      return;\r\n    }\r\n\r\n    const todayG = svg.append('g').attr('class', 'today');\r\n    const today = new Date();\r\n    const todayLine = todayG.append('line');\r\n\r\n    todayLine\r\n      .attr('x1', timeScale(today) + theSidePad)\r\n      .attr('x2', timeScale(today) + theSidePad)\r\n      .attr('y1', conf.titleTopMargin)\r\n      .attr('y2', h - conf.titleTopMargin)\r\n      .attr('class', 'today');\r\n\r\n    if (todayMarker !== '') {\r\n      todayLine.attr('style', todayMarker.replace(/,/g, ';'));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * From this stackexchange question:\r\n   * http://stackoverflow.com/questions/1890203/unique-for-arrays-in-javascript\r\n   *\r\n   * @param arr\r\n   */\r\n  function checkUnique(arr) {\r\n    const hash = {};\r\n    const result = [];\r\n    for (let i = 0, l = arr.length; i < l; ++i) {\r\n      if (!Object.prototype.hasOwnProperty.call(hash, arr[i])) {\r\n        // eslint-disable-line\r\n        // it works with objects! in FF, at least\r\n        hash[arr[i]] = true;\r\n        result.push(arr[i]);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * From this stackexchange question:\r\n   * http://stackoverflow.com/questions/14227981/count-how-many-strings-in-an-array-have-duplicates-in-the-same-array\r\n   *\r\n   * @param arr\r\n   */\r\n  function getCounts(arr) {\r\n    let i = arr.length; // const to loop over\r\n    const obj = {}; // obj to store results\r\n    while (i) {\r\n      obj[arr[--i]] = (obj[arr[i]] || 0) + 1; // count occurrences\r\n    }\r\n    return obj;\r\n  }\r\n\r\n  /**\r\n   * Get specific from everything\r\n   *\r\n   * @param word\r\n   * @param arr\r\n   */\r\n  function getCount(word, arr) {\r\n    return getCounts(arr)[word] || 0;\r\n  }\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `\r\n  .mermaid-main-font {\r\n    font-family: \"trebuchet ms\", verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n  }\r\n  .exclude-range {\r\n    fill: ${options.excludeBkgColor};\r\n  }\r\n\r\n  .section {\r\n    stroke: none;\r\n    opacity: 0.2;\r\n  }\r\n\r\n  .section0 {\r\n    fill: ${options.sectionBkgColor};\r\n  }\r\n\r\n  .section2 {\r\n    fill: ${options.sectionBkgColor2};\r\n  }\r\n\r\n  .section1,\r\n  .section3 {\r\n    fill: ${options.altSectionBkgColor};\r\n    opacity: 0.2;\r\n  }\r\n\r\n  .sectionTitle0 {\r\n    fill: ${options.titleColor};\r\n  }\r\n\r\n  .sectionTitle1 {\r\n    fill: ${options.titleColor};\r\n  }\r\n\r\n  .sectionTitle2 {\r\n    fill: ${options.titleColor};\r\n  }\r\n\r\n  .sectionTitle3 {\r\n    fill: ${options.titleColor};\r\n  }\r\n\r\n  .sectionTitle {\r\n    text-anchor: start;\r\n    // font-size: ${options.ganttFontSize};\r\n    // text-height: 14px;\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n\r\n  }\r\n\r\n\r\n  /* Grid and axis */\r\n\r\n  .grid .tick {\r\n    stroke: ${options.gridColor};\r\n    opacity: 0.8;\r\n    shape-rendering: crispEdges;\r\n    text {\r\n      font-family: ${options.fontFamily};\r\n      fill: ${options.textColor};\r\n    }\r\n  }\r\n\r\n  .grid path {\r\n    stroke-width: 0;\r\n  }\r\n\r\n\r\n  /* Today line */\r\n\r\n  .today {\r\n    fill: none;\r\n    stroke: ${options.todayLineColor};\r\n    stroke-width: 2px;\r\n  }\r\n\r\n\r\n  /* Task styling */\r\n\r\n  /* Default task */\r\n\r\n  .task {\r\n    stroke-width: 2;\r\n  }\r\n\r\n  .taskText {\r\n    text-anchor: middle;\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n  }\r\n\r\n  // .taskText:not([font-size]) {\r\n  //   font-size: ${options.ganttFontSize};\r\n  // }\r\n\r\n  .taskTextOutsideRight {\r\n    fill: ${options.taskTextDarkColor};\r\n    text-anchor: start;\r\n    // font-size: ${options.ganttFontSize};\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n\r\n  }\r\n\r\n  .taskTextOutsideLeft {\r\n    fill: ${options.taskTextDarkColor};\r\n    text-anchor: end;\r\n    // font-size: ${options.ganttFontSize};\r\n  }\r\n\r\n  /* Special case clickable */\r\n  .task.clickable {\r\n    cursor: pointer;\r\n  }\r\n  .taskText.clickable {\r\n    cursor: pointer;\r\n    fill: ${options.taskTextClickableColor} !important;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .taskTextOutsideLeft.clickable {\r\n    cursor: pointer;\r\n    fill: ${options.taskTextClickableColor} !important;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .taskTextOutsideRight.clickable {\r\n    cursor: pointer;\r\n    fill: ${options.taskTextClickableColor} !important;\r\n    font-weight: bold;\r\n  }\r\n\r\n  /* Specific task settings for the sections*/\r\n\r\n  .taskText0,\r\n  .taskText1,\r\n  .taskText2,\r\n  .taskText3 {\r\n    fill: ${options.taskTextColor};\r\n  }\r\n\r\n  .task0,\r\n  .task1,\r\n  .task2,\r\n  .task3 {\r\n    fill: ${options.taskBkgColor};\r\n    stroke: ${options.taskBorderColor};\r\n  }\r\n\r\n  .taskTextOutside0,\r\n  .taskTextOutside2\r\n  {\r\n    fill: ${options.taskTextOutsideColor};\r\n  }\r\n\r\n  .taskTextOutside1,\r\n  .taskTextOutside3 {\r\n    fill: ${options.taskTextOutsideColor};\r\n  }\r\n\r\n\r\n  /* Active task */\r\n\r\n  .active0,\r\n  .active1,\r\n  .active2,\r\n  .active3 {\r\n    fill: ${options.activeTaskBkgColor};\r\n    stroke: ${options.activeTaskBorderColor};\r\n  }\r\n\r\n  .activeText0,\r\n  .activeText1,\r\n  .activeText2,\r\n  .activeText3 {\r\n    fill: ${options.taskTextDarkColor} !important;\r\n  }\r\n\r\n\r\n  /* Completed task */\r\n\r\n  .done0,\r\n  .done1,\r\n  .done2,\r\n  .done3 {\r\n    stroke: ${options.doneTaskBorderColor};\r\n    fill: ${options.doneTaskBkgColor};\r\n    stroke-width: 2;\r\n  }\r\n\r\n  .doneText0,\r\n  .doneText1,\r\n  .doneText2,\r\n  .doneText3 {\r\n    fill: ${options.taskTextDarkColor} !important;\r\n  }\r\n\r\n\r\n  /* Tasks on the critical line */\r\n\r\n  .crit0,\r\n  .crit1,\r\n  .crit2,\r\n  .crit3 {\r\n    stroke: ${options.critBorderColor};\r\n    fill: ${options.critBkgColor};\r\n    stroke-width: 2;\r\n  }\r\n\r\n  .activeCrit0,\r\n  .activeCrit1,\r\n  .activeCrit2,\r\n  .activeCrit3 {\r\n    stroke: ${options.critBorderColor};\r\n    fill: ${options.activeTaskBkgColor};\r\n    stroke-width: 2;\r\n  }\r\n\r\n  .doneCrit0,\r\n  .doneCrit1,\r\n  .doneCrit2,\r\n  .doneCrit3 {\r\n    stroke: ${options.critBorderColor};\r\n    fill: ${options.doneTaskBkgColor};\r\n    stroke-width: 2;\r\n    cursor: pointer;\r\n    shape-rendering: crispEdges;\r\n  }\r\n\r\n  .milestone {\r\n    transform: rotate(45deg) scale(0.8,0.8);\r\n  }\r\n\r\n  .milestoneText {\r\n    font-style: italic;\r\n  }\r\n  .doneCritText0,\r\n  .doneCritText1,\r\n  .doneCritText2,\r\n  .doneCritText3 {\r\n    fill: ${options.taskTextDarkColor} !important;\r\n  }\r\n\r\n  .activeCritText0,\r\n  .activeCritText1,\r\n  .activeCritText2,\r\n  .activeCritText3 {\r\n    fill: ${options.taskTextDarkColor} !important;\r\n  }\r\n\r\n  .titleText {\r\n    text-anchor: middle;\r\n    font-size: 18px;\r\n    fill: ${options.textColor}    ;\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n  }\r\n`;\r\n\r\nexport default getStyles;\r\n","import { log } from '../../logger';\r\nimport { random } from '../../utils';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport * as configApi from '../../config';\r\nimport { getConfig } from '../../config';\r\nimport common from '../common/common';\r\n\r\nlet mainBranchName = getConfig().gitGraph.mainBranchName;\r\nlet commits = {};\r\nlet head = null;\r\nlet branches = {};\r\nbranches[mainBranchName] = head;\r\nlet curBranch = mainBranchName;\r\nlet direction = 'LR';\r\nlet seq = 0;\r\n\r\nfunction getId() {\r\n  return random({ length: 7 });\r\n}\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\n// /**\r\n//  * @param currentCommit\r\n//  * @param otherCommit\r\n//  */\r\n// function isfastforwardable(currentCommit, otherCommit) {\r\n//   log.debug('Entering isfastforwardable:', currentCommit.id, otherCommit.id);\r\n//   let cnt = 0;\r\n//   while (currentCommit.seq <= otherCommit.seq && currentCommit !== otherCommit && cnt < 1000) {\r\n//     cnt++;\r\n//     // only if other branch has more commits\r\n//     if (otherCommit.parent == null) break;\r\n//     if (Array.isArray(otherCommit.parent)) {\r\n//       log.debug('In merge commit:', otherCommit.parent);\r\n//       return (\r\n//         isfastforwardable(currentCommit, commits[otherCommit.parent[0]]) ||\r\n//         isfastforwardable(currentCommit, commits[otherCommit.parent[1]])\r\n//       );\r\n//     } else {\r\n//       otherCommit = commits[otherCommit.parent];\r\n//     }\r\n//   }\r\n//   log.debug(currentCommit.id, otherCommit.id);\r\n//   return currentCommit.id === otherCommit.id;\r\n// }\r\n\r\n/**\r\n * @param currentCommit\r\n * @param otherCommit\r\n */\r\n// function isReachableFrom(currentCommit, otherCommit) {\r\n//   const currentSeq = currentCommit.seq;\r\n//   const otherSeq = otherCommit.seq;\r\n//   if (currentSeq > otherSeq) return isfastforwardable(otherCommit, currentCommit);\r\n//   return false;\r\n// }\r\n\r\n/**\r\n * @param list\r\n * @param fn\r\n */\r\nfunction uniqBy(list, fn) {\r\n  const recordMap = Object.create(null);\r\n  return list.reduce((out, item) => {\r\n    const key = fn(item);\r\n    if (!recordMap[key]) {\r\n      recordMap[key] = true;\r\n      out.push(item);\r\n    }\r\n    return out;\r\n  }, []);\r\n}\r\n\r\nexport const setDirection = function (dir) {\r\n  direction = dir;\r\n};\r\nlet options = {};\r\nexport const setOptions = function (rawOptString) {\r\n  log.debug('options str', rawOptString);\r\n  rawOptString = rawOptString && rawOptString.trim();\r\n  rawOptString = rawOptString || '{}';\r\n  try {\r\n    options = JSON.parse(rawOptString);\r\n  } catch (e) {\r\n    log.error('error while parsing gitGraph options', e.message);\r\n  }\r\n};\r\n\r\nexport const getOptions = function () {\r\n  return options;\r\n};\r\n\r\nexport const commit = function (msg, id, type, tag) {\r\n  log.debug('Entering commit:', msg, id, type, tag);\r\n  id = common.sanitizeText(id, configApi.getConfig());\r\n  msg = common.sanitizeText(msg, configApi.getConfig());\r\n  tag = common.sanitizeText(tag, configApi.getConfig());\r\n  const commit = {\r\n    id: id ? id : seq + '-' + getId(),\r\n    message: msg,\r\n    seq: seq++,\r\n    type: type ? type : commitType.NORMAL,\r\n    tag: tag ? tag : '',\r\n    parents: head == null ? [] : [head.id],\r\n    branch: curBranch,\r\n  };\r\n  head = commit;\r\n  commits[commit.id] = commit;\r\n  branches[curBranch] = commit.id;\r\n  log.debug('in pushCommit ' + commit.id);\r\n};\r\n\r\nexport const branch = function (name) {\r\n  name = common.sanitizeText(name, configApi.getConfig());\r\n  if (typeof branches[name] === 'undefined') {\r\n    branches[name] = head != null ? head.id : null;\r\n    checkout(name);\r\n    log.debug('in createBranch');\r\n  } else {\r\n    let error = new Error(\r\n      'Trying to create an existing branch. (Help: Either use a new name if you want create a new branch or try using \"checkout ' +\r\n        name +\r\n        '\")'\r\n    );\r\n    error.hash = {\r\n      text: 'branch ' + name,\r\n      token: 'branch ' + name,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['\"checkout ' + name + '\"'],\r\n    };\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const merge = function (otherBranch) {\r\n  otherBranch = common.sanitizeText(otherBranch, configApi.getConfig());\r\n  const currentCommit = commits[branches[curBranch]];\r\n  const otherCommit = commits[branches[otherBranch]];\r\n  if (curBranch === otherBranch) {\r\n    let error = new Error('Incorrect usage of \"merge\". Cannot merge a branch to itself');\r\n    error.hash = {\r\n      text: 'merge ' + otherBranch,\r\n      token: 'merge ' + otherBranch,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['branch abc'],\r\n    };\r\n    throw error;\r\n  } else if (typeof currentCommit === 'undefined' || !currentCommit) {\r\n    let error = new Error(\r\n      'Incorrect usage of \"merge\". Current branch (' + curBranch + ')has no commits'\r\n    );\r\n    error.hash = {\r\n      text: 'merge ' + otherBranch,\r\n      token: 'merge ' + otherBranch,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['commit'],\r\n    };\r\n    throw error;\r\n  } else if (typeof branches[otherBranch] === 'undefined') {\r\n    let error = new Error(\r\n      'Incorrect usage of \"merge\". Branch to be merged (' + otherBranch + ') does not exist'\r\n    );\r\n    error.hash = {\r\n      text: 'merge ' + otherBranch,\r\n      token: 'merge ' + otherBranch,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['branch ' + otherBranch],\r\n    };\r\n    throw error;\r\n  } else if (typeof otherCommit === 'undefined' || !otherCommit) {\r\n    let error = new Error(\r\n      'Incorrect usage of \"merge\". Branch to be merged (' + otherBranch + ') has no commits'\r\n    );\r\n    error.hash = {\r\n      text: 'merge ' + otherBranch,\r\n      token: 'merge ' + otherBranch,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['\"commit\"'],\r\n    };\r\n    throw error;\r\n  } else if (currentCommit === otherCommit) {\r\n    let error = new Error('Incorrect usage of \"merge\". Both branches have same head');\r\n    error.hash = {\r\n      text: 'merge ' + otherBranch,\r\n      token: 'merge ' + otherBranch,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['branch abc'],\r\n    };\r\n    throw error;\r\n  }\r\n  // if (isReachableFrom(currentCommit, otherCommit)) {\r\n  //   log.debug('Already merged');\r\n  //   return;\r\n  // }\r\n  // if (isfastforwardable(currentCommit, otherCommit)) {\r\n  //   branches[curBranch] = branches[otherBranch];\r\n  //   head = commits[branches[curBranch]];\r\n  // } else {\r\n  // create merge commit\r\n  const commit = {\r\n    id: seq + '-' + getId(),\r\n    message: 'merged branch ' + otherBranch + ' into ' + curBranch,\r\n    seq: seq++,\r\n    parents: [head == null ? null : head.id, branches[otherBranch]],\r\n    branch: curBranch,\r\n    type: commitType.MERGE,\r\n  };\r\n  head = commit;\r\n  commits[commit.id] = commit;\r\n  branches[curBranch] = commit.id;\r\n  // }\r\n  log.debug(branches);\r\n  log.debug('in mergeBranch');\r\n};\r\n\r\nexport const checkout = function (branch) {\r\n  branch = common.sanitizeText(branch, configApi.getConfig());\r\n  if (typeof branches[branch] === 'undefined') {\r\n    let error = new Error(\r\n      'Trying to checkout branch which is not yet created. (Help try using \"branch ' + branch + '\")'\r\n    );\r\n    error.hash = {\r\n      text: 'checkout ' + branch,\r\n      token: 'checkout ' + branch,\r\n      line: '1',\r\n      loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n      expected: ['\"branch ' + branch + '\"'],\r\n    };\r\n    throw error;\r\n    //branches[branch] = head != null ? head.id : null;\r\n    //log.debug('in createBranch');\r\n  } else {\r\n    curBranch = branch;\r\n    const id = branches[curBranch];\r\n    head = commits[id];\r\n  }\r\n};\r\n\r\n// export const reset = function (commitRef) {\r\n//   log.debug('in reset', commitRef);\r\n//   const ref = commitRef.split(':')[0];\r\n//   let parentCount = parseInt(commitRef.split(':')[1]);\r\n//   let commit = ref === 'HEAD' ? head : commits[branches[ref]];\r\n//   log.debug(commit, parentCount);\r\n//   while (parentCount > 0) {\r\n//     commit = commits[commit.parent];\r\n//     parentCount--;\r\n//     if (!commit) {\r\n//       const err = 'Critical error - unique parent commit not found during reset';\r\n//       log.error(err);\r\n//       throw err;\r\n//     }\r\n//   }\r\n//   head = commit;\r\n//   branches[curBranch] = commit.id;\r\n// };\r\n\r\n/**\r\n * @param arr\r\n * @param key\r\n * @param newval\r\n */\r\nfunction upsert(arr, key, newval) {\r\n  const index = arr.indexOf(key);\r\n  if (index === -1) {\r\n    arr.push(newval);\r\n  } else {\r\n    arr.splice(index, 1, newval);\r\n  }\r\n}\r\n\r\n/** @param commitArr */\r\nfunction prettyPrintCommitHistory(commitArr) {\r\n  const commit = commitArr.reduce((out, commit) => {\r\n    if (out.seq > commit.seq) return out;\r\n    return commit;\r\n  }, commitArr[0]);\r\n  let line = '';\r\n  commitArr.forEach(function (c) {\r\n    if (c === commit) {\r\n      line += '\\t*';\r\n    } else {\r\n      line += '\\t|';\r\n    }\r\n  });\r\n  const label = [line, commit.id, commit.seq];\r\n  for (let branch in branches) {\r\n    if (branches[branch] === commit.id) label.push(branch);\r\n  }\r\n  log.debug(label.join(' '));\r\n  if (commit.parents && commit.parents.length == 2) {\r\n    const newCommit = commits[commit.parents[0]];\r\n    upsert(commitArr, commit, newCommit);\r\n    commitArr.push(commits[commit.parents[1]]);\r\n  } else if (commit.parents.length == 0) {\r\n    return;\r\n  } else {\r\n    const nextCommit = commits[commit.parents];\r\n    upsert(commitArr, commit, nextCommit);\r\n  }\r\n  commitArr = uniqBy(commitArr, (c) => c.id);\r\n  prettyPrintCommitHistory(commitArr);\r\n}\r\n\r\nexport const prettyPrint = function () {\r\n  log.debug(commits);\r\n  const node = getCommitsArray()[0];\r\n  prettyPrintCommitHistory([node]);\r\n};\r\n\r\nexport const clear = function () {\r\n  commits = {};\r\n  head = null;\r\n  let mainBranch = getConfig().gitGraph.mainBranchName;\r\n  branches = {};\r\n  branches[mainBranch] = null;\r\n  curBranch = mainBranch;\r\n  seq = 0;\r\n};\r\n\r\nexport const getBranchesAsObjArray = function () {\r\n  const branchArr = [];\r\n  for (let branch in branches) {\r\n    // branchArr.push({ name: branch, commit: commits[branches[branch]] });\r\n    branchArr.push({ name: branch });\r\n  }\r\n  return branchArr;\r\n};\r\n\r\nexport const getBranches = function () {\r\n  return branches;\r\n};\r\nexport const getCommits = function () {\r\n  return commits;\r\n};\r\nexport const getCommitsArray = function () {\r\n  const commitArr = Object.keys(commits).map(function (key) {\r\n    return commits[key];\r\n  });\r\n  commitArr.forEach(function (o) {\r\n    log.debug(o.id);\r\n  });\r\n  commitArr.sort((a, b) => a.seq - b.seq);\r\n  return commitArr;\r\n};\r\nexport const getCurrentBranch = function () {\r\n  return curBranch;\r\n};\r\nexport const getDirection = function () {\r\n  return direction;\r\n};\r\nexport const getHead = function () {\r\n  return head;\r\n};\r\n\r\nexport const commitType = {\r\n  NORMAL: 0,\r\n  REVERSE: 1,\r\n  HIGHLIGHT: 2,\r\n  MERGE: 3,\r\n};\r\n\r\nexport default {\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().gitGraph,\r\n  setDirection,\r\n  setOptions,\r\n  getOptions,\r\n  commit,\r\n  branch,\r\n  merge,\r\n  checkout,\r\n  //reset,\r\n  prettyPrint,\r\n  clear,\r\n  getBranchesAsObjArray,\r\n  getBranches,\r\n  getCommits,\r\n  getCommitsArray,\r\n  getCurrentBranch,\r\n  getDirection,\r\n  getHead,\r\n  commitType,\r\n};\r\n","import { curveBasis, line, select } from 'd3';\r\nimport { interpolateToCurve, getStylesFromArray, configureSvgSize } from '../../utils';\r\nimport db from './gitGraphAst';\r\nimport gitGraphParser from './parser/gitGraph';\r\nimport { log } from '../../logger';\r\nimport { getConfig } from '../../config';\r\nlet allCommitsDict = {};\r\nlet branchNum;\r\n\r\nconst commitType = {\r\n  NORMAL: 0,\r\n  REVERSE: 1,\r\n  HIGHLIGHT: 2,\r\n  MERGE: 3,\r\n};\r\n\r\nlet branchPos = {};\r\nlet commitPos = {};\r\nlet lanes = [];\r\nlet maxPos = 0;\r\nconst clear = () => {\r\n  branchPos = {};\r\n  commitPos = {};\r\n  allCommitsDict = {};\r\n  maxPos = 0;\r\n  lanes = [];\r\n};\r\n\r\n/**\r\n * Draws a text, used for labels of the branches\r\n *\r\n * @param {string} txt The text\r\n * @returns {SVGElement}\r\n */\r\nconst drawText = (txt) => {\r\n  const svgLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');\r\n  let rows = [];\r\n\r\n  // Handling of new lines in the label\r\n  if (typeof txt === 'string') {\r\n    rows = txt.split(/\\\\n|\\n|<br\\s*\\/?>/gi);\r\n  } else if (Array.isArray(txt)) {\r\n    rows = txt;\r\n  } else {\r\n    rows = [];\r\n  }\r\n\r\n  for (let j = 0; j < rows.length; j++) {\r\n    const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\r\n    tspan.setAttributeNS('http://www.w3.org/XML/1998/namespace', 'xml:space', 'preserve');\r\n    tspan.setAttribute('dy', '1em');\r\n    tspan.setAttribute('x', '0');\r\n    tspan.setAttribute('class', 'row');\r\n    tspan.textContent = rows[j].trim();\r\n    svgLabel.appendChild(tspan);\r\n  }\r\n  /**\r\n   * @param svg\r\n   * @param selector\r\n   */\r\n  return svgLabel;\r\n};\r\n\r\n/**\r\n * Draws the commits with its symbol and labels. The function has tywo modes, one which only\r\n * calculates the positions and one that does the actual drawing. This for a simple way getting the\r\n * vertical leyering rcorrect in the graph.\r\n *\r\n * @param {any} svg\r\n * @param {any} commits\r\n * @param {any} modifyGraph\r\n */\r\nconst drawCommits = (svg, commits, modifyGraph) => {\r\n  const gitGraphConfig = getConfig().gitGraph;\r\n  const gBullets = svg.append('g').attr('class', 'commit-bullets');\r\n  const gLabels = svg.append('g').attr('class', 'commit-labels');\r\n  let pos = 0;\r\n\r\n  const keys = Object.keys(commits);\r\n  const sortedKeys = keys.sort((a, b) => {\r\n    return commits[a].seq - commits[b].seq;\r\n  });\r\n  sortedKeys.forEach((key, index) => {\r\n    const commit = commits[key];\r\n\r\n    const y = branchPos[commit.branch].pos;\r\n    const x = pos + 10;\r\n    // Don't draw the commits now but calculate the positioning which is used by the branch lines etc.\r\n    if (modifyGraph) {\r\n      let typeClass;\r\n      switch (commit.type) {\r\n        case commitType.NORMAL:\r\n          typeClass = 'commit-normal';\r\n          break;\r\n        case commitType.REVERSE:\r\n          typeClass = 'commit-reverse';\r\n          break;\r\n        case commitType.HIGHLIGHT:\r\n          typeClass = 'commit-highlight';\r\n          break;\r\n        case commitType.MERGE:\r\n          typeClass = 'commit-merge';\r\n          break;\r\n        default:\r\n          typeClass = 'commit-normal';\r\n      }\r\n\r\n      if (commit.type === commitType.HIGHLIGHT) {\r\n        const circle = gBullets.append('rect');\r\n        circle.attr('x', x - 10);\r\n        circle.attr('y', y - 10);\r\n        circle.attr('height', 20);\r\n        circle.attr('width', 20);\r\n        circle.attr(\r\n          'class',\r\n          'commit ' +\r\n            commit.id +\r\n            ' commit-highlight' +\r\n            branchPos[commit.branch].index +\r\n            ' ' +\r\n            typeClass +\r\n            '-outer'\r\n        );\r\n        gBullets\r\n          .append('rect')\r\n          .attr('x', x - 6)\r\n          .attr('y', y - 6)\r\n          .attr('height', 12)\r\n          .attr('width', 12)\r\n          .attr(\r\n            'class',\r\n            'commit ' +\r\n              commit.id +\r\n              ' commit' +\r\n              branchPos[commit.branch].index +\r\n              ' ' +\r\n              typeClass +\r\n              '-inner'\r\n          );\r\n      } else {\r\n        const circle = gBullets.append('circle');\r\n        circle.attr('cx', x);\r\n        circle.attr('cy', y);\r\n        circle.attr('r', commit.type === commitType.MERGE ? 9 : 10);\r\n        circle.attr('class', 'commit ' + commit.id + ' commit' + branchPos[commit.branch].index);\r\n        if (commit.type === commitType.MERGE) {\r\n          const circle2 = gBullets.append('circle');\r\n          circle2.attr('cx', x);\r\n          circle2.attr('cy', y);\r\n          circle2.attr('r', 6);\r\n          circle2.attr(\r\n            'class',\r\n            'commit ' + typeClass + ' ' + commit.id + ' commit' + branchPos[commit.branch].index\r\n          );\r\n        }\r\n        if (commit.type === commitType.REVERSE) {\r\n          const cross = gBullets.append('path');\r\n          cross\r\n            .attr('d', `M ${x - 5},${y - 5}L${x + 5},${y + 5}M${x - 5},${y + 5}L${x + 5},${y - 5}`)\r\n            .attr(\r\n              'class',\r\n              'commit ' + typeClass + ' ' + commit.id + ' commit' + branchPos[commit.branch].index\r\n            );\r\n        }\r\n      }\r\n    }\r\n    commitPos[commit.id] = { x: pos + 10, y: y };\r\n\r\n    // The first iteration over the commits are for positioning purposes, this\r\n    // is required for drawing the lines. The circles and labels is drawn after the labels\r\n    // placing them on top of the lines.\r\n    if (modifyGraph) {\r\n      const px = 4;\r\n      const py = 2;\r\n      // Draw the commit label\r\n      if (commit.type !== commitType.MERGE && gitGraphConfig.showCommitLabel) {\r\n        const labelBkg = gLabels.insert('rect').attr('class', 'commit-label-bkg');\r\n\r\n        const text = gLabels\r\n          .append('text')\r\n          .attr('x', pos)\r\n          .attr('y', y + 25)\r\n          .attr('class', 'commit-label')\r\n          .text(commit.id);\r\n        let bbox = text.node().getBBox();\r\n\r\n        // Now we have the label, lets position the background\r\n        labelBkg\r\n          .attr('x', pos + 10 - bbox.width / 2 - py)\r\n          .attr('y', y + 13.5)\r\n          .attr('width', bbox.width + 2 * py)\r\n          .attr('height', bbox.height + 2 * py);\r\n        text.attr('x', pos + 10 - bbox.width / 2);\r\n      }\r\n      if (commit.tag) {\r\n        const rect = gLabels.insert('polygon');\r\n        const hole = gLabels.append('circle');\r\n        const tag = gLabels\r\n          .append('text')\r\n          // Note that we are delaying setting the x position until we know the width of the text\r\n          .attr('y', y - 16)\r\n          .attr('class', 'tag-label')\r\n          .text(commit.tag);\r\n        let tagBbox = tag.node().getBBox();\r\n        tag.attr('x', pos + 10 - tagBbox.width / 2);\r\n\r\n        const h2 = tagBbox.height / 2;\r\n        const ly = y - 19.2;\r\n        rect.attr('class', 'tag-label-bkg').attr(\r\n          'points',\r\n          `\r\n          ${pos - tagBbox.width / 2 - px / 2},${ly + py}\r\n          ${pos - tagBbox.width / 2 - px / 2},${ly - py}\r\n          ${pos + 10 - tagBbox.width / 2 - px},${ly - h2 - py}\r\n          ${pos + 10 + tagBbox.width / 2 + px},${ly - h2 - py}\r\n          ${pos + 10 + tagBbox.width / 2 + px},${ly + h2 + py}\r\n          ${pos + 10 - tagBbox.width / 2 - px},${ly + h2 + py}`\r\n        );\r\n\r\n        hole\r\n          .attr('cx', pos - tagBbox.width / 2 + px / 2)\r\n          .attr('cy', ly)\r\n          .attr('r', 1.5)\r\n          .attr('class', 'tag-hole');\r\n      }\r\n    }\r\n    pos += 50;\r\n    if (pos > maxPos) {\r\n      maxPos = pos;\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Detect if there are other commits between commit1s x-position and commit2s x-position on the same\r\n * branch as commit2.\r\n *\r\n * @param {any} commit1\r\n * @param {any} commit2\r\n * @param allCommits\r\n * @returns\r\n */\r\nconst hasOverlappingCommits = (commit1, commit2, allCommits) => {\r\n  const commit1Pos = commitPos[commit2.id];\r\n  const commit2Pos = commitPos[commit1.id];\r\n\r\n  // Find commits on the same branch as commit2\r\n  const keys = Object.keys(allCommits);\r\n  const overlappingComits = keys.filter((key) => {\r\n    return (\r\n      allCommits[key].branch === commit2.branch &&\r\n      allCommits[key].seq > commit1.seq &&\r\n      allCommits[key].seq < commit2.seq\r\n    );\r\n  });\r\n\r\n  return overlappingComits.length > 0;\r\n};\r\n\r\n/**\r\n * This function find a lane in the y-axis that is not overlapping with any other lanes. This is\r\n * used for drawing the lines between commits.\r\n *\r\n * @param {any} y1\r\n * @param {any} y2\r\n * @param {any} _depth\r\n * @returns\r\n */\r\nconst findLane = (y1, y2, _depth) => {\r\n  const depth = _depth || 0;\r\n\r\n  const candidate = y1 + Math.abs(y1 - y2) / 2;\r\n  if (depth > 5) {\r\n    return candidate;\r\n  }\r\n\r\n  let ok = true;\r\n  for (let i = 0; i < lanes.length; i++) {\r\n    if (Math.abs(lanes[i] - candidate) < 10) {\r\n      ok = false;\r\n    }\r\n  }\r\n  if (ok) {\r\n    lanes.push(candidate);\r\n    return candidate;\r\n  }\r\n  const diff = Math.abs(y1 - y2);\r\n  return findLane(y1, y2 - diff / 5, depth);\r\n};\r\n\r\n/**\r\n * This function draw trhe lines between the commits. They were arrows initially.\r\n *\r\n * @param {any} svg\r\n * @param {any} commit1\r\n * @param {any} commit2\r\n * @param {any} allCommits\r\n */\r\nconst drawArrow = (svg, commit1, commit2, allCommits) => {\r\n  const conf = getConfig();\r\n\r\n  const p1 = commitPos[commit1.id];\r\n  const p2 = commitPos[commit2.id];\r\n  const overlappingCommits = hasOverlappingCommits(commit1, commit2, allCommits);\r\n  // log.debug('drawArrow', p1, p2, overlappingCommits, commit1.id, commit2.id);\r\n\r\n  let url = '';\r\n  if (conf.arrowMarkerAbsolute) {\r\n    url =\r\n      window.location.protocol +\r\n      '//' +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      window.location.search;\r\n    url = url.replace(/\\(/g, '\\\\(');\r\n    url = url.replace(/\\)/g, '\\\\)');\r\n  }\r\n\r\n  let arc = '';\r\n  let arc2 = '';\r\n  let radius = 0;\r\n  let offset = 0;\r\n  let colorClassNum = branchPos[commit2.branch].index;\r\n  let lineDef;\r\n  if (overlappingCommits) {\r\n    arc = 'A 10 10, 0, 0, 0,';\r\n    arc2 = 'A 10 10, 0, 0, 1,';\r\n    radius = 10;\r\n    offset = 10;\r\n    // Figure out the color of the arrow,arrows going down take the color from the destination branch\r\n    colorClassNum = branchPos[commit2.branch].index;\r\n\r\n    const lineY = p1.y < p2.y ? findLane(p1.y, p2.y) : findLane(p2.y, p1.y);\r\n\r\n    if (p1.y < p2.y) {\r\n      lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${lineY - radius} ${arc} ${p1.x + offset} ${lineY} L ${\r\n        p2.x - radius\r\n      } ${lineY} ${arc2} ${p2.x} ${lineY + offset} L ${p2.x} ${p2.y}`;\r\n    } else {\r\n      lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${lineY + radius} ${arc2} ${\r\n        p1.x + offset\r\n      } ${lineY} L ${p2.x - radius} ${lineY} ${arc} ${p2.x} ${lineY - offset} L ${p2.x} ${p2.y}`;\r\n    }\r\n  } else {\r\n    if (p1.y < p2.y) {\r\n      arc = 'A 20 20, 0, 0, 0,';\r\n      radius = 20;\r\n      offset = 20;\r\n\r\n      // Figure out the color of the arrow,arrows going down take the color from the destination branch\r\n      colorClassNum = branchPos[commit2.branch].index;\r\n\r\n      lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y - radius} ${arc} ${p1.x + offset} ${p2.y} L ${\r\n        p2.x\r\n      } ${p2.y}`;\r\n    }\r\n    if (p1.y > p2.y) {\r\n      arc = 'A 20 20, 0, 0, 0,';\r\n      radius = 20;\r\n      offset = 20;\r\n\r\n      // Arrows going up take the color from the source branch\r\n      colorClassNum = branchPos[commit1.branch].index;\r\n      lineDef = `M ${p1.x} ${p1.y} L ${p2.x - radius} ${p1.y} ${arc} ${p2.x} ${p1.y - offset} L ${\r\n        p2.x\r\n      } ${p2.y}`;\r\n    }\r\n\r\n    if (p1.y === p2.y) {\r\n      colorClassNum = branchPos[commit1.branch].index;\r\n      lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y - radius} ${arc} ${p1.x + offset} ${p2.y} L ${\r\n        p2.x\r\n      } ${p2.y}`;\r\n    }\r\n  }\r\n  const arrow = svg\r\n    .append('path')\r\n    .attr('d', lineDef)\r\n    .attr('class', 'arrow arrow' + colorClassNum);\r\n};\r\n\r\nconst drawArrows = (svg, commits) => {\r\n  const gArrows = svg.append('g').attr('class', 'commit-arrows');\r\n  let pos = 0;\r\n\r\n  const k = Object.keys(commits);\r\n  k.forEach((key, index) => {\r\n    const commit = commits[key];\r\n    if (commit.parents && commit.parents.length > 0) {\r\n      commit.parents.forEach((parent) => {\r\n        drawArrow(gArrows, commits[parent], commit, commits);\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * This function adds the branches and the branches' labels to the svg.\r\n *\r\n * @param svg\r\n * @param commitid\r\n * @param branches\r\n * @param direction\r\n */\r\nconst drawBranches = (svg, branches) => {\r\n  const gitGraphConfig = getConfig().gitGraph;\r\n  const g = svg.append('g');\r\n  branches.forEach((branch, index) => {\r\n    const pos = branchPos[branch.name].pos;\r\n    const line = g.append('line');\r\n    line.attr('x1', 0);\r\n    line.attr('y1', pos);\r\n    line.attr('x2', maxPos);\r\n    line.attr('y2', pos);\r\n    line.attr('class', 'branch branch' + index);\r\n\r\n    lanes.push(pos);\r\n\r\n    let name = index === 0 ? gitGraphConfig.mainBranchName : branch.name;\r\n\r\n    // Create the actual text element\r\n    const labelElement = drawText(name);\r\n    // Create outer g, edgeLabel, this will be positioned after graph layout\r\n    const bkg = g.insert('rect');\r\n    const branchLabel = g.insert('g').attr('class', 'branchLabel');\r\n\r\n    // Create inner g, label, this will be positioned now for centering the text\r\n    const label = branchLabel.insert('g').attr('class', 'label branch-label' + index);\r\n    label.node().appendChild(labelElement);\r\n    let bbox = labelElement.getBBox();\r\n    bkg\r\n      .attr('class', 'branchLabelBkg label' + index)\r\n      .attr('rx', 4)\r\n      .attr('ry', 4)\r\n      .attr('x', -bbox.width - 4)\r\n      .attr('y', -bbox.height / 2 + 8)\r\n      .attr('width', bbox.width + 18)\r\n      .attr('height', bbox.height + 4);\r\n\r\n    label.attr(\r\n      'transform',\r\n      'translate(' + (-bbox.width - 14) + ', ' + (pos - bbox.height / 2 - 1) + ')'\r\n    );\r\n    bkg.attr('transform', 'translate(' + -19 + ', ' + (pos - bbox.height / 2) + ')');\r\n  });\r\n};\r\n\r\n/**\r\n * @param svg\r\n * @param commit\r\n * @param direction\r\n * @param branchColor\r\n * @param txt\r\n * @param id\r\n * @param ver\r\n */\r\nexport const draw = function (txt, id, ver) {\r\n  clear();\r\n  const conf = getConfig();\r\n  const gitGraphConfig = getConfig().gitGraph;\r\n  // try {\r\n  const parser = gitGraphParser.parser;\r\n  parser.yy = db;\r\n  parser.yy.clear();\r\n\r\n  log.debug('in gitgraph renderer', txt + '\\n', 'id:', id, ver);\r\n  // // Parse the graph definition\r\n  parser.parse(txt + '\\n');\r\n\r\n  const direction = db.getDirection();\r\n  allCommitsDict = db.getCommits();\r\n  const branches = db.getBranchesAsObjArray();\r\n\r\n  // Position branches vertically\r\n  let pos = 0;\r\n  branches.forEach((branch, index) => {\r\n    branchPos[branch.name] = { pos, index };\r\n    pos += 50;\r\n  });\r\n\r\n  const diagram = select(`[id=\"${id}\"]`);\r\n\r\n  drawCommits(diagram, allCommitsDict, false);\r\n  if (gitGraphConfig.showBranches) {\r\n    drawBranches(diagram, branches);\r\n  }\r\n  drawArrows(diagram, allCommitsDict);\r\n  drawCommits(diagram, allCommitsDict, true);\r\n\r\n  const padding = gitGraphConfig.diagramPadding;\r\n  const svgBounds = diagram.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n\r\n  configureSvgSize(diagram, height, width, conf.useMaxWidth);\r\n  const vBox = `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`;\r\n  diagram.attr('viewBox', vBox);\r\n};\r\n\r\nexport default {\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `\r\n  .commit-id,\r\n  .commit-msg,\r\n  .branch-label {\r\n    fill: lightgrey;\r\n    color: lightgrey;\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n  }\r\n  ${[0, 1, 2, 3, 4, 5, 6, 7]\r\n    .map(\r\n      (i) =>\r\n        `\r\n        .branch-label${i} { fill: ${options['gitBranchLabel' + i]}; }\r\n        .commit${i} { stroke: ${options['git' + i]}; fill: ${options['git' + i]}; }\r\n        .commit-highlight${i} { stroke: ${options['gitInv' + i]}; fill: ${options['gitInv' + i]}; }\r\n        .label${i}  { fill: ${options['git' + i]}; }\r\n        .arrow${i} { stroke: ${options['git' + i]}; }\r\n        `\r\n    )\r\n    .join('\\n')}\r\n\r\n  .branch {\r\n    stroke-width: 1;\r\n    stroke: ${options.lineColor};\r\n    stroke-dasharray: 2;\r\n  }\r\n  .commit-label { font-size: 10px; fill: ${options.commitLabelColor};}\r\n  .commit-label-bkg { font-size: 10px; fill: ${options.commitLabelBackground}; opacity: 0.5; }\r\n  .tag-label { font-size: 10px; fill: ${options.tagLabelColor};}\r\n  .tag-label-bkg { fill: ${options.tagLabelBackground}; stroke: ${options.tagLabelBorder}; }\r\n  .tag-hole { fill: ${options.textColor}; }\r\n\r\n  .commit-merge {\r\n    stroke: ${options.primaryColor};\r\n    fill: ${options.primaryColor};\r\n  }\r\n  .commit-reverse {\r\n    stroke: ${options.primaryColor};\r\n    fill: ${options.primaryColor};\r\n    stroke-width: 3;\r\n  }\r\n  .commit-highlight-outer {\r\n  }\r\n  .commit-highlight-inner {\r\n    stroke: ${options.primaryColor};\r\n    fill: ${options.primaryColor};\r\n  }\r\n\r\n  .arrow { stroke-width: 8; stroke-linecap: round; fill: none}\r\n  }\r\n`;\r\n\r\nexport default getStyles;\r\n","/** Created by knut on 15-01-14. */\r\nimport { log } from '../../logger';\r\n\r\nvar message = '';\r\nvar info = false;\r\n\r\nexport const setMessage = (txt) => {\r\n  log.debug('Setting message to: ' + txt);\r\n  message = txt;\r\n};\r\n\r\nexport const getMessage = () => {\r\n  return message;\r\n};\r\n\r\nexport const setInfo = (inf) => {\r\n  info = inf;\r\n};\r\n\r\nexport const getInfo = () => {\r\n  return info;\r\n};\r\n\r\n// export const parseError = (err, hash) => {\r\n//   global.mermaidAPI.parseError(err, hash)\r\n// }\r\n\r\nexport default {\r\n  setMessage,\r\n  getMessage,\r\n  setInfo,\r\n  getInfo,\r\n  // parseError\r\n};\r\n","/** Created by knut on 14-12-11. */\r\nimport { select } from 'd3';\r\nimport db from './infoDb';\r\nimport infoParser from './parser/info';\r\nimport { log } from '../../logger';\r\nimport { getConfig } from '../../config';\r\n\r\nconst conf = {};\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n\r\n  keys.forEach(function (key) {\r\n    conf[key] = cnf[key];\r\n  });\r\n};\r\n\r\n/**\r\n * Draws a an info picture in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {any} text\r\n * @param {any} id\r\n * @param {any} version\r\n */\r\nexport const draw = (text, id, version) => {\r\n  try {\r\n    const parser = infoParser.parser;\r\n    parser.yy = db;\r\n    log.debug('Renering info diagram\\n' + text);\r\n\r\n    const securityLevel = getConfig().securityLevel;\r\n    // Handle root and ocument for when rendering in sanbox mode\r\n    let sandboxElement;\r\n    if (securityLevel === 'sandbox') {\r\n      sandboxElement = select('#i' + id);\r\n    }\r\n    const root =\r\n      securityLevel === 'sandbox'\r\n        ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n        : select('body');\r\n    const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n    // Parse the graph definition\r\n    parser.parse(text);\r\n    log.debug('Parsed info diagram');\r\n    // Fetch the default direction, use TD if none was found\r\n    const svg = root.select('#' + id);\r\n\r\n    const g = svg.append('g');\r\n\r\n    g.append('text') // text label for the x axis\r\n      .attr('x', 100)\r\n      .attr('y', 40)\r\n      .attr('class', 'version')\r\n      .attr('font-size', '32px')\r\n      .style('text-anchor', 'middle')\r\n      .text('v ' + version);\r\n\r\n    svg.attr('height', 100);\r\n    svg.attr('width', 400);\r\n    // svg.attr('viewBox', '0 0 300 150');\r\n  } catch (e) {\r\n    log.error('Error while rendering info diagram');\r\n    log.error(e.message);\r\n  }\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = () => ``;\r\n\r\nexport default getStyles;\r\n","import { log } from '../../logger';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport * as configApi from '../../config';\r\nimport common from '../common/common';\r\n\r\nlet sections = {};\r\nlet title = '';\r\nlet description = '';\r\nlet showData = false;\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nconst addSection = function (id, value) {\r\n  id = common.sanitizeText(id, configApi.getConfig());\r\n  if (typeof sections[id] === 'undefined') {\r\n    sections[id] = value;\r\n    log.debug('Added new section :', id);\r\n  }\r\n};\r\nconst getSections = () => sections;\r\n\r\nconst setTitle = function (txt) {\r\n  title = common.sanitizeText(txt, configApi.getConfig());\r\n};\r\n\r\nconst setShowData = function (toggle) {\r\n  showData = toggle;\r\n};\r\n\r\nconst getShowData = function () {\r\n  return showData;\r\n};\r\n\r\nconst getTitle = function () {\r\n  return title;\r\n};\r\n\r\nconst setAccDescription = function (txt) {\r\n  description = common.sanitizeText(txt, configApi.getConfig());\r\n};\r\n\r\nconst getAccDescription = function () {\r\n  return description;\r\n};\r\n\r\nconst cleanupValue = function (value) {\r\n  if (value.substring(0, 1) === ':') {\r\n    value = value.substring(1).trim();\r\n    return Number(value.trim());\r\n  } else {\r\n    return Number(value.trim());\r\n  }\r\n};\r\n\r\nconst clear = function () {\r\n  sections = {};\r\n  title = '';\r\n  showData = false;\r\n};\r\n// export const parseError = (err, hash) => {\r\n//   global.mermaidAPI.parseError(err, hash)\r\n// }\r\n\r\nexport default {\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().pie,\r\n  addSection,\r\n  getSections,\r\n  cleanupValue,\r\n  clear,\r\n  setTitle,\r\n  getTitle,\r\n  setShowData,\r\n  getShowData,\r\n  getAccDescription,\r\n  setAccDescription,\r\n  // parseError\r\n};\r\n","/** Created by AshishJ on 11-09-2019. */\r\nimport { select, scaleOrdinal, pie as d3pie, arc } from 'd3';\r\nimport pieData from './pieDb';\r\nimport pieParser from './parser/pie';\r\nimport { log } from '../../logger';\r\nimport { configureSvgSize } from '../../utils';\r\nimport * as configApi from '../../config';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nlet conf = configApi.getConfig();\r\n\r\n/**\r\n * Draws a Pie Chart with the data given in text.\r\n *\r\n * @param text\r\n * @param id\r\n */\r\nlet width;\r\nconst height = 450;\r\nexport const draw = (txt, id) => {\r\n  try {\r\n    conf = configApi.getConfig();\r\n    const parser = pieParser.parser;\r\n    parser.yy = pieData;\r\n    log.debug('Rendering info diagram\\n' + txt);\r\n\r\n    const securityLevel = configApi.getConfig().securityLevel;\r\n    // Handle root and ocument for when rendering in sanbox mode\r\n    let sandboxElement;\r\n    if (securityLevel === 'sandbox') {\r\n      sandboxElement = select('#i' + id);\r\n    }\r\n    const root =\r\n      securityLevel === 'sandbox'\r\n        ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n        : select('body');\r\n    const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n    // Parse the Pie Chart definition\r\n    parser.yy.clear();\r\n    parser.parse(txt);\r\n    log.debug('Parsed info diagram');\r\n    const elem = doc.getElementById(id);\r\n    width = elem.parentElement.offsetWidth;\r\n\r\n    if (typeof width === 'undefined') {\r\n      width = 1200;\r\n    }\r\n\r\n    if (typeof conf.useWidth !== 'undefined') {\r\n      width = conf.useWidth;\r\n    }\r\n    if (typeof conf.pie.useWidth !== 'undefined') {\r\n      width = conf.pie.useWidth;\r\n    }\r\n\r\n    const diagram = root.select('#' + id);\r\n    configureSvgSize(diagram, height, width, conf.pie.useMaxWidth);\r\n\r\n    addSVGAccessibilityFields(parser.yy, diagram, id);\r\n    // Set viewBox\r\n    elem.setAttribute('viewBox', '0 0 ' + width + ' ' + height);\r\n\r\n    // Fetch the default direction, use TD if none was found\r\n    var margin = 40;\r\n    var legendRectSize = 18;\r\n    var legendSpacing = 4;\r\n\r\n    var radius = Math.min(width, height) / 2 - margin;\r\n\r\n    var svg = diagram\r\n      .append('g')\r\n      .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');\r\n\r\n    var data = pieData.getSections();\r\n    var sum = 0;\r\n    Object.keys(data).forEach(function (key) {\r\n      sum += data[key];\r\n    });\r\n\r\n    const themeVariables = conf.themeVariables;\r\n    var myGeneratedColors = [\r\n      themeVariables.pie1,\r\n      themeVariables.pie2,\r\n      themeVariables.pie3,\r\n      themeVariables.pie4,\r\n      themeVariables.pie5,\r\n      themeVariables.pie6,\r\n      themeVariables.pie7,\r\n      themeVariables.pie8,\r\n      themeVariables.pie9,\r\n      themeVariables.pie10,\r\n      themeVariables.pie11,\r\n      themeVariables.pie12,\r\n    ];\r\n\r\n    // Set the color scale\r\n    var color = scaleOrdinal().range(myGeneratedColors);\r\n\r\n    // Compute the position of each group on the pie:\r\n    var pie = d3pie().value(function (d) {\r\n      return d[1];\r\n    });\r\n    var dataReady = pie(Object.entries(data));\r\n\r\n    // Shape helper to build arcs:\r\n    var arcGenerator = arc().innerRadius(0).outerRadius(radius);\r\n\r\n    // Build the pie chart: each part of the pie is a path that we build using the arc function.\r\n    svg\r\n      .selectAll('mySlices')\r\n      .data(dataReady)\r\n      .enter()\r\n      .append('path')\r\n      .attr('d', arcGenerator)\r\n      .attr('fill', function (d) {\r\n        return color(d.data[0]);\r\n      })\r\n      .attr('class', 'pieCircle');\r\n\r\n    // Now add the percentage.\r\n    // Use the centroid method to get the best coordinates.\r\n    svg\r\n      .selectAll('mySlices')\r\n      .data(dataReady)\r\n      .enter()\r\n      .append('text')\r\n      .text(function (d) {\r\n        return ((d.data[1] / sum) * 100).toFixed(0) + '%';\r\n      })\r\n      .attr('transform', function (d) {\r\n        return 'translate(' + arcGenerator.centroid(d) + ')';\r\n      })\r\n      .style('text-anchor', 'middle')\r\n      .attr('class', 'slice');\r\n\r\n    svg\r\n      .append('text')\r\n      .text(parser.yy.getTitle())\r\n      .attr('x', 0)\r\n      .attr('y', -(height - 50) / 2)\r\n      .attr('class', 'pieTitleText');\r\n\r\n    // Add the legends/annotations for each section\r\n    var legend = svg\r\n      .selectAll('.legend')\r\n      .data(color.domain())\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'legend')\r\n      .attr('transform', function (d, i) {\r\n        var height = legendRectSize + legendSpacing;\r\n        var offset = (height * color.domain().length) / 2;\r\n        var horz = 12 * legendRectSize;\r\n        var vert = i * height - offset;\r\n        return 'translate(' + horz + ',' + vert + ')';\r\n      });\r\n\r\n    legend\r\n      .append('rect')\r\n      .attr('width', legendRectSize)\r\n      .attr('height', legendRectSize)\r\n      .style('fill', color)\r\n      .style('stroke', color);\r\n\r\n    legend\r\n      .data(dataReady)\r\n      .append('text')\r\n      .attr('x', legendRectSize + legendSpacing)\r\n      .attr('y', legendRectSize - legendSpacing)\r\n      .text(function (d) {\r\n        if (parser.yy.getShowData() || conf.showData || conf.pie.showData) {\r\n          return d.data[0] + ' [' + d.data[1] + ']';\r\n        } else {\r\n          return d.data[0];\r\n        }\r\n      });\r\n  } catch (e) {\r\n    log.error('Error while rendering info diagram');\r\n    log.error(e);\r\n  }\r\n};\r\n\r\nexport default {\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `\r\n  .pieCircle{\r\n    stroke: ${options.pieStrokeColor};\r\n    stroke-width : ${options.pieStrokeWidth};\r\n    opacity : ${options.pieOpacity};\r\n  }\r\n  .pieTitleText {\r\n    text-anchor: middle;\r\n    font-size: ${options.pieTitleTextSize};\r\n    fill: ${options.pieTitleTextColor};\r\n    font-family: ${options.fontFamily};\r\n  }\r\n  .slice {\r\n    font-family: ${options.fontFamily};\r\n    fill: ${options.pieSectionTextColor};\r\n    font-size:${options.pieSectionTextSize};\r\n    // fill: white;\r\n  }\r\n  .legend text {\r\n    fill: ${options.pieLegendTextColor};\r\n    font-family: ${options.fontFamily};\r\n    font-size: ${options.pieLegendTextSize};\r\n  }\r\n`;\r\n\r\nexport default getStyles;\r\n","import * as configApi from '../../config';\r\nimport { log } from '../../logger';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport common from '../common/common';\r\n\r\nlet relations = [];\r\nlet latestRequirement = {};\r\nlet requirements = {};\r\nlet latestElement = {};\r\nlet elements = {};\r\nlet title = '';\r\nlet accDescription = '';\r\n\r\nconst sanitizeText = (txt) => common.sanitizeText(txt, configApi.getConfig());\r\n\r\nconst RequirementType = {\r\n  REQUIREMENT: 'Requirement',\r\n  FUNCTIONAL_REQUIREMENT: 'Functional Requirement',\r\n  INTERFACE_REQUIREMENT: 'Interface Requirement',\r\n  PERFORMANCE_REQUIREMENT: 'Performance Requirement',\r\n  PHYSICAL_REQUIREMENT: 'Physical Requirement',\r\n  DESIGN_CONSTRAINT: 'Design Constraint',\r\n};\r\n\r\nconst RiskLevel = {\r\n  LOW_RISK: 'Low',\r\n  MED_RISK: 'Medium',\r\n  HIGH_RISK: 'High',\r\n};\r\n\r\nconst VerifyType = {\r\n  VERIFY_ANALYSIS: 'Analysis',\r\n  VERIFY_DEMONSTRATION: 'Demonstration',\r\n  VERIFY_INSPECTION: 'Inspection',\r\n  VERIFY_TEST: 'Test',\r\n};\r\n\r\nconst Relationships = {\r\n  CONTAINS: 'contains',\r\n  COPIES: 'copies',\r\n  DERIVES: 'derives',\r\n  SATISFIES: 'satisfies',\r\n  VERIFIES: 'verifies',\r\n  REFINES: 'refines',\r\n  TRACES: 'traces',\r\n};\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nconst addRequirement = (name, type) => {\r\n  if (typeof requirements[name] === 'undefined') {\r\n    requirements[name] = {\r\n      name,\r\n      type,\r\n\r\n      id: latestRequirement.id,\r\n      text: latestRequirement.text,\r\n      risk: latestRequirement.risk,\r\n      verifyMethod: latestRequirement.verifyMethod,\r\n    };\r\n  }\r\n  latestRequirement = {};\r\n\r\n  return requirements[name];\r\n};\r\n\r\nconst getRequirements = () => requirements;\r\n\r\nconst setNewReqId = (id) => {\r\n  if (typeof latestRequirement != 'undefined') {\r\n    latestRequirement.id = id;\r\n  }\r\n};\r\n\r\nconst setNewReqText = (text) => {\r\n  if (typeof latestRequirement != 'undefined') {\r\n    latestRequirement.text = text;\r\n  }\r\n};\r\n\r\nconst setNewReqRisk = (risk) => {\r\n  if (typeof latestRequirement != 'undefined') {\r\n    latestRequirement.risk = risk;\r\n  }\r\n};\r\n\r\nconst setNewReqVerifyMethod = (verifyMethod) => {\r\n  if (typeof latestRequirement != 'undefined') {\r\n    latestRequirement.verifyMethod = verifyMethod;\r\n  }\r\n};\r\n\r\nconst addElement = (name) => {\r\n  if (typeof elements[name] === 'undefined') {\r\n    elements[name] = {\r\n      name,\r\n\r\n      type: latestElement.type,\r\n      docRef: latestElement.docRef,\r\n    };\r\n    log.info('Added new requirement: ', name);\r\n  }\r\n  latestElement = {};\r\n\r\n  return elements[name];\r\n};\r\n\r\nconst getElements = () => elements;\r\n\r\nconst setNewElementType = (type) => {\r\n  if (typeof latestElement != 'undefined') {\r\n    latestElement.type = type;\r\n  }\r\n};\r\n\r\nconst setNewElementDocRef = (docRef) => {\r\n  if (typeof latestElement != 'undefined') {\r\n    latestElement.docRef = docRef;\r\n  }\r\n};\r\n\r\nconst addRelationship = (type, src, dst) => {\r\n  relations.push({\r\n    type,\r\n    src,\r\n    dst,\r\n  });\r\n};\r\n\r\nconst getRelationships = () => relations;\r\n\r\nconst clear = () => {\r\n  relations = [];\r\n  latestRequirement = {};\r\n  requirements = {};\r\n  latestElement = {};\r\n  elements = {};\r\n};\r\n\r\nexport const setTitle = function (txt) {\r\n  let sanitizedText = sanitizeText(txt, configApi.getConfig());\r\n  title = sanitizedText;\r\n};\r\n\r\nexport const getTitle = function () {\r\n  return title;\r\n};\r\n\r\nexport const setAccDescription = function (txt) {\r\n  let sanitizedText = sanitizeText(txt, configApi.getConfig());\r\n  accDescription = sanitizedText;\r\n};\r\n\r\nexport const getAccDescription = function () {\r\n  return accDescription;\r\n};\r\n\r\nexport default {\r\n  RequirementType,\r\n  RiskLevel,\r\n  VerifyType,\r\n  Relationships,\r\n\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().req,\r\n\r\n  addRequirement,\r\n  getRequirements,\r\n  setNewReqId,\r\n  setNewReqText,\r\n  setNewReqRisk,\r\n  setNewReqVerifyMethod,\r\n  setTitle,\r\n  getTitle,\r\n  setAccDescription,\r\n  getAccDescription,\r\n\r\n  addElement,\r\n  getElements,\r\n  setNewElementType,\r\n  setNewElementDocRef,\r\n\r\n  addRelationship,\r\n  getRelationships,\r\n\r\n  clear,\r\n};\r\n","const ReqMarkers = {\r\n  CONTAINS: 'contains',\r\n  ARROW: 'arrow',\r\n};\r\n\r\nconst insertLineEndings = (parentNode, conf) => {\r\n  let containsNode = parentNode\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ReqMarkers.CONTAINS + '_line_ending')\r\n    .attr('refX', 0)\r\n    .attr('refY', conf.line_height / 2)\r\n    .attr('markerWidth', conf.line_height)\r\n    .attr('markerHeight', conf.line_height)\r\n    .attr('orient', 'auto')\r\n    .append('g');\r\n\r\n  containsNode\r\n    .append('circle')\r\n    .attr('cx', conf.line_height / 2)\r\n    .attr('cy', conf.line_height / 2)\r\n    .attr('r', conf.line_height / 2)\r\n    // .attr('stroke', conf.rect_border_color)\r\n    // .attr('stroke-width', 1)\r\n    .attr('fill', 'none');\r\n\r\n  containsNode\r\n    .append('line')\r\n    .attr('x1', 0)\r\n    .attr('x2', conf.line_height)\r\n    .attr('y1', conf.line_height / 2)\r\n    .attr('y2', conf.line_height / 2)\r\n    // .attr('stroke', conf.rect_border_color)\r\n    .attr('stroke-width', 1);\r\n\r\n  containsNode\r\n    .append('line')\r\n    .attr('y1', 0)\r\n    .attr('y2', conf.line_height)\r\n    .attr('x1', conf.line_height / 2)\r\n    .attr('x2', conf.line_height / 2)\r\n    // .attr('stroke', conf.rect_border_color)\r\n    .attr('stroke-width', 1);\r\n\r\n  parentNode\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', ReqMarkers.ARROW + '_line_ending')\r\n    .attr('refX', conf.line_height)\r\n    .attr('refY', 0.5 * conf.line_height)\r\n    .attr('markerWidth', conf.line_height)\r\n    .attr('markerHeight', conf.line_height)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr(\r\n      'd',\r\n      `M0,0\r\n      L${conf.line_height},${conf.line_height / 2}\r\n      M${conf.line_height},${conf.line_height / 2}\r\n      L0,${conf.line_height}`\r\n    )\r\n    .attr('stroke-width', 1);\r\n  // .attr('stroke', conf.rect_border_color);\r\n};\r\n\r\nexport default {\r\n  ReqMarkers,\r\n  insertLineEndings,\r\n};\r\n","import { line, select } from 'd3';\r\nimport dagre from 'dagre';\r\nimport graphlib from 'graphlib';\r\n// import * as configApi from '../../config';\r\nimport { log } from '../../logger';\r\nimport { configureSvgSize } from '../../utils';\r\nimport common from '../common/common';\r\nimport { parser } from './parser/requirementDiagram';\r\nimport requirementDb from './requirementDb';\r\nimport markers from './requirementMarkers';\r\nimport { getConfig } from '../../config';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nconst conf = {};\r\nlet relCnt = 0;\r\n\r\nexport const setConf = function (cnf) {\r\n  if (typeof cnf === 'undefined') {\r\n    return;\r\n  }\r\n  const keys = Object.keys(cnf);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    conf[keys[i]] = cnf[keys[i]];\r\n  }\r\n};\r\n\r\nconst newRectNode = (parentNode, id) => {\r\n  return parentNode\r\n    .insert('rect', '#' + id)\r\n    .attr('class', 'req reqBox')\r\n    .attr('x', 0)\r\n    .attr('y', 0)\r\n    .attr('width', conf.rect_min_width + 'px')\r\n    .attr('height', conf.rect_min_height + 'px');\r\n};\r\n\r\nconst newTitleNode = (parentNode, id, txts) => {\r\n  let x = conf.rect_min_width / 2;\r\n\r\n  let title = parentNode\r\n    .append('text')\r\n    .attr('class', 'req reqLabel reqTitle')\r\n    .attr('id', id)\r\n    .attr('x', x)\r\n    .attr('y', conf.rect_padding)\r\n    .attr('dominant-baseline', 'hanging');\r\n  // .attr(\r\n  //   'style',\r\n  //   'font-family: ' + configApi.getConfig().fontFamily + '; font-size: ' + conf.fontSize + 'px'\r\n  // )\r\n  let i = 0;\r\n  txts.forEach((textStr) => {\r\n    if (i == 0) {\r\n      title\r\n        .append('tspan')\r\n        .attr('text-anchor', 'middle')\r\n        .attr('x', conf.rect_min_width / 2)\r\n        .attr('dy', 0)\r\n        .text(textStr);\r\n    } else {\r\n      title\r\n        .append('tspan')\r\n        .attr('text-anchor', 'middle')\r\n        .attr('x', conf.rect_min_width / 2)\r\n        .attr('dy', conf.line_height * 0.75)\r\n        .text(textStr);\r\n    }\r\n    i++;\r\n  });\r\n\r\n  let yPadding = 1.5 * conf.rect_padding;\r\n  let linePadding = i * conf.line_height * 0.75;\r\n  let totalY = yPadding + linePadding;\r\n\r\n  parentNode\r\n    .append('line')\r\n    .attr('class', 'req-title-line')\r\n    .attr('x1', '0')\r\n    .attr('x2', conf.rect_min_width)\r\n    .attr('y1', totalY)\r\n    .attr('y2', totalY);\r\n\r\n  return {\r\n    titleNode: title,\r\n    y: totalY,\r\n  };\r\n};\r\n\r\nconst newBodyNode = (parentNode, id, txts, yStart) => {\r\n  let body = parentNode\r\n    .append('text')\r\n    .attr('class', 'req reqLabel')\r\n    .attr('id', id)\r\n    .attr('x', conf.rect_padding)\r\n    .attr('y', yStart)\r\n    .attr('dominant-baseline', 'hanging');\r\n  // .attr(\r\n  //   'style',\r\n  //   'font-family: ' + configApi.getConfig().fontFamily + '; font-size: ' + conf.fontSize + 'px'\r\n  // );\r\n\r\n  let currentRow = 0;\r\n  const charLimit = 30;\r\n  let wrappedTxts = [];\r\n  txts.forEach((textStr) => {\r\n    let currentTextLen = textStr.length;\r\n    while (currentTextLen > charLimit && currentRow < 3) {\r\n      let firstPart = textStr.substring(0, charLimit);\r\n      textStr = textStr.substring(charLimit, textStr.length);\r\n      currentTextLen = textStr.length;\r\n      wrappedTxts[wrappedTxts.length] = firstPart;\r\n      currentRow++;\r\n    }\r\n    if (currentRow == 3) {\r\n      let lastStr = wrappedTxts[wrappedTxts.length - 1];\r\n      wrappedTxts[wrappedTxts.length - 1] = lastStr.substring(0, lastStr.length - 4) + '...';\r\n    } else {\r\n      wrappedTxts[wrappedTxts.length] = textStr;\r\n    }\r\n    currentRow = 0;\r\n  });\r\n\r\n  wrappedTxts.forEach((textStr) => {\r\n    body.append('tspan').attr('x', conf.rect_padding).attr('dy', conf.line_height).text(textStr);\r\n  });\r\n\r\n  return body;\r\n};\r\n\r\nconst addEdgeLabel = (parentNode, svgPath, conf, txt) => {\r\n  // Find the half-way point\r\n  const len = svgPath.node().getTotalLength();\r\n  const labelPoint = svgPath.node().getPointAtLength(len * 0.5);\r\n\r\n  // Append a text node containing the label\r\n  const labelId = 'rel' + relCnt;\r\n  relCnt++;\r\n\r\n  const labelNode = parentNode\r\n    .append('text')\r\n    .attr('class', 'req relationshipLabel')\r\n    .attr('id', labelId)\r\n    .attr('x', labelPoint.x)\r\n    .attr('y', labelPoint.y)\r\n    .attr('text-anchor', 'middle')\r\n    .attr('dominant-baseline', 'middle')\r\n    // .attr('style', 'font-family: ' + conf.fontFamily + '; font-size: ' + conf.fontSize + 'px')\r\n    .text(txt);\r\n\r\n  // Figure out how big the opaque 'container' rectangle needs to be\r\n  const labelBBox = labelNode.node().getBBox();\r\n\r\n  // Insert the opaque rectangle before the text label\r\n  parentNode\r\n    .insert('rect', '#' + labelId)\r\n    .attr('class', 'req reqLabelBox')\r\n    .attr('x', labelPoint.x - labelBBox.width / 2)\r\n    .attr('y', labelPoint.y - labelBBox.height / 2)\r\n    .attr('width', labelBBox.width)\r\n    .attr('height', labelBBox.height)\r\n    .attr('fill', 'white')\r\n    .attr('fill-opacity', '85%');\r\n};\r\n\r\nconst drawRelationshipFromLayout = function (svg, rel, g, insert) {\r\n  // Find the edge relating to this relationship\r\n  const edge = g.edge(elementString(rel.src), elementString(rel.dst));\r\n\r\n  // Get a function that will generate the line path\r\n  const lineFunction = line()\r\n    .x(function (d) {\r\n      return d.x;\r\n    })\r\n    .y(function (d) {\r\n      return d.y;\r\n    });\r\n\r\n  // Insert the line at the right place\r\n  const svgPath = svg\r\n    .insert('path', '#' + insert)\r\n    .attr('class', 'er relationshipLine')\r\n    .attr('d', lineFunction(edge.points))\r\n    .attr('fill', 'none');\r\n\r\n  if (rel.type == requirementDb.Relationships.CONTAINS) {\r\n    svgPath.attr(\r\n      'marker-start',\r\n      'url(' + common.getUrl(conf.arrowMarkerAbsolute) + '#' + rel.type + '_line_ending' + ')'\r\n    );\r\n  } else {\r\n    svgPath.attr('stroke-dasharray', '10,7');\r\n    svgPath.attr(\r\n      'marker-end',\r\n      'url(' +\r\n        common.getUrl(conf.arrowMarkerAbsolute) +\r\n        '#' +\r\n        markers.ReqMarkers.ARROW +\r\n        '_line_ending' +\r\n        ')'\r\n    );\r\n  }\r\n\r\n  addEdgeLabel(svg, svgPath, conf, `<<${rel.type}>>`);\r\n\r\n  return;\r\n};\r\n\r\nexport const drawReqs = (reqs, graph, svgNode) => {\r\n  Object.keys(reqs).forEach((reqName) => {\r\n    let req = reqs[reqName];\r\n    reqName = elementString(reqName);\r\n    log.info('Added new requirement: ', reqName);\r\n\r\n    const groupNode = svgNode.append('g').attr('id', reqName);\r\n    const textId = 'req-' + reqName;\r\n    const rectNode = newRectNode(groupNode, textId);\r\n\r\n    let nodes = [];\r\n\r\n    let titleNodeInfo = newTitleNode(groupNode, reqName + '_title', [\r\n      `<<${req.type}>>`,\r\n      `${req.name}`,\r\n    ]);\r\n\r\n    nodes.push(titleNodeInfo.titleNode);\r\n\r\n    let bodyNode = newBodyNode(\r\n      groupNode,\r\n      reqName + '_body',\r\n      [\r\n        `Id: ${req.id}`,\r\n        `Text: ${req.text}`,\r\n        `Risk: ${req.risk}`,\r\n        `Verification: ${req.verifyMethod}`,\r\n      ],\r\n      titleNodeInfo.y\r\n    );\r\n\r\n    nodes.push(bodyNode);\r\n\r\n    const rectBBox = rectNode.node().getBBox();\r\n\r\n    // Add the entity to the graph\r\n    graph.setNode(reqName, {\r\n      width: rectBBox.width,\r\n      height: rectBBox.height,\r\n      shape: 'rect',\r\n      id: reqName,\r\n    });\r\n  });\r\n};\r\n\r\nexport const drawElements = (els, graph, svgNode) => {\r\n  Object.keys(els).forEach((elName) => {\r\n    let el = els[elName];\r\n    const id = elementString(elName);\r\n\r\n    const groupNode = svgNode.append('g').attr('id', id);\r\n    const textId = 'element-' + id;\r\n    const rectNode = newRectNode(groupNode, textId);\r\n\r\n    let nodes = [];\r\n\r\n    let titleNodeInfo = newTitleNode(groupNode, textId + '_title', [`<<Element>>`, `${elName}`]);\r\n\r\n    nodes.push(titleNodeInfo.titleNode);\r\n\r\n    let bodyNode = newBodyNode(\r\n      groupNode,\r\n      textId + '_body',\r\n      [`Type: ${el.type || 'Not Specified'}`, `Doc Ref: ${el.docRef || 'None'}`],\r\n      titleNodeInfo.y\r\n    );\r\n\r\n    nodes.push(bodyNode);\r\n\r\n    const rectBBox = rectNode.node().getBBox();\r\n\r\n    // Add the entity to the graph\r\n    graph.setNode(id, {\r\n      width: rectBBox.width,\r\n      height: rectBBox.height,\r\n      shape: 'rect',\r\n      id: id,\r\n    });\r\n  });\r\n};\r\n\r\nconst addRelationships = (relationships, g) => {\r\n  relationships.forEach(function (r) {\r\n    let src = elementString(r.src);\r\n    let dst = elementString(r.dst);\r\n    g.setEdge(src, dst, { relationship: r });\r\n  });\r\n  return relationships;\r\n};\r\n\r\nconst adjustEntities = function (svgNode, graph) {\r\n  graph.nodes().forEach(function (v) {\r\n    if (typeof v !== 'undefined' && typeof graph.node(v) !== 'undefined') {\r\n      svgNode.select('#' + v);\r\n      svgNode\r\n        .select('#' + v)\r\n        .attr(\r\n          'transform',\r\n          'translate(' +\r\n            (graph.node(v).x - graph.node(v).width / 2) +\r\n            ',' +\r\n            (graph.node(v).y - graph.node(v).height / 2) +\r\n            ' )'\r\n        );\r\n    }\r\n  });\r\n  return;\r\n};\r\n\r\nconst elementString = (str) => {\r\n  return str.replace(/\\s/g, '').replace(/\\./g, '_');\r\n};\r\n\r\nexport const draw = (text, id) => {\r\n  parser.yy = requirementDb;\r\n  parser.yy.clear();\r\n  parser.parse(text);\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and ocument for when rendering in sanbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  const svg = root.select(`[id='${id}']`);\r\n  markers.insertLineEndings(svg, conf);\r\n\r\n  const g = new graphlib.Graph({\r\n    multigraph: false,\r\n    compound: false,\r\n    directed: true,\r\n  })\r\n    .setGraph({\r\n      rankdir: conf.layoutDirection,\r\n      marginx: 20,\r\n      marginy: 20,\r\n      nodesep: 100,\r\n      edgesep: 100,\r\n      ranksep: 100,\r\n    })\r\n    .setDefaultEdgeLabel(function () {\r\n      return {};\r\n    });\r\n\r\n  let requirements = requirementDb.getRequirements();\r\n  let elements = requirementDb.getElements();\r\n  let relationships = requirementDb.getRelationships();\r\n\r\n  drawReqs(requirements, g, svg);\r\n  drawElements(elements, g, svg);\r\n  addRelationships(relationships, g);\r\n  dagre.layout(g);\r\n  adjustEntities(svg, g);\r\n\r\n  relationships.forEach(function (rel) {\r\n    drawRelationshipFromLayout(svg, rel, g, id);\r\n  });\r\n\r\n  // svg.attr('height', '500px');\r\n  const padding = conf.rect_padding;\r\n  const svgBounds = svg.node().getBBox();\r\n  const width = svgBounds.width + padding * 2;\r\n  const height = svgBounds.height + padding * 2;\r\n\r\n  configureSvgSize(svg, height, width, conf.useMaxWidth);\r\n\r\n  svg.attr('viewBox', `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`);\r\n  // Adds title and description to the requirements diagram\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = (options) => `\r\n\r\n  marker {\r\n    fill: ${options.relationColor};\r\n    stroke: ${options.relationColor};\r\n  }\r\n\r\n  marker.cross {\r\n    stroke: ${options.lineColor};\r\n  }\r\n\r\n  svg {\r\n    font-family: ${options.fontFamily};\r\n    font-size: ${options.fontSize};\r\n  }\r\n\r\n  .reqBox {\r\n    fill: ${options.requirementBackground};\r\n    fill-opacity: 100%;\r\n    stroke: ${options.requirementBorderColor};\r\n    stroke-width: ${options.requirementBorderSize};\r\n  }\r\n  \r\n  .reqTitle, .reqLabel{\r\n    fill:  ${options.requirementTextColor};\r\n  }\r\n  .reqLabelBox {\r\n    fill: ${options.relationLabelBackground};\r\n    fill-opacity: 100%;\r\n  }\r\n\r\n  .req-title-line {\r\n    stroke: ${options.requirementBorderColor};\r\n    stroke-width: ${options.requirementBorderSize};\r\n  }\r\n  .relationshipLine {\r\n    stroke: ${options.relationColor};\r\n    stroke-width: 1;\r\n  }\r\n  .relationshipLabel {\r\n    fill: ${options.relationLabelColor};\r\n  }\r\n\r\n`;\r\n// fill', conf.rect_fill)\r\nexport default getStyles;\r\n","import mermaidAPI from '../../mermaidAPI';\r\nimport * as configApi from '../../config';\r\nimport { log } from '../../logger';\r\nimport { sanitizeText } from '../common/common';\r\n\r\nlet prevActor = undefined;\r\nlet actors = {};\r\nlet messages = [];\r\nconst notes = [];\r\nlet title = '';\r\nlet description = '';\r\nlet sequenceNumbersEnabled = false;\r\nlet wrapEnabled = false;\r\n\r\nexport const parseDirective = function(statement, context, type) {\r\n    mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nexport const addActor = function(id, name, description, type) {\r\n    // Don't allow description nulling\r\n    const old = actors[id];\r\n    if (old && name === old.name && description == null) return;\r\n\r\n    // Don't allow null descriptions, either\r\n    if (description == null || description.text == null) {\r\n        description = { text: name, wrap: null, type };\r\n    }\r\n    if (type == null || description.text == null) {\r\n        description = { text: name, wrap: null, type };\r\n    }\r\n\r\n    actors[id] = {\r\n        name: name,\r\n        description: description.text,\r\n        wrap: (description.wrap === undefined && autoWrap()) || !!description.wrap,\r\n        prevActor: prevActor,\r\n        links: {},\r\n        properties: {},\r\n        actorCnt: null,\r\n        rectData: null,\r\n        type: type || 'participant',\r\n    };\r\n    if (prevActor && actors[prevActor]) {\r\n        actors[prevActor].nextActor = id;\r\n    }\r\n\r\n    prevActor = id;\r\n};\r\n\r\nconst activationCount = (part) => {\r\n    let i;\r\n    let count = 0;\r\n    for (i = 0; i < messages.length; i++) {\r\n        if (messages[i].type === LINETYPE.ACTIVE_START) {\r\n            if (messages[i].from.actor === part) {\r\n                count++;\r\n            }\r\n        }\r\n        if (messages[i].type === LINETYPE.ACTIVE_END) {\r\n            if (messages[i].from.actor === part) {\r\n                count--;\r\n            }\r\n        }\r\n    }\r\n    return count;\r\n};\r\n\r\nexport const addMessage = function(idFrom, idTo, message, answer) {\r\n    messages.push({\r\n        from: idFrom,\r\n        to: idTo,\r\n        message: message.text,\r\n        wrap: (message.wrap === undefined && autoWrap()) || !!message.wrap,\r\n        answer: answer,\r\n    });\r\n};\r\n\r\nexport const addSignal = function(\r\n    idFrom,\r\n    idTo,\r\n    message = { text: undefined, wrap: undefined },\r\n    messageType\r\n) {\r\n    if (messageType === LINETYPE.ACTIVE_END) {\r\n        const cnt = activationCount(idFrom.actor);\r\n        if (cnt < 1) {\r\n            // Bail out as there is an activation signal from an inactive participant\r\n            let error = new Error('Trying to inactivate an inactive participant (' + idFrom.actor + ')');\r\n            error.hash = {\r\n                text: '->>-',\r\n                token: '->>-',\r\n                line: '1',\r\n                loc: { first_line: 1, last_line: 1, first_column: 1, last_column: 1 },\r\n                expected: [\"'ACTIVE_PARTICIPANT'\"],\r\n            };\r\n            throw error;\r\n        }\r\n    }\r\n    messages.push({\r\n        from: idFrom,\r\n        to: idTo,\r\n        message: message.text,\r\n        wrap: (message.wrap === undefined && autoWrap()) || !!message.wrap,\r\n        type: messageType,\r\n    });\r\n    return true;\r\n};\r\n\r\nexport const getMessages = function() {\r\n    return messages;\r\n};\r\n\r\nexport const getActors = function() {\r\n    return actors;\r\n};\r\nexport const getActor = function(id) {\r\n    return actors[id];\r\n};\r\nexport const getActorKeys = function() {\r\n    return Object.keys(actors);\r\n};\r\nexport const getTitle = function() {\r\n    return title;\r\n};\r\nexport const enableSequenceNumbers = function() {\r\n    sequenceNumbersEnabled = true;\r\n};\r\nexport const disableSequenceNumbers = function() {\r\n    sequenceNumbersEnabled = false;\r\n};\r\nexport const showSequenceNumbers = () => sequenceNumbersEnabled;\r\n\r\nexport const setWrap = function(wrapSetting) {\r\n    wrapEnabled = wrapSetting;\r\n};\r\n\r\nexport const autoWrap = () => wrapEnabled;\r\n\r\nexport const clear = function() {\r\n    actors = {};\r\n    messages = [];\r\n    sequenceNumbersEnabled = false;\r\n};\r\n\r\nexport const parseMessage = function(str) {\r\n    const _str = str.trim();\r\n    const message = {\r\n        text: _str.replace(/^[:]?(?:no)?wrap:/, '').trim(),\r\n        wrap: _str.match(/^[:]?wrap:/) !== null ?\r\n            true : _str.match(/^[:]?nowrap:/) !== null ?\r\n            false : undefined,\r\n    };\r\n    log.debug('parseMessage:', message);\r\n    return message;\r\n};\r\n\r\nexport const LINETYPE = {\r\n    SOLID: 0,\r\n    DOTTED: 1,\r\n    NOTE: 2,\r\n    SOLID_CROSS: 3,\r\n    DOTTED_CROSS: 4,\r\n    SOLID_OPEN: 5,\r\n    DOTTED_OPEN: 6,\r\n    LOOP_START: 10,\r\n    LOOP_END: 11,\r\n    ALT_START: 12,\r\n    ALT_ELSE: 13,\r\n    ALT_END: 14,\r\n    OPT_START: 15,\r\n    OPT_END: 16,\r\n    ACTIVE_START: 17,\r\n    ACTIVE_END: 18,\r\n    PAR_START: 19,\r\n    PAR_AND: 20,\r\n    PAR_END: 21,\r\n    RECT_START: 22,\r\n    RECT_END: 23,\r\n    SOLID_POINT: 24,\r\n    DOTTED_POINT: 25,\r\n    AUTONUMBER: 26\r\n};\r\n\r\nexport const ARROWTYPE = {\r\n    FILLED: 0,\r\n    OPEN: 1,\r\n};\r\n\r\nexport const PLACEMENT = {\r\n    LEFTOF: 0,\r\n    RIGHTOF: 1,\r\n    OVER: 2,\r\n};\r\n\r\nexport const addNote = function(actor, placement, message) {\r\n    const note = {\r\n        actor: actor,\r\n        placement: placement,\r\n        message: message.text,\r\n        wrap: (message.wrap === undefined && autoWrap()) || !!message.wrap,\r\n    };\r\n\r\n    // Coerce actor into a [to, from, ...] array\r\n    const actors = [].concat(actor, actor);\r\n\r\n    notes.push(note);\r\n    messages.push({\r\n        from: actors[0],\r\n        to: actors[1],\r\n        message: message.text,\r\n        wrap: (message.wrap === undefined && autoWrap()) || !!message.wrap,\r\n        type: LINETYPE.NOTE,\r\n        placement: placement,\r\n    });\r\n};\r\n\r\nexport const addLinks = function(actorId, text) {\r\n    // find the actor\r\n    const actor = getActor(actorId);\r\n    // JSON.parse the text\r\n    try {\r\n        let sanitizedText = sanitizeText(text.text, configApi.getConfig());\r\n        sanitizedText = sanitizedText.replace(/&amp;/g, '&');\r\n        sanitizedText = sanitizedText.replace(/&equals;/g, '=');\r\n        const links = JSON.parse(sanitizedText);\r\n        // add the deserialized text to the actor's links field.\r\n        insertLinks(actor, links);\r\n    } catch (e) {\r\n        log.error('error while parsing actor link text', e);\r\n    }\r\n};\r\n\r\nexport const addALink = function(actorId, text) {\r\n    // find the actor\r\n    const actor = getActor(actorId);\r\n    try {\r\n        const links = {};\r\n        let sanitizedText = sanitizeText(text.text, configApi.getConfig());\r\n        var sep = sanitizedText.indexOf('@');\r\n        sanitizedText = sanitizedText.replace(/&amp;/g, '&');\r\n        sanitizedText = sanitizedText.replace(/&equals;/g, '=');\r\n        var label = sanitizedText.slice(0, sep - 1).trim();\r\n        var link = sanitizedText.slice(sep + 1).trim();\r\n\r\n        links[label] = link;\r\n        // add the deserialized text to the actor's links field.\r\n        insertLinks(actor, links);\r\n    } catch (e) {\r\n        log.error('error while parsing actor link text', e);\r\n    }\r\n};\r\n\r\n/**\r\n * @param {any} actor\r\n * @param {any} links\r\n */\r\nfunction insertLinks(actor, links) {\r\n    if (actor.links == null) {\r\n        actor.links = links;\r\n    } else {\r\n        for (let key in links) {\r\n            actor.links[key] = links[key];\r\n        }\r\n    }\r\n}\r\n\r\nexport const addProperties = function(actorId, text) {\r\n    // find the actor\r\n    const actor = getActor(actorId);\r\n    // JSON.parse the text\r\n    try {\r\n        let sanitizedText = sanitizeText(text.text, configApi.getConfig());\r\n        const properties = JSON.parse(sanitizedText);\r\n        // add the deserialized text to the actor's property field.\r\n        insertProperties(actor, properties);\r\n    } catch (e) {\r\n        log.error('error while parsing actor properties text', e);\r\n    }\r\n};\r\n\r\n/**\r\n * @param {any} actor\r\n * @param {any} properties\r\n */\r\nfunction insertProperties(actor, properties) {\r\n    if (actor.properties == null) {\r\n        actor.properties = properties;\r\n    } else {\r\n        for (let key in properties) {\r\n            actor.properties[key] = properties[key];\r\n        }\r\n    }\r\n}\r\n\r\nexport const addDetails = function(actorId, text) {\r\n    // find the actor\r\n    const actor = getActor(actorId);\r\n    const elem = document.getElementById(text.text);\r\n\r\n    // JSON.parse the text\r\n    try {\r\n        const text = elem.innerHTML;\r\n        const details = JSON.parse(text);\r\n        // add the deserialized text to the actor's property field.\r\n        if (details['properties']) {\r\n            insertProperties(actor, details['properties']);\r\n        }\r\n\r\n        if (details['links']) {\r\n            insertLinks(actor, details['links']);\r\n        }\r\n    } catch (e) {\r\n        log.error('error while parsing actor details text', e);\r\n    }\r\n};\r\n\r\nexport const getActorProperty = function(actor, key) {\r\n    if (typeof actor !== 'undefined' && typeof actor.properties !== 'undefined') {\r\n        return actor.properties[key];\r\n    }\r\n\r\n    return undefined;\r\n};\r\n\r\nexport const setTitle = function(txt) {\r\n    let sanitizedText = sanitizeText(txt, configApi.getConfig());\r\n    title = sanitizedText;\r\n};\r\n\r\nexport const apply = function(param) {\r\n    if (param instanceof Array) {\r\n        param.forEach(function(item) {\r\n            apply(item);\r\n        });\r\n    } else {\r\n        switch (param.type) {\r\n            case 'sequenceIndex':\r\n                messages.push({\r\n                    from: undefined,\r\n                    to: undefined,\r\n                    message: { start: param.sequenceIndex, step: param.sequenceIndexStep, visible: param.sequenceVisible },\r\n                    wrap: false,\r\n                    type: param.signalType,\r\n                });\r\n                break;\r\n            case 'addParticipant':\r\n                addActor(param.actor, param.actor, param.description, 'participant');\r\n                break;\r\n            case 'addActor':\r\n                addActor(param.actor, param.actor, param.description, 'actor');\r\n                break;\r\n            case 'activeStart':\r\n                addSignal(param.actor, undefined, undefined, param.signalType);\r\n                break;\r\n            case 'activeEnd':\r\n                addSignal(param.actor, undefined, undefined, param.signalType);\r\n                break;\r\n            case 'addNote':\r\n                addNote(param.actor, param.placement, param.text);\r\n                break;\r\n            case 'addLinks':\r\n                addLinks(param.actor, param.text);\r\n                break;\r\n            case 'addALink':\r\n                addALink(param.actor, param.text);\r\n                break;\r\n            case 'addProperties':\r\n                addProperties(param.actor, param.text);\r\n                break;\r\n            case 'addDetails':\r\n                addDetails(param.actor, param.text);\r\n                break;\r\n            case 'addMessage':\r\n                addSignal(param.from, param.to, param.msg, param.signalType);\r\n                break;\r\n            case 'loopStart':\r\n                addSignal(undefined, undefined, param.loopText, param.signalType);\r\n                break;\r\n            case 'loopEnd':\r\n                addSignal(undefined, undefined, undefined, param.signalType);\r\n                break;\r\n            case 'rectStart':\r\n                addSignal(undefined, undefined, param.color, param.signalType);\r\n                break;\r\n            case 'rectEnd':\r\n                addSignal(undefined, undefined, undefined, param.signalType);\r\n                break;\r\n            case 'optStart':\r\n                addSignal(undefined, undefined, param.optText, param.signalType);\r\n                break;\r\n            case 'optEnd':\r\n                addSignal(undefined, undefined, undefined, param.signalType);\r\n                break;\r\n            case 'altStart':\r\n                addSignal(undefined, undefined, param.altText, param.signalType);\r\n                break;\r\n            case 'else':\r\n                addSignal(undefined, undefined, param.altText, param.signalType);\r\n                break;\r\n            case 'altEnd':\r\n                addSignal(undefined, undefined, undefined, param.signalType);\r\n                break;\r\n            case 'setTitle':\r\n                setTitle(param.text);\r\n                break;\r\n            case 'parStart':\r\n                addSignal(undefined, undefined, param.parText, param.signalType);\r\n                break;\r\n            case 'and':\r\n                addSignal(undefined, undefined, param.parText, param.signalType);\r\n                break;\r\n            case 'parEnd':\r\n                addSignal(undefined, undefined, undefined, param.signalType);\r\n                break;\r\n        }\r\n    }\r\n};\r\n\r\nconst setAccDescription = function(description_lex) {\r\n    let sanitizedText = sanitizeText(description_lex, configApi.getConfig());\r\n    description = sanitizedText;\r\n};\r\n\r\nconst getAccDescription = function() {\r\n    return description;\r\n};\r\n\r\nexport default {\r\n    addActor,\r\n    addMessage,\r\n    addSignal,\r\n    addLinks,\r\n    addDetails,\r\n    addProperties,\r\n    autoWrap,\r\n    setWrap,\r\n    enableSequenceNumbers,\r\n    disableSequenceNumbers,\r\n    showSequenceNumbers,\r\n    getMessages,\r\n    getActors,\r\n    getActor,\r\n    getActorKeys,\r\n    getActorProperty,\r\n    getTitle,\r\n    parseDirective,\r\n    getConfig: () => configApi.getConfig().sequence,\r\n    clear,\r\n    parseMessage,\r\n    LINETYPE,\r\n    ARROWTYPE,\r\n    PLACEMENT,\r\n    addNote,\r\n    setTitle,\r\n    apply,\r\n    setAccDescription,\r\n    getAccDescription,\r\n};","import { select, selectAll } from 'd3';\r\nimport svgDraw, { drawText, fixLifeLineHeights } from './svgDraw';\r\nimport { log } from '../../logger';\r\nimport { parser } from './parser/sequenceDiagram';\r\nimport common from '../common/common';\r\nimport sequenceDb from './sequenceDb';\r\nimport * as configApi from '../../config';\r\nimport utils, { assignWithDepth, configureSvgSize } from '../../utils';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nparser.yy = sequenceDb;\r\n\r\nlet conf = {};\r\n\r\nexport const bounds = {\r\n    data: {\r\n        startx: undefined,\r\n        stopx: undefined,\r\n        starty: undefined,\r\n        stopy: undefined,\r\n    },\r\n    verticalPos: 0,\r\n    sequenceItems: [],\r\n    activations: [],\r\n    models: {\r\n        getHeight: function() {\r\n            return (\r\n                Math.max.apply(\r\n                    null,\r\n                    this.actors.length === 0 ? [0] : this.actors.map((actor) => actor.height || 0)\r\n                ) +\r\n                (this.loops.length === 0 ?\r\n                    0 :\r\n                    this.loops.map((it) => it.height || 0).reduce((acc, h) => acc + h)) +\r\n                (this.messages.length === 0 ?\r\n                    0 :\r\n                    this.messages.map((it) => it.height || 0).reduce((acc, h) => acc + h)) +\r\n                (this.notes.length === 0 ?\r\n                    0 :\r\n                    this.notes.map((it) => it.height || 0).reduce((acc, h) => acc + h))\r\n            );\r\n        },\r\n        clear: function() {\r\n            this.actors = [];\r\n            this.loops = [];\r\n            this.messages = [];\r\n            this.notes = [];\r\n        },\r\n        addActor: function(actorModel) {\r\n            this.actors.push(actorModel);\r\n        },\r\n        addLoop: function(loopModel) {\r\n            this.loops.push(loopModel);\r\n        },\r\n        addMessage: function(msgModel) {\r\n            this.messages.push(msgModel);\r\n        },\r\n        addNote: function(noteModel) {\r\n            this.notes.push(noteModel);\r\n        },\r\n        lastActor: function() {\r\n            return this.actors[this.actors.length - 1];\r\n        },\r\n        lastLoop: function() {\r\n            return this.loops[this.loops.length - 1];\r\n        },\r\n        lastMessage: function() {\r\n            return this.messages[this.messages.length - 1];\r\n        },\r\n        lastNote: function() {\r\n            return this.notes[this.notes.length - 1];\r\n        },\r\n        actors: [],\r\n        loops: [],\r\n        messages: [],\r\n        notes: [],\r\n    },\r\n    init: function() {\r\n        this.sequenceItems = [];\r\n        this.activations = [];\r\n        this.models.clear();\r\n        this.data = {\r\n            startx: undefined,\r\n            stopx: undefined,\r\n            starty: undefined,\r\n            stopy: undefined,\r\n        };\r\n        this.verticalPos = 0;\r\n        setConf(parser.yy.getConfig());\r\n    },\r\n    updateVal: function(obj, key, val, fun) {\r\n        if (typeof obj[key] === 'undefined') {\r\n            obj[key] = val;\r\n        } else {\r\n            obj[key] = fun(val, obj[key]);\r\n        }\r\n    },\r\n    updateBounds: function(startx, starty, stopx, stopy) {\r\n        const _self = this;\r\n        let cnt = 0;\r\n        /** @param {any} type */\r\n        function updateFn(type) {\r\n            return function updateItemBounds(item) {\r\n                cnt++;\r\n                // The loop sequenceItems is a stack so the biggest margins in the beginning of the sequenceItems\r\n                const n = _self.sequenceItems.length - cnt + 1;\r\n\r\n                _self.updateVal(item, 'starty', starty - n * conf.boxMargin, Math.min);\r\n                _self.updateVal(item, 'stopy', stopy + n * conf.boxMargin, Math.max);\r\n\r\n                _self.updateVal(bounds.data, 'startx', startx - n * conf.boxMargin, Math.min);\r\n                _self.updateVal(bounds.data, 'stopx', stopx + n * conf.boxMargin, Math.max);\r\n\r\n                if (!(type === 'activation')) {\r\n                    _self.updateVal(item, 'startx', startx - n * conf.boxMargin, Math.min);\r\n                    _self.updateVal(item, 'stopx', stopx + n * conf.boxMargin, Math.max);\r\n\r\n                    _self.updateVal(bounds.data, 'starty', starty - n * conf.boxMargin, Math.min);\r\n                    _self.updateVal(bounds.data, 'stopy', stopy + n * conf.boxMargin, Math.max);\r\n                }\r\n            };\r\n        }\r\n\r\n        this.sequenceItems.forEach(updateFn());\r\n        this.activations.forEach(updateFn('activation'));\r\n    },\r\n    insert: function(startx, starty, stopx, stopy) {\r\n        const _startx = Math.min(startx, stopx);\r\n        const _stopx = Math.max(startx, stopx);\r\n        const _starty = Math.min(starty, stopy);\r\n        const _stopy = Math.max(starty, stopy);\r\n\r\n        this.updateVal(bounds.data, 'startx', _startx, Math.min);\r\n        this.updateVal(bounds.data, 'starty', _starty, Math.min);\r\n        this.updateVal(bounds.data, 'stopx', _stopx, Math.max);\r\n        this.updateVal(bounds.data, 'stopy', _stopy, Math.max);\r\n\r\n        this.updateBounds(_startx, _starty, _stopx, _stopy);\r\n    },\r\n    newActivation: function(message, diagram, actors) {\r\n        const actorRect = actors[message.from.actor];\r\n        const stackedSize = actorActivations(message.from.actor).length || 0;\r\n        const x = actorRect.x + actorRect.width / 2 + ((stackedSize - 1) * conf.activationWidth) / 2;\r\n        this.activations.push({\r\n            startx: x,\r\n            starty: this.verticalPos + 2,\r\n            stopx: x + conf.activationWidth,\r\n            stopy: undefined,\r\n            actor: message.from.actor,\r\n            anchored: svgDraw.anchorElement(diagram),\r\n        });\r\n    },\r\n    endActivation: function(message) {\r\n        // find most recent activation for given actor\r\n        const lastActorActivationIdx = this.activations\r\n            .map(function(activation) {\r\n                return activation.actor;\r\n            })\r\n            .lastIndexOf(message.from.actor);\r\n        return this.activations.splice(lastActorActivationIdx, 1)[0];\r\n    },\r\n    createLoop: function(title = { message: undefined, wrap: false, width: undefined }, fill) {\r\n        return {\r\n            startx: undefined,\r\n            starty: this.verticalPos,\r\n            stopx: undefined,\r\n            stopy: undefined,\r\n            title: title.message,\r\n            wrap: title.wrap,\r\n            width: title.width,\r\n            height: 0,\r\n            fill: fill,\r\n        };\r\n    },\r\n    newLoop: function(title = { message: undefined, wrap: false, width: undefined }, fill) {\r\n        this.sequenceItems.push(this.createLoop(title, fill));\r\n    },\r\n    endLoop: function() {\r\n        return this.sequenceItems.pop();\r\n    },\r\n    addSectionToLoop: function(message) {\r\n        const loop = this.sequenceItems.pop();\r\n        loop.sections = loop.sections || [];\r\n        loop.sectionTitles = loop.sectionTitles || [];\r\n        loop.sections.push({ y: bounds.getVerticalPos(), height: 0 });\r\n        loop.sectionTitles.push(message);\r\n        this.sequenceItems.push(loop);\r\n    },\r\n    bumpVerticalPos: function(bump) {\r\n        this.verticalPos = this.verticalPos + bump;\r\n        this.data.stopy = this.verticalPos;\r\n    },\r\n    getVerticalPos: function() {\r\n        return this.verticalPos;\r\n    },\r\n    getBounds: function() {\r\n        return { bounds: this.data, models: this.models };\r\n    },\r\n};\r\n\r\n/**\r\n * Draws an note in the diagram with the attached line\r\n *\r\n * @param {any} elem - The diagram to draw to.\r\n * @param {{ x: number; y: number; message: string; width: number }} noteModel - Startx: x axis\r\n *   start position, verticalPos: y axis position, messsage: the message to be shown, width: Set\r\n *   this with a custom width to override the default configured width.\r\n */\r\nconst drawNote = function(elem, noteModel) {\r\n    bounds.bumpVerticalPos(conf.boxMargin);\r\n    noteModel.height = conf.boxMargin;\r\n    noteModel.starty = bounds.getVerticalPos();\r\n    const rect = svgDraw.getNoteRect();\r\n    rect.x = noteModel.startx;\r\n    rect.y = noteModel.starty;\r\n    rect.width = noteModel.width || conf.width;\r\n    rect.class = 'note';\r\n\r\n    let g = elem.append('g');\r\n    const rectElem = svgDraw.drawRect(g, rect);\r\n    const textObj = svgDraw.getTextObj();\r\n    textObj.x = noteModel.startx;\r\n    textObj.y = noteModel.starty;\r\n    textObj.width = rect.width;\r\n    textObj.dy = '1em';\r\n    textObj.text = noteModel.message;\r\n    textObj.class = 'noteText';\r\n    textObj.fontFamily = conf.noteFontFamily;\r\n    textObj.fontSize = conf.noteFontSize;\r\n    textObj.fontWeight = conf.noteFontWeight;\r\n    textObj.anchor = conf.noteAlign;\r\n    textObj.textMargin = conf.noteMargin;\r\n    textObj.valign = conf.noteAlign;\r\n\r\n    let textElem = drawText(g, textObj);\r\n\r\n    let textHeight = Math.round(\r\n        textElem\r\n        .map((te) => (te._groups || te)[0][0].getBBox().height)\r\n        .reduce((acc, curr) => acc + curr)\r\n    );\r\n\r\n    rectElem.attr('height', textHeight + 2 * conf.noteMargin);\r\n    noteModel.height += textHeight + 2 * conf.noteMargin;\r\n    bounds.bumpVerticalPos(textHeight + 2 * conf.noteMargin);\r\n    noteModel.stopy = noteModel.starty + textHeight + 2 * conf.noteMargin;\r\n    noteModel.stopx = noteModel.startx + rect.width;\r\n    bounds.insert(noteModel.startx, noteModel.starty, noteModel.stopx, noteModel.stopy);\r\n    bounds.models.addNote(noteModel);\r\n};\r\n\r\nconst messageFont = (cnf) => {\r\n    return {\r\n        fontFamily: cnf.messageFontFamily,\r\n        fontSize: cnf.messageFontSize,\r\n        fontWeight: cnf.messageFontWeight,\r\n    };\r\n};\r\nconst noteFont = (cnf) => {\r\n    return {\r\n        fontFamily: cnf.noteFontFamily,\r\n        fontSize: cnf.noteFontSize,\r\n        fontWeight: cnf.noteFontWeight,\r\n    };\r\n};\r\nconst actorFont = (cnf) => {\r\n    return {\r\n        fontFamily: cnf.actorFontFamily,\r\n        fontSize: cnf.actorFontSize,\r\n        fontWeight: cnf.actorFontWeight,\r\n    };\r\n};\r\n\r\n/**\r\n * Process a message by adding its dimensions to the bound. It returns the Y coordinate of the\r\n * message so it can be drawn later. We do not draw the message at this point so the arrowhead can\r\n * be on top of the activation box.\r\n *\r\n * @param {any} diagram - The parent of the message element\r\n * @param {any} msgModel - The model containing fields describing a message\r\n * @returns {number} LineStarty - The Y coordinate at which the message line starts\r\n */\r\nconst boundMessage = function(diagram, msgModel) {\r\n    bounds.bumpVerticalPos(10);\r\n    const { startx, stopx, message } = msgModel;\r\n    const lines = common.splitBreaks(message).length;\r\n    let textDims = utils.calculateTextDimensions(message, messageFont(conf));\r\n    const lineHeight = textDims.height / lines;\r\n    msgModel.height += lineHeight;\r\n\r\n    bounds.bumpVerticalPos(lineHeight);\r\n\r\n    let lineStarty;\r\n    let totalOffset = textDims.height - 10;\r\n    let textWidth = textDims.width;\r\n\r\n    if (startx === stopx) {\r\n        lineStarty = bounds.getVerticalPos() + totalOffset;\r\n        if (!conf.rightAngles) {\r\n            totalOffset += conf.boxMargin;\r\n            lineStarty = bounds.getVerticalPos() + totalOffset;\r\n        }\r\n        totalOffset += 30;\r\n        const dx = Math.max(textWidth / 2, conf.width / 2);\r\n        bounds.insert(\r\n            startx - dx,\r\n            bounds.getVerticalPos() - 10 + totalOffset,\r\n            stopx + dx,\r\n            bounds.getVerticalPos() + 30 + totalOffset\r\n        );\r\n    } else {\r\n        totalOffset += conf.boxMargin;\r\n        lineStarty = bounds.getVerticalPos() + totalOffset;\r\n        bounds.insert(startx, lineStarty - 10, stopx, lineStarty);\r\n    }\r\n    bounds.bumpVerticalPos(totalOffset);\r\n    msgModel.height += totalOffset;\r\n    msgModel.stopy = msgModel.starty + msgModel.height;\r\n    bounds.insert(msgModel.fromBounds, msgModel.starty, msgModel.toBounds, msgModel.stopy);\r\n\r\n    return lineStarty;\r\n};\r\n\r\n/**\r\n * Draws a message. Note that the bounds have previously been updated by boundMessage.\r\n *\r\n * @param {any} diagram - The parent of the message element\r\n * @param {any} msgModel - The model containing fields describing a message\r\n * @param {float} lineStarty - The Y coordinate at which the message line starts\r\n */\r\nconst drawMessage = function(diagram, msgModel, lineStarty) {\r\n    const { startx, stopx, starty, message, type, sequenceIndex, sequenceVisible } = msgModel;\r\n    let textDims = utils.calculateTextDimensions(message, messageFont(conf));\r\n    const textObj = svgDraw.getTextObj();\r\n    textObj.x = startx;\r\n    textObj.y = starty + 10;\r\n    textObj.width = stopx - startx;\r\n    textObj.class = 'messageText';\r\n    textObj.dy = '1em';\r\n    textObj.text = message;\r\n    textObj.fontFamily = conf.messageFontFamily;\r\n    textObj.fontSize = conf.messageFontSize;\r\n    textObj.fontWeight = conf.messageFontWeight;\r\n    textObj.anchor = conf.messageAlign;\r\n    textObj.valign = conf.messageAlign;\r\n    textObj.textMargin = conf.wrapPadding;\r\n    textObj.tspan = false;\r\n\r\n    drawText(diagram, textObj);\r\n\r\n    let textWidth = textDims.width;\r\n\r\n    let line;\r\n    if (startx === stopx) {\r\n        if (conf.rightAngles) {\r\n            line = diagram\r\n                .append('path')\r\n                .attr(\r\n                    'd',\r\n                    `M  ${startx},${lineStarty} H ${startx + Math.max(conf.width / 2, textWidth / 2)} V ${\r\n            lineStarty + 25\r\n          } H ${startx}`\r\n                );\r\n        } else {\r\n            line = diagram\r\n                .append('path')\r\n                .attr(\r\n                    'd',\r\n                    'M ' +\r\n                    startx +\r\n                    ',' +\r\n                    lineStarty +\r\n                    ' C ' +\r\n                    (startx + 60) +\r\n                    ',' +\r\n                    (lineStarty - 10) +\r\n                    ' ' +\r\n                    (startx + 60) +\r\n                    ',' +\r\n                    (lineStarty + 30) +\r\n                    ' ' +\r\n                    startx +\r\n                    ',' +\r\n                    (lineStarty + 20)\r\n                );\r\n        }\r\n    } else {\r\n        line = diagram.append('line');\r\n        line.attr('x1', startx);\r\n        line.attr('y1', lineStarty);\r\n        line.attr('x2', stopx);\r\n        line.attr('y2', lineStarty);\r\n    }\r\n    // Make an SVG Container\r\n    // Draw the line\r\n    if (\r\n        type === parser.yy.LINETYPE.DOTTED ||\r\n        type === parser.yy.LINETYPE.DOTTED_CROSS ||\r\n        type === parser.yy.LINETYPE.DOTTED_POINT ||\r\n        type === parser.yy.LINETYPE.DOTTED_OPEN\r\n    ) {\r\n        line.style('stroke-dasharray', '3, 3');\r\n        line.attr('class', 'messageLine1');\r\n    } else {\r\n        line.attr('class', 'messageLine0');\r\n    }\r\n\r\n    let url = '';\r\n    if (conf.arrowMarkerAbsolute) {\r\n        url =\r\n            window.location.protocol +\r\n            '//' +\r\n            window.location.host +\r\n            window.location.pathname +\r\n            window.location.search;\r\n        url = url.replace(/\\(/g, '\\\\(');\r\n        url = url.replace(/\\)/g, '\\\\)');\r\n    }\r\n\r\n    line.attr('stroke-width', 2);\r\n    line.attr('stroke', 'none'); // handled by theme/css anyway\r\n    line.style('fill', 'none'); // remove any fill colour\r\n    if (type === parser.yy.LINETYPE.SOLID || type === parser.yy.LINETYPE.DOTTED) {\r\n        line.attr('marker-end', 'url(' + url + '#arrowhead)');\r\n    }\r\n    if (type === parser.yy.LINETYPE.SOLID_POINT || type === parser.yy.LINETYPE.DOTTED_POINT) {\r\n        line.attr('marker-end', 'url(' + url + '#filled-head)');\r\n    }\r\n\r\n    if (type === parser.yy.LINETYPE.SOLID_CROSS || type === parser.yy.LINETYPE.DOTTED_CROSS) {\r\n        line.attr('marker-end', 'url(' + url + '#crosshead)');\r\n    }\r\n\r\n    // add node number\r\n    if (sequenceVisible || conf.showSequenceNumbers) {\r\n        line.attr('marker-start', 'url(' + url + '#sequencenumber)');\r\n        diagram\r\n            .append('text')\r\n            .attr('x', startx)\r\n            .attr('y', lineStarty + 4)\r\n            .attr('font-family', 'sans-serif')\r\n            .attr('font-size', '12px')\r\n            .attr('text-anchor', 'middle')\r\n            .attr('textLength', '16px')\r\n            .attr('class', 'sequenceNumber')\r\n            .text(sequenceIndex);\r\n    }\r\n};\r\n\r\nexport const drawActors = function(diagram, actors, actorKeys, verticalPos) {\r\n    // Draw the actors\r\n    let prevWidth = 0;\r\n    let prevMargin = 0;\r\n    let maxHeight = 0;\r\n    for (let i = 0; i < actorKeys.length; i++) {\r\n        const actor = actors[actorKeys[i]];\r\n\r\n        // Add some rendering data to the object\r\n        actor.width = actor.width || conf.width;\r\n        actor.height = Math.max(actor.height || conf.height, conf.height);\r\n        actor.margin = actor.margin || conf.actorMargin;\r\n\r\n        actor.x = prevWidth + prevMargin;\r\n        actor.y = verticalPos;\r\n\r\n        // Draw the box with the attached line\r\n        const height = svgDraw.drawActor(diagram, actor, conf);\r\n        maxHeight = Math.max(maxHeight, height);\r\n        bounds.insert(actor.x, verticalPos, actor.x + actor.width, actor.height);\r\n\r\n        prevWidth += actor.width;\r\n        prevMargin += actor.margin;\r\n        bounds.models.addActor(actor);\r\n    }\r\n\r\n    // Add a margin between the actor boxes and the first arrow\r\n    bounds.bumpVerticalPos(maxHeight);\r\n};\r\n\r\nexport const drawActorsPopup = function(diagram, actors, actorKeys, doc) {\r\n    var maxHeight = 0;\r\n    var maxWidth = 0;\r\n    for (let i = 0; i < actorKeys.length; i++) {\r\n        const actor = actors[actorKeys[i]];\r\n        const minMenuWidth = getRequiredPopupWidth(actor);\r\n        var menuDimensions = svgDraw.drawPopup(\r\n            diagram,\r\n            actor,\r\n            minMenuWidth,\r\n            conf,\r\n            conf.forceMenus,\r\n            doc\r\n        );\r\n        if (menuDimensions.height > maxHeight) {\r\n            maxHeight = menuDimensions.height;\r\n        }\r\n        if (menuDimensions.width + actor.x > maxWidth) {\r\n            maxWidth = menuDimensions.width + actor.x;\r\n        }\r\n    }\r\n\r\n    return { maxHeight: maxHeight, maxWidth: maxWidth };\r\n};\r\n\r\nexport const setConf = function(cnf) {\r\n    assignWithDepth(conf, cnf);\r\n\r\n    if (cnf.fontFamily) {\r\n        conf.actorFontFamily = conf.noteFontFamily = conf.messageFontFamily = cnf.fontFamily;\r\n    }\r\n    if (cnf.fontSize) {\r\n        conf.actorFontSize = conf.noteFontSize = conf.messageFontSize = cnf.fontSize;\r\n    }\r\n    if (cnf.fontWeight) {\r\n        conf.actorFontWeight = conf.noteFontWeight = conf.messageFontWeight = cnf.fontWeight;\r\n    }\r\n};\r\n\r\nconst actorActivations = function(actor) {\r\n    return bounds.activations.filter(function(activation) {\r\n        return activation.actor === actor;\r\n    });\r\n};\r\n\r\nconst activationBounds = function(actor, actors) {\r\n    // handle multiple stacked activations for same actor\r\n    const actorObj = actors[actor];\r\n    const activations = actorActivations(actor);\r\n\r\n    const left = activations.reduce(function(acc, activation) {\r\n        return Math.min(acc, activation.startx);\r\n    }, actorObj.x + actorObj.width / 2);\r\n    const right = activations.reduce(function(acc, activation) {\r\n        return Math.max(acc, activation.stopx);\r\n    }, actorObj.x + actorObj.width / 2);\r\n    return [left, right];\r\n};\r\n\r\n/**\r\n * @param {any} loopWidths\r\n * @param {any} msg\r\n * @param {any} preMargin\r\n * @param {any} postMargin\r\n * @param {any} addLoopFn\r\n */\r\nfunction adjustLoopHeightForWrap(loopWidths, msg, preMargin, postMargin, addLoopFn) {\r\n    bounds.bumpVerticalPos(preMargin);\r\n    let heightAdjust = postMargin;\r\n    if (msg.id && msg.message && loopWidths[msg.id]) {\r\n        let loopWidth = loopWidths[msg.id].width;\r\n        let textConf = messageFont(conf);\r\n        msg.message = utils.wrapLabel(`[${msg.message}]`, loopWidth - 2 * conf.wrapPadding, textConf);\r\n        msg.width = loopWidth;\r\n        msg.wrap = true;\r\n\r\n        // const lines = common.splitBreaks(msg.message).length;\r\n        const textDims = utils.calculateTextDimensions(msg.message, textConf);\r\n        const totalOffset = Math.max(textDims.height, conf.labelBoxHeight);\r\n        heightAdjust = postMargin + totalOffset;\r\n        log.debug(`${totalOffset} - ${msg.message}`);\r\n    }\r\n    addLoopFn(msg);\r\n    bounds.bumpVerticalPos(heightAdjust);\r\n}\r\n\r\n/**\r\n * Draws a sequenceDiagram in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {any} text\r\n * @param {any} id\r\n */\r\nexport const draw = function(text, id) {\r\n    conf = configApi.getConfig().sequence;\r\n    const securityLevel = configApi.getConfig().securityLevel;\r\n    // Handle root and ocument for when rendering in sanbox mode\r\n    let sandboxElement;\r\n    if (securityLevel === 'sandbox') {\r\n        sandboxElement = select('#i' + id);\r\n    }\r\n    const root =\r\n        securityLevel === 'sandbox' ?\r\n        select(sandboxElement.nodes()[0].contentDocument.body) :\r\n        select('body');\r\n    const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n    parser.yy.clear();\r\n    parser.yy.setWrap(conf.wrap);\r\n    parser.parse(text + '\\n');\r\n    bounds.init();\r\n    log.debug(`C:${JSON.stringify(conf, null, 2)}`);\r\n\r\n    const diagram =\r\n        securityLevel === 'sandbox' ? root.select(`[id=\"${id}\"]`) : select(`[id=\"${id}\"]`);\r\n\r\n    // Fetch data from the parsing\r\n    const actors = parser.yy.getActors();\r\n    const actorKeys = parser.yy.getActorKeys();\r\n    const messages = parser.yy.getMessages();\r\n    const title = parser.yy.getTitle();\r\n\r\n    const maxMessageWidthPerActor = getMaxMessageWidthPerActor(actors, messages);\r\n    conf.height = calculateActorMargins(actors, maxMessageWidthPerActor);\r\n\r\n    svgDraw.insertComputerIcon(diagram);\r\n    svgDraw.insertDatabaseIcon(diagram);\r\n    svgDraw.insertClockIcon(diagram);\r\n\r\n    drawActors(diagram, actors, actorKeys, 0);\r\n    const loopWidths = calculateLoopBounds(messages, actors, maxMessageWidthPerActor);\r\n\r\n    // The arrow head definition is attached to the svg once\r\n    svgDraw.insertArrowHead(diagram);\r\n    svgDraw.insertArrowCrossHead(diagram);\r\n    svgDraw.insertArrowFilledHead(diagram);\r\n    svgDraw.insertSequenceNumber(diagram);\r\n\r\n    /**\r\n     * @param {any} msg\r\n     * @param {any} verticalPos\r\n     */\r\n    function activeEnd(msg, verticalPos) {\r\n        const activationData = bounds.endActivation(msg);\r\n        if (activationData.starty + 18 > verticalPos) {\r\n            activationData.starty = verticalPos - 6;\r\n            verticalPos += 12;\r\n        }\r\n        svgDraw.drawActivation(\r\n            diagram,\r\n            activationData,\r\n            verticalPos,\r\n            conf,\r\n            actorActivations(msg.from.actor).length\r\n        );\r\n\r\n        bounds.insert(activationData.startx, verticalPos - 10, activationData.stopx, verticalPos);\r\n    }\r\n\r\n    // Draw the messages/signals\r\n    let sequenceIndex = 1;\r\n    let sequenceIndexStep = 1;\r\n    let messagesToDraw = Array();\r\n    messages.forEach(function(msg) {\r\n        let loopModel, noteModel, msgModel;\r\n\r\n        switch (msg.type) {\r\n            case parser.yy.LINETYPE.NOTE:\r\n                noteModel = msg.noteModel;\r\n                drawNote(diagram, noteModel);\r\n                break;\r\n            case parser.yy.LINETYPE.ACTIVE_START:\r\n                bounds.newActivation(msg, diagram, actors);\r\n                break;\r\n            case parser.yy.LINETYPE.ACTIVE_END:\r\n                activeEnd(msg, bounds.getVerticalPos());\r\n                break;\r\n            case parser.yy.LINETYPE.LOOP_START:\r\n                adjustLoopHeightForWrap(\r\n                    loopWidths,\r\n                    msg,\r\n                    conf.boxMargin,\r\n                    conf.boxMargin + conf.boxTextMargin,\r\n                    (message) => bounds.newLoop(message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.LOOP_END:\r\n                loopModel = bounds.endLoop();\r\n                svgDraw.drawLoop(diagram, loopModel, 'loop', conf);\r\n                bounds.bumpVerticalPos(loopModel.stopy - bounds.getVerticalPos());\r\n                bounds.models.addLoop(loopModel);\r\n                break;\r\n            case parser.yy.LINETYPE.RECT_START:\r\n                adjustLoopHeightForWrap(loopWidths, msg, conf.boxMargin, conf.boxMargin, (message) =>\r\n                    bounds.newLoop(undefined, message.message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.RECT_END:\r\n                loopModel = bounds.endLoop();\r\n                svgDraw.drawBackgroundRect(diagram, loopModel);\r\n                bounds.models.addLoop(loopModel);\r\n                bounds.bumpVerticalPos(loopModel.stopy - bounds.getVerticalPos());\r\n                break;\r\n            case parser.yy.LINETYPE.OPT_START:\r\n                adjustLoopHeightForWrap(\r\n                    loopWidths,\r\n                    msg,\r\n                    conf.boxMargin,\r\n                    conf.boxMargin + conf.boxTextMargin,\r\n                    (message) => bounds.newLoop(message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.OPT_END:\r\n                loopModel = bounds.endLoop();\r\n                svgDraw.drawLoop(diagram, loopModel, 'opt', conf);\r\n                bounds.bumpVerticalPos(loopModel.stopy - bounds.getVerticalPos());\r\n                bounds.models.addLoop(loopModel);\r\n                break;\r\n            case parser.yy.LINETYPE.ALT_START:\r\n                adjustLoopHeightForWrap(\r\n                    loopWidths,\r\n                    msg,\r\n                    conf.boxMargin,\r\n                    conf.boxMargin + conf.boxTextMargin,\r\n                    (message) => bounds.newLoop(message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.ALT_ELSE:\r\n                adjustLoopHeightForWrap(\r\n                    loopWidths,\r\n                    msg,\r\n                    conf.boxMargin + conf.boxTextMargin,\r\n                    conf.boxMargin,\r\n                    (message) => bounds.addSectionToLoop(message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.ALT_END:\r\n                loopModel = bounds.endLoop();\r\n                svgDraw.drawLoop(diagram, loopModel, 'alt', conf);\r\n                bounds.bumpVerticalPos(loopModel.stopy - bounds.getVerticalPos());\r\n                bounds.models.addLoop(loopModel);\r\n                break;\r\n            case parser.yy.LINETYPE.PAR_START:\r\n                adjustLoopHeightForWrap(\r\n                    loopWidths,\r\n                    msg,\r\n                    conf.boxMargin,\r\n                    conf.boxMargin + conf.boxTextMargin,\r\n                    (message) => bounds.newLoop(message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.PAR_AND:\r\n                adjustLoopHeightForWrap(\r\n                    loopWidths,\r\n                    msg,\r\n                    conf.boxMargin + conf.boxTextMargin,\r\n                    conf.boxMargin,\r\n                    (message) => bounds.addSectionToLoop(message)\r\n                );\r\n                break;\r\n            case parser.yy.LINETYPE.PAR_END:\r\n                loopModel = bounds.endLoop();\r\n                svgDraw.drawLoop(diagram, loopModel, 'par', conf);\r\n                bounds.bumpVerticalPos(loopModel.stopy - bounds.getVerticalPos());\r\n                bounds.models.addLoop(loopModel);\r\n                break;\r\n            case parser.yy.LINETYPE.AUTONUMBER:\r\n                sequenceIndex = msg.message.start || sequenceIndex;\r\n                sequenceIndexStep = msg.message.step || sequenceIndexStep;\r\n                if (msg.message.visible) parser.yy.enableSequenceNumbers();\r\n                else parser.yy.disableSequenceNumbers();\r\n                break;\r\n            default:\r\n                try {\r\n                    // lastMsg = msg\r\n                    msgModel = msg.msgModel;\r\n                    msgModel.starty = bounds.getVerticalPos();\r\n                    msgModel.sequenceIndex = sequenceIndex;\r\n                    msgModel.sequenceVisible = parser.yy.showSequenceNumbers();\r\n                    let lineStarty = boundMessage(diagram, msgModel);\r\n                    messagesToDraw.push({ messageModel: msgModel, lineStarty: lineStarty });\r\n                    bounds.models.addMessage(msgModel);\r\n                } catch (e) {\r\n                    log.error('error while drawing message', e);\r\n                }\r\n        }\r\n\r\n        // Increment sequence counter if msg.type is a line (and not another event like activation or note, etc)\r\n        if (\r\n            [\r\n                parser.yy.LINETYPE.SOLID_OPEN,\r\n                parser.yy.LINETYPE.DOTTED_OPEN,\r\n                parser.yy.LINETYPE.SOLID,\r\n                parser.yy.LINETYPE.DOTTED,\r\n                parser.yy.LINETYPE.SOLID_CROSS,\r\n                parser.yy.LINETYPE.DOTTED_CROSS,\r\n                parser.yy.LINETYPE.SOLID_POINT,\r\n                parser.yy.LINETYPE.DOTTED_POINT,\r\n            ].includes(msg.type)\r\n        ) {\r\n            sequenceIndex = sequenceIndex + sequenceIndexStep;\r\n        }\r\n    });\r\n\r\n    messagesToDraw.forEach((e) => drawMessage(diagram, e.messageModel, e.lineStarty));\r\n\r\n    if (conf.mirrorActors) {\r\n        // Draw actors below diagram\r\n        bounds.bumpVerticalPos(conf.boxMargin * 2);\r\n        drawActors(diagram, actors, actorKeys, bounds.getVerticalPos());\r\n        bounds.bumpVerticalPos(conf.boxMargin);\r\n        fixLifeLineHeights(diagram, bounds.getVerticalPos());\r\n    }\r\n\r\n    // only draw popups for the top row of actors.\r\n    var requiredBoxSize = drawActorsPopup(diagram, actors, actorKeys, doc);\r\n\r\n    const { bounds: box } = bounds.getBounds();\r\n\r\n    // Adjust line height of actor lines now that the height of the diagram is known\r\n    log.debug('For line height fix Querying: #' + id + ' .actor-line');\r\n    const actorLines = selectAll('#' + id + ' .actor-line');\r\n    actorLines.attr('y2', box.stopy);\r\n\r\n    // Make sure the height of the diagram supports long menus.\r\n    let boxHeight = box.stopy - box.starty;\r\n    if (boxHeight < requiredBoxSize.maxHeight) {\r\n        boxHeight = requiredBoxSize.maxHeight;\r\n    }\r\n\r\n    let height = boxHeight + 2 * conf.diagramMarginY;\r\n    if (conf.mirrorActors) {\r\n        height = height - conf.boxMargin + conf.bottomMarginAdj;\r\n    }\r\n\r\n    // Make sure the width of the diagram supports wide menus.\r\n    let boxWidth = box.stopx - box.startx;\r\n    if (boxWidth < requiredBoxSize.maxWidth) {\r\n        boxWidth = requiredBoxSize.maxWidth;\r\n    }\r\n    const width = boxWidth + 2 * conf.diagramMarginX;\r\n\r\n    if (title) {\r\n        diagram\r\n            .append('text')\r\n            .text(title)\r\n            .attr('x', (box.stopx - box.startx) / 2 - 2 * conf.diagramMarginX)\r\n            .attr('y', -25);\r\n    }\r\n\r\n    configureSvgSize(diagram, height, width, conf.useMaxWidth);\r\n\r\n    const extraVertForTitle = title ? 40 : 0;\r\n    diagram.attr(\r\n        'viewBox',\r\n        box.startx -\r\n        conf.diagramMarginX +\r\n        ' -' +\r\n        (conf.diagramMarginY + extraVertForTitle) +\r\n        ' ' +\r\n        width +\r\n        ' ' +\r\n        (height + extraVertForTitle)\r\n    );\r\n\r\n    addSVGAccessibilityFields(parser.yy, diagram, id);\r\n    log.debug(`models:`, bounds.models);\r\n};\r\n\r\n/**\r\n * Retrieves the max message width of each actor, supports signals (messages, loops) and notes.\r\n *\r\n * It will enumerate each given message, and will determine its text width, in relation to the actor\r\n * it originates from, and destined to.\r\n *\r\n * @param {any} actors - The actors map\r\n * @param {Array} messages - A list of message objects to iterate\r\n * @returns {any}\r\n */\r\nconst getMaxMessageWidthPerActor = function(actors, messages) {\r\n    const maxMessageWidthPerActor = {};\r\n\r\n    messages.forEach(function(msg) {\r\n        if (actors[msg.to] && actors[msg.from]) {\r\n            const actor = actors[msg.to];\r\n\r\n            // If this is the first actor, and the message is left of it, no need to calculate the margin\r\n            if (msg.placement === parser.yy.PLACEMENT.LEFTOF && !actor.prevActor) {\r\n                return;\r\n            }\r\n\r\n            // If this is the last actor, and the message is right of it, no need to calculate the margin\r\n            if (msg.placement === parser.yy.PLACEMENT.RIGHTOF && !actor.nextActor) {\r\n                return;\r\n            }\r\n\r\n            const isNote = msg.placement !== undefined;\r\n            const isMessage = !isNote;\r\n\r\n            const textFont = isNote ? noteFont(conf) : messageFont(conf);\r\n            let wrappedMessage = msg.wrap ?\r\n                utils.wrapLabel(msg.message, conf.width - 2 * conf.wrapPadding, textFont) :\r\n                msg.message;\r\n            const messageDimensions = utils.calculateTextDimensions(wrappedMessage, textFont);\r\n            const messageWidth = messageDimensions.width + 2 * conf.wrapPadding;\r\n\r\n            /*\r\n             * The following scenarios should be supported:\r\n             *\r\n             * - There's a message (non-note) between fromActor and toActor\r\n             *   - If fromActor is on the right and toActor is on the left, we should\r\n             *     define the toActor's margin\r\n             *   - If fromActor is on the left and toActor is on the right, we should\r\n             *     define the fromActor's margin\r\n             * - There's a note, in which case fromActor == toActor\r\n             *   - If the note is to the left of the actor, we should define the previous actor\r\n             *     margin\r\n             *   - If the note is on the actor, we should define both the previous and next actor\r\n             *     margins, each being the half of the note size\r\n             *   - If the note is on the right of the actor, we should define the current actor\r\n             *     margin\r\n             */\r\n            if (isMessage && msg.from === actor.nextActor) {\r\n                maxMessageWidthPerActor[msg.to] = Math.max(\r\n                    maxMessageWidthPerActor[msg.to] || 0,\r\n                    messageWidth\r\n                );\r\n            } else if (isMessage && msg.from === actor.prevActor) {\r\n                maxMessageWidthPerActor[msg.from] = Math.max(\r\n                    maxMessageWidthPerActor[msg.from] || 0,\r\n                    messageWidth\r\n                );\r\n            } else if (isMessage && msg.from === msg.to) {\r\n                maxMessageWidthPerActor[msg.from] = Math.max(\r\n                    maxMessageWidthPerActor[msg.from] || 0,\r\n                    messageWidth / 2\r\n                );\r\n\r\n                maxMessageWidthPerActor[msg.to] = Math.max(\r\n                    maxMessageWidthPerActor[msg.to] || 0,\r\n                    messageWidth / 2\r\n                );\r\n            } else if (msg.placement === parser.yy.PLACEMENT.RIGHTOF) {\r\n                maxMessageWidthPerActor[msg.from] = Math.max(\r\n                    maxMessageWidthPerActor[msg.from] || 0,\r\n                    messageWidth\r\n                );\r\n            } else if (msg.placement === parser.yy.PLACEMENT.LEFTOF) {\r\n                maxMessageWidthPerActor[actor.prevActor] = Math.max(\r\n                    maxMessageWidthPerActor[actor.prevActor] || 0,\r\n                    messageWidth\r\n                );\r\n            } else if (msg.placement === parser.yy.PLACEMENT.OVER) {\r\n                if (actor.prevActor) {\r\n                    maxMessageWidthPerActor[actor.prevActor] = Math.max(\r\n                        maxMessageWidthPerActor[actor.prevActor] || 0,\r\n                        messageWidth / 2\r\n                    );\r\n                }\r\n\r\n                if (actor.nextActor) {\r\n                    maxMessageWidthPerActor[msg.from] = Math.max(\r\n                        maxMessageWidthPerActor[msg.from] || 0,\r\n                        messageWidth / 2\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    log.debug('maxMessageWidthPerActor:', maxMessageWidthPerActor);\r\n    return maxMessageWidthPerActor;\r\n};\r\n\r\nconst getRequiredPopupWidth = function(actor) {\r\n    let requiredPopupWidth = 0;\r\n    const textFont = actorFont(conf);\r\n    for (let key in actor.links) {\r\n        let labelDimensions = utils.calculateTextDimensions(key, textFont);\r\n        let labelWidth = labelDimensions.width + 2 * conf.wrapPadding + 2 * conf.boxMargin;\r\n        if (requiredPopupWidth < labelWidth) {\r\n            requiredPopupWidth = labelWidth;\r\n        }\r\n    }\r\n\r\n    return requiredPopupWidth;\r\n};\r\n\r\n/**\r\n * This will calculate the optimal margin for each given actor, for a given actor->messageWidth map.\r\n *\r\n * An actor's margin is determined by the width of the actor, the width of the largest message that\r\n * originates from it, and the configured conf.actorMargin.\r\n *\r\n * @param {any} actors - The actors map to calculate margins for\r\n * @param {any} actorToMessageWidth - A map of actor key -> max message width it holds\r\n */\r\nconst calculateActorMargins = function(actors, actorToMessageWidth) {\r\n    let maxHeight = 0;\r\n    Object.keys(actors).forEach((prop) => {\r\n        const actor = actors[prop];\r\n        if (actor.wrap) {\r\n            actor.description = utils.wrapLabel(\r\n                actor.description,\r\n                conf.width - 2 * conf.wrapPadding,\r\n                actorFont(conf)\r\n            );\r\n        }\r\n        const actDims = utils.calculateTextDimensions(actor.description, actorFont(conf));\r\n        actor.width = actor.wrap ?\r\n            conf.width :\r\n            Math.max(conf.width, actDims.width + 2 * conf.wrapPadding);\r\n\r\n        actor.height = actor.wrap ? Math.max(actDims.height, conf.height) : conf.height;\r\n        maxHeight = Math.max(maxHeight, actor.height);\r\n    });\r\n\r\n    for (let actorKey in actorToMessageWidth) {\r\n        const actor = actors[actorKey];\r\n\r\n        if (!actor) {\r\n            continue;\r\n        }\r\n\r\n        const nextActor = actors[actor.nextActor];\r\n\r\n        // No need to space out an actor that doesn't have a next link\r\n        if (!nextActor) {\r\n            continue;\r\n        }\r\n\r\n        const messageWidth = actorToMessageWidth[actorKey];\r\n        const actorWidth = messageWidth + conf.actorMargin - actor.width / 2 - nextActor.width / 2;\r\n\r\n        actor.margin = Math.max(actorWidth, conf.actorMargin);\r\n    }\r\n\r\n    return Math.max(maxHeight, conf.height);\r\n};\r\n\r\nconst buildNoteModel = function(msg, actors) {\r\n    let startx = actors[msg.from].x;\r\n    let stopx = actors[msg.to].x;\r\n    let shouldWrap = msg.wrap && msg.message;\r\n\r\n    let textDimensions = utils.calculateTextDimensions(\r\n        shouldWrap ? utils.wrapLabel(msg.message, conf.width, noteFont(conf)) : msg.message,\r\n        noteFont(conf)\r\n    );\r\n    let noteModel = {\r\n        width: shouldWrap ?\r\n            conf.width : Math.max(conf.width, textDimensions.width + 2 * conf.noteMargin),\r\n        height: 0,\r\n        startx: actors[msg.from].x,\r\n        stopx: 0,\r\n        starty: 0,\r\n        stopy: 0,\r\n        message: msg.message,\r\n    };\r\n    if (msg.placement === parser.yy.PLACEMENT.RIGHTOF) {\r\n        noteModel.width = shouldWrap ?\r\n            Math.max(conf.width, textDimensions.width) :\r\n            Math.max(\r\n                actors[msg.from].width / 2 + actors[msg.to].width / 2,\r\n                textDimensions.width + 2 * conf.noteMargin\r\n            );\r\n        noteModel.startx = startx + (actors[msg.from].width + conf.actorMargin) / 2;\r\n    } else if (msg.placement === parser.yy.PLACEMENT.LEFTOF) {\r\n        noteModel.width = shouldWrap ?\r\n            Math.max(conf.width, textDimensions.width + 2 * conf.noteMargin) :\r\n            Math.max(\r\n                actors[msg.from].width / 2 + actors[msg.to].width / 2,\r\n                textDimensions.width + 2 * conf.noteMargin\r\n            );\r\n        noteModel.startx = startx - noteModel.width + (actors[msg.from].width - conf.actorMargin) / 2;\r\n    } else if (msg.to === msg.from) {\r\n        textDimensions = utils.calculateTextDimensions(\r\n            shouldWrap ?\r\n            utils.wrapLabel(msg.message, Math.max(conf.width, actors[msg.from].width), noteFont(conf)) :\r\n            msg.message,\r\n            noteFont(conf)\r\n        );\r\n        noteModel.width = shouldWrap ?\r\n            Math.max(conf.width, actors[msg.from].width) :\r\n            Math.max(actors[msg.from].width, conf.width, textDimensions.width + 2 * conf.noteMargin);\r\n        noteModel.startx = startx + (actors[msg.from].width - noteModel.width) / 2;\r\n    } else {\r\n        noteModel.width =\r\n            Math.abs(startx + actors[msg.from].width / 2 - (stopx + actors[msg.to].width / 2)) +\r\n            conf.actorMargin;\r\n        noteModel.startx =\r\n            startx < stopx ?\r\n            startx + actors[msg.from].width / 2 - conf.actorMargin / 2 :\r\n            stopx + actors[msg.to].width / 2 - conf.actorMargin / 2;\r\n    }\r\n    if (shouldWrap) {\r\n        noteModel.message = utils.wrapLabel(\r\n            msg.message,\r\n            noteModel.width - 2 * conf.wrapPadding,\r\n            noteFont(conf)\r\n        );\r\n    }\r\n    log.debug(\r\n        `NM:[${noteModel.startx},${noteModel.stopx},${noteModel.starty},${noteModel.stopy}:${noteModel.width},${noteModel.height}=${msg.message}]`\r\n    );\r\n    return noteModel;\r\n};\r\n\r\nconst buildMessageModel = function(msg, actors) {\r\n    let process = false;\r\n    if (\r\n        [\r\n            parser.yy.LINETYPE.SOLID_OPEN,\r\n            parser.yy.LINETYPE.DOTTED_OPEN,\r\n            parser.yy.LINETYPE.SOLID,\r\n            parser.yy.LINETYPE.DOTTED,\r\n            parser.yy.LINETYPE.SOLID_CROSS,\r\n            parser.yy.LINETYPE.DOTTED_CROSS,\r\n            parser.yy.LINETYPE.SOLID_POINT,\r\n            parser.yy.LINETYPE.DOTTED_POINT,\r\n        ].includes(msg.type)\r\n    ) {\r\n        process = true;\r\n    }\r\n    if (!process) {\r\n        return {};\r\n    }\r\n    const fromBounds = activationBounds(msg.from, actors);\r\n    const toBounds = activationBounds(msg.to, actors);\r\n    const fromIdx = fromBounds[0] <= toBounds[0] ? 1 : 0;\r\n    const toIdx = fromBounds[0] < toBounds[0] ? 0 : 1;\r\n    const allBounds = fromBounds.concat(toBounds);\r\n    const boundedWidth = Math.abs(toBounds[toIdx] - fromBounds[fromIdx]);\r\n    if (msg.wrap && msg.message) {\r\n        msg.message = utils.wrapLabel(\r\n            msg.message,\r\n            Math.max(boundedWidth + 2 * conf.wrapPadding, conf.width),\r\n            messageFont(conf)\r\n        );\r\n    }\r\n    const msgDims = utils.calculateTextDimensions(msg.message, messageFont(conf));\r\n\r\n    return {\r\n        width: Math.max(\r\n            msg.wrap ? 0 : msgDims.width + 2 * conf.wrapPadding,\r\n            boundedWidth + 2 * conf.wrapPadding,\r\n            conf.width\r\n        ),\r\n        height: 0,\r\n        startx: fromBounds[fromIdx],\r\n        stopx: toBounds[toIdx],\r\n        starty: 0,\r\n        stopy: 0,\r\n        message: msg.message,\r\n        type: msg.type,\r\n        wrap: msg.wrap,\r\n        fromBounds: Math.min.apply(null, allBounds),\r\n        toBounds: Math.max.apply(null, allBounds),\r\n    };\r\n};\r\n\r\nconst calculateLoopBounds = function(messages, actors) {\r\n    const loops = {};\r\n    const stack = [];\r\n    let current, noteModel, msgModel;\r\n\r\n    messages.forEach(function(msg) {\r\n        msg.id = utils.random({ length: 10 });\r\n        switch (msg.type) {\r\n            case parser.yy.LINETYPE.LOOP_START:\r\n            case parser.yy.LINETYPE.ALT_START:\r\n            case parser.yy.LINETYPE.OPT_START:\r\n            case parser.yy.LINETYPE.PAR_START:\r\n                stack.push({\r\n                    id: msg.id,\r\n                    msg: msg.message,\r\n                    from: Number.MAX_SAFE_INTEGER,\r\n                    to: Number.MIN_SAFE_INTEGER,\r\n                    width: 0,\r\n                });\r\n                break;\r\n            case parser.yy.LINETYPE.ALT_ELSE:\r\n            case parser.yy.LINETYPE.PAR_AND:\r\n                if (msg.message) {\r\n                    current = stack.pop();\r\n                    loops[current.id] = current;\r\n                    loops[msg.id] = current;\r\n                    stack.push(current);\r\n                }\r\n                break;\r\n            case parser.yy.LINETYPE.LOOP_END:\r\n            case parser.yy.LINETYPE.ALT_END:\r\n            case parser.yy.LINETYPE.OPT_END:\r\n            case parser.yy.LINETYPE.PAR_END:\r\n                current = stack.pop();\r\n                loops[current.id] = current;\r\n                break;\r\n            case parser.yy.LINETYPE.ACTIVE_START:\r\n                {\r\n                    const actorRect = actors[msg.from ? msg.from.actor : msg.to.actor];\r\n                    const stackedSize = actorActivations(msg.from ? msg.from.actor : msg.to.actor).length;\r\n                    const x =\r\n                        actorRect.x + actorRect.width / 2 + ((stackedSize - 1) * conf.activationWidth) / 2;\r\n                    const toAdd = {\r\n                        startx: x,\r\n                        stopx: x + conf.activationWidth,\r\n                        actor: msg.from.actor,\r\n                        enabled: true,\r\n                    };\r\n                    bounds.activations.push(toAdd);\r\n                }\r\n                break;\r\n            case parser.yy.LINETYPE.ACTIVE_END:\r\n                {\r\n                    const lastActorActivationIdx = bounds.activations\r\n                        .map((a) => a.actor)\r\n                        .lastIndexOf(msg.from.actor);\r\n                    delete bounds.activations.splice(lastActorActivationIdx, 1)[0];\r\n                }\r\n                break;\r\n        }\r\n        const isNote = msg.placement !== undefined;\r\n        if (isNote) {\r\n            noteModel = buildNoteModel(msg, actors);\r\n            msg.noteModel = noteModel;\r\n            stack.forEach((stk) => {\r\n                current = stk;\r\n                current.from = Math.min(current.from, noteModel.startx);\r\n                current.to = Math.max(current.to, noteModel.startx + noteModel.width);\r\n                current.width =\r\n                    Math.max(current.width, Math.abs(current.from - current.to)) - conf.labelBoxWidth;\r\n            });\r\n        } else {\r\n            msgModel = buildMessageModel(msg, actors);\r\n            msg.msgModel = msgModel;\r\n            if (msgModel.startx && msgModel.stopx && stack.length > 0) {\r\n                stack.forEach((stk) => {\r\n                    current = stk;\r\n                    if (msgModel.startx === msgModel.stopx) {\r\n                        let from = actors[msg.from];\r\n                        let to = actors[msg.to];\r\n                        current.from = Math.min(\r\n                            from.x - msgModel.width / 2,\r\n                            from.x - from.width / 2,\r\n                            current.from\r\n                        );\r\n                        current.to = Math.max(to.x + msgModel.width / 2, to.x + from.width / 2, current.to);\r\n                        current.width =\r\n                            Math.max(current.width, Math.abs(current.to - current.from)) - conf.labelBoxWidth;\r\n                    } else {\r\n                        current.from = Math.min(msgModel.startx, current.from);\r\n                        current.to = Math.max(msgModel.stopx, current.to);\r\n                        current.width = Math.max(current.width, msgModel.width) - conf.labelBoxWidth;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    });\r\n    bounds.activations = [];\r\n    log.debug('Loop type widths:', loops);\r\n    return loops;\r\n};\r\n\r\nexport default {\r\n    bounds,\r\n    drawActors,\r\n    drawActorsPopup,\r\n    setConf,\r\n    draw,\r\n};","const getStyles = (options) =>\r\n  `.actor {\r\n    stroke: ${options.actorBorder};\r\n    fill: ${options.actorBkg};\r\n  }\r\n\r\n  text.actor > tspan {\r\n    fill: ${options.actorTextColor};\r\n    stroke: none;\r\n  }\r\n\r\n  .actor-line {\r\n    stroke: ${options.actorLineColor};\r\n  }\r\n\r\n  .messageLine0 {\r\n    stroke-width: 1.5;\r\n    stroke-dasharray: none;\r\n    stroke: ${options.signalColor};\r\n  }\r\n\r\n  .messageLine1 {\r\n    stroke-width: 1.5;\r\n    stroke-dasharray: 2, 2;\r\n    stroke: ${options.signalColor};\r\n  }\r\n\r\n  #arrowhead path {\r\n    fill: ${options.signalColor};\r\n    stroke: ${options.signalColor};\r\n  }\r\n\r\n  .sequenceNumber {\r\n    fill: ${options.sequenceNumberColor};\r\n  }\r\n\r\n  #sequencenumber {\r\n    fill: ${options.signalColor};\r\n  }\r\n\r\n  #crosshead path {\r\n    fill: ${options.signalColor};\r\n    stroke: ${options.signalColor};\r\n  }\r\n\r\n  .messageText {\r\n    fill: ${options.signalTextColor};\r\n    stroke: ${options.signalTextColor};\r\n  }\r\n\r\n  .labelBox {\r\n    stroke: ${options.labelBoxBorderColor};\r\n    fill: ${options.labelBoxBkgColor};\r\n  }\r\n\r\n  .labelText, .labelText > tspan {\r\n    fill: ${options.labelTextColor};\r\n    stroke: none;\r\n  }\r\n\r\n  .loopText, .loopText > tspan {\r\n    fill: ${options.loopTextColor};\r\n    stroke: none;\r\n  }\r\n\r\n  .loopLine {\r\n    stroke-width: 2px;\r\n    stroke-dasharray: 2, 2;\r\n    stroke: ${options.labelBoxBorderColor};\r\n    fill: ${options.labelBoxBorderColor};\r\n  }\r\n\r\n  .note {\r\n    //stroke: #decc93;\r\n    stroke: ${options.noteBorderColor};\r\n    fill: ${options.noteBkgColor};\r\n  }\r\n\r\n  .noteText, .noteText > tspan {\r\n    fill: ${options.noteTextColor};\r\n    stroke: none;\r\n  }\r\n\r\n  .activation0 {\r\n    fill: ${options.activationBkgColor};\r\n    stroke: ${options.activationBorderColor};\r\n  }\r\n\r\n  .activation1 {\r\n    fill: ${options.activationBkgColor};\r\n    stroke: ${options.activationBorderColor};\r\n  }\r\n\r\n  .activation2 {\r\n    fill: ${options.activationBkgColor};\r\n    stroke: ${options.activationBorderColor};\r\n  }\r\n\r\n  .actorPopupMenu {\r\n    position: absolute;\r\n  }\r\n\r\n  .actorPopupMenuPanel {\r\n    position: absolute;\r\n    fill: ${options.actorBkg};\r\n    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\r\n    filter: drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));\r\n}\r\n  .actor-man line {\r\n    stroke: ${options.actorBorder};\r\n    fill: ${options.actorBkg};\r\n  }\r\n  .actor-man circle, line {\r\n    stroke: ${options.actorBorder};\r\n    fill: ${options.actorBkg};\r\n    stroke-width: 2px;\r\n  }\r\n`;\r\n\r\nexport default getStyles;\r\n","import common from '../common/common';\r\nimport { addFunction } from '../../interactionDb';\r\nimport { sanitizeUrl } from '@braintree/sanitize-url';\r\n\r\nexport const drawRect = function (elem, rectData) {\r\n  const rectElem = elem.append('rect');\r\n  rectElem.attr('x', rectData.x);\r\n  rectElem.attr('y', rectData.y);\r\n  rectElem.attr('fill', rectData.fill);\r\n  rectElem.attr('stroke', rectData.stroke);\r\n  rectElem.attr('width', rectData.width);\r\n  rectElem.attr('height', rectData.height);\r\n  rectElem.attr('rx', rectData.rx);\r\n  rectElem.attr('ry', rectData.ry);\r\n\r\n  if (typeof rectData.class !== 'undefined') {\r\n    rectElem.attr('class', rectData.class);\r\n  }\r\n\r\n  return rectElem;\r\n};\r\n\r\n// const sanitizeUrl = function (s) {\r\n//   return s\r\n//     .replace(/&/g, '&amp;')\r\n//     .replace(/</g, '&lt;')\r\n//     .replace(/javascript:/g, '');\r\n// };\r\n\r\nconst addPopupInteraction = (id, actorCnt) => {\r\n  addFunction(() => {\r\n    const arr = document.querySelectorAll(id);\r\n    // This will be the case when running in sandboxed mode\r\n    if (arr.length === 0) return;\r\n    arr[0].addEventListener('mouseover', function () {\r\n      popupMenuUpFunc('actor' + actorCnt + '_popup');\r\n    });\r\n    arr[0].addEventListener('mouseout', function () {\r\n      popupMenuDownFunc('actor' + actorCnt + '_popup');\r\n    });\r\n  });\r\n};\r\nexport const drawPopup = function (elem, actor, minMenuWidth, textAttrs, forceMenus) {\r\n  if (actor.links === undefined || actor.links === null || Object.keys(actor.links).length === 0) {\r\n    return { height: 0, width: 0 };\r\n  }\r\n\r\n  const links = actor.links;\r\n  const actorCnt = actor.actorCnt;\r\n  const rectData = actor.rectData;\r\n\r\n  var displayValue = 'none';\r\n  if (forceMenus) {\r\n    displayValue = 'block !important';\r\n  }\r\n\r\n  const g = elem.append('g');\r\n  g.attr('id', 'actor' + actorCnt + '_popup');\r\n  g.attr('class', 'actorPopupMenu');\r\n  g.attr('display', displayValue);\r\n  addPopupInteraction('#actor' + actorCnt + '_popup', actorCnt);\r\n  var actorClass = '';\r\n  if (typeof rectData.class !== 'undefined') {\r\n    actorClass = ' ' + rectData.class;\r\n  }\r\n\r\n  let menuWidth = rectData.width > minMenuWidth ? rectData.width : minMenuWidth;\r\n\r\n  const rectElem = g.append('rect');\r\n  rectElem.attr('class', 'actorPopupMenuPanel' + actorClass);\r\n  rectElem.attr('x', rectData.x);\r\n  rectElem.attr('y', rectData.height);\r\n  rectElem.attr('fill', rectData.fill);\r\n  rectElem.attr('stroke', rectData.stroke);\r\n  rectElem.attr('width', menuWidth);\r\n  rectElem.attr('height', rectData.height);\r\n  rectElem.attr('rx', rectData.rx);\r\n  rectElem.attr('ry', rectData.ry);\r\n  if (links != null) {\r\n    var linkY = 20;\r\n    for (let key in links) {\r\n      var linkElem = g.append('a');\r\n      var sanitizedLink = sanitizeUrl(links[key]);\r\n      linkElem.attr('xlink:href', sanitizedLink);\r\n      linkElem.attr('target', '_blank');\r\n\r\n      _drawMenuItemTextCandidateFunc(textAttrs)(\r\n        key,\r\n        linkElem,\r\n        rectData.x + 10,\r\n        rectData.height + linkY,\r\n        menuWidth,\r\n        20,\r\n        { class: 'actor' },\r\n        textAttrs\r\n      );\r\n\r\n      linkY += 30;\r\n    }\r\n  }\r\n\r\n  rectElem.attr('height', linkY);\r\n\r\n  return { height: rectData.height + linkY, width: menuWidth };\r\n};\r\n\r\nexport const drawImage = function (elem, x, y, link) {\r\n  const imageElem = elem.append('image');\r\n  imageElem.attr('x', x);\r\n  imageElem.attr('y', y);\r\n  var sanitizedLink = sanitizeUrl(link);\r\n  imageElem.attr('xlink:href', sanitizedLink);\r\n};\r\n\r\nexport const drawEmbeddedImage = function (elem, x, y, link) {\r\n  const imageElem = elem.append('use');\r\n  imageElem.attr('x', x);\r\n  imageElem.attr('y', y);\r\n  var sanitizedLink = sanitizeUrl(link);\r\n  imageElem.attr('xlink:href', '#' + sanitizedLink);\r\n};\r\n\r\nexport const popupMenu = function (popid) {\r\n  return (\r\n    \"var pu = document.getElementById('\" +\r\n    popid +\r\n    \"'); if (pu != null) { pu.style.display = 'block'; }\"\r\n  );\r\n};\r\n\r\nexport const popdownMenu = function (popid) {\r\n  return (\r\n    \"var pu = document.getElementById('\" +\r\n    popid +\r\n    \"'); if (pu != null) { pu.style.display = 'none'; }\"\r\n  );\r\n};\r\n\r\nconst popupMenuUpFunc = function (popupId) {\r\n  var pu = document.getElementById(popupId);\r\n  if (pu != null) {\r\n    pu.style.display = 'block';\r\n  }\r\n};\r\n\r\nconst popupMenuDownFunc = function (popupId) {\r\n  var pu = document.getElementById(popupId);\r\n  if (pu != null) {\r\n    pu.style.display = 'none';\r\n  }\r\n};\r\nexport const drawText = function (elem, textData) {\r\n  let prevTextHeight = 0,\r\n    textHeight = 0;\r\n  const lines = textData.text.split(common.lineBreakRegex);\r\n\r\n  let textElems = [];\r\n  let dy = 0;\r\n  let yfunc = () => textData.y;\r\n  if (\r\n    typeof textData.valign !== 'undefined' &&\r\n    typeof textData.textMargin !== 'undefined' &&\r\n    textData.textMargin > 0\r\n  ) {\r\n    switch (textData.valign) {\r\n      case 'top':\r\n      case 'start':\r\n        yfunc = () => Math.round(textData.y + textData.textMargin);\r\n        break;\r\n      case 'middle':\r\n      case 'center':\r\n        yfunc = () =>\r\n          Math.round(textData.y + (prevTextHeight + textHeight + textData.textMargin) / 2);\r\n        break;\r\n      case 'bottom':\r\n      case 'end':\r\n        yfunc = () =>\r\n          Math.round(\r\n            textData.y +\r\n              (prevTextHeight + textHeight + 2 * textData.textMargin) -\r\n              textData.textMargin\r\n          );\r\n        break;\r\n    }\r\n  }\r\n  if (\r\n    typeof textData.anchor !== 'undefined' &&\r\n    typeof textData.textMargin !== 'undefined' &&\r\n    typeof textData.width !== 'undefined'\r\n  ) {\r\n    switch (textData.anchor) {\r\n      case 'left':\r\n      case 'start':\r\n        textData.x = Math.round(textData.x + textData.textMargin);\r\n        textData.anchor = 'start';\r\n        textData.dominantBaseline = 'text-after-edge';\r\n        textData.alignmentBaseline = 'middle';\r\n        break;\r\n      case 'middle':\r\n      case 'center':\r\n        textData.x = Math.round(textData.x + textData.width / 2);\r\n        textData.anchor = 'middle';\r\n        textData.dominantBaseline = 'middle';\r\n        textData.alignmentBaseline = 'middle';\r\n        break;\r\n      case 'right':\r\n      case 'end':\r\n        textData.x = Math.round(textData.x + textData.width - textData.textMargin);\r\n        textData.anchor = 'end';\r\n        textData.dominantBaseline = 'text-before-edge';\r\n        textData.alignmentBaseline = 'middle';\r\n        break;\r\n    }\r\n  }\r\n  for (let i = 0; i < lines.length; i++) {\r\n    let line = lines[i];\r\n    if (\r\n      typeof textData.textMargin !== 'undefined' &&\r\n      textData.textMargin === 0 &&\r\n      typeof textData.fontSize !== 'undefined'\r\n    ) {\r\n      dy = i * textData.fontSize;\r\n    }\r\n\r\n    const textElem = elem.append('text');\r\n    textElem.attr('x', textData.x);\r\n    textElem.attr('y', yfunc());\r\n    if (typeof textData.anchor !== 'undefined') {\r\n      textElem\r\n        .attr('text-anchor', textData.anchor)\r\n        .attr('dominant-baseline', textData.dominantBaseline)\r\n        .attr('alignment-baseline', textData.alignmentBaseline);\r\n    }\r\n    if (typeof textData.fontFamily !== 'undefined') {\r\n      textElem.style('font-family', textData.fontFamily);\r\n    }\r\n    if (typeof textData.fontSize !== 'undefined') {\r\n      textElem.style('font-size', textData.fontSize);\r\n    }\r\n    if (typeof textData.fontWeight !== 'undefined') {\r\n      textElem.style('font-weight', textData.fontWeight);\r\n    }\r\n    if (typeof textData.fill !== 'undefined') {\r\n      textElem.attr('fill', textData.fill);\r\n    }\r\n    if (typeof textData.class !== 'undefined') {\r\n      textElem.attr('class', textData.class);\r\n    }\r\n    if (typeof textData.dy !== 'undefined') {\r\n      textElem.attr('dy', textData.dy);\r\n    } else if (dy !== 0) {\r\n      textElem.attr('dy', dy);\r\n    }\r\n\r\n    if (textData.tspan) {\r\n      const span = textElem.append('tspan');\r\n      span.attr('x', textData.x);\r\n      if (typeof textData.fill !== 'undefined') {\r\n        span.attr('fill', textData.fill);\r\n      }\r\n      span.text(line);\r\n    } else {\r\n      textElem.text(line);\r\n    }\r\n    if (\r\n      typeof textData.valign !== 'undefined' &&\r\n      typeof textData.textMargin !== 'undefined' &&\r\n      textData.textMargin > 0\r\n    ) {\r\n      textHeight += (textElem._groups || textElem)[0][0].getBBox().height;\r\n      prevTextHeight = textHeight;\r\n    }\r\n\r\n    textElems.push(textElem);\r\n  }\r\n\r\n  return textElems;\r\n};\r\n\r\nexport const drawLabel = function (elem, txtObject) {\r\n  /**\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} cut\r\n   * @returns {any}\r\n   */\r\n  function genPoints(x, y, width, height, cut) {\r\n    return (\r\n      x +\r\n      ',' +\r\n      y +\r\n      ' ' +\r\n      (x + width) +\r\n      ',' +\r\n      y +\r\n      ' ' +\r\n      (x + width) +\r\n      ',' +\r\n      (y + height - cut) +\r\n      ' ' +\r\n      (x + width - cut * 1.2) +\r\n      ',' +\r\n      (y + height) +\r\n      ' ' +\r\n      x +\r\n      ',' +\r\n      (y + height)\r\n    );\r\n  }\r\n  const polygon = elem.append('polygon');\r\n  polygon.attr('points', genPoints(txtObject.x, txtObject.y, txtObject.width, txtObject.height, 7));\r\n  polygon.attr('class', 'labelBox');\r\n\r\n  txtObject.y = txtObject.y + txtObject.height / 2;\r\n\r\n  drawText(elem, txtObject);\r\n  return polygon;\r\n};\r\n\r\nlet actorCnt = -1;\r\n\r\nexport const fixLifeLineHeights = (diagram, bounds) => {\r\n  if (!diagram.selectAll) return;\r\n  diagram\r\n    .selectAll('.actor-line')\r\n    .attr('class', '200')\r\n    .attr('y2', bounds - 55);\r\n};\r\n\r\n/**\r\n * Draws an actor in the diagram with the attached line\r\n *\r\n * @param {any} elem - The diagram we'll draw to.\r\n * @param {any} actor - The actor to draw.\r\n * @param {any} conf - DrawText implementation discriminator object\r\n */\r\nconst drawActorTypeParticipant = function (elem, actor, conf) {\r\n  const center = actor.x + actor.width / 2;\r\n\r\n  const boxpluslineGroup = elem.append('g');\r\n  var g = boxpluslineGroup;\r\n\r\n  if (actor.y === 0) {\r\n    actorCnt++;\r\n    g.append('line')\r\n      .attr('id', 'actor' + actorCnt)\r\n      .attr('x1', center)\r\n      .attr('y1', 5)\r\n      .attr('x2', center)\r\n      .attr('y2', 2000)\r\n      .attr('class', 'actor-line')\r\n      .attr('stroke-width', '0.5px')\r\n      .attr('stroke', '#999');\r\n\r\n    g = boxpluslineGroup.append('g');\r\n    actor.actorCnt = actorCnt;\r\n\r\n    if (actor.links != null) {\r\n      g.attr('id', 'root-' + actorCnt);\r\n      addPopupInteraction('#root-' + actorCnt, actorCnt);\r\n    }\r\n  }\r\n\r\n  const rect = getNoteRect();\r\n  var cssclass = 'actor';\r\n  if (actor.properties != null && actor.properties['class']) {\r\n    cssclass = actor.properties['class'];\r\n  } else {\r\n    rect.fill = '#eaeaea';\r\n  }\r\n  rect.x = actor.x;\r\n  rect.y = actor.y;\r\n  rect.width = actor.width;\r\n  rect.height = actor.height;\r\n  rect.class = cssclass;\r\n  rect.rx = 3;\r\n  rect.ry = 3;\r\n  const rectElem = drawRect(g, rect);\r\n  actor.rectData = rect;\r\n\r\n  if (actor.properties != null && actor.properties['icon']) {\r\n    const iconSrc = actor.properties['icon'].trim();\r\n    if (iconSrc.charAt(0) === '@') {\r\n      drawEmbeddedImage(g, rect.x + rect.width - 20, rect.y + 10, iconSrc.substr(1));\r\n    } else {\r\n      drawImage(g, rect.x + rect.width - 20, rect.y + 10, iconSrc);\r\n    }\r\n  }\r\n\r\n  _drawTextCandidateFunc(conf)(\r\n    actor.description,\r\n    g,\r\n    rect.x,\r\n    rect.y,\r\n    rect.width,\r\n    rect.height,\r\n    { class: 'actor' },\r\n    conf\r\n  );\r\n\r\n  let height = actor.height;\r\n  if (rectElem.node) {\r\n    const bounds = rectElem.node().getBBox();\r\n    actor.height = bounds.height;\r\n    height = bounds.height;\r\n  }\r\n\r\n  return height;\r\n};\r\n\r\nconst drawActorTypeActor = function (elem, actor, conf) {\r\n  const center = actor.x + actor.width / 2;\r\n\r\n  if (actor.y === 0) {\r\n    actorCnt++;\r\n    elem\r\n      .append('line')\r\n      .attr('id', 'actor' + actorCnt)\r\n      .attr('x1', center)\r\n      .attr('y1', 80)\r\n      .attr('x2', center)\r\n      .attr('y2', 2000)\r\n      .attr('class', 'actor-line')\r\n      .attr('stroke-width', '0.5px')\r\n      .attr('stroke', '#999');\r\n  }\r\n  const actElem = elem.append('g');\r\n  actElem.attr('class', 'actor-man');\r\n\r\n  const rect = getNoteRect();\r\n  rect.x = actor.x;\r\n  rect.y = actor.y;\r\n  rect.fill = '#eaeaea';\r\n  rect.width = actor.width;\r\n  rect.height = actor.height;\r\n  rect.class = 'actor';\r\n  rect.rx = 3;\r\n  rect.ry = 3;\r\n  // drawRect(actElem, rect);\r\n\r\n  actElem\r\n    .append('line')\r\n    .attr('id', 'actor-man-torso' + actorCnt)\r\n    .attr('x1', center)\r\n    .attr('y1', actor.y + 25)\r\n    .attr('x2', center)\r\n    .attr('y2', actor.y + 45);\r\n\r\n  actElem\r\n    .append('line')\r\n    .attr('id', 'actor-man-arms' + actorCnt)\r\n    .attr('x1', center - 18)\r\n    .attr('y1', actor.y + 33)\r\n    .attr('x2', center + 18)\r\n    .attr('y2', actor.y + 33);\r\n  actElem\r\n    .append('line')\r\n    .attr('x1', center - 18)\r\n    .attr('y1', actor.y + 60)\r\n    .attr('x2', center)\r\n    .attr('y2', actor.y + 45);\r\n  actElem\r\n    .append('line')\r\n    .attr('x1', center)\r\n    .attr('y1', actor.y + 45)\r\n    .attr('x2', center + 16)\r\n    .attr('y2', actor.y + 60);\r\n\r\n  const circle = actElem.append('circle');\r\n  circle.attr('cx', actor.x + actor.width / 2);\r\n  circle.attr('cy', actor.y + 10);\r\n  circle.attr('r', 15);\r\n  circle.attr('width', actor.width);\r\n  circle.attr('height', actor.height);\r\n\r\n  const bounds = actElem.node().getBBox();\r\n  actor.height = bounds.height;\r\n\r\n  _drawTextCandidateFunc(conf)(\r\n    actor.description,\r\n    actElem,\r\n    rect.x,\r\n    rect.y + 35,\r\n    rect.width,\r\n    rect.height,\r\n    { class: 'actor' },\r\n    conf\r\n  );\r\n\r\n  return actor.height;\r\n};\r\n\r\nexport const drawActor = function (elem, actor, conf) {\r\n  switch (actor.type) {\r\n    case 'actor':\r\n      return drawActorTypeActor(elem, actor, conf);\r\n    case 'participant':\r\n      return drawActorTypeParticipant(elem, actor, conf);\r\n  }\r\n};\r\n\r\nexport const anchorElement = function (elem) {\r\n  return elem.append('g');\r\n};\r\n/**\r\n * Draws an activation in the diagram\r\n *\r\n * @param {any} elem - Element to append activation rect.\r\n * @param {any} bounds - Activation box bounds.\r\n * @param {any} verticalPos - Precise y cooridnate of bottom activation box edge.\r\n * @param {any} conf - Sequence diagram config object.\r\n * @param {any} actorActivations - Number of activations on the actor.\r\n */\r\nexport const drawActivation = function (elem, bounds, verticalPos, conf, actorActivations) {\r\n  const rect = getNoteRect();\r\n  const g = bounds.anchored;\r\n  rect.x = bounds.startx;\r\n  rect.y = bounds.starty;\r\n  rect.class = 'activation' + (actorActivations % 3); // Will evaluate to 0, 1 or 2\r\n  rect.width = bounds.stopx - bounds.startx;\r\n  rect.height = verticalPos - bounds.starty;\r\n  drawRect(g, rect);\r\n};\r\n\r\n/**\r\n * Draws a loop in the diagram\r\n *\r\n * @param {any} elem - Elemenet to append the loop to.\r\n * @param {any} loopModel - LoopModel of the given loop.\r\n * @param {any} labelText - Text within the loop.\r\n * @param {any} conf - Diagrom configuration\r\n * @returns {any}\r\n */\r\nexport const drawLoop = function (elem, loopModel, labelText, conf) {\r\n  const {\r\n    boxMargin,\r\n    boxTextMargin,\r\n    labelBoxHeight,\r\n    labelBoxWidth,\r\n    messageFontFamily: fontFamily,\r\n    messageFontSize: fontSize,\r\n    messageFontWeight: fontWeight,\r\n  } = conf;\r\n  const g = elem.append('g');\r\n  const drawLoopLine = function (startx, starty, stopx, stopy) {\r\n    return g\r\n      .append('line')\r\n      .attr('x1', startx)\r\n      .attr('y1', starty)\r\n      .attr('x2', stopx)\r\n      .attr('y2', stopy)\r\n      .attr('class', 'loopLine');\r\n  };\r\n  drawLoopLine(loopModel.startx, loopModel.starty, loopModel.stopx, loopModel.starty);\r\n  drawLoopLine(loopModel.stopx, loopModel.starty, loopModel.stopx, loopModel.stopy);\r\n  drawLoopLine(loopModel.startx, loopModel.stopy, loopModel.stopx, loopModel.stopy);\r\n  drawLoopLine(loopModel.startx, loopModel.starty, loopModel.startx, loopModel.stopy);\r\n  if (typeof loopModel.sections !== 'undefined') {\r\n    loopModel.sections.forEach(function (item) {\r\n      drawLoopLine(loopModel.startx, item.y, loopModel.stopx, item.y).style(\r\n        'stroke-dasharray',\r\n        '3, 3'\r\n      );\r\n    });\r\n  }\r\n\r\n  let txt = getTextObj();\r\n  txt.text = labelText;\r\n  txt.x = loopModel.startx;\r\n  txt.y = loopModel.starty;\r\n  txt.fontFamily = fontFamily;\r\n  txt.fontSize = fontSize;\r\n  txt.fontWeight = fontWeight;\r\n  txt.anchor = 'middle';\r\n  txt.valign = 'middle';\r\n  txt.tspan = false;\r\n  txt.width = labelBoxWidth || 50;\r\n  txt.height = labelBoxHeight || 20;\r\n  txt.textMargin = boxTextMargin;\r\n  txt.class = 'labelText';\r\n\r\n  drawLabel(g, txt);\r\n  txt = getTextObj();\r\n  txt.text = loopModel.title;\r\n  txt.x = loopModel.startx + labelBoxWidth / 2 + (loopModel.stopx - loopModel.startx) / 2;\r\n  txt.y = loopModel.starty + boxMargin + boxTextMargin;\r\n  txt.anchor = 'middle';\r\n  txt.valign = 'middle';\r\n  txt.textMargin = boxTextMargin;\r\n  txt.class = 'loopText';\r\n  txt.fontFamily = fontFamily;\r\n  txt.fontSize = fontSize;\r\n  txt.fontWeight = fontWeight;\r\n  txt.wrap = true;\r\n\r\n  let textElem = drawText(g, txt);\r\n\r\n  if (typeof loopModel.sectionTitles !== 'undefined') {\r\n    loopModel.sectionTitles.forEach(function (item, idx) {\r\n      if (item.message) {\r\n        txt.text = item.message;\r\n        txt.x = loopModel.startx + (loopModel.stopx - loopModel.startx) / 2;\r\n        txt.y = loopModel.sections[idx].y + boxMargin + boxTextMargin;\r\n        txt.class = 'loopText';\r\n        txt.anchor = 'middle';\r\n        txt.valign = 'middle';\r\n        txt.tspan = false;\r\n        txt.fontFamily = fontFamily;\r\n        txt.fontSize = fontSize;\r\n        txt.fontWeight = fontWeight;\r\n        txt.wrap = loopModel.wrap;\r\n        textElem = drawText(g, txt);\r\n        let sectionHeight = Math.round(\r\n          textElem\r\n            .map((te) => (te._groups || te)[0][0].getBBox().height)\r\n            .reduce((acc, curr) => acc + curr)\r\n        );\r\n        loopModel.sections[idx].height += sectionHeight - (boxMargin + boxTextMargin);\r\n      }\r\n    });\r\n  }\r\n\r\n  loopModel.height = Math.round(loopModel.stopy - loopModel.starty);\r\n  return g;\r\n};\r\n\r\n/**\r\n * Draws a background rectangle\r\n *\r\n * @param {any} elem Diagram (reference for bounds)\r\n * @param {any} bounds Shape of the rectangle\r\n */\r\nexport const drawBackgroundRect = function (elem, bounds) {\r\n  const rectElem = drawRect(elem, {\r\n    x: bounds.startx,\r\n    y: bounds.starty,\r\n    width: bounds.stopx - bounds.startx,\r\n    height: bounds.stopy - bounds.starty,\r\n    fill: bounds.fill,\r\n    class: 'rect',\r\n  });\r\n  rectElem.lower();\r\n};\r\n\r\nexport const insertDatabaseIcon = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('symbol')\r\n    .attr('id', 'database')\r\n    .attr('fill-rule', 'evenodd')\r\n    .attr('clip-rule', 'evenodd')\r\n    .append('path')\r\n    .attr('transform', 'scale(.5)')\r\n    .attr(\r\n      'd',\r\n      'M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z'\r\n    );\r\n};\r\n\r\nexport const insertComputerIcon = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('symbol')\r\n    .attr('id', 'computer')\r\n    .attr('width', '24')\r\n    .attr('height', '24')\r\n    .append('path')\r\n    .attr('transform', 'scale(.5)')\r\n    .attr(\r\n      'd',\r\n      'M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z'\r\n    );\r\n};\r\n\r\nexport const insertClockIcon = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('symbol')\r\n    .attr('id', 'clock')\r\n    .attr('width', '24')\r\n    .attr('height', '24')\r\n    .append('path')\r\n    .attr('transform', 'scale(.5)')\r\n    .attr(\r\n      'd',\r\n      'M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z'\r\n    );\r\n};\r\n\r\n/**\r\n * Setup arrow head and define the marker. The result is appended to the svg.\r\n *\r\n * @param elem\r\n */\r\nexport const insertArrowHead = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'arrowhead')\r\n    .attr('refX', 9)\r\n    .attr('refY', 5)\r\n    .attr('markerUnits', 'userSpaceOnUse')\r\n    .attr('markerWidth', 12)\r\n    .attr('markerHeight', 12)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 0 0 L 10 5 L 0 10 z'); // this is actual shape for arrowhead\r\n};\r\n/**\r\n * Setup arrow head and define the marker. The result is appended to the svg.\r\n *\r\n * @param {any} elem\r\n */\r\nexport const insertArrowFilledHead = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'filled-head')\r\n    .attr('refX', 18)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 18,7 L9,13 L14,7 L9,1 Z');\r\n};\r\n/**\r\n * Setup node number. The result is appended to the svg.\r\n *\r\n * @param {any} elem\r\n */\r\nexport const insertSequenceNumber = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'sequencenumber')\r\n    .attr('refX', 15)\r\n    .attr('refY', 15)\r\n    .attr('markerWidth', 60)\r\n    .attr('markerHeight', 40)\r\n    .attr('orient', 'auto')\r\n    .append('circle')\r\n    .attr('cx', 15)\r\n    .attr('cy', 15)\r\n    .attr('r', 6);\r\n  // .style(\"fill\", '#f00');\r\n};\r\n/**\r\n * Setup arrow head and define the marker. The result is appended to the svg.\r\n *\r\n * @param {any} elem\r\n */\r\nexport const insertArrowCrossHead = function (elem) {\r\n  const defs = elem.append('defs');\r\n  const marker = defs\r\n    .append('marker')\r\n    .attr('id', 'crosshead')\r\n    .attr('markerWidth', 15)\r\n    .attr('markerHeight', 8)\r\n    .attr('orient', 'auto')\r\n    .attr('refX', 16)\r\n    .attr('refY', 4);\r\n\r\n  // The arrow\r\n  marker\r\n    .append('path')\r\n    .attr('fill', 'black')\r\n    .attr('stroke', '#000000')\r\n    .style('stroke-dasharray', '0, 0')\r\n    .attr('stroke-width', '1px')\r\n    .attr('d', 'M 9,2 V 6 L16,4 Z');\r\n\r\n  // The cross\r\n  marker\r\n    .append('path')\r\n    .attr('fill', 'none')\r\n    .attr('stroke', '#000000')\r\n    .style('stroke-dasharray', '0, 0')\r\n    .attr('stroke-width', '1px')\r\n    .attr('d', 'M 0,1 L 6,7 M 6,1 L 0,7');\r\n  // this is actual shape for arrowhead\r\n};\r\n\r\nexport const getTextObj = function () {\r\n  return {\r\n    x: 0,\r\n    y: 0,\r\n    fill: undefined,\r\n    anchor: undefined,\r\n    style: '#666',\r\n    width: undefined,\r\n    height: undefined,\r\n    textMargin: 0,\r\n    rx: 0,\r\n    ry: 0,\r\n    tspan: true,\r\n    valign: undefined,\r\n  };\r\n};\r\n\r\nexport const getNoteRect = function () {\r\n  return {\r\n    x: 0,\r\n    y: 0,\r\n    fill: '#EDF2AE',\r\n    stroke: '#666',\r\n    width: 100,\r\n    anchor: 'start',\r\n    height: 100,\r\n    rx: 0,\r\n    ry: 0,\r\n  };\r\n};\r\n\r\nconst _drawTextCandidateFunc = (function () {\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   */\r\n  function byText(content, g, x, y, width, height, textAttrs) {\r\n    const text = g\r\n      .append('text')\r\n      .attr('x', x + width / 2)\r\n      .attr('y', y + height / 2 + 5)\r\n      .style('text-anchor', 'middle')\r\n      .text(content);\r\n    _setTextAttrs(text, textAttrs);\r\n  }\r\n\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} conf\r\n   */\r\n  function byTspan(content, g, x, y, width, height, textAttrs, conf) {\r\n    const { actorFontSize, actorFontFamily, actorFontWeight } = conf;\r\n\r\n    const lines = content.split(common.lineBreakRegex);\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const dy = i * actorFontSize - (actorFontSize * (lines.length - 1)) / 2;\r\n      const text = g\r\n        .append('text')\r\n        .attr('x', x + width / 2)\r\n        .attr('y', y)\r\n        .style('text-anchor', 'middle')\r\n        .style('font-size', actorFontSize)\r\n        .style('font-weight', actorFontWeight)\r\n        .style('font-family', actorFontFamily);\r\n      text\r\n        .append('tspan')\r\n        .attr('x', x + width / 2)\r\n        .attr('dy', dy)\r\n        .text(lines[i]);\r\n\r\n      text\r\n        .attr('y', y + height / 2.0)\r\n        .attr('dominant-baseline', 'central')\r\n        .attr('alignment-baseline', 'central');\r\n\r\n      _setTextAttrs(text, textAttrs);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} conf\r\n   */\r\n  function byFo(content, g, x, y, width, height, textAttrs, conf) {\r\n    const s = g.append('switch');\r\n    const f = s\r\n      .append('foreignObject')\r\n      .attr('x', x)\r\n      .attr('y', y)\r\n      .attr('width', width)\r\n      .attr('height', height);\r\n\r\n    const text = f\r\n      .append('xhtml:div')\r\n      .style('display', 'table')\r\n      .style('height', '100%')\r\n      .style('width', '100%');\r\n\r\n    text\r\n      .append('div')\r\n      .style('display', 'table-cell')\r\n      .style('text-align', 'center')\r\n      .style('vertical-align', 'middle')\r\n      .text(content);\r\n\r\n    byTspan(content, s, x, y, width, height, textAttrs, conf);\r\n    _setTextAttrs(text, textAttrs);\r\n  }\r\n\r\n  /**\r\n   * @param {any} toText\r\n   * @param {any} fromTextAttrsDict\r\n   */\r\n  function _setTextAttrs(toText, fromTextAttrsDict) {\r\n    for (const key in fromTextAttrsDict) {\r\n      if (fromTextAttrsDict.hasOwnProperty(key)) { // eslint-disable-line\r\n        toText.attr(key, fromTextAttrsDict[key]);\r\n      }\r\n    }\r\n  }\r\n\r\n  return function (conf) {\r\n    return conf.textPlacement === 'fo' ? byFo : conf.textPlacement === 'old' ? byText : byTspan;\r\n  };\r\n})();\r\n\r\nconst _drawMenuItemTextCandidateFunc = (function () {\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   */\r\n  function byText(content, g, x, y, width, height, textAttrs) {\r\n    const text = g\r\n      .append('text')\r\n      .attr('x', x)\r\n      .attr('y', y)\r\n      .style('text-anchor', 'start')\r\n      .text(content);\r\n    _setTextAttrs(text, textAttrs);\r\n  }\r\n\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} conf\r\n   */\r\n  function byTspan(content, g, x, y, width, height, textAttrs, conf) {\r\n    const { actorFontSize, actorFontFamily, actorFontWeight } = conf;\r\n\r\n    const lines = content.split(common.lineBreakRegex);\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const dy = i * actorFontSize - (actorFontSize * (lines.length - 1)) / 2;\r\n      const text = g\r\n        .append('text')\r\n        .attr('x', x)\r\n        .attr('y', y)\r\n        .style('text-anchor', 'start')\r\n        .style('font-size', actorFontSize)\r\n        .style('font-weight', actorFontWeight)\r\n        .style('font-family', actorFontFamily);\r\n      text.append('tspan').attr('x', x).attr('dy', dy).text(lines[i]);\r\n\r\n      text\r\n        .attr('y', y + height / 2.0)\r\n        .attr('dominant-baseline', 'central')\r\n        .attr('alignment-baseline', 'central');\r\n\r\n      _setTextAttrs(text, textAttrs);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} conf\r\n   */\r\n  function byFo(content, g, x, y, width, height, textAttrs, conf) {\r\n    const s = g.append('switch');\r\n    const f = s\r\n      .append('foreignObject')\r\n      .attr('x', x)\r\n      .attr('y', y)\r\n      .attr('width', width)\r\n      .attr('height', height);\r\n\r\n    const text = f\r\n      .append('xhtml:div')\r\n      .style('display', 'table')\r\n      .style('height', '100%')\r\n      .style('width', '100%');\r\n\r\n    text\r\n      .append('div')\r\n      .style('display', 'table-cell')\r\n      .style('text-align', 'center')\r\n      .style('vertical-align', 'middle')\r\n      .text(content);\r\n\r\n    byTspan(content, s, x, y, width, height, textAttrs, conf);\r\n    _setTextAttrs(text, textAttrs);\r\n  }\r\n\r\n  /**\r\n   * @param {any} toText\r\n   * @param {any} fromTextAttrsDict\r\n   */\r\n  function _setTextAttrs(toText, fromTextAttrsDict) {\r\n    for (const key in fromTextAttrsDict) {\r\n      if (fromTextAttrsDict.hasOwnProperty(key)) { // eslint-disable-line\r\n        toText.attr(key, fromTextAttrsDict[key]);\r\n      }\r\n    }\r\n  }\r\n\r\n  return function (conf) {\r\n    return conf.textPlacement === 'fo' ? byFo : conf.textPlacement === 'old' ? byText : byTspan;\r\n  };\r\n})();\r\n\r\nexport default {\r\n  drawRect,\r\n  drawText,\r\n  drawLabel,\r\n  drawActor,\r\n  drawPopup,\r\n  drawImage,\r\n  drawEmbeddedImage,\r\n  anchorElement,\r\n  drawActivation,\r\n  drawLoop,\r\n  drawBackgroundRect,\r\n  insertArrowHead,\r\n  insertArrowFilledHead,\r\n  insertSequenceNumber,\r\n  insertArrowCrossHead,\r\n  insertDatabaseIcon,\r\n  insertComputerIcon,\r\n  insertClockIcon,\r\n  getTextObj,\r\n  getNoteRect,\r\n  popupMenu,\r\n  popdownMenu,\r\n  fixLifeLineHeights,\r\n  sanitizeUrl,\r\n};\r\n","const idCache = {};\r\n\r\nexport const set = (key, val) => {\r\n  idCache[key] = val;\r\n};\r\n\r\nexport const get = (k) => idCache[k];\r\nexport const keys = () => Object.keys(idCache);\r\nexport const size = () => keys().length;\r\n\r\nexport default {\r\n  get,\r\n  set,\r\n  keys,\r\n  size,\r\n};\r\n","import { line, curveBasis } from 'd3';\r\nimport idCache from './id-cache.js';\r\nimport stateDb from './stateDb';\r\nimport utils from '../../utils';\r\nimport common from '../common/common';\r\nimport { getConfig } from '../../config';\r\nimport { log } from '../../logger';\r\n\r\n/**\r\n * Draws a start state as a black circle\r\n *\r\n * @param {any} g\r\n */\r\nexport const drawStartState = (g) =>\r\n  g\r\n    .append('circle')\r\n    // .style('stroke', 'black')\r\n    // .style('fill', 'black')\r\n    .attr('class', 'start-state')\r\n    .attr('r', getConfig().state.sizeUnit)\r\n    .attr('cx', getConfig().state.padding + getConfig().state.sizeUnit)\r\n    .attr('cy', getConfig().state.padding + getConfig().state.sizeUnit);\r\n\r\n/**\r\n * Draws a start state as a black circle\r\n *\r\n * @param {any} g\r\n */\r\nexport const drawDivider = (g) =>\r\n  g\r\n    .append('line')\r\n    .style('stroke', 'grey')\r\n    .style('stroke-dasharray', '3')\r\n    .attr('x1', getConfig().state.textHeight)\r\n    .attr('class', 'divider')\r\n    .attr('x2', getConfig().state.textHeight * 2)\r\n    .attr('y1', 0)\r\n    .attr('y2', 0);\r\n\r\n/**\r\n * Draws a an end state as a black circle\r\n *\r\n * @param {any} g\r\n * @param {any} stateDef\r\n */\r\nexport const drawSimpleState = (g, stateDef) => {\r\n  const state = g\r\n    .append('text')\r\n    .attr('x', 2 * getConfig().state.padding)\r\n    .attr('y', getConfig().state.textHeight + 2 * getConfig().state.padding)\r\n    .attr('font-size', getConfig().state.fontSize)\r\n    .attr('class', 'state-title')\r\n    .text(stateDef.id);\r\n\r\n  const classBox = state.node().getBBox();\r\n  g.insert('rect', ':first-child')\r\n    .attr('x', getConfig().state.padding)\r\n    .attr('y', getConfig().state.padding)\r\n    .attr('width', classBox.width + 2 * getConfig().state.padding)\r\n    .attr('height', classBox.height + 2 * getConfig().state.padding)\r\n    .attr('rx', getConfig().state.radius);\r\n\r\n  return state;\r\n};\r\n\r\n/**\r\n * Draws a state with descriptions\r\n *\r\n * @param {any} g\r\n * @param {any} stateDef\r\n * @returns\r\n */\r\nexport const drawDescrState = (g, stateDef) => {\r\n  const addTspan = function (textEl, txt, isFirst) {\r\n    const tSpan = textEl\r\n      .append('tspan')\r\n      .attr('x', 2 * getConfig().state.padding)\r\n      .text(txt);\r\n    if (!isFirst) {\r\n      tSpan.attr('dy', getConfig().state.textHeight);\r\n    }\r\n  };\r\n  const title = g\r\n    .append('text')\r\n    .attr('x', 2 * getConfig().state.padding)\r\n    .attr('y', getConfig().state.textHeight + 1.3 * getConfig().state.padding)\r\n    .attr('font-size', getConfig().state.fontSize)\r\n    .attr('class', 'state-title')\r\n    .text(stateDef.descriptions[0]);\r\n\r\n  const titleBox = title.node().getBBox();\r\n  const titleHeight = titleBox.height;\r\n\r\n  const description = g\r\n    .append('text') // text label for the x axis\r\n    .attr('x', getConfig().state.padding)\r\n    .attr(\r\n      'y',\r\n      titleHeight +\r\n        getConfig().state.padding * 0.4 +\r\n        getConfig().state.dividerMargin +\r\n        getConfig().state.textHeight\r\n    )\r\n    .attr('class', 'state-description');\r\n\r\n  let isFirst = true;\r\n  let isSecond = true;\r\n  stateDef.descriptions.forEach(function (descr) {\r\n    if (!isFirst) {\r\n      addTspan(description, descr, isSecond);\r\n      isSecond = false;\r\n    }\r\n    isFirst = false;\r\n  });\r\n\r\n  const descrLine = g\r\n    .append('line') // text label for the x axis\r\n    .attr('x1', getConfig().state.padding)\r\n    .attr('y1', getConfig().state.padding + titleHeight + getConfig().state.dividerMargin / 2)\r\n    .attr('y2', getConfig().state.padding + titleHeight + getConfig().state.dividerMargin / 2)\r\n    .attr('class', 'descr-divider');\r\n  const descrBox = description.node().getBBox();\r\n  const width = Math.max(descrBox.width, titleBox.width);\r\n\r\n  descrLine.attr('x2', width + 3 * getConfig().state.padding);\r\n  // const classBox = title.node().getBBox();\r\n\r\n  g.insert('rect', ':first-child')\r\n    .attr('x', getConfig().state.padding)\r\n    .attr('y', getConfig().state.padding)\r\n    .attr('width', width + 2 * getConfig().state.padding)\r\n    .attr('height', descrBox.height + titleHeight + 2 * getConfig().state.padding)\r\n    .attr('rx', getConfig().state.radius);\r\n\r\n  return g;\r\n};\r\n\r\n/** Adds the creates a box around the existing content and adds a panel for the id on top of the content. */\r\n/**\r\n * Function that creates an title row and a frame around a substate for a composit state diagram.\r\n * The function returns a new d3 svg object with updated width and height properties;\r\n *\r\n * @param {any} g The d3 svg object for the substate to framed\r\n * @param {any} stateDef The info about the\r\n * @param {any} altBkg\r\n */\r\nexport const addTitleAndBox = (g, stateDef, altBkg) => {\r\n  const pad = getConfig().state.padding;\r\n  const dblPad = 2 * getConfig().state.padding;\r\n  const orgBox = g.node().getBBox();\r\n  const orgWidth = orgBox.width;\r\n  const orgX = orgBox.x;\r\n\r\n  const title = g\r\n    .append('text')\r\n    .attr('x', 0)\r\n    .attr('y', getConfig().state.titleShift)\r\n    .attr('font-size', getConfig().state.fontSize)\r\n    .attr('class', 'state-title')\r\n    .text(stateDef.id);\r\n\r\n  const titleBox = title.node().getBBox();\r\n  const titleWidth = titleBox.width + dblPad;\r\n  let width = Math.max(titleWidth, orgWidth); // + dblPad;\r\n  if (width === orgWidth) {\r\n    width = width + dblPad;\r\n  }\r\n  let startX;\r\n  // const lineY = 1 - getConfig().state.textHeight;\r\n  // const descrLine = g\r\n  //   .append('line') // text label for the x axis\r\n  //   .attr('x1', 0)\r\n  //   .attr('y1', lineY)\r\n  //   .attr('y2', lineY)\r\n  //   .attr('class', 'descr-divider');\r\n\r\n  const graphBox = g.node().getBBox();\r\n  // descrLine.attr('x2', graphBox.width + getConfig().state.padding);\r\n\r\n  if (stateDef.doc) {\r\n    // cnsole.warn(\r\n    //   stateDef.id,\r\n    //   'orgX: ',\r\n    //   orgX,\r\n    //   'width: ',\r\n    //   width,\r\n    //   'titleWidth: ',\r\n    //   titleWidth,\r\n    //   'orgWidth: ',\r\n    //   orgWidth,\r\n    //   'width',\r\n    //   width\r\n    // );\r\n  }\r\n\r\n  startX = orgX - pad;\r\n  if (titleWidth > orgWidth) {\r\n    startX = (orgWidth - width) / 2 + pad;\r\n  }\r\n  if (Math.abs(orgX - graphBox.x) < pad) {\r\n    if (titleWidth > orgWidth) {\r\n      startX = orgX - (titleWidth - orgWidth) / 2;\r\n    }\r\n  }\r\n\r\n  const lineY = 1 - getConfig().state.textHeight;\r\n  // White color\r\n  g.insert('rect', ':first-child')\r\n    .attr('x', startX)\r\n    .attr('y', lineY)\r\n    .attr('class', altBkg ? 'alt-composit' : 'composit')\r\n    .attr('width', width)\r\n    .attr(\r\n      'height',\r\n      graphBox.height + getConfig().state.textHeight + getConfig().state.titleShift + 1\r\n    )\r\n    .attr('rx', '0');\r\n\r\n  title.attr('x', startX + pad);\r\n  if (titleWidth <= orgWidth) title.attr('x', orgX + (width - dblPad) / 2 - titleWidth / 2 + pad);\r\n\r\n  // Title background\r\n  g.insert('rect', ':first-child')\r\n    .attr('x', startX)\r\n    .attr(\r\n      'y',\r\n      getConfig().state.titleShift - getConfig().state.textHeight - getConfig().state.padding\r\n    )\r\n    .attr('width', width)\r\n    // Just needs to be higher then the descr line, will be clipped by the white color box\r\n    .attr('height', getConfig().state.textHeight * 3)\r\n    .attr('rx', getConfig().state.radius);\r\n\r\n  // Full background\r\n  g.insert('rect', ':first-child')\r\n    .attr('x', startX)\r\n    .attr(\r\n      'y',\r\n      getConfig().state.titleShift - getConfig().state.textHeight - getConfig().state.padding\r\n    )\r\n    .attr('width', width)\r\n    .attr('height', graphBox.height + 3 + 2 * getConfig().state.textHeight)\r\n    .attr('rx', getConfig().state.radius);\r\n\r\n  return g;\r\n};\r\n\r\nconst drawEndState = (g) => {\r\n  g.append('circle')\r\n    // .style('stroke', 'black')\r\n    // .style('fill', 'white')\r\n    .attr('class', 'end-state-outer')\r\n    .attr('r', getConfig().state.sizeUnit + getConfig().state.miniPadding)\r\n    .attr(\r\n      'cx',\r\n      getConfig().state.padding + getConfig().state.sizeUnit + getConfig().state.miniPadding\r\n    )\r\n    .attr(\r\n      'cy',\r\n      getConfig().state.padding + getConfig().state.sizeUnit + getConfig().state.miniPadding\r\n    );\r\n\r\n  return (\r\n    g\r\n      .append('circle')\r\n      // .style('stroke', 'black')\r\n      // .style('fill', 'black')\r\n      .attr('class', 'end-state-inner')\r\n      .attr('r', getConfig().state.sizeUnit)\r\n      .attr('cx', getConfig().state.padding + getConfig().state.sizeUnit + 2)\r\n      .attr('cy', getConfig().state.padding + getConfig().state.sizeUnit + 2)\r\n  );\r\n};\r\nconst drawForkJoinState = (g, stateDef) => {\r\n  let width = getConfig().state.forkWidth;\r\n  let height = getConfig().state.forkHeight;\r\n\r\n  if (stateDef.parentId) {\r\n    let tmp = width;\r\n    width = height;\r\n    height = tmp;\r\n  }\r\n  return g\r\n    .append('rect')\r\n    .style('stroke', 'black')\r\n    .style('fill', 'black')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .attr('x', getConfig().state.padding)\r\n    .attr('y', getConfig().state.padding);\r\n};\r\n\r\nexport const drawText = function (elem, textData) {\r\n  // Remove and ignore br:s\r\n  const nText = textData.text.replace(common.lineBreakRegex, ' ');\r\n\r\n  const textElem = elem.append('text');\r\n  textElem.attr('x', textData.x);\r\n  textElem.attr('y', textData.y);\r\n  textElem.style('text-anchor', textData.anchor);\r\n  textElem.attr('fill', textData.fill);\r\n  if (typeof textData.class !== 'undefined') {\r\n    textElem.attr('class', textData.class);\r\n  }\r\n\r\n  const span = textElem.append('tspan');\r\n  span.attr('x', textData.x + textData.textMargin * 2);\r\n  span.attr('fill', textData.fill);\r\n  span.text(nText);\r\n\r\n  return textElem;\r\n};\r\n\r\nconst _drawLongText = (_text, x, y, g) => {\r\n  let textHeight = 0;\r\n\r\n  const textElem = g.append('text');\r\n  textElem.style('text-anchor', 'start');\r\n  textElem.attr('class', 'noteText');\r\n\r\n  let text = _text.replace(/\\r\\n/g, '<br/>');\r\n  text = text.replace(/\\n/g, '<br/>');\r\n  const lines = text.split(common.lineBreakRegex);\r\n\r\n  let tHeight = 1.25 * getConfig().state.noteMargin;\r\n  for (const line of lines) {\r\n    const txt = line.trim();\r\n\r\n    if (txt.length > 0) {\r\n      const span = textElem.append('tspan');\r\n      span.text(txt);\r\n      if (tHeight === 0) {\r\n        const textBounds = span.node().getBBox();\r\n        tHeight += textBounds.height;\r\n      }\r\n      textHeight += tHeight;\r\n      span.attr('x', x + getConfig().state.noteMargin);\r\n      span.attr('y', y + textHeight + 1.25 * getConfig().state.noteMargin);\r\n    }\r\n  }\r\n  return { textWidth: textElem.node().getBBox().width, textHeight };\r\n};\r\n\r\n/**\r\n * Draws a note to the diagram\r\n *\r\n * @param text - The text of the given note.\r\n * @param g - The element the note is attached to.\r\n */\r\n\r\nexport const drawNote = (text, g) => {\r\n  g.attr('class', 'state-note');\r\n  const note = g.append('rect').attr('x', 0).attr('y', getConfig().state.padding);\r\n  const rectElem = g.append('g');\r\n\r\n  const { textWidth, textHeight } = _drawLongText(text, 0, 0, rectElem);\r\n  note.attr('height', textHeight + 2 * getConfig().state.noteMargin);\r\n  note.attr('width', textWidth + getConfig().state.noteMargin * 2);\r\n\r\n  return note;\r\n};\r\n\r\n/**\r\n * Starting point for drawing a state. The function finds out the specifics about the state and\r\n * renders with approprtiate function.\r\n *\r\n * @param {any} elem\r\n * @param {any} stateDef\r\n */\r\n\r\nexport const drawState = function (elem, stateDef) {\r\n  const id = stateDef.id;\r\n  const stateInfo = {\r\n    id: id,\r\n    label: stateDef.id,\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n\r\n  const g = elem.append('g').attr('id', id).attr('class', 'stateGroup');\r\n\r\n  if (stateDef.type === 'start') drawStartState(g);\r\n  if (stateDef.type === 'end') drawEndState(g);\r\n  if (stateDef.type === 'fork' || stateDef.type === 'join') drawForkJoinState(g, stateDef);\r\n  if (stateDef.type === 'note') drawNote(stateDef.note.text, g);\r\n  if (stateDef.type === 'divider') drawDivider(g);\r\n  if (stateDef.type === 'default' && stateDef.descriptions.length === 0)\r\n    drawSimpleState(g, stateDef);\r\n  if (stateDef.type === 'default' && stateDef.descriptions.length > 0) drawDescrState(g, stateDef);\r\n\r\n  const stateBox = g.node().getBBox();\r\n  stateInfo.width = stateBox.width + 2 * getConfig().state.padding;\r\n  stateInfo.height = stateBox.height + 2 * getConfig().state.padding;\r\n\r\n  idCache.set(id, stateInfo);\r\n  // stateCnt++;\r\n  return stateInfo;\r\n};\r\n\r\nlet edgeCount = 0;\r\nexport const drawEdge = function (elem, path, relation) {\r\n  const getRelationType = function (type) {\r\n    switch (type) {\r\n      case stateDb.relationType.AGGREGATION:\r\n        return 'aggregation';\r\n      case stateDb.relationType.EXTENSION:\r\n        return 'extension';\r\n      case stateDb.relationType.COMPOSITION:\r\n        return 'composition';\r\n      case stateDb.relationType.DEPENDENCY:\r\n        return 'dependency';\r\n    }\r\n  };\r\n\r\n  path.points = path.points.filter((p) => !Number.isNaN(p.y));\r\n\r\n  // The data for our line\r\n  const lineData = path.points;\r\n\r\n  // This is the accessor function we talked about above\r\n  const lineFunction = line()\r\n    .x(function (d) {\r\n      return d.x;\r\n    })\r\n    .y(function (d) {\r\n      return d.y;\r\n    })\r\n    .curve(curveBasis);\r\n\r\n  const svgPath = elem\r\n    .append('path')\r\n    .attr('d', lineFunction(lineData))\r\n    .attr('id', 'edge' + edgeCount)\r\n    .attr('class', 'transition');\r\n  let url = '';\r\n  if (getConfig().state.arrowMarkerAbsolute) {\r\n    url =\r\n      window.location.protocol +\r\n      '//' +\r\n      window.location.host +\r\n      window.location.pathname +\r\n      window.location.search;\r\n    url = url.replace(/\\(/g, '\\\\(');\r\n    url = url.replace(/\\)/g, '\\\\)');\r\n  }\r\n\r\n  svgPath.attr(\r\n    'marker-end',\r\n    'url(' + url + '#' + getRelationType(stateDb.relationType.DEPENDENCY) + 'End' + ')'\r\n  );\r\n\r\n  if (typeof relation.title !== 'undefined') {\r\n    const label = elem.append('g').attr('class', 'stateLabel');\r\n\r\n    const { x, y } = utils.calcLabelPosition(path.points);\r\n\r\n    const rows = common.getRows(relation.title);\r\n\r\n    let titleHeight = 0;\r\n    const titleRows = [];\r\n    let maxWidth = 0;\r\n    let minX = 0;\r\n\r\n    for (let i = 0; i <= rows.length; i++) {\r\n      const title = label\r\n        .append('text')\r\n        .attr('text-anchor', 'middle')\r\n        .text(rows[i])\r\n        .attr('x', x)\r\n        .attr('y', y + titleHeight);\r\n\r\n      const boundstmp = title.node().getBBox();\r\n      maxWidth = Math.max(maxWidth, boundstmp.width);\r\n      minX = Math.min(minX, boundstmp.x);\r\n\r\n      log.info(boundstmp.x, x, y + titleHeight);\r\n\r\n      if (titleHeight === 0) {\r\n        const titleBox = title.node().getBBox();\r\n        titleHeight = titleBox.height;\r\n        log.info('Title height', titleHeight, y);\r\n      }\r\n      titleRows.push(title);\r\n    }\r\n\r\n    let boxHeight = titleHeight * rows.length;\r\n    if (rows.length > 1) {\r\n      const heightAdj = (rows.length - 1) * titleHeight * 0.5;\r\n\r\n      titleRows.forEach((title, i) => title.attr('y', y + i * titleHeight - heightAdj));\r\n      boxHeight = titleHeight * rows.length;\r\n    }\r\n\r\n    const bounds = label.node().getBBox();\r\n\r\n    label\r\n      .insert('rect', ':first-child')\r\n      .attr('class', 'box')\r\n      .attr('x', x - maxWidth / 2 - getConfig().state.padding / 2)\r\n      .attr('y', y - boxHeight / 2 - getConfig().state.padding / 2 - 3.5)\r\n      .attr('width', maxWidth + getConfig().state.padding)\r\n      .attr('height', boxHeight + getConfig().state.padding);\r\n\r\n    log.info(bounds);\r\n\r\n    //label.attr('transform', '0 -' + (bounds.y / 2));\r\n\r\n    // Debug points\r\n    // path.points.forEach(point => {\r\n    //   g.append('circle')\r\n    //     .style('stroke', 'red')\r\n    //     .style('fill', 'red')\r\n    //     .attr('r', 1)\r\n    //     .attr('cx', point.x)\r\n    //     .attr('cy', point.y);\r\n    // });\r\n    // g.append('circle')\r\n    //   .style('stroke', 'blue')\r\n    //   .style('fill', 'blue')\r\n    //   .attr('r', 1)\r\n    //   .attr('cx', x)\r\n    //   .attr('cy', y);\r\n  }\r\n\r\n  edgeCount++;\r\n};\r\n","import { log } from '../../logger';\r\nimport { generateId } from '../../utils';\r\nimport mermaidAPI from '../../mermaidAPI';\r\nimport common from '../common/common';\r\nimport * as configApi from '../../config';\r\n\r\nconst sanitizeText = (txt) => common.sanitizeText(txt, configApi.getConfig());\r\n\r\nconst clone = (o) => JSON.parse(JSON.stringify(o));\r\nlet rootDoc = [];\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nconst setRootDoc = (o) => {\r\n  log.info('Setting root doc', o);\r\n  // rootDoc = { id: 'root', doc: o };\r\n  rootDoc = o;\r\n};\r\n\r\nconst getRootDoc = () => rootDoc;\r\n\r\nconst docTranslator = (parent, node, first) => {\r\n  if (node.stmt === 'relation') {\r\n    docTranslator(parent, node.state1, true);\r\n    docTranslator(parent, node.state2, false);\r\n  } else {\r\n    if (node.stmt === 'state') {\r\n      if (node.id === '[*]') {\r\n        node.id = first ? parent.id + '_start' : parent.id + '_end';\r\n        node.start = first;\r\n      }\r\n    }\r\n\r\n    if (node.doc) {\r\n      const doc = [];\r\n      // Check for concurrency\r\n      let i = 0;\r\n      let currentDoc = [];\r\n      for (i = 0; i < node.doc.length; i++) {\r\n        if (node.doc[i].type === 'divider') {\r\n          // debugger;\r\n          const newNode = clone(node.doc[i]);\r\n          newNode.doc = clone(currentDoc);\r\n          doc.push(newNode);\r\n          currentDoc = [];\r\n        } else {\r\n          currentDoc.push(node.doc[i]);\r\n        }\r\n      }\r\n\r\n      // If any divider was encountered\r\n      if (doc.length > 0 && currentDoc.length > 0) {\r\n        const newNode = {\r\n          stmt: 'state',\r\n          id: generateId(),\r\n          type: 'divider',\r\n          doc: clone(currentDoc),\r\n        };\r\n        doc.push(clone(newNode));\r\n        node.doc = doc;\r\n      }\r\n\r\n      node.doc.forEach((docNode) => docTranslator(node, docNode, true));\r\n    }\r\n  }\r\n};\r\nconst getRootDocV2 = () => {\r\n  docTranslator({ id: 'root' }, { id: 'root', doc: rootDoc }, true);\r\n  return { id: 'root', doc: rootDoc };\r\n  // Here\r\n};\r\n\r\nconst extract = (_doc) => {\r\n  // const res = { states: [], relations: [] };\r\n  let doc;\r\n  if (_doc.doc) {\r\n    doc = _doc.doc;\r\n  } else {\r\n    doc = _doc;\r\n  }\r\n  // let doc = root.doc;\r\n  // if (!doc) {\r\n  //   doc = root;\r\n  // }\r\n  log.info(doc);\r\n  clear();\r\n\r\n  log.info('Extract', doc);\r\n\r\n  doc.forEach((item) => {\r\n    if (item.stmt === 'state') {\r\n      addState(item.id, item.type, item.doc, item.description, item.note);\r\n    }\r\n    if (item.stmt === 'relation') {\r\n      addRelation(item.state1.id, item.state2.id, item.description);\r\n    }\r\n  });\r\n};\r\n\r\nconst newDoc = () => {\r\n  return {\r\n    relations: [],\r\n    states: {},\r\n    documents: {},\r\n  };\r\n};\r\n\r\nlet documents = {\r\n  root: newDoc(),\r\n};\r\n\r\nlet currentDocument = documents.root;\r\n\r\nlet startCnt = 0;\r\nlet endCnt = 0; // eslint-disable-line\r\n// let stateCnt = 0;\r\n\r\nlet title = 'State diagram';\r\nlet description = '';\r\n\r\nconst setTitle = function (txt) {\r\n  title = sanitizeText(txt);\r\n};\r\n\r\nconst getTitle = function () {\r\n  return title;\r\n};\r\n\r\nconst setAccDescription = function (txt) {\r\n  description = sanitizeText(txt);\r\n};\r\n\r\nconst getAccDescription = function () {\r\n  return description;\r\n};\r\n\r\n/**\r\n * Function called by parser when a node definition has been found.\r\n *\r\n * @param {any} id\r\n * @param {any} type\r\n * @param {any} doc\r\n * @param {any} descr\r\n * @param {any} note\r\n */\r\nexport const addState = function (id, type, doc, descr, note) {\r\n  if (typeof currentDocument.states[id] === 'undefined') {\r\n    currentDocument.states[id] = {\r\n      id: id,\r\n      descriptions: [],\r\n      type,\r\n      doc,\r\n      note,\r\n    };\r\n  } else {\r\n    if (!currentDocument.states[id].doc) {\r\n      currentDocument.states[id].doc = doc;\r\n    }\r\n    if (!currentDocument.states[id].type) {\r\n      currentDocument.states[id].type = type;\r\n    }\r\n  }\r\n  if (descr) {\r\n    log.info('Adding state ', id, descr);\r\n    if (typeof descr === 'string') addDescription(id, descr.trim());\r\n\r\n    if (typeof descr === 'object') {\r\n      descr.forEach((des) => addDescription(id, des.trim()));\r\n    }\r\n  }\r\n\r\n  if (note) {\r\n    currentDocument.states[id].note = note;\r\n    currentDocument.states[id].note.text = common.sanitizeText(\r\n      currentDocument.states[id].note.text,\r\n      configApi.getConfig()\r\n    );\r\n  }\r\n};\r\n\r\nexport const clear = function () {\r\n  documents = {\r\n    root: newDoc(),\r\n  };\r\n  currentDocument = documents.root;\r\n\r\n  currentDocument = documents.root;\r\n\r\n  startCnt = 0;\r\n  endCnt = 0; // eslint-disable-line\r\n  classes = [];\r\n};\r\n\r\nexport const getState = function (id) {\r\n  return currentDocument.states[id];\r\n};\r\n\r\nexport const getStates = function () {\r\n  return currentDocument.states;\r\n};\r\nexport const logDocuments = function () {\r\n  log.info('Documents = ', documents);\r\n};\r\nexport const getRelations = function () {\r\n  return currentDocument.relations;\r\n};\r\n\r\nexport const addRelation = function (_id1, _id2, title) {\r\n  let id1 = _id1;\r\n  let id2 = _id2;\r\n  let type1 = 'default';\r\n  let type2 = 'default';\r\n  if (_id1 === '[*]') {\r\n    startCnt++;\r\n    id1 = 'start' + startCnt;\r\n    type1 = 'start';\r\n  }\r\n  if (_id2 === '[*]') {\r\n    endCnt++;\r\n    id2 = 'end' + startCnt;\r\n    type2 = 'end';\r\n  }\r\n  addState(id1, type1);\r\n  addState(id2, type2);\r\n  currentDocument.relations.push({\r\n    id1,\r\n    id2,\r\n    title: common.sanitizeText(title, configApi.getConfig()),\r\n  });\r\n};\r\n\r\nconst addDescription = function (id, _descr) {\r\n  const theState = currentDocument.states[id];\r\n  let descr = _descr;\r\n  if (descr[0] === ':') {\r\n    descr = descr.substr(1).trim();\r\n  }\r\n  theState.descriptions.push(common.sanitizeText(descr, configApi.getConfig()));\r\n};\r\n\r\nexport const cleanupLabel = function (label) {\r\n  if (label.substring(0, 1) === ':') {\r\n    return label.substr(2).trim();\r\n  } else {\r\n    return label.trim();\r\n  }\r\n};\r\n\r\nexport const lineType = {\r\n  LINE: 0,\r\n  DOTTED_LINE: 1,\r\n};\r\n\r\nlet dividerCnt = 0;\r\nconst getDividerId = () => {\r\n  dividerCnt++;\r\n  return 'divider-id-' + dividerCnt;\r\n};\r\n\r\nlet classes = [];\r\n\r\nconst getClasses = () => classes;\r\n\r\nlet direction = 'TB';\r\nconst getDirection = () => direction;\r\nconst setDirection = (dir) => {\r\n  direction = dir;\r\n};\r\n\r\nexport const relationType = {\r\n  AGGREGATION: 0,\r\n  EXTENSION: 1,\r\n  COMPOSITION: 2,\r\n  DEPENDENCY: 3,\r\n};\r\n\r\nconst trimColon = (str) => (str && str[0] === ':' ? str.substr(1).trim() : str.trim());\r\n\r\nexport default {\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().state,\r\n  addState,\r\n  clear,\r\n  getState,\r\n  getStates,\r\n  getRelations,\r\n  getClasses,\r\n  getDirection,\r\n  addRelation,\r\n  getDividerId,\r\n  setDirection,\r\n  // addDescription,\r\n  cleanupLabel,\r\n  lineType,\r\n  relationType,\r\n  logDocuments,\r\n  getRootDoc,\r\n  setRootDoc,\r\n  getRootDocV2,\r\n  extract,\r\n  trimColon,\r\n  getTitle,\r\n  setTitle,\r\n  getAccDescription,\r\n  setAccDescription,\r\n};\r\n","import graphlib from 'graphlib';\r\nimport { select } from 'd3';\r\nimport stateDb from './stateDb';\r\nimport state from './parser/stateDiagram';\r\nimport { getConfig } from '../../config';\r\nimport { render } from '../../dagre-wrapper/index.js';\r\nimport { log } from '../../logger';\r\nimport { configureSvgSize } from '../../utils';\r\nimport common from '../common/common';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nconst conf = {};\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    conf[keys[i]] = cnf[keys[i]];\r\n  }\r\n};\r\n\r\nlet nodeDb = {};\r\n\r\n/**\r\n * Returns the all the styles from classDef statements in the graph definition.\r\n *\r\n * @param {any} text\r\n * @returns {object} ClassDef styles\r\n */\r\nexport const getClasses = function (text) {\r\n  log.trace('Extracting classes');\r\n  stateDb.clear();\r\n  const parser = state.parser;\r\n  parser.yy = stateDb;\r\n\r\n  // Parse the graph definition\r\n  parser.parse(text);\r\n  return stateDb.getClasses();\r\n};\r\n\r\nconst setupNode = (g, parent, node, altFlag) => {\r\n  // Add the node\r\n  if (node.id !== 'root') {\r\n    let shape = 'rect';\r\n    if (node.start === true) {\r\n      shape = 'start';\r\n    }\r\n    if (node.start === false) {\r\n      shape = 'end';\r\n    }\r\n    if (node.type !== 'default') {\r\n      shape = node.type;\r\n    }\r\n\r\n    if (!nodeDb[node.id]) {\r\n      nodeDb[node.id] = {\r\n        id: node.id,\r\n        shape,\r\n        description: common.sanitizeText(node.id, getConfig()),\r\n        classes: 'statediagram-state',\r\n      };\r\n    }\r\n\r\n    // Build of the array of description strings accordinging\r\n    if (node.description) {\r\n      if (Array.isArray(nodeDb[node.id].description)) {\r\n        // There already is an array of strings,add to it\r\n        nodeDb[node.id].shape = 'rectWithTitle';\r\n        nodeDb[node.id].description.push(node.description);\r\n      } else {\r\n        if (nodeDb[node.id].description.length > 0) {\r\n          // if there is a description already transformit to an array\r\n          nodeDb[node.id].shape = 'rectWithTitle';\r\n          if (nodeDb[node.id].description === node.id) {\r\n            // If the previous description was the is, remove it\r\n            nodeDb[node.id].description = [node.description];\r\n          } else {\r\n            nodeDb[node.id].description = [nodeDb[node.id].description, node.description];\r\n          }\r\n        } else {\r\n          nodeDb[node.id].shape = 'rect';\r\n          nodeDb[node.id].description = node.description;\r\n        }\r\n      }\r\n      nodeDb[node.id].description = common.sanitizeTextOrArray(\r\n        nodeDb[node.id].description,\r\n        getConfig()\r\n      );\r\n    }\r\n\r\n    //\r\n    if (nodeDb[node.id].description.length === 1 && nodeDb[node.id].shape === 'rectWithTitle') {\r\n      nodeDb[node.id].shape = 'rect';\r\n    }\r\n\r\n    // Save data for description and group so that for instance a statement without description overwrites\r\n    // one with description\r\n\r\n    // group\r\n    if (!nodeDb[node.id].type && node.doc) {\r\n      log.info('Setting cluster for ', node.id, getDir(node));\r\n      nodeDb[node.id].type = 'group';\r\n      nodeDb[node.id].dir = getDir(node);\r\n      nodeDb[node.id].shape = node.type === 'divider' ? 'divider' : 'roundedWithTitle';\r\n      nodeDb[node.id].classes =\r\n        nodeDb[node.id].classes +\r\n        ' ' +\r\n        (altFlag ? 'statediagram-cluster statediagram-cluster-alt' : 'statediagram-cluster');\r\n    }\r\n\r\n    const nodeData = {\r\n      labelStyle: '',\r\n      shape: nodeDb[node.id].shape,\r\n      labelText: nodeDb[node.id].description,\r\n      // typeof nodeDb[node.id].description === 'object'\r\n      //   ? nodeDb[node.id].description[0]\r\n      //   : nodeDb[node.id].description,\r\n      classes: nodeDb[node.id].classes, //classStr,\r\n      style: '', //styles.style,\r\n      id: node.id,\r\n      dir: nodeDb[node.id].dir,\r\n      domId: 'state-' + node.id + '-' + cnt,\r\n      type: nodeDb[node.id].type,\r\n      padding: 15, //getConfig().flowchart.padding\r\n    };\r\n\r\n    if (node.note) {\r\n      // Todo: set random id\r\n      const noteData = {\r\n        labelStyle: '',\r\n        shape: 'note',\r\n        labelText: node.note.text,\r\n        classes: 'statediagram-note', //classStr,\r\n        style: '', //styles.style,\r\n        id: node.id + '----note-' + cnt,\r\n        domId: 'state-' + node.id + '----note-' + cnt,\r\n        type: nodeDb[node.id].type,\r\n        padding: 15, //getConfig().flowchart.padding\r\n      };\r\n      const groupData = {\r\n        labelStyle: '',\r\n        shape: 'noteGroup',\r\n        labelText: node.note.text,\r\n        classes: nodeDb[node.id].classes, //classStr,\r\n        style: '', //styles.style,\r\n        id: node.id + '----parent',\r\n        domId: 'state-' + node.id + '----parent-' + cnt,\r\n        type: 'group',\r\n        padding: 0, //getConfig().flowchart.padding\r\n      };\r\n      cnt++;\r\n\r\n      g.setNode(node.id + '----parent', groupData);\r\n\r\n      g.setNode(noteData.id, noteData);\r\n      g.setNode(node.id, nodeData);\r\n\r\n      g.setParent(node.id, node.id + '----parent');\r\n      g.setParent(noteData.id, node.id + '----parent');\r\n\r\n      let from = node.id;\r\n      let to = noteData.id;\r\n\r\n      if (node.note.position === 'left of') {\r\n        from = noteData.id;\r\n        to = node.id;\r\n      }\r\n      g.setEdge(from, to, {\r\n        arrowhead: 'none',\r\n        arrowType: '',\r\n        style: 'fill:none',\r\n        labelStyle: '',\r\n        classes: 'transition note-edge',\r\n        arrowheadStyle: 'fill: #333',\r\n        labelpos: 'c',\r\n        labelType: 'text',\r\n        thickness: 'normal',\r\n      });\r\n    } else {\r\n      g.setNode(node.id, nodeData);\r\n    }\r\n  }\r\n\r\n  if (parent) {\r\n    if (parent.id !== 'root') {\r\n      log.trace('Setting node ', node.id, ' to be child of its parent ', parent.id);\r\n      g.setParent(node.id, parent.id);\r\n    }\r\n  }\r\n  if (node.doc) {\r\n    log.trace('Adding nodes children ');\r\n    setupDoc(g, node, node.doc, !altFlag);\r\n  }\r\n};\r\nlet cnt = 0;\r\nconst setupDoc = (g, parent, doc, altFlag) => {\r\n  // cnt = 0;\r\n  log.trace('items', doc);\r\n  doc.forEach((item) => {\r\n    if (item.stmt === 'state' || item.stmt === 'default') {\r\n      setupNode(g, parent, item, altFlag);\r\n    } else if (item.stmt === 'relation') {\r\n      setupNode(g, parent, item.state1, altFlag);\r\n      setupNode(g, parent, item.state2, altFlag);\r\n      const edgeData = {\r\n        id: 'edge' + cnt,\r\n        arrowhead: 'normal',\r\n        arrowTypeEnd: 'arrow_barb',\r\n        style: 'fill:none',\r\n        labelStyle: '',\r\n        label: common.sanitizeText(item.description, getConfig()),\r\n        arrowheadStyle: 'fill: #333',\r\n        labelpos: 'c',\r\n        labelType: 'text',\r\n        thickness: 'normal',\r\n        classes: 'transition',\r\n      };\r\n      let startId = item.state1.id;\r\n      let endId = item.state2.id;\r\n\r\n      g.setEdge(startId, endId, edgeData, cnt);\r\n      cnt++;\r\n    }\r\n  });\r\n};\r\nconst getDir = (nodes, defaultDir) => {\r\n  let dir = defaultDir || 'TB';\r\n  if (nodes.doc) {\r\n    for (let i = 0; i < nodes.doc.length; i++) {\r\n      const node = nodes.doc[i];\r\n      if (node.stmt === 'dir') {\r\n        dir = node.value;\r\n      }\r\n    }\r\n  }\r\n  return dir;\r\n};\r\n/**\r\n * Draws a flowchart in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {any} text\r\n * @param {any} id\r\n */\r\nexport const draw = function (text, id) {\r\n  log.info('Drawing state diagram (v2)', id);\r\n  stateDb.clear();\r\n  nodeDb = {};\r\n  const parser = state.parser;\r\n  parser.yy = stateDb;\r\n\r\n  // Parse the graph definition\r\n  parser.parse(text);\r\n\r\n  // Fetch the default direction, use TD if none was found\r\n  let dir = stateDb.getDirection();\r\n  if (typeof dir === 'undefined') {\r\n    dir = 'LR';\r\n  }\r\n\r\n  const conf = getConfig().state;\r\n  const nodeSpacing = conf.nodeSpacing || 50;\r\n  const rankSpacing = conf.rankSpacing || 50;\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n\r\n  log.info(stateDb.getRootDocV2());\r\n  stateDb.extract(stateDb.getRootDocV2());\r\n  log.info(stateDb.getRootDocV2());\r\n\r\n  // Create the input mermaid.graph\r\n  const g = new graphlib.Graph({\r\n    multigraph: true,\r\n    compound: true,\r\n  })\r\n    .setGraph({\r\n      rankdir: getDir(stateDb.getRootDocV2()),\r\n      nodesep: nodeSpacing,\r\n      ranksep: rankSpacing,\r\n      marginx: 8,\r\n      marginy: 8,\r\n    })\r\n    .setDefaultEdgeLabel(function () {\r\n      return {};\r\n    });\r\n\r\n  setupNode(g, undefined, stateDb.getRootDocV2(), true);\r\n\r\n  // Set up an SVG group so that we can translate the final graph.\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n  const svg = root.select(`[id=\"${id}\"]`);\r\n\r\n  // Run the renderer. This is what draws the final graph.\r\n\r\n  const element = root.select('#' + id + ' g');\r\n  render(element, g, ['barb'], 'statediagram', id);\r\n\r\n  const padding = 8;\r\n\r\n  const bounds = svg.node().getBBox();\r\n\r\n  const width = bounds.width + padding * 2;\r\n  const height = bounds.height + padding * 2;\r\n\r\n  // Zoom in a bit\r\n  svg.attr('class', 'statediagram');\r\n\r\n  const svgBounds = svg.node().getBBox();\r\n\r\n  configureSvgSize(svg, height, width * 1.75, conf.useMaxWidth);\r\n\r\n  // Ensure the viewBox includes the whole svgBounds area with extra space for padding\r\n  const vBox = `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`;\r\n  log.debug(`viewBox ${vBox}`);\r\n  svg.attr('viewBox', vBox);\r\n\r\n  // Add label rects for non html labels\r\n  // if (!evaluate(conf.htmlLabels) || true) {\r\n  const labels = document.querySelectorAll('[id=\"' + id + '\"] .edgeLabel .label');\r\n  for (let k = 0; k < labels.length; k++) {\r\n    const label = labels[k];\r\n\r\n    // Get dimensions of label\r\n    const dim = label.getBBox();\r\n\r\n    const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n    rect.setAttribute('rx', 0);\r\n    rect.setAttribute('ry', 0);\r\n    rect.setAttribute('width', dim.width);\r\n    rect.setAttribute('height', dim.height);\r\n\r\n    label.insertBefore(rect, label.firstChild);\r\n    // }\r\n  }\r\n  addSVGAccessibilityFields(parser.yy, svg, id);\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  getClasses,\r\n  draw,\r\n};\r\n","import { select } from 'd3';\r\nimport dagre from 'dagre';\r\nimport graphlib from 'graphlib';\r\nimport { log } from '../../logger';\r\nimport stateDb from './stateDb';\r\nimport common from '../common/common';\r\nimport { parser } from './parser/stateDiagram';\r\n// import idCache from './id-cache';\r\nimport { drawState, addTitleAndBox, drawEdge } from './shapes';\r\nimport { getConfig } from '../../config';\r\nimport { configureSvgSize } from '../../utils';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nparser.yy = stateDb;\r\n\r\n// TODO Move conf object to main conf in mermaidAPI\r\nlet conf;\r\n\r\nconst transformationLog = {};\r\n\r\nexport const setConf = function () {};\r\n\r\n/**\r\n * Setup arrow head and define the marker. The result is appended to the svg.\r\n *\r\n * @param {any} elem\r\n */\r\nconst insertMarkers = function (elem) {\r\n  elem\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'dependencyEnd')\r\n    .attr('refX', 19)\r\n    .attr('refY', 7)\r\n    .attr('markerWidth', 20)\r\n    .attr('markerHeight', 28)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 19,7 L9,13 L14,7 L9,1 Z');\r\n};\r\n\r\n/**\r\n * Draws a flowchart in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {any} text\r\n * @param {any} id\r\n */\r\nexport const draw = function (text, id) {\r\n  conf = getConfig().state;\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and ocument for when rendering in sanbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  parser.yy.clear();\r\n  parser.parse(text);\r\n  log.debug('Rendering diagram ' + text);\r\n\r\n  // Fetch the default direction, use TD if none was found\r\n  const diagram = root.select(`[id='${id}']`);\r\n  insertMarkers(diagram);\r\n\r\n  // Layout graph, Create a new directed graph\r\n  const graph = new graphlib.Graph({\r\n    multigraph: true,\r\n    compound: true,\r\n    // acyclicer: 'greedy',\r\n    rankdir: 'RL',\r\n    // ranksep: '20'\r\n  });\r\n\r\n  // Default to assigning a new object as a label for each new edge.\r\n  graph.setDefaultEdgeLabel(function () {\r\n    return {};\r\n  });\r\n\r\n  const rootDoc = stateDb.getRootDoc();\r\n  renderDoc(rootDoc, diagram, undefined, false, root, doc);\r\n\r\n  const padding = conf.padding;\r\n  const bounds = diagram.node().getBBox();\r\n\r\n  const width = bounds.width + padding * 2;\r\n  const height = bounds.height + padding * 2;\r\n\r\n  // zoom in a bit\r\n  const svgWidth = width * 1.75;\r\n  configureSvgSize(diagram, height, svgWidth, conf.useMaxWidth);\r\n\r\n  diagram.attr(\r\n    'viewBox',\r\n    `${bounds.x - conf.padding}  ${bounds.y - conf.padding} ` + width + ' ' + height\r\n  );\r\n  addSVGAccessibilityFields(parser.yy, diagram, id);\r\n};\r\nconst getLabelWidth = (text) => {\r\n  return text ? text.length * conf.fontSizeFactor : 1;\r\n};\r\n\r\nconst renderDoc = (doc, diagram, parentId, altBkg, root, domDocument) => {\r\n  // Layout graph, Create a new directed graph\r\n  const graph = new graphlib.Graph({\r\n    compound: true,\r\n    multigraph: true,\r\n  });\r\n\r\n  let i;\r\n  let edgeFreeDoc = true;\r\n  for (i = 0; i < doc.length; i++) {\r\n    if (doc[i].stmt === 'relation') {\r\n      edgeFreeDoc = false;\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Set an object for the graph label\r\n  if (parentId)\r\n    graph.setGraph({\r\n      rankdir: 'LR',\r\n      multigraph: true,\r\n      compound: true,\r\n      // acyclicer: 'greedy',\r\n      ranker: 'tight-tree',\r\n      ranksep: edgeFreeDoc ? 1 : conf.edgeLengthFactor,\r\n      nodeSep: edgeFreeDoc ? 1 : 50,\r\n      isMultiGraph: true,\r\n      // ranksep: 5,\r\n      // nodesep: 1\r\n    });\r\n  else {\r\n    graph.setGraph({\r\n      rankdir: 'TB',\r\n      multigraph: true,\r\n      compound: true,\r\n      // isCompound: true,\r\n      // acyclicer: 'greedy',\r\n      // ranker: 'longest-path'\r\n      ranksep: edgeFreeDoc ? 1 : conf.edgeLengthFactor,\r\n      nodeSep: edgeFreeDoc ? 1 : 50,\r\n      ranker: 'tight-tree',\r\n      // ranker: 'network-simplex'\r\n      isMultiGraph: true,\r\n    });\r\n  }\r\n\r\n  // Default to assigning a new object as a label for each new edge.\r\n  graph.setDefaultEdgeLabel(function () {\r\n    return {};\r\n  });\r\n\r\n  stateDb.extract(doc);\r\n  const states = stateDb.getStates();\r\n  const relations = stateDb.getRelations();\r\n\r\n  const keys = Object.keys(states);\r\n\r\n  let first = true;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const stateDef = states[keys[i]];\r\n\r\n    if (parentId) {\r\n      stateDef.parentId = parentId;\r\n    }\r\n\r\n    let node;\r\n    if (stateDef.doc) {\r\n      let sub = diagram.append('g').attr('id', stateDef.id).attr('class', 'stateGroup');\r\n      node = renderDoc(stateDef.doc, sub, stateDef.id, !altBkg, root, domDocument);\r\n\r\n      if (first) {\r\n        // first = false;\r\n        sub = addTitleAndBox(sub, stateDef, altBkg);\r\n        let boxBounds = sub.node().getBBox();\r\n        node.width = boxBounds.width;\r\n        node.height = boxBounds.height + conf.padding / 2;\r\n        transformationLog[stateDef.id] = { y: conf.compositTitleSize };\r\n      } else {\r\n        // sub = addIdAndBox(sub, stateDef);\r\n        let boxBounds = sub.node().getBBox();\r\n        node.width = boxBounds.width;\r\n        node.height = boxBounds.height;\r\n        // transformationLog[stateDef.id] = { y: conf.compositTitleSize };\r\n      }\r\n    } else {\r\n      node = drawState(diagram, stateDef, graph);\r\n    }\r\n\r\n    if (stateDef.note) {\r\n      // Draw note note\r\n      const noteDef = {\r\n        descriptions: [],\r\n        id: stateDef.id + '-note',\r\n        note: stateDef.note,\r\n        type: 'note',\r\n      };\r\n      const note = drawState(diagram, noteDef, graph);\r\n\r\n      // graph.setNode(node.id, node);\r\n      if (stateDef.note.position === 'left of') {\r\n        graph.setNode(node.id + '-note', note);\r\n        graph.setNode(node.id, node);\r\n      } else {\r\n        graph.setNode(node.id, node);\r\n        graph.setNode(node.id + '-note', note);\r\n      }\r\n      // graph.setNode(node.id);\r\n      graph.setParent(node.id, node.id + '-group');\r\n      graph.setParent(node.id + '-note', node.id + '-group');\r\n    } else {\r\n      // Add nodes to the graph. The first argument is the node id. The second is\r\n      // metadata about the node. In this case we're going to add labels to each of\r\n      // our nodes.\r\n      graph.setNode(node.id, node);\r\n    }\r\n  }\r\n\r\n  log.debug('Count=', graph.nodeCount(), graph);\r\n  let cnt = 0;\r\n  relations.forEach(function (relation) {\r\n    cnt++;\r\n    log.debug('Setting edge', relation);\r\n    graph.setEdge(\r\n      relation.id1,\r\n      relation.id2,\r\n      {\r\n        relation: relation,\r\n        width: getLabelWidth(relation.title),\r\n        height: conf.labelHeight * common.getRows(relation.title).length,\r\n        labelpos: 'c',\r\n      },\r\n      'id' + cnt\r\n    );\r\n  });\r\n\r\n  dagre.layout(graph);\r\n\r\n  log.debug('Graph after layout', graph.nodes());\r\n  const svgElem = diagram.node();\r\n\r\n  graph.nodes().forEach(function (v) {\r\n    if (typeof v !== 'undefined' && typeof graph.node(v) !== 'undefined') {\r\n      log.warn('Node ' + v + ': ' + JSON.stringify(graph.node(v)));\r\n      root\r\n        .select('#' + svgElem.id + ' #' + v)\r\n        .attr(\r\n          'transform',\r\n          'translate(' +\r\n            (graph.node(v).x - graph.node(v).width / 2) +\r\n            ',' +\r\n            (graph.node(v).y +\r\n              (transformationLog[v] ? transformationLog[v].y : 0) -\r\n              graph.node(v).height / 2) +\r\n            ' )'\r\n        );\r\n      root\r\n        .select('#' + svgElem.id + ' #' + v)\r\n        .attr('data-x-shift', graph.node(v).x - graph.node(v).width / 2);\r\n      const dividers = domDocument.querySelectorAll('#' + svgElem.id + ' #' + v + ' .divider');\r\n      dividers.forEach((divider) => {\r\n        const parent = divider.parentElement;\r\n        let pWidth = 0;\r\n        let pShift = 0;\r\n        if (parent) {\r\n          if (parent.parentElement) pWidth = parent.parentElement.getBBox().width;\r\n          pShift = parseInt(parent.getAttribute('data-x-shift'), 10);\r\n          if (Number.isNaN(pShift)) {\r\n            pShift = 0;\r\n          }\r\n        }\r\n        divider.setAttribute('x1', 0 - pShift + 8);\r\n        divider.setAttribute('x2', pWidth - pShift - 8);\r\n      });\r\n    } else {\r\n      log.debug('No Node ' + v + ': ' + JSON.stringify(graph.node(v)));\r\n    }\r\n  });\r\n\r\n  let stateBox = svgElem.getBBox();\r\n\r\n  graph.edges().forEach(function (e) {\r\n    if (typeof e !== 'undefined' && typeof graph.edge(e) !== 'undefined') {\r\n      log.debug('Edge ' + e.v + ' -> ' + e.w + ': ' + JSON.stringify(graph.edge(e)));\r\n      drawEdge(diagram, graph.edge(e), graph.edge(e).relation);\r\n    }\r\n  });\r\n\r\n  stateBox = svgElem.getBBox();\r\n\r\n  const stateInfo = {\r\n    id: parentId ? parentId : 'root',\r\n    label: parentId ? parentId : 'root',\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n\r\n  stateInfo.width = stateBox.width + 2 * conf.padding;\r\n  stateInfo.height = stateBox.height + 2 * conf.padding;\r\n\r\n  log.debug('Doc rendered', stateInfo, graph);\r\n  return stateInfo;\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `\r\ndefs #statediagram-barbEnd {\r\n    fill: ${options.transitionColor};\r\n    stroke: ${options.transitionColor};\r\n  }\r\ng.stateGroup text {\r\n  fill: ${options.nodeBorder};\r\n  stroke: none;\r\n  font-size: 10px;\r\n}\r\ng.stateGroup text {\r\n  fill: ${options.textColor};\r\n  stroke: none;\r\n  font-size: 10px;\r\n\r\n}\r\ng.stateGroup .state-title {\r\n  font-weight: bolder;\r\n  fill: ${options.stateLabelColor};\r\n}\r\n\r\ng.stateGroup rect {\r\n  fill: ${options.mainBkg};\r\n  stroke: ${options.nodeBorder};\r\n}\r\n\r\ng.stateGroup line {\r\n  stroke: ${options.lineColor};\r\n  stroke-width: 1;\r\n}\r\n\r\n.transition {\r\n  stroke: ${options.transitionColor};\r\n  stroke-width: 1;\r\n  fill: none;\r\n}\r\n\r\n.stateGroup .composit {\r\n  fill: ${options.background};\r\n  border-bottom: 1px\r\n}\r\n\r\n.stateGroup .alt-composit {\r\n  fill: #e0e0e0;\r\n  border-bottom: 1px\r\n}\r\n\r\n.state-note {\r\n  stroke: ${options.noteBorderColor};\r\n  fill: ${options.noteBkgColor};\r\n\r\n  text {\r\n    fill: ${options.noteTextColor};\r\n    stroke: none;\r\n    font-size: 10px;\r\n  }\r\n}\r\n\r\n.stateLabel .box {\r\n  stroke: none;\r\n  stroke-width: 0;\r\n  fill: ${options.mainBkg};\r\n  opacity: 0.5;\r\n}\r\n\r\n.edgeLabel .label rect {\r\n  fill: ${options.labelBackgroundColor};\r\n  opacity: 0.5;\r\n}\r\n.edgeLabel .label text {\r\n  fill: ${options.transitionLabelColor || options.tertiaryTextColor};\r\n}\r\n.label div .edgeLabel {\r\n  color: ${options.transitionLabelColor || options.tertiaryTextColor};\r\n}\r\n\r\n.stateLabel text {\r\n  fill: ${options.stateLabelColor};\r\n  font-size: 10px;\r\n  font-weight: bold;\r\n}\r\n\r\n.node circle.state-start {\r\n  fill: ${options.specialStateColor};\r\n  stroke: ${options.specialStateColor};\r\n}\r\n\r\n.node .fork-join {\r\n  fill: ${options.specialStateColor};\r\n  stroke: ${options.specialStateColor};\r\n}\r\n\r\n.node circle.state-end {\r\n  fill: ${options.innerEndBackground};\r\n  stroke: ${options.background};\r\n  stroke-width: 1.5\r\n}\r\n.end-state-inner {\r\n  fill: ${options.compositeBackground || options.background};\r\n  // stroke: ${options.background};\r\n  stroke-width: 1.5\r\n}\r\n\r\n.node rect {\r\n  fill: ${options.stateBkg || options.mainBkg};\r\n  stroke: ${options.stateBorder || options.nodeBorder};\r\n  stroke-width: 1px;\r\n}\r\n.node polygon {\r\n  fill: ${options.mainBkg};\r\n  stroke: ${options.stateBorder || options.nodeBorder};;\r\n  stroke-width: 1px;\r\n}\r\n#statediagram-barbEnd {\r\n  fill: ${options.lineColor};\r\n}\r\n\r\n.statediagram-cluster rect {\r\n  fill: ${options.compositeTitleBackground};\r\n  stroke: ${options.stateBorder || options.nodeBorder};\r\n  stroke-width: 1px;\r\n}\r\n\r\n.cluster-label, .nodeLabel {\r\n  color: ${options.stateLabelColor};\r\n}\r\n\r\n.statediagram-cluster rect.outer {\r\n  rx: 5px;\r\n  ry: 5px;\r\n}\r\n.statediagram-state .divider {\r\n  stroke: ${options.stateBorder || options.nodeBorder};\r\n}\r\n\r\n.statediagram-state .title-state {\r\n  rx: 5px;\r\n  ry: 5px;\r\n}\r\n.statediagram-cluster.statediagram-cluster .inner {\r\n  fill: ${options.compositeBackground || options.background};\r\n}\r\n.statediagram-cluster.statediagram-cluster-alt .inner {\r\n  fill: ${options.altBackground ? options.altBackground : '#efefef'};\r\n}\r\n\r\n.statediagram-cluster .inner {\r\n  rx:0;\r\n  ry:0;\r\n}\r\n\r\n.statediagram-state rect.basic {\r\n  rx: 5px;\r\n  ry: 5px;\r\n}\r\n.statediagram-state rect.divider {\r\n  stroke-dasharray: 10,10;\r\n  fill: ${options.altBackground ? options.altBackground : '#efefef'};\r\n}\r\n\r\n.note-edge {\r\n  stroke-dasharray: 5;\r\n}\r\n\r\n.statediagram-note rect {\r\n  fill: ${options.noteBkgColor};\r\n  stroke: ${options.noteBorderColor};\r\n  stroke-width: 1px;\r\n  rx: 0;\r\n  ry: 0;\r\n}\r\n.statediagram-note rect {\r\n  fill: ${options.noteBkgColor};\r\n  stroke: ${options.noteBorderColor};\r\n  stroke-width: 1px;\r\n  rx: 0;\r\n  ry: 0;\r\n}\r\n\r\n.statediagram-note text {\r\n  fill: ${options.noteTextColor};\r\n}\r\n\r\n.statediagram-note .nodeLabel {\r\n  color: ${options.noteTextColor};\r\n}\r\n.statediagram .edgeLabel {\r\n  color: red; // ${options.noteTextColor};\r\n}\r\n\r\n#dependencyStart, #dependencyEnd {\r\n  fill: ${options.lineColor};\r\n  stroke: ${options.lineColor};\r\n  stroke-width: 1;\r\n}\r\n`;\r\n\r\nexport default getStyles;\r\n","import mermaidAPI from '../../mermaidAPI';\r\nimport * as configApi from '../../config';\r\nimport common from '../common/common';\r\n\r\nconst sanitizeText = (txt) => common.sanitizeText(txt, configApi.getConfig());\r\n\r\nlet title = '';\r\nlet description = '';\r\nlet currentSection = '';\r\n\r\nconst sections = [];\r\nconst tasks = [];\r\nconst rawTasks = [];\r\n\r\nexport const parseDirective = function (statement, context, type) {\r\n  mermaidAPI.parseDirective(this, statement, context, type);\r\n};\r\n\r\nexport const clear = function () {\r\n  sections.length = 0;\r\n  tasks.length = 0;\r\n  currentSection = '';\r\n  title = '';\r\n  description = '';\r\n  rawTasks.length = 0;\r\n};\r\n\r\nconst setTitle = function (txt) {\r\n  title = sanitizeText(txt);\r\n};\r\n\r\nconst getTitle = function () {\r\n  return title;\r\n};\r\n\r\nconst setAccDescription = function (txt) {\r\n  description = sanitizeText(txt);\r\n};\r\n\r\nconst getAccDescription = function () {\r\n  return description;\r\n};\r\n\r\nexport const addSection = function (txt) {\r\n  currentSection = txt;\r\n  sections.push(txt);\r\n};\r\n\r\nexport const getSections = function () {\r\n  return sections;\r\n};\r\n\r\nexport const getTasks = function () {\r\n  let allItemsProcessed = compileTasks();\r\n  const maxDepth = 100;\r\n  let iterationCount = 0;\r\n  while (!allItemsProcessed && iterationCount < maxDepth) {\r\n    allItemsProcessed = compileTasks();\r\n    iterationCount++;\r\n  }\r\n\r\n  tasks.push(...rawTasks);\r\n\r\n  return tasks;\r\n};\r\n\r\nconst updateActors = function () {\r\n  const tempActors = [];\r\n  tasks.forEach((task) => {\r\n    if (task.people) {\r\n      tempActors.push(...task.people);\r\n    }\r\n  });\r\n\r\n  const unique = new Set(tempActors);\r\n  return [...unique].sort();\r\n};\r\n\r\nexport const addTask = function (descr, taskData) {\r\n  const pieces = taskData.substr(1).split(':');\r\n\r\n  let score = 0;\r\n  let peeps = [];\r\n  if (pieces.length === 1) {\r\n    score = Number(pieces[0]);\r\n    peeps = [];\r\n  } else {\r\n    score = Number(pieces[0]);\r\n    peeps = pieces[1].split(',');\r\n  }\r\n  const peopleList = peeps.map((s) => s.trim());\r\n\r\n  const rawTask = {\r\n    section: currentSection,\r\n    type: currentSection,\r\n    people: peopleList,\r\n    task: descr,\r\n    score,\r\n  };\r\n\r\n  rawTasks.push(rawTask);\r\n};\r\n\r\nexport const addTaskOrg = function (descr) {\r\n  const newTask = {\r\n    section: currentSection,\r\n    type: currentSection,\r\n    description: descr,\r\n    task: descr,\r\n    classes: [],\r\n  };\r\n  tasks.push(newTask);\r\n};\r\n\r\nconst compileTasks = function () {\r\n  const compileTask = function (pos) {\r\n    return rawTasks[pos].processed;\r\n  };\r\n\r\n  let allProcessed = true;\r\n  for (let i = 0; i < rawTasks.length; i++) {\r\n    compileTask(i);\r\n\r\n    allProcessed = allProcessed && rawTasks[i].processed;\r\n  }\r\n  return allProcessed;\r\n};\r\n\r\nconst getActors = function () {\r\n  return updateActors();\r\n};\r\n\r\nexport default {\r\n  parseDirective,\r\n  getConfig: () => configApi.getConfig().journey,\r\n  clear,\r\n  setTitle,\r\n  getTitle,\r\n  setAccDescription,\r\n  getAccDescription,\r\n  addSection,\r\n  getSections,\r\n  getTasks,\r\n  addTask,\r\n  addTaskOrg,\r\n  getActors,\r\n};\r\n","import { select } from 'd3';\r\nimport { parser } from './parser/journey';\r\nimport journeyDb from './journeyDb';\r\nimport svgDraw from './svgDraw';\r\nimport { getConfig } from '../../config';\r\nimport { configureSvgSize } from '../../utils';\r\nimport addSVGAccessibilityFields from '../../accessibility';\r\n\r\nparser.yy = journeyDb;\r\n\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n\r\n  keys.forEach(function (key) {\r\n    conf[key] = cnf[key];\r\n  });\r\n};\r\n\r\nconst actors = {};\r\n\r\n/** @param {any} diagram */\r\nfunction drawActorLegend(diagram) {\r\n  const conf = getConfig().journey;\r\n  // Draw the actors\r\n  let yPos = 60;\r\n  Object.keys(actors).forEach((person) => {\r\n    const colour = actors[person].color;\r\n\r\n    const circleData = {\r\n      cx: 20,\r\n      cy: yPos,\r\n      r: 7,\r\n      fill: colour,\r\n      stroke: '#000',\r\n      pos: actors[person].position,\r\n    };\r\n    svgDraw.drawCircle(diagram, circleData);\r\n\r\n    const labelData = {\r\n      x: 40,\r\n      y: yPos + 7,\r\n      fill: '#666',\r\n      text: person,\r\n      textMargin: conf.boxTextMargin | 5,\r\n    };\r\n    svgDraw.drawText(diagram, labelData);\r\n\r\n    yPos += 20;\r\n  });\r\n}\r\nconst conf = getConfig().journey;\r\nconst LEFT_MARGIN = getConfig().journey.leftMargin;\r\nexport const draw = function (text, id) {\r\n  const conf = getConfig().journey;\r\n  parser.yy.clear();\r\n  parser.parse(text + '\\n');\r\n\r\n  const securityLevel = getConfig().securityLevel;\r\n  // Handle root and ocument for when rendering in sanbox mode\r\n  let sandboxElement;\r\n  if (securityLevel === 'sandbox') {\r\n    sandboxElement = select('#i' + id);\r\n  }\r\n  const root =\r\n    securityLevel === 'sandbox'\r\n      ? select(sandboxElement.nodes()[0].contentDocument.body)\r\n      : select('body');\r\n  const doc = securityLevel === 'sandbox' ? sandboxElement.nodes()[0].contentDocument : document;\r\n\r\n  bounds.init();\r\n  const diagram = root.select('#' + id);\r\n  diagram.attr('xmlns:xlink', 'http://www.w3.org/1999/xlink');\r\n\r\n  svgDraw.initGraphics(diagram);\r\n\r\n  const tasks = parser.yy.getTasks();\r\n  const title = parser.yy.getTitle();\r\n\r\n  const actorNames = parser.yy.getActors();\r\n  for (let member in actors) delete actors[member];\r\n  let actorPos = 0;\r\n  actorNames.forEach((actorName) => {\r\n    actors[actorName] = {\r\n      color: conf.actorColours[actorPos % conf.actorColours.length],\r\n      position: actorPos,\r\n    };\r\n    actorPos++;\r\n  });\r\n\r\n  drawActorLegend(diagram);\r\n  bounds.insert(0, 0, LEFT_MARGIN, Object.keys(actors).length * 50);\r\n  drawTasks(diagram, tasks, 0);\r\n\r\n  const box = bounds.getBounds();\r\n  if (title) {\r\n    diagram\r\n      .append('text')\r\n      .text(title)\r\n      .attr('x', LEFT_MARGIN)\r\n      .attr('font-size', '4ex')\r\n      .attr('font-weight', 'bold')\r\n      .attr('y', 25);\r\n  }\r\n\r\n  const height = box.stopy - box.starty + 2 * conf.diagramMarginY;\r\n  const width = LEFT_MARGIN + box.stopx + 2 * conf.diagramMarginX;\r\n\r\n  configureSvgSize(diagram, height, width, conf.useMaxWidth);\r\n\r\n  // Draw activity line\r\n  diagram\r\n    .append('line')\r\n    .attr('x1', LEFT_MARGIN)\r\n    .attr('y1', conf.height * 4) // One section head + one task + margins\r\n    .attr('x2', width - LEFT_MARGIN - 4) // Subtract stroke width so arrow point is retained\r\n    .attr('y2', conf.height * 4)\r\n    .attr('stroke-width', 4)\r\n    .attr('stroke', 'black')\r\n    .attr('marker-end', 'url(#arrowhead)');\r\n\r\n  const extraVertForTitle = title ? 70 : 0;\r\n  diagram.attr('viewBox', `${box.startx} -25 ${width} ${height + extraVertForTitle}`);\r\n  diagram.attr('preserveAspectRatio', 'xMinYMin meet');\r\n  diagram.attr('height', height + extraVertForTitle + 25);\r\n\r\n  addSVGAccessibilityFields(parser.yy, diagram, id);\r\n};\r\n\r\nexport const bounds = {\r\n  data: {\r\n    startx: undefined,\r\n    stopx: undefined,\r\n    starty: undefined,\r\n    stopy: undefined,\r\n  },\r\n  verticalPos: 0,\r\n\r\n  sequenceItems: [],\r\n  init: function () {\r\n    this.sequenceItems = [];\r\n    this.data = {\r\n      startx: undefined,\r\n      stopx: undefined,\r\n      starty: undefined,\r\n      stopy: undefined,\r\n    };\r\n    this.verticalPos = 0;\r\n  },\r\n  updateVal: function (obj, key, val, fun) {\r\n    if (typeof obj[key] === 'undefined') {\r\n      obj[key] = val;\r\n    } else {\r\n      obj[key] = fun(val, obj[key]);\r\n    }\r\n  },\r\n  updateBounds: function (startx, starty, stopx, stopy) {\r\n    const conf = getConfig().journey;\r\n    const _self = this;\r\n    let cnt = 0;\r\n    /** @param {any} type */\r\n    function updateFn(type) {\r\n      return function updateItemBounds(item) {\r\n        cnt++;\r\n        // The loop sequenceItems is a stack so the biggest margins in the beginning of the sequenceItems\r\n        const n = _self.sequenceItems.length - cnt + 1;\r\n        _self.updateVal(item, 'starty', starty - n * conf.boxMargin, Math.min);\r\n        _self.updateVal(item, 'stopy', stopy + n * conf.boxMargin, Math.max);\r\n\r\n        _self.updateVal(bounds.data, 'startx', startx - n * conf.boxMargin, Math.min);\r\n        _self.updateVal(bounds.data, 'stopx', stopx + n * conf.boxMargin, Math.max);\r\n\r\n        if (!(type === 'activation')) {\r\n          _self.updateVal(item, 'startx', startx - n * conf.boxMargin, Math.min);\r\n          _self.updateVal(item, 'stopx', stopx + n * conf.boxMargin, Math.max);\r\n\r\n          _self.updateVal(bounds.data, 'starty', starty - n * conf.boxMargin, Math.min);\r\n          _self.updateVal(bounds.data, 'stopy', stopy + n * conf.boxMargin, Math.max);\r\n        }\r\n      };\r\n    }\r\n\r\n    this.sequenceItems.forEach(updateFn());\r\n  },\r\n  insert: function (startx, starty, stopx, stopy) {\r\n    const _startx = Math.min(startx, stopx);\r\n    const _stopx = Math.max(startx, stopx);\r\n    const _starty = Math.min(starty, stopy);\r\n    const _stopy = Math.max(starty, stopy);\r\n\r\n    this.updateVal(bounds.data, 'startx', _startx, Math.min);\r\n    this.updateVal(bounds.data, 'starty', _starty, Math.min);\r\n    this.updateVal(bounds.data, 'stopx', _stopx, Math.max);\r\n    this.updateVal(bounds.data, 'stopy', _stopy, Math.max);\r\n\r\n    this.updateBounds(_startx, _starty, _stopx, _stopy);\r\n  },\r\n  bumpVerticalPos: function (bump) {\r\n    this.verticalPos = this.verticalPos + bump;\r\n    this.data.stopy = this.verticalPos;\r\n  },\r\n  getVerticalPos: function () {\r\n    return this.verticalPos;\r\n  },\r\n  getBounds: function () {\r\n    return this.data;\r\n  },\r\n};\r\n\r\nconst fills = conf.sectionFills;\r\nconst textColours = conf.sectionColours;\r\n\r\nexport const drawTasks = function (diagram, tasks, verticalPos) {\r\n  const conf = getConfig().journey;\r\n  let lastSection = '';\r\n  const sectionVHeight = conf.height * 2 + conf.diagramMarginY;\r\n  const taskPos = verticalPos + sectionVHeight;\r\n\r\n  let sectionNumber = 0;\r\n  let fill = '#CCC';\r\n  let colour = 'black';\r\n  let num = 0;\r\n\r\n  // Draw the tasks\r\n  for (let i = 0; i < tasks.length; i++) {\r\n    let task = tasks[i];\r\n    if (lastSection !== task.section) {\r\n      fill = fills[sectionNumber % fills.length];\r\n      num = sectionNumber % fills.length;\r\n      colour = textColours[sectionNumber % textColours.length];\r\n\r\n      const section = {\r\n        x: i * conf.taskMargin + i * conf.width + LEFT_MARGIN,\r\n        y: 50,\r\n        text: task.section,\r\n        fill,\r\n        num,\r\n        colour,\r\n      };\r\n\r\n      svgDraw.drawSection(diagram, section, conf);\r\n      lastSection = task.section;\r\n      sectionNumber++;\r\n    }\r\n\r\n    // Collect the actors involved in the task\r\n    const taskActors = task.people.reduce((acc, actorName) => {\r\n      if (actors[actorName]) {\r\n        acc[actorName] = actors[actorName];\r\n      }\r\n\r\n      return acc;\r\n    }, {});\r\n\r\n    // Add some rendering data to the object\r\n    task.x = i * conf.taskMargin + i * conf.width + LEFT_MARGIN;\r\n    task.y = taskPos;\r\n    task.width = conf.diagramMarginX;\r\n    task.height = conf.diagramMarginY;\r\n    task.colour = colour;\r\n    task.fill = fill;\r\n    task.num = num;\r\n    task.actors = taskActors;\r\n\r\n    // Draw the box with the attached line\r\n    svgDraw.drawTask(diagram, task, conf);\r\n    bounds.insert(task.x, task.y, task.x + task.width + conf.taskMargin, 300 + 5 * 30); // stopy is the length of the descenders.\r\n  }\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","const getStyles = (options) =>\r\n  `.label {\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n    color: ${options.textColor};\r\n  }\r\n  .mouth {\r\n    stroke: #666;\r\n  }\r\n\r\n  line {\r\n    stroke: ${options.textColor}\r\n  }\r\n\r\n  .legend {\r\n    fill: ${options.textColor};\r\n  }\r\n\r\n  .label text {\r\n    fill: #333;\r\n  }\r\n  .label {\r\n    color: ${options.textColor}\r\n  }\r\n\r\n  .face {\r\n    ${options.faceColor ? `fill: ${options.faceColor}` : 'fill: #FFF8DC'};\r\n    stroke: #999;\r\n  }\r\n\r\n  .node rect,\r\n  .node circle,\r\n  .node ellipse,\r\n  .node polygon,\r\n  .node path {\r\n    fill: ${options.mainBkg};\r\n    stroke: ${options.nodeBorder};\r\n    stroke-width: 1px;\r\n  }\r\n\r\n  .node .label {\r\n    text-align: center;\r\n  }\r\n  .node.clickable {\r\n    cursor: pointer;\r\n  }\r\n\r\n  .arrowheadPath {\r\n    fill: ${options.arrowheadColor};\r\n  }\r\n\r\n  .edgePath .path {\r\n    stroke: ${options.lineColor};\r\n    stroke-width: 1.5px;\r\n  }\r\n\r\n  .flowchart-link {\r\n    stroke: ${options.lineColor};\r\n    fill: none;\r\n  }\r\n\r\n  .edgeLabel {\r\n    background-color: ${options.edgeLabelBackground};\r\n    rect {\r\n      opacity: 0.5;\r\n    }\r\n    text-align: center;\r\n  }\r\n\r\n  .cluster rect {\r\n  }\r\n\r\n  .cluster text {\r\n    fill: ${options.titleColor};\r\n  }\r\n\r\n  div.mermaidTooltip {\r\n    position: absolute;\r\n    text-align: center;\r\n    max-width: 200px;\r\n    padding: 2px;\r\n    font-family: 'trebuchet ms', verdana, arial, sans-serif;\r\n    font-family: var(--mermaid-font-family);\r\n    font-size: 12px;\r\n    background: ${options.tertiaryColor};\r\n    border: 1px solid ${options.border2};\r\n    border-radius: 2px;\r\n    pointer-events: none;\r\n    z-index: 100;\r\n  }\r\n\r\n  .task-type-0, .section-type-0  {\r\n    ${options.fillType0 ? `fill: ${options.fillType0}` : ''};\r\n  }\r\n  .task-type-1, .section-type-1  {\r\n    ${options.fillType0 ? `fill: ${options.fillType1}` : ''};\r\n  }\r\n  .task-type-2, .section-type-2  {\r\n    ${options.fillType0 ? `fill: ${options.fillType2}` : ''};\r\n  }\r\n  .task-type-3, .section-type-3  {\r\n    ${options.fillType0 ? `fill: ${options.fillType3}` : ''};\r\n  }\r\n  .task-type-4, .section-type-4  {\r\n    ${options.fillType0 ? `fill: ${options.fillType4}` : ''};\r\n  }\r\n  .task-type-5, .section-type-5  {\r\n    ${options.fillType0 ? `fill: ${options.fillType5}` : ''};\r\n  }\r\n  .task-type-6, .section-type-6  {\r\n    ${options.fillType0 ? `fill: ${options.fillType6}` : ''};\r\n  }\r\n  .task-type-7, .section-type-7  {\r\n    ${options.fillType0 ? `fill: ${options.fillType7}` : ''};\r\n  }\r\n\r\n  .actor-0 {\r\n    ${options.actor0 ? `fill: ${options.actor0}` : ''};\r\n  }\r\n  .actor-1 {\r\n    ${options.actor1 ? `fill: ${options.actor1}` : ''};\r\n  }\r\n  .actor-2 {\r\n    ${options.actor2 ? `fill: ${options.actor2}` : ''};\r\n  }\r\n  .actor-3 {\r\n    ${options.actor3 ? `fill: ${options.actor3}` : ''};\r\n  }\r\n  .actor-4 {\r\n    ${options.actor4 ? `fill: ${options.actor4}` : ''};\r\n  }\r\n  .actor-5 {\r\n    ${options.actor5 ? `fill: ${options.actor5}` : ''};\r\n  }\r\n\r\n  }\r\n`;\r\n\r\nexport default getStyles;\r\n","import { arc as d3arc } from 'd3';\r\n\r\nexport const drawRect = function (elem, rectData) {\r\n  const rectElem = elem.append('rect');\r\n  rectElem.attr('x', rectData.x);\r\n  rectElem.attr('y', rectData.y);\r\n  rectElem.attr('fill', rectData.fill);\r\n  rectElem.attr('stroke', rectData.stroke);\r\n  rectElem.attr('width', rectData.width);\r\n  rectElem.attr('height', rectData.height);\r\n  rectElem.attr('rx', rectData.rx);\r\n  rectElem.attr('ry', rectData.ry);\r\n\r\n  if (typeof rectData.class !== 'undefined') {\r\n    rectElem.attr('class', rectData.class);\r\n  }\r\n\r\n  return rectElem;\r\n};\r\n\r\nexport const drawFace = function (element, faceData) {\r\n  const radius = 15;\r\n  const circleElement = element\r\n    .append('circle')\r\n    .attr('cx', faceData.cx)\r\n    .attr('cy', faceData.cy)\r\n    .attr('class', 'face')\r\n    .attr('r', radius)\r\n    .attr('stroke-width', 2)\r\n    .attr('overflow', 'visible');\r\n\r\n  const face = element.append('g');\r\n\r\n  //left eye\r\n  face\r\n    .append('circle')\r\n    .attr('cx', faceData.cx - radius / 3)\r\n    .attr('cy', faceData.cy - radius / 3)\r\n    .attr('r', 1.5)\r\n    .attr('stroke-width', 2)\r\n    .attr('fill', '#666')\r\n    .attr('stroke', '#666');\r\n\r\n  //right eye\r\n  face\r\n    .append('circle')\r\n    .attr('cx', faceData.cx + radius / 3)\r\n    .attr('cy', faceData.cy - radius / 3)\r\n    .attr('r', 1.5)\r\n    .attr('stroke-width', 2)\r\n    .attr('fill', '#666')\r\n    .attr('stroke', '#666');\r\n\r\n  /** @param {any} face */\r\n  function smile(face) {\r\n    const arc = d3arc()\r\n      .startAngle(Math.PI / 2)\r\n      .endAngle(3 * (Math.PI / 2))\r\n      .innerRadius(radius / 2)\r\n      .outerRadius(radius / 2.2);\r\n    //mouth\r\n    face\r\n      .append('path')\r\n      .attr('class', 'mouth')\r\n      .attr('d', arc)\r\n      .attr('transform', 'translate(' + faceData.cx + ',' + (faceData.cy + 2) + ')');\r\n  }\r\n\r\n  /** @param {any} face */\r\n  function sad(face) {\r\n    const arc = d3arc()\r\n      .startAngle((3 * Math.PI) / 2)\r\n      .endAngle(5 * (Math.PI / 2))\r\n      .innerRadius(radius / 2)\r\n      .outerRadius(radius / 2.2);\r\n    //mouth\r\n    face\r\n      .append('path')\r\n      .attr('class', 'mouth')\r\n      .attr('d', arc)\r\n      .attr('transform', 'translate(' + faceData.cx + ',' + (faceData.cy + 7) + ')');\r\n  }\r\n\r\n  /** @param {any} face */\r\n  function ambivalent(face) {\r\n    face\r\n      .append('line')\r\n      .attr('class', 'mouth')\r\n      .attr('stroke', 2)\r\n      .attr('x1', faceData.cx - 5)\r\n      .attr('y1', faceData.cy + 7)\r\n      .attr('x2', faceData.cx + 5)\r\n      .attr('y2', faceData.cy + 7)\r\n      .attr('class', 'mouth')\r\n      .attr('stroke-width', '1px')\r\n      .attr('stroke', '#666');\r\n  }\r\n\r\n  if (faceData.score > 3) {\r\n    smile(face);\r\n  } else if (faceData.score < 3) {\r\n    sad(face);\r\n  } else {\r\n    ambivalent(face);\r\n  }\r\n\r\n  return circleElement;\r\n};\r\n\r\nexport const drawCircle = function (element, circleData) {\r\n  const circleElement = element.append('circle');\r\n  circleElement.attr('cx', circleData.cx);\r\n  circleElement.attr('cy', circleData.cy);\r\n  circleElement.attr('class', 'actor-' + circleData.pos);\r\n  circleElement.attr('fill', circleData.fill);\r\n  circleElement.attr('stroke', circleData.stroke);\r\n  circleElement.attr('r', circleData.r);\r\n\r\n  if (typeof circleElement.class !== 'undefined') {\r\n    circleElement.attr('class', circleElement.class);\r\n  }\r\n\r\n  if (typeof circleData.title !== 'undefined') {\r\n    circleElement.append('title').text(circleData.title);\r\n  }\r\n\r\n  return circleElement;\r\n};\r\n\r\nexport const drawText = function (elem, textData) {\r\n  // Remove and ignore br:s\r\n  const nText = textData.text.replace(/<br\\s*\\/?>/gi, ' ');\r\n\r\n  const textElem = elem.append('text');\r\n  textElem.attr('x', textData.x);\r\n  textElem.attr('y', textData.y);\r\n  textElem.attr('class', 'legend');\r\n\r\n  textElem.style('text-anchor', textData.anchor);\r\n\r\n  if (typeof textData.class !== 'undefined') {\r\n    textElem.attr('class', textData.class);\r\n  }\r\n\r\n  const span = textElem.append('tspan');\r\n  span.attr('x', textData.x + textData.textMargin * 2);\r\n  span.text(nText);\r\n\r\n  return textElem;\r\n};\r\n\r\nexport const drawLabel = function (elem, txtObject) {\r\n  /**\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} cut\r\n   */\r\n  function genPoints(x, y, width, height, cut) {\r\n    return (\r\n      x +\r\n      ',' +\r\n      y +\r\n      ' ' +\r\n      (x + width) +\r\n      ',' +\r\n      y +\r\n      ' ' +\r\n      (x + width) +\r\n      ',' +\r\n      (y + height - cut) +\r\n      ' ' +\r\n      (x + width - cut * 1.2) +\r\n      ',' +\r\n      (y + height) +\r\n      ' ' +\r\n      x +\r\n      ',' +\r\n      (y + height)\r\n    );\r\n  }\r\n  const polygon = elem.append('polygon');\r\n  polygon.attr('points', genPoints(txtObject.x, txtObject.y, 50, 20, 7));\r\n  polygon.attr('class', 'labelBox');\r\n\r\n  txtObject.y = txtObject.y + txtObject.labelMargin;\r\n  txtObject.x = txtObject.x + 0.5 * txtObject.labelMargin;\r\n  drawText(elem, txtObject);\r\n};\r\n\r\nexport const drawSection = function (elem, section, conf) {\r\n  const g = elem.append('g');\r\n\r\n  const rect = getNoteRect();\r\n  rect.x = section.x;\r\n  rect.y = section.y;\r\n  rect.fill = section.fill;\r\n  rect.width = conf.width;\r\n  rect.height = conf.height;\r\n  rect.class = 'journey-section section-type-' + section.num;\r\n  rect.rx = 3;\r\n  rect.ry = 3;\r\n  drawRect(g, rect);\r\n\r\n  _drawTextCandidateFunc(conf)(\r\n    section.text,\r\n    g,\r\n    rect.x,\r\n    rect.y,\r\n    rect.width,\r\n    rect.height,\r\n    { class: 'journey-section section-type-' + section.num },\r\n    conf,\r\n    section.colour\r\n  );\r\n};\r\n\r\nlet taskCount = -1;\r\n/**\r\n * Draws an actor in the diagram with the attaced line\r\n *\r\n * @param {any} elem The HTML element\r\n * @param {any} task The task to render\r\n * @param {any} conf The global configuration\r\n */\r\nexport const drawTask = function (elem, task, conf) {\r\n  const center = task.x + conf.width / 2;\r\n  const g = elem.append('g');\r\n  taskCount++;\r\n  const maxHeight = 300 + 5 * 30;\r\n  g.append('line')\r\n    .attr('id', 'task' + taskCount)\r\n    .attr('x1', center)\r\n    .attr('y1', task.y)\r\n    .attr('x2', center)\r\n    .attr('y2', maxHeight)\r\n    .attr('class', 'task-line')\r\n    .attr('stroke-width', '1px')\r\n    .attr('stroke-dasharray', '4 2')\r\n    .attr('stroke', '#666');\r\n\r\n  drawFace(g, {\r\n    cx: center,\r\n    cy: 300 + (5 - task.score) * 30,\r\n    score: task.score,\r\n  });\r\n\r\n  const rect = getNoteRect();\r\n  rect.x = task.x;\r\n  rect.y = task.y;\r\n  rect.fill = task.fill;\r\n  rect.width = conf.width;\r\n  rect.height = conf.height;\r\n  rect.class = 'task task-type-' + task.num;\r\n  rect.rx = 3;\r\n  rect.ry = 3;\r\n  drawRect(g, rect);\r\n\r\n  let xPos = task.x + 14;\r\n  task.people.forEach((person) => {\r\n    const colour = task.actors[person].color;\r\n\r\n    const circle = {\r\n      cx: xPos,\r\n      cy: task.y,\r\n      r: 7,\r\n      fill: colour,\r\n      stroke: '#000',\r\n      title: person,\r\n      pos: task.actors[person].position,\r\n    };\r\n\r\n    drawCircle(g, circle);\r\n    xPos += 10;\r\n  });\r\n\r\n  _drawTextCandidateFunc(conf)(\r\n    task.task,\r\n    g,\r\n    rect.x,\r\n    rect.y,\r\n    rect.width,\r\n    rect.height,\r\n    { class: 'task' },\r\n    conf,\r\n    task.colour\r\n  );\r\n};\r\n\r\n/**\r\n * Draws a background rectangle\r\n *\r\n * @param {any} elem The html element\r\n * @param {any} bounds The bounds of the drawing\r\n */\r\nexport const drawBackgroundRect = function (elem, bounds) {\r\n  const rectElem = drawRect(elem, {\r\n    x: bounds.startx,\r\n    y: bounds.starty,\r\n    width: bounds.stopx - bounds.startx,\r\n    height: bounds.stopy - bounds.starty,\r\n    fill: bounds.fill,\r\n    class: 'rect',\r\n  });\r\n  rectElem.lower();\r\n};\r\n\r\nexport const getTextObj = function () {\r\n  return {\r\n    x: 0,\r\n    y: 0,\r\n    fill: undefined,\r\n    'text-anchor': 'start',\r\n    width: 100,\r\n    height: 100,\r\n    textMargin: 0,\r\n    rx: 0,\r\n    ry: 0,\r\n  };\r\n};\r\n\r\nexport const getNoteRect = function () {\r\n  return {\r\n    x: 0,\r\n    y: 0,\r\n    width: 100,\r\n    anchor: 'start',\r\n    height: 100,\r\n    rx: 0,\r\n    ry: 0,\r\n  };\r\n};\r\n\r\nconst _drawTextCandidateFunc = (function () {\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} colour\r\n   */\r\n  function byText(content, g, x, y, width, height, textAttrs, colour) {\r\n    const text = g\r\n      .append('text')\r\n      .attr('x', x + width / 2)\r\n      .attr('y', y + height / 2 + 5)\r\n      .style('font-color', colour)\r\n      .style('text-anchor', 'middle')\r\n      .text(content);\r\n    _setTextAttrs(text, textAttrs);\r\n  }\r\n\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} conf\r\n   * @param {any} colour\r\n   */\r\n  function byTspan(content, g, x, y, width, height, textAttrs, conf, colour) {\r\n    const { taskFontSize, taskFontFamily } = conf;\r\n\r\n    const lines = content.split(/<br\\s*\\/?>/gi);\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const dy = i * taskFontSize - (taskFontSize * (lines.length - 1)) / 2;\r\n      const text = g\r\n        .append('text')\r\n        .attr('x', x + width / 2)\r\n        .attr('y', y)\r\n        .attr('fill', colour)\r\n        .style('text-anchor', 'middle')\r\n        .style('font-size', taskFontSize)\r\n        .style('font-family', taskFontFamily);\r\n      text\r\n        .append('tspan')\r\n        .attr('x', x + width / 2)\r\n        .attr('dy', dy)\r\n        .text(lines[i]);\r\n\r\n      text\r\n        .attr('y', y + height / 2.0)\r\n        .attr('dominant-baseline', 'central')\r\n        .attr('alignment-baseline', 'central');\r\n\r\n      _setTextAttrs(text, textAttrs);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {any} content\r\n   * @param {any} g\r\n   * @param {any} x\r\n   * @param {any} y\r\n   * @param {any} width\r\n   * @param {any} height\r\n   * @param {any} textAttrs\r\n   * @param {any} conf\r\n   */\r\n  function byFo(content, g, x, y, width, height, textAttrs, conf) {\r\n    const body = g.append('switch');\r\n    const f = body\r\n      .append('foreignObject')\r\n      .attr('x', x)\r\n      .attr('y', y)\r\n      .attr('width', width)\r\n      .attr('height', height)\r\n      .attr('position', 'fixed');\r\n\r\n    const text = f\r\n      .append('xhtml:div')\r\n      .style('display', 'table')\r\n      .style('height', '100%')\r\n      .style('width', '100%');\r\n\r\n    text\r\n      .append('div')\r\n      .attr('class', 'label')\r\n      .style('display', 'table-cell')\r\n      .style('text-align', 'center')\r\n      .style('vertical-align', 'middle')\r\n      .text(content);\r\n\r\n    byTspan(content, body, x, y, width, height, textAttrs, conf);\r\n    _setTextAttrs(text, textAttrs);\r\n  }\r\n\r\n  /**\r\n   * @param {any} toText\r\n   * @param {any} fromTextAttrsDict\r\n   */\r\n  function _setTextAttrs(toText, fromTextAttrsDict) {\r\n    for (const key in fromTextAttrsDict) {\r\n      if (key in fromTextAttrsDict) {\r\n        // eslint-disable-line\r\n        // noinspection JSUnfilteredForInLoop\r\n        toText.attr(key, fromTextAttrsDict[key]);\r\n      }\r\n    }\r\n  }\r\n\r\n  return function (conf) {\r\n    return conf.textPlacement === 'fo' ? byFo : conf.textPlacement === 'old' ? byText : byTspan;\r\n  };\r\n})();\r\n\r\nconst initGraphics = function (graphics) {\r\n  graphics\r\n    .append('defs')\r\n    .append('marker')\r\n    .attr('id', 'arrowhead')\r\n    .attr('refX', 5)\r\n    .attr('refY', 2)\r\n    .attr('markerWidth', 6)\r\n    .attr('markerHeight', 4)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n    .attr('d', 'M 0,0 V 4 L6,2 Z'); // this is actual shape for arrowhead\r\n};\r\n\r\nexport default {\r\n  drawRect,\r\n  drawCircle,\r\n  drawSection,\r\n  drawText,\r\n  drawLabel,\r\n  drawTask,\r\n  drawBackgroundRect,\r\n  getTextObj,\r\n  getNoteRect,\r\n  initGraphics,\r\n};\r\n","/** Created by knut on 14-12-11. */\r\nimport { select } from 'd3';\r\nimport { log } from './logger';\r\n\r\nconst conf = {};\r\n\r\n/**\r\n * Merges the value of `conf` with the passed `cnf`\r\n *\r\n * @param {object} cnf Config to merge\r\n */\r\nexport const setConf = function (cnf) {\r\n  const keys = Object.keys(cnf);\r\n\r\n  keys.forEach(function (key) {\r\n    conf[key] = cnf[key];\r\n  });\r\n};\r\n\r\n/**\r\n * Draws a an info picture in the tag with id: id based on the graph definition in text.\r\n *\r\n * @param {string} id The text for the error\r\n * @param {string} ver The version\r\n */\r\nexport const draw = (id, ver) => {\r\n  try {\r\n    log.debug('Renering svg for syntax error\\n');\r\n\r\n    const svg = select('#' + id);\r\n\r\n    const g = svg.append('g');\r\n\r\n    g.append('path')\r\n      .attr('class', 'error-icon')\r\n      .attr(\r\n        'd',\r\n        'm411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z'\r\n      );\r\n\r\n    g.append('path')\r\n      .attr('class', 'error-icon')\r\n      .attr(\r\n        'd',\r\n        'm459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z'\r\n      );\r\n\r\n    g.append('path')\r\n      .attr('class', 'error-icon')\r\n      .attr(\r\n        'd',\r\n        'm340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z'\r\n      );\r\n\r\n    g.append('path')\r\n      .attr('class', 'error-icon')\r\n      .attr(\r\n        'd',\r\n        'm400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z'\r\n      );\r\n\r\n    g.append('path')\r\n      .attr('class', 'error-icon')\r\n      .attr(\r\n        'd',\r\n        'm496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z'\r\n      );\r\n\r\n    g.append('path')\r\n      .attr('class', 'error-icon')\r\n      .attr(\r\n        'd',\r\n        'm436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z'\r\n      );\r\n\r\n    g.append('text') // text label for the x axis\r\n      .attr('class', 'error-text')\r\n      .attr('x', 1240)\r\n      .attr('y', 250)\r\n      .attr('font-size', '150px')\r\n      .style('text-anchor', 'middle')\r\n      .text('Syntax error in graph');\r\n    g.append('text') // text label for the x axis\r\n      .attr('class', 'error-text')\r\n      .attr('x', 1050)\r\n      .attr('y', 400)\r\n      .attr('font-size', '100px')\r\n      .style('text-anchor', 'middle')\r\n      .text('mermaid version ' + ver);\r\n\r\n    svg.attr('height', 100);\r\n    svg.attr('width', 400);\r\n    svg.attr('viewBox', '768 0 512 512');\r\n  } catch (e) {\r\n    log.error('Error while rendering info diagram');\r\n    log.error(e.message);\r\n  }\r\n};\r\n\r\nexport default {\r\n  setConf,\r\n  draw,\r\n};\r\n","let interactionFunctions = [];\r\nexport const addFunction = (func) => {\r\n  interactionFunctions.push(func);\r\n};\r\nexport const attachFunctions = () => {\r\n  interactionFunctions.forEach((f) => {\r\n    f();\r\n  });\r\n  interactionFunctions = [];\r\n};\r\n","import moment from 'moment-mini';\r\n\r\n/** @typedef {'debug' | 'info' | 'warn' | 'error' | 'fatal'} LogLevel A log level */\r\n\r\n/** @type {Object<LogLevel, number>} */\r\nexport const LEVELS = {\r\n  debug: 1,\r\n  info: 2,\r\n  warn: 3,\r\n  error: 4,\r\n  fatal: 5,\r\n};\r\n\r\nexport const log = {\r\n  debug: () => {},\r\n  info: () => {},\r\n  warn: () => {},\r\n  error: () => {},\r\n  fatal: () => {},\r\n};\r\n\r\n/**\r\n * Sets a log level\r\n *\r\n * @param {LogLevel} [level=\"fatal\"] The level to set the logging to. Default is `\"fatal\"`\r\n */\r\nexport const setLogLevel = function (level = 'fatal') {\r\n  if (isNaN(level)) {\r\n    level = level.toLowerCase();\r\n    if (LEVELS[level] !== undefined) {\r\n      level = LEVELS[level];\r\n    }\r\n  }\r\n  log.trace = () => {};\r\n  log.debug = () => {};\r\n  log.info = () => {};\r\n  log.warn = () => {};\r\n  log.error = () => {};\r\n  log.fatal = () => {};\r\n  if (level <= LEVELS.fatal) {\r\n    log.fatal = console.error\r\n      ? console.error.bind(console, format('FATAL'), 'color: orange')\r\n      : console.log.bind(console, '\\x1b[35m', format('FATAL'));\r\n  }\r\n  if (level <= LEVELS.error) {\r\n    log.error = console.error\r\n      ? console.error.bind(console, format('ERROR'), 'color: orange')\r\n      : console.log.bind(console, '\\x1b[31m', format('ERROR'));\r\n  }\r\n  if (level <= LEVELS.warn) {\r\n    log.warn = console.warn\r\n      ? console.warn.bind(console, format('WARN'), 'color: orange')\r\n      : console.log.bind(console, `\\x1b[33m`, format('WARN'));\r\n  }\r\n  if (level <= LEVELS.info) {\r\n    log.info = console.info // ? console.info.bind(console, '\\x1b[34m', format('INFO'), 'color: blue')\r\n      ? console.info.bind(console, format('INFO'), 'color: lightblue')\r\n      : console.log.bind(console, '\\x1b[34m', format('INFO'));\r\n  }\r\n  if (level <= LEVELS.debug) {\r\n    log.debug = console.debug\r\n      ? console.debug.bind(console, format('DEBUG'), 'color: lightgreen')\r\n      : console.log.bind(console, '\\x1b[32m', format('DEBUG'));\r\n  }\r\n};\r\n\r\n/**\r\n * Returns a format with the timestamp and the log level\r\n *\r\n * @param {LogLevel} level The level for the log format\r\n * @returns {string} The format with the timestamp and log level\r\n */\r\nconst format = (level) => {\r\n  const time = moment().format('ss.SSS');\r\n  return `%c${time} : ${level} : `;\r\n};\r\n","/**\r\n * Web page integration module for the mermaid framework. It uses the mermaidAPI for mermaid\r\n * functionality and to render the diagrams to svg code.\r\n */\r\nimport { log } from './logger';\r\nimport mermaidAPI from './mermaidAPI';\r\nimport utils from './utils';\r\n\r\n/**\r\n * ## init\r\n *\r\n * Function that goes through the document to find the chart definitions in there and render them.\r\n *\r\n * The function tags the processed attributes with the attribute data-processed and ignores found\r\n * elements with the attribute already set. This way the init function can be triggered several times.\r\n *\r\n * Optionally, `init` can accept in the second argument one of the following:\r\n *\r\n * - A DOM Node\r\n * - An array of DOM nodes (as would come from a jQuery selector)\r\n * - A W3C selector, a la `.mermaid`\r\n *\r\n * ```mermaid\r\n * graph LR;\r\n *  a(Find elements)-->b{Processed}\r\n *  b-->|Yes|c(Leave element)\r\n *  b-->|No |d(Transform)\r\n * ```\r\n *\r\n * Renders the mermaid diagrams\r\n */\r\nconst init = function () {\r\n  try {\r\n    initThrowsErrors();\r\n  } catch (e) {\r\n    log.warn('Syntax Error rendering');\r\n    log.warn(e);\r\n    if (this.parseError) {\r\n      this.parseError(e);\r\n    }\r\n  }\r\n};\r\n\r\nconst initThrowsErrors = function () {\r\n  const conf = mermaidAPI.getConfig();\r\n  // console.log('Starting rendering diagrams (init) - mermaid.init', conf);\r\n  let nodes;\r\n  if (arguments.length >= 2) {\r\n    /*! sequence config was passed as #1 */\r\n    if (typeof arguments[0] !== 'undefined') {\r\n      mermaid.sequenceConfig = arguments[0];\r\n    }\r\n\r\n    nodes = arguments[1];\r\n  } else {\r\n    nodes = arguments[0];\r\n  }\r\n\r\n  // if last argument is a function this is the callback function\r\n  let callback;\r\n  if (typeof arguments[arguments.length - 1] === 'function') {\r\n    callback = arguments[arguments.length - 1];\r\n    log.debug('Callback function found');\r\n  } else {\r\n    if (typeof conf.mermaid !== 'undefined') {\r\n      if (typeof conf.mermaid.callback === 'function') {\r\n        callback = conf.mermaid.callback;\r\n        log.debug('Callback function found');\r\n      } else {\r\n        log.debug('No Callback function found');\r\n      }\r\n    }\r\n  }\r\n  nodes =\r\n    nodes === undefined\r\n      ? document.querySelectorAll('.mermaid')\r\n      : typeof nodes === 'string'\r\n      ? document.querySelectorAll(nodes)\r\n      : nodes instanceof window.Node\r\n      ? [nodes]\r\n      : nodes; // Last case  - sequence config was passed pick next\r\n\r\n  log.debug('Start On Load before: ' + mermaid.startOnLoad);\r\n  if (typeof mermaid.startOnLoad !== 'undefined') {\r\n    log.debug('Start On Load inner: ' + mermaid.startOnLoad);\r\n    mermaidAPI.updateSiteConfig({ startOnLoad: mermaid.startOnLoad });\r\n  }\r\n\r\n  if (typeof mermaid.ganttConfig !== 'undefined') {\r\n    mermaidAPI.updateSiteConfig({ gantt: mermaid.ganttConfig });\r\n  }\r\n\r\n  const idGeneratior = new utils.initIdGeneratior(conf.deterministicIds, conf.deterministicIDSeed);\r\n\r\n  let txt;\r\n\r\n  for (let i = 0; i < nodes.length; i++) {\r\n    // element is the current div with mermaid class\r\n    const element = nodes[i];\r\n\r\n    /*! Check if previously processed */\r\n    if (!element.getAttribute('data-processed')) {\r\n      element.setAttribute('data-processed', true);\r\n    } else {\r\n      continue;\r\n    }\r\n\r\n    const id = `mermaid-${idGeneratior.next()}`;\r\n\r\n    // Fetch the graph definition including tags\r\n    txt = element.innerHTML;\r\n\r\n    // transforms the html to pure text\r\n    txt = utils\r\n      .entityDecode(txt)\r\n      .trim()\r\n      .replace(/<br\\s*\\/?>/gi, '<br/>');\r\n\r\n    const init = utils.detectInit(txt);\r\n    if (init) {\r\n      log.debug('Detected early reinit: ', init);\r\n    }\r\n\r\n    mermaidAPI.render(\r\n      id,\r\n      txt,\r\n      (svgCode, bindFunctions) => {\r\n        element.innerHTML = svgCode;\r\n        if (typeof callback !== 'undefined') {\r\n          callback(id);\r\n        }\r\n        if (bindFunctions) bindFunctions(element);\r\n      },\r\n      element\r\n    );\r\n  }\r\n};\r\n\r\nconst initialize = function (config) {\r\n  // mermaidAPI.reset();\r\n  if (typeof config.mermaid !== 'undefined') {\r\n    if (typeof config.mermaid.startOnLoad !== 'undefined') {\r\n      mermaid.startOnLoad = config.mermaid.startOnLoad;\r\n    }\r\n    if (typeof config.mermaid.htmlLabels !== 'undefined') {\r\n      mermaid.htmlLabels =\r\n        config.mermaid.htmlLabels === 'false' || config.mermaid.htmlLabels === false ? false : true;\r\n    }\r\n  }\r\n  mermaidAPI.initialize(config);\r\n  // mermaidAPI.reset();\r\n};\r\n\r\n/**\r\n * ##contentLoaded Callback function that is called when page is loaded. This functions fetches\r\n * configuration for mermaid rendering and calls init for rendering the mermaid diagrams on the page.\r\n */\r\nconst contentLoaded = function () {\r\n  let config;\r\n\r\n  if (mermaid.startOnLoad) {\r\n    // No config found, do check API config\r\n    config = mermaidAPI.getConfig();\r\n    if (config.startOnLoad) {\r\n      mermaid.init();\r\n    }\r\n  } else {\r\n    if (typeof mermaid.startOnLoad === 'undefined') {\r\n      log.debug('In start, no config');\r\n      config = mermaidAPI.getConfig();\r\n      if (config.startOnLoad) {\r\n        mermaid.init();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nif (typeof document !== 'undefined') {\r\n  /*!\r\n   * Wait for document loaded before starting the execution\r\n   */\r\n  window.addEventListener(\r\n    'load',\r\n    function () {\r\n      contentLoaded();\r\n    },\r\n    false\r\n  );\r\n}\r\n\r\nconst mermaid = {\r\n  startOnLoad: true,\r\n  htmlLabels: true,\r\n\r\n  mermaidAPI,\r\n  parse: mermaidAPI.parse,\r\n  render: mermaidAPI.render,\r\n\r\n  init,\r\n  initialize,\r\n\r\n  contentLoaded,\r\n};\r\n\r\nexport default mermaid;\r\n","/**\r\n * Edit this\r\n * Page[[N|Solid](img/GitHub-Mark-32px.png)](https://github.com/mermaid-js/mermaid/blob/develop/src/mermaidAPI.js)\r\n *\r\n * This is the API to be used when optionally handling the integration with the web page, instead of\r\n * using the default integration provided by mermaid.js.\r\n *\r\n * The core of this api is the [**render**](Setup.md?id=render) function which, given a graph\r\n * definition as text, renders the graph/diagram and returns an svg element for the graph.\r\n *\r\n * It is is then up to the user of the API to make use of the svg, either insert it somewhere in the\r\n * page or do something completely different.\r\n *\r\n * In addition to the render function, a number of behavioral configuration options are available.\r\n *\r\n * @name mermaidAPI\r\n */\r\nimport { select } from 'd3';\r\nimport { compile, serialize, stringify } from 'stylis';\r\nimport pkg from '../package.json';\r\nimport * as configApi from './config';\r\nimport classDb from './diagrams/class/classDb';\r\nimport classRenderer from './diagrams/class/classRenderer';\r\nimport classRendererV2 from './diagrams/class/classRenderer-v2';\r\nimport classParser from './diagrams/class/parser/classDiagram';\r\nimport erDb from './diagrams/er/erDb';\r\nimport erRenderer from './diagrams/er/erRenderer';\r\nimport erParser from './diagrams/er/parser/erDiagram';\r\nimport flowDb from './diagrams/flowchart/flowDb';\r\nimport flowRenderer from './diagrams/flowchart/flowRenderer';\r\nimport flowRendererV2 from './diagrams/flowchart/flowRenderer-v2';\r\nimport flowParser from './diagrams/flowchart/parser/flow';\r\nimport ganttDb from './diagrams/gantt/ganttDb';\r\nimport ganttRenderer from './diagrams/gantt/ganttRenderer';\r\nimport ganttParser from './diagrams/gantt/parser/gantt';\r\nimport gitGraphAst from './diagrams/git/gitGraphAst';\r\nimport gitGraphRenderer from './diagrams/git/gitGraphRenderer';\r\nimport gitGraphParser from './diagrams/git/parser/gitGraph';\r\nimport infoDb from './diagrams/info/infoDb';\r\nimport infoRenderer from './diagrams/info/infoRenderer';\r\nimport infoParser from './diagrams/info/parser/info';\r\nimport pieParser from './diagrams/pie/parser/pie';\r\nimport pieDb from './diagrams/pie/pieDb';\r\nimport pieRenderer from './diagrams/pie/pieRenderer';\r\nimport addSVGAccessibilityFields from './diagrams/pie/pieRenderer';\r\nimport requirementParser from './diagrams/requirement/parser/requirementDiagram';\r\nimport requirementDb from './diagrams/requirement/requirementDb';\r\nimport requirementRenderer from './diagrams/requirement/requirementRenderer';\r\nimport sequenceParser from './diagrams/sequence/parser/sequenceDiagram';\r\nimport sequenceDb from './diagrams/sequence/sequenceDb';\r\nimport sequenceRenderer from './diagrams/sequence/sequenceRenderer';\r\nimport stateParser from './diagrams/state/parser/stateDiagram';\r\nimport stateDb from './diagrams/state/stateDb';\r\nimport stateRenderer from './diagrams/state/stateRenderer';\r\nimport stateRendererV2 from './diagrams/state/stateRenderer-v2';\r\nimport journeyDb from './diagrams/user-journey/journeyDb';\r\nimport journeyRenderer from './diagrams/user-journey/journeyRenderer';\r\nimport journeyParser from './diagrams/user-journey/parser/journey';\r\nimport errorRenderer from './errorRenderer';\r\nimport { attachFunctions } from './interactionDb';\r\nimport { log, setLogLevel } from './logger';\r\nimport getStyles from './styles';\r\nimport theme from './themes';\r\nimport utils, { directiveSanitizer, assignWithDepth, sanitizeCss } from './utils';\r\n\r\n/**\r\n * @param text\r\n * @returns {any}\r\n */\r\nfunction parse(text) {\r\n  const cnf = configApi.getConfig();\r\n  const graphInit = utils.detectInit(text, cnf);\r\n  if (graphInit) {\r\n    reinitialize(graphInit);\r\n    log.info('reinit ', graphInit);\r\n  }\r\n  const graphType = utils.detectType(text, cnf);\r\n  let parser;\r\n\r\n  log.debug('Type ' + graphType);\r\n  switch (graphType) {\r\n    case 'gitGraph':\r\n      parser = gitGraphParser;\r\n      parser.parser.yy = gitGraphAst;\r\n      parser.parser.yy.clear();\r\n      break;\r\n    case 'flowchart':\r\n      flowDb.clear();\r\n      parser = flowParser;\r\n      parser.parser.yy = flowDb;\r\n      break;\r\n    case 'flowchart-v2':\r\n      flowDb.clear();\r\n      parser = flowParser;\r\n      parser.parser.yy = flowDb;\r\n      break;\r\n    case 'sequence':\r\n      sequenceDb.clear();\r\n      parser = sequenceParser;\r\n      parser.parser.yy = sequenceDb;\r\n      break;\r\n    case 'gantt':\r\n      parser = ganttParser;\r\n      parser.parser.yy = ganttDb;\r\n      break;\r\n    case 'class':\r\n      parser = classParser;\r\n      parser.parser.yy = classDb;\r\n      break;\r\n    case 'classDiagram':\r\n      parser = classParser;\r\n      parser.parser.yy = classDb;\r\n      break;\r\n    case 'state':\r\n      parser = stateParser;\r\n      parser.parser.yy = stateDb;\r\n      break;\r\n    case 'stateDiagram':\r\n      parser = stateParser;\r\n      parser.parser.yy = stateDb;\r\n      break;\r\n    case 'info':\r\n      log.debug('info info info');\r\n      parser = infoParser;\r\n      parser.parser.yy = infoDb;\r\n      break;\r\n    case 'pie':\r\n      log.debug('pie');\r\n      parser = pieParser;\r\n      parser.parser.yy = pieDb;\r\n      break;\r\n    case 'er':\r\n      log.debug('er');\r\n      parser = erParser;\r\n      parser.parser.yy = erDb;\r\n      break;\r\n    case 'journey':\r\n      log.debug('Journey');\r\n      parser = journeyParser;\r\n      parser.parser.yy = journeyDb;\r\n      break;\r\n    case 'requirement':\r\n    case 'requirementDiagram':\r\n      log.debug('RequirementDiagram');\r\n      parser = requirementParser;\r\n      parser.parser.yy = requirementDb;\r\n      break;\r\n  }\r\n  parser.parser.yy.graphType = graphType;\r\n  parser.parser.yy.parseError = (str, hash) => {\r\n    const error = { str, hash };\r\n    throw error;\r\n  };\r\n\r\n  parser.parse(text);\r\n  return parser;\r\n}\r\n\r\nexport const encodeEntities = function (text) {\r\n  let txt = text;\r\n\r\n  txt = txt.replace(/style.*:\\S*#.*;/g, function (s) {\r\n    const innerTxt = s.substring(0, s.length - 1);\r\n    return innerTxt;\r\n  });\r\n  txt = txt.replace(/classDef.*:\\S*#.*;/g, function (s) {\r\n    const innerTxt = s.substring(0, s.length - 1);\r\n    return innerTxt;\r\n  });\r\n\r\n  txt = txt.replace(/#\\w+;/g, function (s) {\r\n    const innerTxt = s.substring(1, s.length - 1);\r\n\r\n    const isInt = /^\\+?\\d+$/.test(innerTxt);\r\n    if (isInt) {\r\n      return '' + innerTxt + '';\r\n    } else {\r\n      return '' + innerTxt + '';\r\n    }\r\n  });\r\n\r\n  return txt;\r\n};\r\n\r\nexport const decodeEntities = function (text) {\r\n  let txt = text;\r\n\r\n  txt = txt.replace(//g, function () {\r\n    return '&#';\r\n  });\r\n  txt = txt.replace(//g, function () {\r\n    return '&';\r\n  });\r\n  txt = txt.replace(//g, function () {\r\n    return ';';\r\n  });\r\n\r\n  return txt;\r\n};\r\n/**\r\n * Function that renders an svg with a graph from a chart definition. Usage example below.\r\n *\r\n * ```javascript\r\n * mermaidAPI.initialize({\r\n *   startOnLoad: true,\r\n * });\r\n * $(function () {\r\n *   const graphDefinition = 'graph TB\\na-->b';\r\n *   const cb = function (svgGraph) {\r\n *     console.log(svgGraph);\r\n *   };\r\n *   mermaidAPI.render('id1', graphDefinition, cb);\r\n * });\r\n * ```\r\n *\r\n * @param {any} id The id of the element to be rendered\r\n * @param {any} _txt The graph definition\r\n * @param {any} cb Callback which is called after rendering is finished with the svg code as inparam.\r\n * @param {any} container Selector to element in which a div with the graph temporarily will be\r\n *   inserted. In one is provided a hidden div will be inserted in the body of the page instead. The\r\n *   element will be removed when rendering is completed.\r\n * @returns {any}\r\n */\r\nconst render = function (id, _txt, cb, container) {\r\n  configApi.reset();\r\n  let txt = _txt;\r\n  const graphInit = utils.detectInit(txt);\r\n  if (graphInit) {\r\n    directiveSanitizer(graphInit);\r\n    configApi.addDirective(graphInit);\r\n  }\r\n  let cnf = configApi.getConfig();\r\n\r\n  log.debug(cnf);\r\n\r\n  // Check the maximum allowed text size\r\n  if (_txt.length > cnf.maxTextSize) {\r\n    txt = 'graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa';\r\n  }\r\n\r\n  // let d3Iframe;\r\n  let root = select('body');\r\n\r\n  // In regular execurtion the container will be the div with a mermaid class\r\n  if (typeof container !== 'undefined') {\r\n    if (cnf.securityLevel === 'sandbox') {\r\n      // IF we are in sandboxed mode, we do everyting mermaid related\r\n      // in a sandboxed div\r\n      const iframe = select('body')\r\n        .append('iframe')\r\n        .attr('id', 'i' + id)\r\n        .attr('style', 'width: 100%; height: 100%;')\r\n        .attr('sandbox', '');\r\n      // const iframeBody = ;\r\n      root = select(iframe.nodes()[0].contentDocument.body);\r\n      root.node().style.margin = 0;\r\n    }\r\n\r\n    // A container was provided by the caller\r\n    container.innerHTML = '';\r\n\r\n    if (cnf.securityLevel === 'sandbox') {\r\n      // IF we are in sandboxed mode, we do everyting mermaid related\r\n      // in a sandboxed div\r\n      const iframe = select(container)\r\n        .append('iframe')\r\n        .attr('id', 'i' + id)\r\n        .attr('style', 'width: 100%; height: 100%;')\r\n        .attr('sandbox', '');\r\n      // const iframeBody = ;\r\n      root = select(iframe.nodes()[0].contentDocument.body);\r\n      root.node().style.margin = 0;\r\n    } else {\r\n      root = select(container);\r\n    }\r\n\r\n    root\r\n      .append('div')\r\n      .attr('id', 'd' + id)\r\n      .attr('style', 'font-family: ' + cnf.fontFamily)\r\n      .append('svg')\r\n      .attr('id', id)\r\n      .attr('width', '100%')\r\n      .attr('xmlns', 'http://www.w3.org/2000/svg')\r\n      .append('g');\r\n  } else {\r\n    // No container was provided\r\n    // If there is an existsing element with the id, we remove it\r\n    // this likley a previously rendered diagram\r\n    const existingSvg = document.getElementById(id);\r\n    if (existingSvg) {\r\n      existingSvg.remove();\r\n    }\r\n\r\n    // Remove previous tpm element if it exists\r\n    let element;\r\n    if (cnf.securityLevel !== 'sandbox') {\r\n      element = document.querySelector('#' + 'd' + id);\r\n    } else {\r\n      element = document.querySelector('#' + 'i' + id);\r\n    }\r\n    if (element) {\r\n      element.remove();\r\n    }\r\n\r\n    // if (cnf.securityLevel === 'sandbox') {\r\n    //   const iframe = select('body')\r\n    //     .append('iframe')\r\n    //     .attr('id', 'i' + id)\r\n    //     .attr('sandbox', '');\r\n    //   // const iframeBody = ;\r\n    //   root = select(iframe.nodes()[0].contentDocument.body);\r\n    // }\r\n\r\n    // Add the tmp div used for rendering with the id `d${id}`\r\n    // d+id it will contain a svg with the id \"id\"\r\n\r\n    if (cnf.securityLevel === 'sandbox') {\r\n      // IF we are in sandboxed mode, we do everyting mermaid related\r\n      // in a sandboxed div\r\n      const iframe = select('body')\r\n        .append('iframe')\r\n        .attr('id', 'i' + id)\r\n        .attr('style', 'width: 100%; height: 100%;')\r\n        .attr('sandbox', '');\r\n      // const iframeBody = ;\r\n      root = select(iframe.nodes()[0].contentDocument.body);\r\n      root.node().style.margin = 0;\r\n    } else {\r\n      root = select('body');\r\n    }\r\n\r\n    // This is the temporary div\r\n    root\r\n      .append('div')\r\n      .attr('id', 'd' + id)\r\n      // this is the seed of the svg to be rendered\r\n      .append('svg')\r\n      .attr('id', id)\r\n      .attr('width', '100%')\r\n      .attr('xmlns', 'http://www.w3.org/2000/svg')\r\n      .append('g');\r\n  }\r\n\r\n  txt = encodeEntities(txt);\r\n\r\n  // Get the tmp element containing the the svg\r\n  const element = root.select('#d' + id).node();\r\n  const graphType = utils.detectType(txt, cnf);\r\n\r\n  // insert inline style into svg\r\n  const svg = element.firstChild;\r\n  const firstChild = svg.firstChild;\r\n\r\n  let userStyles = '';\r\n  // user provided theme CSS\r\n  if (cnf.themeCSS !== undefined) {\r\n    userStyles += `\\n${cnf.themeCSS}`;\r\n  }\r\n  // user provided theme CSS\r\n  if (cnf.fontFamily !== undefined) {\r\n    userStyles += `\\n:root { --mermaid-font-family: ${cnf.fontFamily}}`;\r\n  }\r\n  // user provided theme CSS\r\n  if (cnf.altFontFamily !== undefined) {\r\n    userStyles += `\\n:root { --mermaid-alt-font-family: ${cnf.altFontFamily}}`;\r\n  }\r\n\r\n  // classDef\r\n  if (graphType === 'flowchart' || graphType === 'flowchart-v2' || graphType === 'graph') {\r\n    const classes = flowRenderer.getClasses(txt);\r\n    const htmlLabels = cnf.htmlLabels || cnf.flowchart.htmlLabels;\r\n    for (const className in classes) {\r\n      if (htmlLabels) {\r\n        userStyles += `\\n.${className} > * { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n        userStyles += `\\n.${className} span { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n      } else {\r\n        userStyles += `\\n.${className} path { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n        userStyles += `\\n.${className} rect { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n        userStyles += `\\n.${className} polygon { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n        userStyles += `\\n.${className} ellipse { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n        userStyles += `\\n.${className} circle { ${classes[className].styles.join(\r\n          ' !important; '\r\n        )} !important; }`;\r\n        if (classes[className].textStyles) {\r\n          userStyles += `\\n.${className} tspan { ${classes[className].textStyles.join(\r\n            ' !important; '\r\n          )} !important; }`;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // log.warn(cnf.themeVariables);\r\n\r\n  const stylis = (selector, styles) => serialize(compile(`${selector}{${styles}}`), stringify);\r\n  const rules = stylis(`#${id}`, getStyles(graphType, userStyles, cnf.themeVariables));\r\n\r\n  const style1 = document.createElement('style');\r\n  style1.innerHTML = `#${id} ` + rules;\r\n  svg.insertBefore(style1, firstChild);\r\n\r\n  // Verify that the generated svgs are ok before removing this\r\n\r\n  // const style2 = document.createElement('style');\r\n  // const cs = window.getComputedStyle(svg);\r\n  // style2.innerHTML = `#d${id} * {\r\n  //   color: ${cs.color};\r\n  //   // font: ${cs.font};\r\n  //   // font-family: Arial;\r\n  //   // font-size: 24px;\r\n  // }`;\r\n  // svg.insertBefore(style2, firstChild);\r\n\r\n  try {\r\n    switch (graphType) {\r\n      case 'gitGraph':\r\n        // cnf.flowchart.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        //gitGraphRenderer.setConf(cnf.git);\r\n        gitGraphRenderer.draw(txt, id, false);\r\n        break;\r\n      case 'flowchart':\r\n        cnf.flowchart.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        flowRenderer.setConf(cnf.flowchart);\r\n        flowRenderer.draw(txt, id, false);\r\n        break;\r\n      case 'flowchart-v2':\r\n        cnf.flowchart.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        flowRendererV2.setConf(cnf.flowchart);\r\n        flowRendererV2.draw(txt, id, false);\r\n        break;\r\n      case 'sequence':\r\n        cnf.sequence.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        if (cnf.sequenceDiagram) {\r\n          // backwards compatibility\r\n          sequenceRenderer.setConf(Object.assign(cnf.sequence, cnf.sequenceDiagram));\r\n          console.error(\r\n            '`mermaid config.sequenceDiagram` has been renamed to `config.sequence`. Please update your mermaid config.'\r\n          );\r\n        } else {\r\n          sequenceRenderer.setConf(cnf.sequence);\r\n        }\r\n        sequenceRenderer.draw(txt, id);\r\n        break;\r\n      case 'gantt':\r\n        cnf.gantt.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        ganttRenderer.setConf(cnf.gantt);\r\n        ganttRenderer.draw(txt, id);\r\n        break;\r\n      case 'class':\r\n        cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        classRenderer.setConf(cnf.class);\r\n        classRenderer.draw(txt, id);\r\n        break;\r\n      case 'classDiagram':\r\n        cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        classRendererV2.setConf(cnf.class);\r\n        classRendererV2.draw(txt, id);\r\n        break;\r\n      case 'state':\r\n        cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        stateRenderer.setConf(cnf.state);\r\n        stateRenderer.draw(txt, id);\r\n        break;\r\n      case 'stateDiagram':\r\n        cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        stateRendererV2.setConf(cnf.state);\r\n        stateRendererV2.draw(txt, id);\r\n        break;\r\n      case 'info':\r\n        cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        infoRenderer.setConf(cnf.class);\r\n        infoRenderer.draw(txt, id, pkg.version);\r\n        break;\r\n      case 'pie':\r\n        //cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\r\n        //pieRenderer.setConf(cnf.pie);\r\n        pieRenderer.draw(txt, id, pkg.version);\r\n        break;\r\n      case 'er':\r\n        erRenderer.setConf(cnf.er);\r\n        erRenderer.draw(txt, id, pkg.version);\r\n        break;\r\n      case 'journey':\r\n        journeyRenderer.setConf(cnf.journey);\r\n        journeyRenderer.draw(txt, id, pkg.version);\r\n        break;\r\n      case 'requirement':\r\n        requirementRenderer.setConf(cnf.requirement);\r\n        requirementRenderer.draw(txt, id, pkg.version);\r\n        break;\r\n    }\r\n  } catch (e) {\r\n    // errorRenderer.setConf(cnf.class);\r\n    errorRenderer.draw(id, pkg.version);\r\n    throw e;\r\n  }\r\n\r\n  root\r\n    .select(`[id=\"${id}\"]`)\r\n    .selectAll('foreignobject > *')\r\n    .attr('xmlns', 'http://www.w3.org/1999/xhtml');\r\n\r\n  // Fix for when the base tag is used\r\n  let svgCode = root.select('#d' + id).node().innerHTML;\r\n\r\n  log.debug('cnf.arrowMarkerAbsolute', cnf.arrowMarkerAbsolute);\r\n  if (\r\n    (!cnf.arrowMarkerAbsolute || cnf.arrowMarkerAbsolute === 'false') &&\r\n    cnf.arrowMarkerAbsolute !== 'sandbox'\r\n  ) {\r\n    svgCode = svgCode.replace(/marker-end=\"url\\(.*?#/g, 'marker-end=\"url(#', 'g');\r\n  }\r\n\r\n  svgCode = decodeEntities(svgCode);\r\n\r\n  // Fix for when the br tag is used\r\n  svgCode = svgCode.replace(/<br>/g, '<br/>');\r\n\r\n  if (cnf.securityLevel === 'sandbox') {\r\n    let svgEl = root.select('#d' + id + ' svg').node();\r\n    let width = '100%';\r\n    let height = '100%';\r\n    if (svgEl) {\r\n      // width = svgEl.viewBox.baseVal.width + 'px';\r\n      height = svgEl.viewBox.baseVal.height + 'px';\r\n    }\r\n    svgCode = `<iframe style=\"width:${width};height:${height};border:0;margin:0;\" src=\"data:text/html;base64,${btoa(\r\n      '<body style=\"margin:0\">' + svgCode + '</body>'\r\n    )}\" sandbox=\"allow-top-navigation-by-user-activation allow-popups\">\r\n  The iframe tag is not supported by your browser.\r\n</iframe>`;\r\n  }\r\n\r\n  if (typeof cb !== 'undefined') {\r\n    switch (graphType) {\r\n      case 'flowchart':\r\n      case 'flowchart-v2':\r\n        cb(svgCode, flowDb.bindFunctions);\r\n        break;\r\n      case 'gantt':\r\n        cb(svgCode, ganttDb.bindFunctions);\r\n        break;\r\n      case 'class':\r\n      case 'classDiagram':\r\n        cb(svgCode, classDb.bindFunctions);\r\n        break;\r\n      default:\r\n        cb(svgCode);\r\n    }\r\n  } else {\r\n    log.debug('CB = undefined!');\r\n  }\r\n  attachFunctions();\r\n\r\n  const tmpElementSelector = cnf.securityLevel === 'sandbox' ? '#i' + id : '#d' + id;\r\n  const node = select(tmpElementSelector).node();\r\n  if (node !== null && typeof node.remove === 'function') {\r\n    select(tmpElementSelector).node().remove();\r\n  }\r\n\r\n  return svgCode;\r\n};\r\n\r\nlet currentDirective = {};\r\n\r\nconst parseDirective = function (p, statement, context, type) {\r\n  try {\r\n    if (statement !== undefined) {\r\n      statement = statement.trim();\r\n      switch (context) {\r\n        case 'open_directive':\r\n          currentDirective = {};\r\n          break;\r\n        case 'type_directive':\r\n          currentDirective.type = statement.toLowerCase();\r\n          break;\r\n        case 'arg_directive':\r\n          currentDirective.args = JSON.parse(statement);\r\n          break;\r\n        case 'close_directive':\r\n          handleDirective(p, currentDirective, type);\r\n          currentDirective = null;\r\n          break;\r\n      }\r\n    }\r\n  } catch (error) {\r\n    log.error(\r\n      `Error while rendering sequenceDiagram directive: ${statement} jison context: ${context}`\r\n    );\r\n    log.error(error.message);\r\n  }\r\n};\r\n\r\nconst handleDirective = function (p, directive, type) {\r\n  log.debug(`Directive type=${directive.type} with args:`, directive.args);\r\n  switch (directive.type) {\r\n    case 'init':\r\n    case 'initialize': {\r\n      ['config'].forEach((prop) => {\r\n        if (typeof directive.args[prop] !== 'undefined') {\r\n          if (type === 'flowchart-v2') {\r\n            type = 'flowchart';\r\n          }\r\n          directive.args[type] = directive.args[prop];\r\n          delete directive.args[prop];\r\n        }\r\n      });\r\n      log.debug('sanitize in handleDirective', directive.args);\r\n      directiveSanitizer(directive.args);\r\n      log.debug('sanitize in handleDirective (done)', directive.args);\r\n      reinitialize(directive.args);\r\n      configApi.addDirective(directive.args);\r\n      break;\r\n    }\r\n    case 'wrap':\r\n    case 'nowrap':\r\n      if (p && p['setWrap']) {\r\n        p.setWrap(directive.type === 'wrap');\r\n      }\r\n      break;\r\n    case 'themeCss':\r\n      log.warn('themeCss encountered');\r\n      break;\r\n    default:\r\n      log.warn(\r\n        `Unhandled directive: source: '%%{${directive.type}: ${JSON.stringify(\r\n          directive.args ? directive.args : {}\r\n        )}}%%`,\r\n        directive\r\n      );\r\n      break;\r\n  }\r\n};\r\n\r\n/** @param {any} conf */\r\nfunction updateRendererConfigs(conf) {\r\n  // Todo remove, all diagrams should get config on demoand from the config object, no need for this\r\n\r\n  // gitGraphRenderer.setConf(conf.git); // Todo Remove all  of these\r\n  flowRenderer.setConf(conf.flowchart);\r\n  flowRendererV2.setConf(conf.flowchart);\r\n  if (typeof conf['sequenceDiagram'] !== 'undefined') {\r\n    sequenceRenderer.setConf(assignWithDepth(conf.sequence, conf['sequenceDiagram']));\r\n  }\r\n  sequenceRenderer.setConf(conf.sequence);\r\n  ganttRenderer.setConf(conf.gantt);\r\n  classRenderer.setConf(conf.class);\r\n  stateRenderer.setConf(conf.state);\r\n  stateRendererV2.setConf(conf.state);\r\n  infoRenderer.setConf(conf.class);\r\n  // pieRenderer.setConf(conf.class);\r\n  erRenderer.setConf(conf.er);\r\n  journeyRenderer.setConf(conf.journey);\r\n  requirementRenderer.setConf(conf.requirement);\r\n  errorRenderer.setConf(conf.class);\r\n}\r\n\r\n/** To be removed */\r\nfunction reinitialize() {\r\n  // `mermaidAPI.reinitialize: v${pkg.version}`,\r\n  //   JSON.stringify(options),\r\n  //   options.themeVariables.primaryColor;\r\n  // // if (options.theme && theme[options.theme]) {\r\n  // //   options.themeVariables = theme[options.theme].getThemeVariables(options.themeVariables);\r\n  // // }\r\n  // // Set default options\r\n  // const config =\r\n  //   typeof options === 'object' ? configApi.setConfig(options) : configApi.getSiteConfig();\r\n  // updateRendererConfigs(config);\r\n  // setLogLevel(config.logLevel);\r\n  // log.debug('mermaidAPI.reinitialize: ', config);\r\n}\r\n\r\n/** @param {any} options */\r\nfunction initialize(options) {\r\n  // console.warn(`mermaidAPI.initialize: v${pkg.version} `, options);\r\n\r\n  // Handle legacy location of font-family configuration\r\n  if (options && options.fontFamily) {\r\n    if (!options.themeVariables) {\r\n      options.themeVariables = { fontFamily: options.fontFamily };\r\n    } else {\r\n      if (!options.themeVariables.fontFamily) {\r\n        options.themeVariables = { fontFamily: options.fontFamily };\r\n      }\r\n    }\r\n  }\r\n  // Set default options\r\n  configApi.saveConfigFromInitilize(options);\r\n\r\n  if (options && options.theme && theme[options.theme]) {\r\n    // Todo merge with user options\r\n    options.themeVariables = theme[options.theme].getThemeVariables(options.themeVariables);\r\n  } else {\r\n    if (options) options.themeVariables = theme.default.getThemeVariables(options.themeVariables);\r\n  }\r\n\r\n  const config =\r\n    typeof options === 'object' ? configApi.setSiteConfig(options) : configApi.getSiteConfig();\r\n\r\n  updateRendererConfigs(config);\r\n  setLogLevel(config.logLevel);\r\n  // log.debug('mermaidAPI.initialize: ', config);\r\n}\r\n\r\nconst mermaidAPI = Object.freeze({\r\n  render,\r\n  parse,\r\n  parseDirective,\r\n  initialize,\r\n  reinitialize,\r\n  getConfig: configApi.getConfig,\r\n  setConfig: configApi.setConfig,\r\n  getSiteConfig: configApi.getSiteConfig,\r\n  updateSiteConfig: configApi.updateSiteConfig,\r\n  reset: () => {\r\n    // console.warn('reset');\r\n    configApi.reset();\r\n    // const siteConfig = configApi.getSiteConfig();\r\n    // updateRendererConfigs(siteConfig);\r\n  },\r\n  globalReset: () => {\r\n    configApi.reset(configApi.defaultConfig);\r\n    updateRendererConfigs(configApi.getConfig());\r\n  },\r\n  defaultConfig: configApi.defaultConfig,\r\n});\r\n\r\nsetLogLevel(configApi.getConfig().logLevel);\r\nconfigApi.reset(configApi.getConfig());\r\n\r\nexport default mermaidAPI;\r\n/**\r\n * ## mermaidAPI configuration defaults\r\n *\r\n * ```html\r\n * <script>\r\n *   var config = {\r\n *     theme: 'default',\r\n *     logLevel: 'fatal',\r\n *     securityLevel: 'strict',\r\n *     startOnLoad: true,\r\n *     arrowMarkerAbsolute: false,\r\n *\r\n *     er: {\r\n *       diagramPadding: 20,\r\n *       layoutDirection: 'TB',\r\n *       minEntityWidth: 100,\r\n *       minEntityHeight: 75,\r\n *       entityPadding: 15,\r\n *       stroke: 'gray',\r\n *       fill: 'honeydew',\r\n *       fontSize: 12,\r\n *       useMaxWidth: true,\r\n *     },\r\n *     flowchart: {\r\n *       diagramPadding: 8,\r\n *       htmlLabels: true,\r\n *       curve: 'basis',\r\n *     },\r\n *     sequence: {\r\n *       diagramMarginX: 50,\r\n *       diagramMarginY: 10,\r\n *       actorMargin: 50,\r\n *       width: 150,\r\n *       height: 65,\r\n *       boxMargin: 10,\r\n *       boxTextMargin: 5,\r\n *       noteMargin: 10,\r\n *       messageMargin: 35,\r\n *       messageAlign: 'center',\r\n *       mirrorActors: true,\r\n *       bottomMarginAdj: 1,\r\n *       useMaxWidth: true,\r\n *       rightAngles: false,\r\n *       showSequenceNumbers: false,\r\n *     },\r\n *     gantt: {\r\n *       titleTopMargin: 25,\r\n *       barHeight: 20,\r\n *       barGap: 4,\r\n *       topPadding: 50,\r\n *       leftPadding: 75,\r\n *       gridLineStartPadding: 35,\r\n *       fontSize: 11,\r\n *       fontFamily: '\"Open Sans\", sans-serif',\r\n *       numberSectionStyles: 4,\r\n *       axisFormat: '%Y-%m-%d',\r\n *       topAxis: false,\r\n *     },\r\n *   };\r\n *   mermaid.initialize(config);\r\n * </script>\r\n * ```\r\n */\r\n","import classDiagram from './diagrams/class/styles';\r\nimport er from './diagrams/er/styles';\r\nimport flowchart from './diagrams/flowchart/styles';\r\nimport gantt from './diagrams/gantt/styles';\r\nimport gitGraph from './diagrams/git/styles';\r\nimport info from './diagrams/info/styles';\r\nimport pie from './diagrams/pie/styles';\r\nimport requirement from './diagrams/requirement/styles';\r\nimport sequence from './diagrams/sequence/styles';\r\nimport stateDiagram from './diagrams/state/styles';\r\nimport journey from './diagrams/user-journey/styles';\r\n\r\nconst themes = {\r\n  flowchart,\r\n  'flowchart-v2': flowchart,\r\n  sequence,\r\n  gantt,\r\n  classDiagram,\r\n  'classDiagram-v2': classDiagram,\r\n  class: classDiagram,\r\n  stateDiagram,\r\n  state: stateDiagram,\r\n  gitGraph,\r\n  info,\r\n  pie,\r\n  er,\r\n  journey,\r\n  requirement,\r\n};\r\n\r\nexport const calcThemeVariables = (theme, userOverRides) => theme.calcColors(userOverRides);\r\n\r\nconst getStyles = (type, userStyles, options) => {\r\n  //console.warn('options in styles: ', options);\r\n  return ` {\r\n    font-family: ${options.fontFamily};\r\n    font-size: ${options.fontSize};\r\n    fill: ${options.textColor}\r\n  }\r\n\r\n  /* Classes common for multiple diagrams */\r\n\r\n  .error-icon {\r\n    fill: ${options.errorBkgColor};\r\n  }\r\n  .error-text {\r\n    fill: ${options.errorTextColor};\r\n    stroke: ${options.errorTextColor};\r\n  }\r\n\r\n  .edge-thickness-normal {\r\n    stroke-width: 2px;\r\n  }\r\n  .edge-thickness-thick {\r\n    stroke-width: 3.5px\r\n  }\r\n  .edge-pattern-solid {\r\n    stroke-dasharray: 0;\r\n  }\r\n\r\n  .edge-pattern-dashed{\r\n    stroke-dasharray: 3;\r\n  }\r\n  .edge-pattern-dotted {\r\n    stroke-dasharray: 2;\r\n  }\r\n\r\n  .marker {\r\n    fill: ${options.lineColor};\r\n    stroke: ${options.lineColor};\r\n  }\r\n  .marker.cross {\r\n    stroke: ${options.lineColor};\r\n  }\r\n\r\n  svg {\r\n    font-family: ${options.fontFamily};\r\n    font-size: ${options.fontSize};\r\n  }\r\n\r\n  ${themes[type](options)}\r\n\r\n  ${userStyles}\r\n`;\r\n};\r\n\r\nexport default getStyles;\r\n","import { getThemeVariables as baseThemeVariables } from './theme-base';\r\nimport { getThemeVariables as darkThemeVariables } from './theme-dark';\r\nimport { getThemeVariables as defaultThemeVariables } from './theme-default';\r\nimport { getThemeVariables as forestThemeVariables } from './theme-forest';\r\nimport { getThemeVariables as neutralThemeVariables } from './theme-neutral';\r\n\r\nexport default {\r\n  base: {\r\n    getThemeVariables: baseThemeVariables,\r\n  },\r\n  dark: {\r\n    getThemeVariables: darkThemeVariables,\r\n  },\r\n  default: {\r\n    getThemeVariables: defaultThemeVariables,\r\n  },\r\n  forest: {\r\n    getThemeVariables: forestThemeVariables,\r\n  },\r\n  neutral: {\r\n    getThemeVariables: neutralThemeVariables,\r\n  },\r\n};\r\n","import { darken, lighten, adjust, invert } from 'khroma';\r\nimport { mkBorder } from './theme-helpers';\r\nclass Theme {\r\n  constructor() {\r\n    /** # Base variables */\r\n    /**\r\n     * - Background - used to know what the background color is of the diagram. This is used for\r\n     *   deducing colors for istance line color. Defaulr value is #f4f4f4.\r\n     */\r\n    this.background = '#f4f4f4';\r\n    this.darkMode = false;\r\n\r\n    // this.background = '#0c0c0c';\r\n    // this.darkMode = true;\r\n    this.primaryColor = '#fff4dd';\r\n    // this.background = '#0c0c0c';\r\n    // this.primaryColor = '#1f1f00';\r\n\r\n    this.noteBkgColor = '#fff5ad';\r\n    this.noteTextColor = '#333';\r\n\r\n    // dark\r\n\r\n    // this.primaryColor = '#034694';\r\n    // this.primaryColor = '#f2ee7e';\r\n    // this.primaryColor = '#9f33be';\r\n    // this.primaryColor = '#f0fff0';\r\n    // this.primaryColor = '#fa255e';\r\n    // this.primaryColor = '#ECECFF';\r\n\r\n    // this.secondaryColor = '#c39ea0';\r\n    // this.tertiaryColor = '#f8e5e5';\r\n\r\n    // this.secondaryColor = '#dfdfde';\r\n    // this.tertiaryColor = '#CCCCFF';\r\n\r\n    this.fontFamily = '\"trebuchet ms\", verdana, arial, sans-serif';\r\n    this.fontSize = '16px';\r\n    // this.updateColors();\r\n  }\r\n  updateColors() {\r\n    // The || is to make sure that if the variable has been defiend by a user override that value is to be used\r\n\r\n    /* Main */\r\n    this.primaryTextColor = this.primaryTextColor || (this.darkMode ? '#eee' : '#333'); // invert(this.primaryColor);\r\n    this.secondaryColor = this.secondaryColor || adjust(this.primaryColor, { h: -120 });\r\n    this.tertiaryColor = this.tertiaryColor || adjust(this.primaryColor, { h: 180, l: 5 });\r\n\r\n    this.primaryBorderColor = this.primaryBorderColor || mkBorder(this.primaryColor, this.darkMode);\r\n    this.secondaryBorderColor =\r\n      this.secondaryBorderColor || mkBorder(this.secondaryColor, this.darkMode);\r\n    this.tertiaryBorderColor =\r\n      this.tertiaryBorderColor || mkBorder(this.tertiaryColor, this.darkMode);\r\n    this.noteBorderColor = this.noteBorderColor || mkBorder(this.noteBkgColor, this.darkMode);\r\n    this.noteBkgColor = this.noteBkgColor || '#fff5ad';\r\n    this.noteTextColor = this.noteTextColor || '#333';\r\n\r\n    this.secondaryTextColor = this.secondaryTextColor || invert(this.secondaryColor);\r\n    this.tertiaryTextColor = this.tertiaryTextColor || invert(this.tertiaryColor);\r\n    this.lineColor = this.lineColor || invert(this.background);\r\n    this.textColor = this.textColor || this.primaryTextColor;\r\n\r\n    /* Flowchart variables */\r\n    this.nodeBkg = this.nodeBkg || this.primaryColor;\r\n    this.mainBkg = this.mainBkg || this.primaryColor;\r\n    this.nodeBorder = this.nodeBorder || this.primaryBorderColor;\r\n    this.clusterBkg = this.clusterBkg || this.tertiaryColor;\r\n    this.clusterBorder = this.clusterBorder || this.tertiaryBorderColor;\r\n    this.defaultLinkColor = this.defaultLinkColor || this.lineColor;\r\n    this.titleColor = this.titleColor || this.tertiaryTextColor;\r\n    this.edgeLabelBackground =\r\n      this.edgeLabelBackground ||\r\n      (this.darkMode ? darken(this.secondaryColor, 30) : this.secondaryColor);\r\n    this.nodeTextColor = this.nodeTextColor || this.primaryTextColor;\r\n    /* Sequence Diagram variables */\r\n\r\n    // this.actorBorder = lighten(this.border1, 0.5);\r\n    this.actorBorder = this.actorBorder || this.primaryBorderColor;\r\n    this.actorBkg = this.actorBkg || this.mainBkg;\r\n    this.actorTextColor = this.actorTextColor || this.primaryTextColor;\r\n    this.actorLineColor = this.actorLineColor || 'grey';\r\n    this.labelBoxBkgColor = this.labelBoxBkgColor || this.actorBkg;\r\n    this.signalColor = this.signalColor || this.textColor;\r\n    this.signalTextColor = this.signalTextColor || this.textColor;\r\n    this.labelBoxBorderColor = this.labelBoxBorderColor || this.actorBorder;\r\n    this.labelTextColor = this.labelTextColor || this.actorTextColor;\r\n    this.loopTextColor = this.loopTextColor || this.actorTextColor;\r\n    this.activationBorderColor = this.activationBorderColor || darken(this.secondaryColor, 10);\r\n    this.activationBkgColor = this.activationBkgColor || this.secondaryColor;\r\n    this.sequenceNumberColor = this.sequenceNumberColor || invert(this.lineColor);\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.sectionBkgColor = this.sectionBkgColor || this.tertiaryColor;\r\n    this.altSectionBkgColor = this.altSectionBkgColor || 'white';\r\n    this.sectionBkgColor = this.sectionBkgColor || this.secondaryColor;\r\n    this.sectionBkgColor2 = this.sectionBkgColor2 || this.primaryColor;\r\n    this.excludeBkgColor = this.excludeBkgColor || '#eeeeee';\r\n    this.taskBorderColor = this.taskBorderColor || this.primaryBorderColor;\r\n    this.taskBkgColor = this.taskBkgColor || this.primaryColor;\r\n    this.activeTaskBorderColor = this.activeTaskBorderColor || this.primaryColor;\r\n    this.activeTaskBkgColor = this.activeTaskBkgColor || lighten(this.primaryColor, 23);\r\n    this.gridColor = this.gridColor || 'lightgrey';\r\n    this.doneTaskBkgColor = this.doneTaskBkgColor || 'lightgrey';\r\n    this.doneTaskBorderColor = this.doneTaskBorderColor || 'grey';\r\n    this.critBorderColor = this.critBorderColor || '#ff8888';\r\n    this.critBkgColor = this.critBkgColor || 'red';\r\n    this.todayLineColor = this.todayLineColor || 'red';\r\n    this.taskTextColor = this.taskTextColor || this.textColor;\r\n    this.taskTextOutsideColor = this.taskTextOutsideColor || this.textColor;\r\n    this.taskTextLightColor = this.taskTextLightColor || this.textColor;\r\n    this.taskTextColor = this.taskTextColor || this.primaryTextColor;\r\n    this.taskTextDarkColor = this.taskTextDarkColor || this.textColor;\r\n    this.taskTextClickableColor = this.taskTextClickableColor || '#003163';\r\n\r\n    /* state colors */\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    this.transitionLabelColor = this.transitionLabelColor || this.textColor;\r\n    /* The color of the text tables of the tstates*/\r\n    this.stateLabelColor = this.stateLabelColor || this.stateBkg || this.primaryTextColor;\r\n\r\n    this.stateBkg = this.stateBkg || this.mainBkg;\r\n    this.labelBackgroundColor = this.labelBackgroundColor || this.stateBkg;\r\n    this.compositeBackground = this.compositeBackground || this.background || this.tertiaryColor;\r\n    this.altBackground = this.altBackground || this.tertiaryColor;\r\n    this.compositeTitleBackground = this.compositeTitleBackground || this.mainBkg;\r\n    this.compositeBorder = this.compositeBorder || this.nodeBorder;\r\n    this.innerEndBackground = this.nodeBorder;\r\n    this.errorBkgColor = this.errorBkgColor || this.tertiaryColor;\r\n    this.errorTextColor = this.errorTextColor || this.tertiaryTextColor;\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    this.specialStateColor = this.lineColor;\r\n\r\n    /* class */\r\n    this.classText = this.classText || this.textColor;\r\n\r\n    /* user-journey */\r\n    this.fillType0 = this.fillType0 || this.primaryColor;\r\n    this.fillType1 = this.fillType1 || this.secondaryColor;\r\n    this.fillType2 = this.fillType2 || adjust(this.primaryColor, { h: 64 });\r\n    this.fillType3 = this.fillType3 || adjust(this.secondaryColor, { h: 64 });\r\n    this.fillType4 = this.fillType4 || adjust(this.primaryColor, { h: -64 });\r\n    this.fillType5 = this.fillType5 || adjust(this.secondaryColor, { h: -64 });\r\n    this.fillType6 = this.fillType6 || adjust(this.primaryColor, { h: 128 });\r\n    this.fillType7 = this.fillType7 || adjust(this.secondaryColor, { h: 128 });\r\n\r\n    /* pie */\r\n    this.pie1 = this.pie1 || this.primaryColor;\r\n    this.pie2 = this.pie2 || this.secondaryColor;\r\n    this.pie3 = this.pie3 || this.tertiaryColor;\r\n    this.pie4 = this.pie4 || adjust(this.primaryColor, { l: -10 });\r\n    this.pie5 = this.pie5 || adjust(this.secondaryColor, { l: -10 });\r\n    this.pie6 = this.pie6 || adjust(this.tertiaryColor, { l: -10 });\r\n    this.pie7 = this.pie7 || adjust(this.primaryColor, { h: +60, l: -10 });\r\n    this.pie8 = this.pie8 || adjust(this.primaryColor, { h: -60, l: -10 });\r\n    this.pie9 = this.pie9 || adjust(this.primaryColor, { h: 120, l: 0 });\r\n    this.pie10 = this.pie10 || adjust(this.primaryColor, { h: +60, l: -20 });\r\n    this.pie11 = this.pie11 || adjust(this.primaryColor, { h: -60, l: -20 });\r\n    this.pie12 = this.pie12 || adjust(this.primaryColor, { h: 120, l: -10 });\r\n    this.pieTitleTextSize = this.pieTitleTextSize || '25px';\r\n    this.pieTitleTextColor = this.pieTitleTextColor || this.taskTextDarkColor;\r\n    this.pieSectionTextSize = this.pieSectionTextSize || '17px';\r\n    this.pieSectionTextColor = this.pieSectionTextColor || this.textColor;\r\n    this.pieLegendTextSize = this.pieLegendTextSize || '17px';\r\n    this.pieLegendTextColor = this.pieLegendTextColor || this.taskTextDarkColor;\r\n    this.pieStrokeColor = this.pieStrokeColor || 'black';\r\n    this.pieStrokeWidth = this.pieStrokeWidth || '2px';\r\n    this.pieOpacity = this.pieOpacity || '0.7';\r\n\r\n    /* requirement-diagram */\r\n    this.requirementBackground = this.requirementBackground || this.primaryColor;\r\n    this.requirementBorderColor = this.requirementBorderColor || this.primaryBorderColor;\r\n    this.requirementBorderSize = this.requirementBorderSize || this.primaryBorderColor;\r\n    this.requirementTextColor = this.requirementTextColor || this.primaryTextColor;\r\n    this.relationColor = this.relationColor || this.lineColor;\r\n    this.relationLabelBackground =\r\n      this.relationLabelBackground ||\r\n      (this.darkMode ? darken(this.secondaryColor, 30) : this.secondaryColor);\r\n    this.relationLabelColor = this.relationLabelColor || this.actorTextColor;\r\n\r\n    /* git */\r\n    this.git0 = this.git0 || this.primaryColor;\r\n    this.git1 = this.git1 || this.secondaryColor;\r\n    this.git2 = this.git2 || this.tertiaryColor;\r\n    this.git3 = this.git3 || adjust(this.primaryColor, { h: -30 });\r\n    this.git4 = this.git4 || adjust(this.primaryColor, { h: -60 });\r\n    this.git5 = this.git5 || adjust(this.primaryColor, { h: -90 });\r\n    this.git6 = this.git6 || adjust(this.primaryColor, { h: +60 });\r\n    this.git7 = this.git7 || adjust(this.primaryColor, { h: +120 });\r\n    if (this.darkMode) {\r\n      this.git0 = lighten(this.git0, 25);\r\n      this.git1 = lighten(this.git1, 25);\r\n      this.git2 = lighten(this.git2, 25);\r\n      this.git3 = lighten(this.git3, 25);\r\n      this.git4 = lighten(this.git4, 25);\r\n      this.git5 = lighten(this.git5, 25);\r\n      this.git6 = lighten(this.git6, 25);\r\n      this.git7 = lighten(this.git7, 25);\r\n    } else {\r\n      this.git0 = darken(this.git0, 25);\r\n      this.git1 = darken(this.git1, 25);\r\n      this.git2 = darken(this.git2, 25);\r\n      this.git3 = darken(this.git3, 25);\r\n      this.git4 = darken(this.git4, 25);\r\n      this.git5 = darken(this.git5, 25);\r\n      this.git6 = darken(this.git6, 25);\r\n      this.git7 = darken(this.git7, 25);\r\n    }\r\n    this.gitInv0 = this.gitInv0 || invert(this.git0);\r\n    this.gitInv1 = this.gitInv1 || invert(this.git1);\r\n    this.gitInv2 = this.gitInv2 || invert(this.git2);\r\n    this.gitInv3 = this.gitInv3 || invert(this.git3);\r\n    this.gitInv4 = this.gitInv4 || invert(this.git4);\r\n    this.gitInv5 = this.gitInv5 || invert(this.git5);\r\n    this.gitInv6 = this.gitInv6 || invert(this.git6);\r\n    this.gitInv7 = this.gitInv7 || invert(this.git7);\r\n    this.branchLabelColor =\r\n      this.branchLabelColor || (this.darkMode ? 'black' : this.labelTextColor);\r\n    this.gitBranchLabel0 = this.gitBranchLabel0 || this.branchLabelColor;\r\n    this.gitBranchLabel1 = this.gitBranchLabel1 || this.branchLabelColor;\r\n    this.gitBranchLabel2 = this.gitBranchLabel2 || this.branchLabelColor;\r\n    this.gitBranchLabel3 = this.gitBranchLabel3 || this.branchLabelColor;\r\n    this.gitBranchLabel4 = this.gitBranchLabel4 || this.branchLabelColor;\r\n    this.gitBranchLabel5 = this.gitBranchLabel5 || this.branchLabelColor;\r\n    this.gitBranchLabel6 = this.gitBranchLabel6 || this.branchLabelColor;\r\n    this.gitBranchLabel7 = this.gitBranchLabel7 || this.branchLabelColor;\r\n\r\n    this.tagLabelColor = this.tagLabelColor || this.primaryTextColor;\r\n    this.tagLabelBackground = this.tagLabelBackground || this.primaryColor;\r\n    this.tagLabelBorder = this.tagBorder || this.primaryBorderColor;\r\n    this.commitLabelColor = this.commitLabelColor || this.secondaryTextColor;\r\n    this.commitLabelBackground = this.commitLabelBackground || this.secondaryColor;\r\n  }\r\n  calculate(overrides) {\r\n    if (typeof overrides !== 'object') {\r\n      // Calculate colors form base colors\r\n      this.updateColors();\r\n      return;\r\n    }\r\n\r\n    const keys = Object.keys(overrides);\r\n\r\n    // Copy values from overrides, this is mainly for base colors\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n\r\n    // Calculate colors form base colors\r\n    this.updateColors();\r\n    // Copy values from overrides again in case of an override of derived value\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n  }\r\n}\r\n\r\nexport const getThemeVariables = (userOverrides) => {\r\n  const theme = new Theme();\r\n  theme.calculate(userOverrides);\r\n  return theme;\r\n};\r\n","import { invert, lighten, darken, rgba, adjust } from 'khroma';\r\nimport { mkBorder } from './theme-helpers';\r\nclass Theme {\r\n  constructor() {\r\n    this.background = '#333';\r\n    this.primaryColor = '#1f2020';\r\n    this.secondaryColor = lighten(this.primaryColor, 16);\r\n\r\n    this.tertiaryColor = adjust(this.primaryColor, { h: -160 });\r\n    this.primaryBorderColor = invert(this.background);\r\n    this.secondaryBorderColor = mkBorder(this.secondaryColor, this.darkMode);\r\n    this.tertiaryBorderColor = mkBorder(this.tertiaryColor, this.darkMode);\r\n    this.primaryTextColor = invert(this.primaryColor);\r\n    this.secondaryTextColor = invert(this.secondaryColor);\r\n    this.tertiaryTextColor = invert(this.tertiaryColor);\r\n    this.lineColor = invert(this.background);\r\n    this.textColor = invert(this.background);\r\n\r\n    this.mainBkg = '#1f2020';\r\n    this.secondBkg = 'calculated';\r\n    this.mainContrastColor = 'lightgrey';\r\n    this.darkTextColor = lighten(invert('#323D47'), 10);\r\n    this.lineColor = 'calculated';\r\n    this.border1 = '#81B1DB';\r\n    this.border2 = rgba(255, 255, 255, 0.25);\r\n    this.arrowheadColor = 'calculated';\r\n    this.fontFamily = '\"trebuchet ms\", verdana, arial, sans-serif';\r\n    this.fontSize = '16px';\r\n    this.labelBackground = '#181818';\r\n    this.textColor = '#ccc';\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = 'calculated';\r\n    this.nodeBorder = 'calculated';\r\n    this.clusterBkg = 'calculated';\r\n    this.clusterBorder = 'calculated';\r\n    this.defaultLinkColor = 'calculated';\r\n    this.titleColor = '#F9FFFE';\r\n    this.edgeLabelBackground = 'calculated';\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = 'calculated';\r\n    this.actorBkg = 'calculated';\r\n    this.actorTextColor = 'calculated';\r\n    this.actorLineColor = 'calculated';\r\n    this.signalColor = 'calculated';\r\n    this.signalTextColor = 'calculated';\r\n    this.labelBoxBkgColor = 'calculated';\r\n    this.labelBoxBorderColor = 'calculated';\r\n    this.labelTextColor = 'calculated';\r\n    this.loopTextColor = 'calculated';\r\n    this.noteBorderColor = 'calculated';\r\n    this.noteBkgColor = '#fff5ad';\r\n    this.noteTextColor = 'calculated';\r\n    this.activationBorderColor = 'calculated';\r\n    this.activationBkgColor = 'calculated';\r\n    this.sequenceNumberColor = 'black';\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.sectionBkgColor = darken('#EAE8D9', 30);\r\n    this.altSectionBkgColor = 'calculated';\r\n    this.sectionBkgColor2 = '#EAE8D9';\r\n    this.taskBorderColor = rgba(255, 255, 255, 70);\r\n    this.taskBkgColor = 'calculated';\r\n    this.taskTextColor = 'calculated';\r\n    this.taskTextLightColor = 'calculated';\r\n    this.taskTextOutsideColor = 'calculated';\r\n    this.taskTextClickableColor = '#003163';\r\n    this.activeTaskBorderColor = rgba(255, 255, 255, 50);\r\n    this.activeTaskBkgColor = '#81B1DB';\r\n    this.gridColor = 'calculated';\r\n    this.doneTaskBkgColor = 'calculated';\r\n    this.doneTaskBorderColor = 'grey';\r\n    this.critBorderColor = '#E83737';\r\n    this.critBkgColor = '#E83737';\r\n    this.taskTextDarkColor = 'calculated';\r\n    this.todayLineColor = '#DB5757';\r\n\r\n    /* state colors */\r\n    this.labelColor = 'calculated';\r\n\r\n    this.errorBkgColor = '#a44141';\r\n    this.errorTextColor = '#ddd';\r\n  }\r\n  updateColors() {\r\n    this.secondBkg = lighten(this.mainBkg, 16);\r\n    this.lineColor = this.mainContrastColor;\r\n    this.arrowheadColor = this.mainContrastColor;\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = this.mainBkg;\r\n    this.nodeBorder = this.border1;\r\n    this.clusterBkg = this.secondBkg;\r\n    this.clusterBorder = this.border2;\r\n    this.defaultLinkColor = this.lineColor;\r\n    this.edgeLabelBackground = lighten(this.labelBackground, 25);\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = this.border1;\r\n    this.actorBkg = this.mainBkg;\r\n    this.actorTextColor = this.mainContrastColor;\r\n    this.actorLineColor = this.mainContrastColor;\r\n    this.signalColor = this.mainContrastColor;\r\n    this.signalTextColor = this.mainContrastColor;\r\n    this.labelBoxBkgColor = this.actorBkg;\r\n    this.labelBoxBorderColor = this.actorBorder;\r\n    this.labelTextColor = this.mainContrastColor;\r\n    this.loopTextColor = this.mainContrastColor;\r\n    this.noteBorderColor = this.secondaryBorderColor;\r\n    this.noteBkgColor = this.secondBkg;\r\n    this.noteTextColor = this.secondaryTextColor;\r\n    this.activationBorderColor = this.border1;\r\n    this.activationBkgColor = this.secondBkg;\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.altSectionBkgColor = this.background;\r\n    this.taskBkgColor = lighten(this.mainBkg, 23);\r\n    this.taskTextColor = this.darkTextColor;\r\n    this.taskTextLightColor = this.mainContrastColor;\r\n    this.taskTextOutsideColor = this.taskTextLightColor;\r\n    this.gridColor = this.mainContrastColor;\r\n    this.doneTaskBkgColor = this.mainContrastColor;\r\n    this.taskTextDarkColor = this.darkTextColor;\r\n\r\n    /* state colors */\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    this.transitionLabelColor = this.transitionLabelColor || this.textColor;\r\n    this.stateLabelColor = this.stateLabelColor || this.stateBkg || this.primaryTextColor;\r\n    this.stateBkg = this.stateBkg || this.mainBkg;\r\n    this.labelBackgroundColor = this.labelBackgroundColor || this.stateBkg;\r\n    this.compositeBackground = this.compositeBackground || this.background || this.tertiaryColor;\r\n    this.altBackground = this.altBackground || '#555';\r\n    this.compositeTitleBackground = this.compositeTitleBackground || this.mainBkg;\r\n    this.compositeBorder = this.compositeBorder || this.nodeBorder;\r\n    this.innerEndBackground = this.primaryBorderColor;\r\n    this.specialStateColor = '#f4f4f4'; // this.lineColor;\r\n\r\n    this.errorBkgColor = this.errorBkgColor || this.tertiaryColor;\r\n    this.errorTextColor = this.errorTextColor || this.tertiaryTextColor;\r\n\r\n    this.fillType0 = this.primaryColor;\r\n    this.fillType1 = this.secondaryColor;\r\n    this.fillType2 = adjust(this.primaryColor, { h: 64 });\r\n    this.fillType3 = adjust(this.secondaryColor, { h: 64 });\r\n    this.fillType4 = adjust(this.primaryColor, { h: -64 });\r\n    this.fillType5 = adjust(this.secondaryColor, { h: -64 });\r\n    this.fillType6 = adjust(this.primaryColor, { h: 128 });\r\n    this.fillType7 = adjust(this.secondaryColor, { h: 128 });\r\n\r\n    /* pie */\r\n    this.pie1 = this.pie1 || '#0b0000';\r\n    this.pie2 = this.pie2 || '#4d1037';\r\n    this.pie3 = this.pie3 || '#3f5258';\r\n    this.pie4 = this.pie4 || '#4f2f1b';\r\n    this.pie5 = this.pie5 || '#6e0a0a';\r\n    this.pie6 = this.pie6 || '#3b0048';\r\n    this.pie7 = this.pie7 || '#995a01';\r\n    this.pie8 = this.pie8 || '#154706';\r\n    this.pie9 = this.pie9 || '#161722';\r\n    this.pie10 = this.pie10 || '#00296f';\r\n    this.pie11 = this.pie11 || '#01629c';\r\n    this.pie12 = this.pie12 || '#010029';\r\n    this.pieTitleTextSize = this.pieTitleTextSize || '25px';\r\n    this.pieTitleTextColor = this.pieTitleTextColor || this.taskTextDarkColor;\r\n    this.pieSectionTextSize = this.pieSectionTextSize || '17px';\r\n    this.pieSectionTextColor = this.pieSectionTextColor || this.textColor;\r\n    this.pieLegendTextSize = this.pieLegendTextSize || '17px';\r\n    this.pieLegendTextColor = this.pieLegendTextColor || this.taskTextDarkColor;\r\n    this.pieStrokeColor = this.pieStrokeColor || 'black';\r\n    this.pieStrokeWidth = this.pieStrokeWidth || '2px';\r\n    this.pieOpacity = this.pieOpacity || '0.7';\r\n\r\n    /* class */\r\n    this.classText = this.primaryTextColor;\r\n\r\n    /* requirement-diagram */\r\n    this.requirementBackground = this.requirementBackground || this.primaryColor;\r\n    this.requirementBorderColor = this.requirementBorderColor || this.primaryBorderColor;\r\n    this.requirementBorderSize = this.requirementBorderSize || this.primaryBorderColor;\r\n    this.requirementTextColor = this.requirementTextColor || this.primaryTextColor;\r\n    this.relationColor = this.relationColor || this.lineColor;\r\n    this.relationLabelBackground =\r\n      this.relationLabelBackground ||\r\n      (this.darkMode ? darken(this.secondaryColor, 30) : this.secondaryColor);\r\n    this.relationLabelColor = this.relationLabelColor || this.actorTextColor;\r\n\r\n    /* git */\r\n    this.git0 = lighten(this.secondaryColor, 20);\r\n    this.git1 = lighten(this.pie2 || this.secondaryColor, 20);\r\n    this.git2 = lighten(this.pie3 || this.tertiaryColor, 20);\r\n    this.git3 = lighten(this.pie4 || adjust(this.primaryColor, { h: -30 }), 20);\r\n    this.git4 = lighten(this.pie5 || adjust(this.primaryColor, { h: -60 }), 20);\r\n    this.git5 = lighten(this.pie6 || adjust(this.primaryColor, { h: -90 }), 10);\r\n    this.git6 = lighten(this.pie7 || adjust(this.primaryColor, { h: +60 }), 10);\r\n    this.git7 = lighten(this.pie8 || adjust(this.primaryColor, { h: +120 }), 20);\r\n    this.gitInv0 = this.gitInv0 || invert(this.git0);\r\n    this.gitInv1 = this.gitInv1 || invert(this.git1);\r\n    this.gitInv2 = this.gitInv2 || invert(this.git2);\r\n    this.gitInv3 = this.gitInv3 || invert(this.git3);\r\n    this.gitInv4 = this.gitInv4 || invert(this.git4);\r\n    this.gitInv5 = this.gitInv5 || invert(this.git5);\r\n    this.gitInv6 = this.gitInv6 || invert(this.git6);\r\n    this.gitInv7 = this.gitInv7 || invert(this.git7);\r\n\r\n    this.tagLabelColor = this.tagLabelColor || this.primaryTextColor;\r\n    this.tagLabelBackground = this.tagLabelBackground || this.primaryColor;\r\n    this.tagLabelBorder = this.tagBorder || this.primaryBorderColor;\r\n    this.commitLabelColor = this.commitLabelColor || this.secondaryTextColor;\r\n    this.commitLabelBackground = this.commitLabelBackground || this.secondaryColor;\r\n  }\r\n  calculate(overrides) {\r\n    if (typeof overrides !== 'object') {\r\n      // Calculate colors form base colors\r\n      this.updateColors();\r\n      return;\r\n    }\r\n\r\n    const keys = Object.keys(overrides);\r\n\r\n    // Copy values from overrides, this is mainly for base colors\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n\r\n    // Calculate colors form base colors\r\n    this.updateColors();\r\n    // Copy values from overrides again in case of an override of derived value\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n  }\r\n}\r\n\r\nexport const getThemeVariables = (userOverrides) => {\r\n  const theme = new Theme();\r\n  theme.calculate(userOverrides);\r\n  return theme;\r\n};\r\n","import { invert, lighten, rgba, adjust, darken } from 'khroma';\r\nimport { mkBorder } from './theme-helpers';\r\n\r\nclass Theme {\r\n  constructor() {\r\n    /* Base variables */\r\n    this.background = '#f4f4f4';\r\n    this.primaryColor = '#ECECFF';\r\n\r\n    this.secondaryColor = adjust(this.primaryColor, { h: 120 });\r\n    this.secondaryColor = '#ffffde';\r\n    this.tertiaryColor = adjust(this.primaryColor, { h: -160 });\r\n    this.primaryBorderColor = mkBorder(this.primaryColor, this.darkMode);\r\n    this.secondaryBorderColor = mkBorder(this.secondaryColor, this.darkMode);\r\n    this.tertiaryBorderColor = mkBorder(this.tertiaryColor, this.darkMode);\r\n    // this.noteBorderColor = mkBorder(this.noteBkgColor, this.darkMode);\r\n\r\n    this.primaryTextColor = invert(this.primaryColor);\r\n    this.secondaryTextColor = invert(this.secondaryColor);\r\n    this.tertiaryTextColor = invert(this.tertiaryColor);\r\n    this.lineColor = invert(this.background);\r\n    this.textColor = invert(this.background);\r\n\r\n    this.background = 'white';\r\n    this.mainBkg = '#ECECFF';\r\n    this.secondBkg = '#ffffde';\r\n    this.lineColor = '#333333';\r\n    this.border1 = '#9370DB';\r\n    this.border2 = '#aaaa33';\r\n    this.arrowheadColor = '#333333';\r\n    this.fontFamily = '\"trebuchet ms\", verdana, arial, sans-serif';\r\n    this.fontSize = '16px';\r\n    this.labelBackground = '#e8e8e8';\r\n    this.textColor = '#333';\r\n\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = 'calculated';\r\n    this.nodeBorder = 'calculated';\r\n    this.clusterBkg = 'calculated';\r\n    this.clusterBorder = 'calculated';\r\n    this.defaultLinkColor = 'calculated';\r\n    this.titleColor = 'calculated';\r\n    this.edgeLabelBackground = 'calculated';\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = 'calculated';\r\n    this.actorBkg = 'calculated';\r\n    this.actorTextColor = 'black';\r\n    this.actorLineColor = 'grey';\r\n    this.signalColor = 'calculated';\r\n    this.signalTextColor = 'calculated';\r\n    this.labelBoxBkgColor = 'calculated';\r\n    this.labelBoxBorderColor = 'calculated';\r\n    this.labelTextColor = 'calculated';\r\n    this.loopTextColor = 'calculated';\r\n    this.noteBorderColor = 'calculated';\r\n    this.noteBkgColor = '#fff5ad';\r\n    this.noteTextColor = 'calculated';\r\n    this.activationBorderColor = '#666';\r\n    this.activationBkgColor = '#f4f4f4';\r\n    this.sequenceNumberColor = 'white';\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.sectionBkgColor = 'calculated';\r\n    this.altSectionBkgColor = 'calculated';\r\n    this.sectionBkgColor2 = 'calculated';\r\n    this.excludeBkgColor = '#eeeeee';\r\n    this.taskBorderColor = 'calculated';\r\n    this.taskBkgColor = 'calculated';\r\n    this.taskTextLightColor = 'calculated';\r\n    this.taskTextColor = this.taskTextLightColor;\r\n    this.taskTextDarkColor = 'calculated';\r\n    this.taskTextOutsideColor = this.taskTextDarkColor;\r\n    this.taskTextClickableColor = 'calculated';\r\n    this.activeTaskBorderColor = 'calculated';\r\n    this.activeTaskBkgColor = 'calculated';\r\n    this.gridColor = 'calculated';\r\n    this.doneTaskBkgColor = 'calculated';\r\n    this.doneTaskBorderColor = 'calculated';\r\n    this.critBorderColor = 'calculated';\r\n    this.critBkgColor = 'calculated';\r\n    this.todayLineColor = 'calculated';\r\n\r\n    this.sectionBkgColor = rgba(102, 102, 255, 0.49);\r\n    this.altSectionBkgColor = 'white';\r\n    this.sectionBkgColor2 = '#fff400';\r\n    this.taskBorderColor = '#534fbc';\r\n    this.taskBkgColor = '#8a90dd';\r\n    this.taskTextLightColor = 'white';\r\n    this.taskTextColor = 'calculated';\r\n    this.taskTextDarkColor = 'black';\r\n    this.taskTextOutsideColor = 'calculated';\r\n    this.taskTextClickableColor = '#003163';\r\n    this.activeTaskBorderColor = '#534fbc';\r\n    this.activeTaskBkgColor = '#bfc7ff';\r\n    this.gridColor = 'lightgrey';\r\n    this.doneTaskBkgColor = 'lightgrey';\r\n    this.doneTaskBorderColor = 'grey';\r\n    this.critBorderColor = '#ff8888';\r\n    this.critBkgColor = 'red';\r\n    this.todayLineColor = 'red';\r\n\r\n    /* state colors */\r\n    this.labelColor = 'black';\r\n    this.errorBkgColor = '#552222';\r\n    this.errorTextColor = '#552222';\r\n    this.updateColors();\r\n  }\r\n  updateColors() {\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = this.mainBkg;\r\n    this.nodeBorder = this.border1; // border 1\r\n    this.clusterBkg = this.secondBkg;\r\n    this.clusterBorder = this.border2;\r\n    this.defaultLinkColor = this.lineColor;\r\n    this.titleColor = this.textColor;\r\n    this.edgeLabelBackground = this.labelBackground;\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    // this.actorBorder = lighten(this.border1, 0.5);\r\n    this.actorBorder = lighten(this.border1, 23);\r\n    this.actorBkg = this.mainBkg;\r\n    this.labelBoxBkgColor = this.actorBkg;\r\n    this.signalColor = this.textColor;\r\n    this.signalTextColor = this.textColor;\r\n    this.labelBoxBorderColor = this.actorBorder;\r\n    this.labelTextColor = this.actorTextColor;\r\n    this.loopTextColor = this.actorTextColor;\r\n    this.noteBorderColor = this.border2;\r\n    this.noteTextColor = this.actorTextColor;\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.taskTextColor = this.taskTextLightColor;\r\n    this.taskTextOutsideColor = this.taskTextDarkColor;\r\n\r\n    /* state colors */\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    this.transitionLabelColor = this.transitionLabelColor || this.textColor;\r\n    this.stateLabelColor = this.stateLabelColor || this.stateBkg || this.primaryTextColor;\r\n\r\n    this.stateBkg = this.stateBkg || this.mainBkg;\r\n    this.labelBackgroundColor = this.labelBackgroundColor || this.stateBkg;\r\n    this.compositeBackground = this.compositeBackground || this.background || this.tertiaryColor;\r\n    this.altBackground = this.altBackground || '#f0f0f0';\r\n    this.compositeTitleBackground = this.compositeTitleBackground || this.mainBkg;\r\n    this.compositeBorder = this.compositeBorder || this.nodeBorder;\r\n    this.innerEndBackground = this.nodeBorder;\r\n    this.specialStateColor = this.lineColor;\r\n\r\n    this.errorBkgColor = this.errorBkgColor || this.tertiaryColor;\r\n    this.errorTextColor = this.errorTextColor || this.tertiaryTextColor;\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    /* class */\r\n    this.classText = this.primaryTextColor;\r\n    /* journey */\r\n    this.fillType0 = this.primaryColor;\r\n    this.fillType1 = this.secondaryColor;\r\n    this.fillType2 = adjust(this.primaryColor, { h: 64 });\r\n    this.fillType3 = adjust(this.secondaryColor, { h: 64 });\r\n    this.fillType4 = adjust(this.primaryColor, { h: -64 });\r\n    this.fillType5 = adjust(this.secondaryColor, { h: -64 });\r\n    this.fillType6 = adjust(this.primaryColor, { h: 128 });\r\n    this.fillType7 = adjust(this.secondaryColor, { h: 128 });\r\n\r\n    /* pie */\r\n    this.pie1 = this.pie1 || this.primaryColor;\r\n    this.pie2 = this.pie2 || this.secondaryColor;\r\n    this.pie3 = this.pie3 || adjust(this.tertiaryColor, { l: -40 });\r\n    this.pie4 = this.pie4 || adjust(this.primaryColor, { l: -10 });\r\n    this.pie5 = this.pie5 || adjust(this.secondaryColor, { l: -30 });\r\n    this.pie6 = this.pie6 || adjust(this.tertiaryColor, { l: -20 });\r\n    this.pie7 = this.pie7 || adjust(this.primaryColor, { h: +60, l: -20 });\r\n    this.pie8 = this.pie8 || adjust(this.primaryColor, { h: -60, l: -40 });\r\n    this.pie9 = this.pie9 || adjust(this.primaryColor, { h: 120, l: -40 });\r\n    this.pie10 = this.pie10 || adjust(this.primaryColor, { h: +60, l: -40 });\r\n    this.pie11 = this.pie11 || adjust(this.primaryColor, { h: -90, l: -40 });\r\n    this.pie12 = this.pie12 || adjust(this.primaryColor, { h: 120, l: -30 });\r\n    this.pieTitleTextSize = this.pieTitleTextSize || '25px';\r\n    this.pieTitleTextColor = this.pieTitleTextColor || this.taskTextDarkColor;\r\n    this.pieSectionTextSize = this.pieSectionTextSize || '17px';\r\n    this.pieSectionTextColor = this.pieSectionTextColor || this.textColor;\r\n    this.pieLegendTextSize = this.pieLegendTextSize || '17px';\r\n    this.pieLegendTextColor = this.pieLegendTextColor || this.taskTextDarkColor;\r\n    this.pieStrokeColor = this.pieStrokeColor || 'black';\r\n    this.pieStrokeWidth = this.pieStrokeWidth || '2px';\r\n    this.pieOpacity = this.pieOpacity || '0.7';\r\n\r\n    /* requirement-diagram */\r\n    this.requirementBackground = this.requirementBackground || this.primaryColor;\r\n    this.requirementBorderColor = this.requirementBorderColor || this.primaryBorderColor;\r\n    this.requirementBorderSize = this.requirementBorderSize || this.primaryBorderColor;\r\n    this.requirementTextColor = this.requirementTextColor || this.primaryTextColor;\r\n    this.relationColor = this.relationColor || this.lineColor;\r\n    this.relationLabelBackground = this.relationLabelBackground || this.labelBackground;\r\n    this.relationLabelColor = this.relationLabelColor || this.actorTextColor;\r\n\r\n    /* git */\r\n    this.git0 = this.git0 || this.primaryColor;\r\n    this.git1 = this.git1 || this.secondaryColor;\r\n    this.git2 = this.git2 || this.tertiaryColor;\r\n    this.git3 = this.git3 || adjust(this.primaryColor, { h: -30 });\r\n    this.git4 = this.git4 || adjust(this.primaryColor, { h: -60 });\r\n    this.git5 = this.git5 || adjust(this.primaryColor, { h: -90 });\r\n    this.git6 = this.git6 || adjust(this.primaryColor, { h: +60 });\r\n    this.git7 = this.git7 || adjust(this.primaryColor, { h: +120 });\r\n    if (this.darkMode) {\r\n      this.git0 = lighten(this.git0, 25);\r\n      this.git1 = lighten(this.git1, 25);\r\n      this.git2 = lighten(this.git2, 25);\r\n      this.git3 = lighten(this.git3, 25);\r\n      this.git4 = lighten(this.git4, 25);\r\n      this.git5 = lighten(this.git5, 25);\r\n      this.git6 = lighten(this.git6, 25);\r\n      this.git7 = lighten(this.git7, 25);\r\n    } else {\r\n      this.git0 = darken(this.git0, 25);\r\n      this.git1 = darken(this.git1, 25);\r\n      this.git2 = darken(this.git2, 25);\r\n      this.git3 = darken(this.git3, 25);\r\n      this.git4 = darken(this.git4, 25);\r\n      this.git5 = darken(this.git5, 25);\r\n      this.git6 = darken(this.git6, 25);\r\n      this.git7 = darken(this.git7, 25);\r\n    }\r\n    this.gitInv0 = this.gitInv0 || darken(invert(this.git0), 25);\r\n    this.gitInv1 = this.gitInv1 || invert(this.git1);\r\n    this.gitInv2 = this.gitInv2 || invert(this.git2);\r\n    this.gitInv3 = this.gitInv3 || invert(this.git3);\r\n    this.gitInv4 = this.gitInv4 || invert(this.git4);\r\n    this.gitInv5 = this.gitInv5 || invert(this.git5);\r\n    this.gitInv6 = this.gitInv6 || invert(this.git6);\r\n    this.gitInv7 = this.gitInv7 || invert(this.git7);\r\n    this.gitBranchLabel0 = this.gitBranchLabel0 || invert(this.labelTextColor);\r\n    this.gitBranchLabel1 = this.gitBranchLabel1 || this.labelTextColor;\r\n    this.gitBranchLabel2 = this.gitBranchLabel2 || this.labelTextColor;\r\n    this.gitBranchLabel3 = this.gitBranchLabel3 || invert(this.labelTextColor);\r\n    this.gitBranchLabel4 = this.gitBranchLabel4 || this.labelTextColor;\r\n    this.gitBranchLabel5 = this.gitBranchLabel5 || this.labelTextColor;\r\n    this.gitBranchLabel6 = this.gitBranchLabel6 || this.labelTextColor;\r\n    this.gitBranchLabel7 = this.gitBranchLabel7 || this.labelTextColor;\r\n\r\n    this.tagLabelColor = this.tagLabelColor || this.primaryTextColor;\r\n    this.tagLabelBackground = this.tagLabelBackground || this.primaryColor;\r\n    this.tagLabelBorder = this.tagBorder || this.primaryBorderColor;\r\n    this.commitLabelColor = this.commitLabelColor || this.secondaryTextColor;\r\n    this.commitLabelBackground = this.commitLabelBackground || this.secondaryColor;\r\n  }\r\n  calculate(overrides) {\r\n    if (typeof overrides !== 'object') {\r\n      // Calculate colors form base colors\r\n      this.updateColors();\r\n      return;\r\n    }\r\n\r\n    const keys = Object.keys(overrides);\r\n\r\n    // Copy values from overrides, this is mainly for base colors\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n\r\n    // Calculate colors form base colors\r\n    this.updateColors();\r\n    // Copy values from overrides again in case of an override of derived value\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n  }\r\n}\r\n\r\nexport const getThemeVariables = (userOverrides) => {\r\n  const theme = new Theme();\r\n  theme.calculate(userOverrides);\r\n  return theme;\r\n};\r\n","import { darken, lighten, adjust, invert } from 'khroma';\r\nimport { mkBorder } from './theme-helpers';\r\nclass Theme {\r\n  constructor() {\r\n    /* Base vales */\r\n    this.background = '#f4f4f4';\r\n    this.primaryColor = '#cde498';\r\n    this.secondaryColor = '#cdffb2';\r\n    this.background = 'white';\r\n    this.mainBkg = '#cde498';\r\n    this.secondBkg = '#cdffb2';\r\n    this.lineColor = 'green';\r\n    this.border1 = '#13540c';\r\n    this.border2 = '#6eaa49';\r\n    this.arrowheadColor = 'green';\r\n    this.fontFamily = '\"trebuchet ms\", verdana, arial, sans-serif';\r\n    this.fontSize = '16px';\r\n\r\n    this.tertiaryColor = lighten('#cde498', 10);\r\n    this.primaryBorderColor = mkBorder(this.primaryColor, this.darkMode);\r\n    this.secondaryBorderColor = mkBorder(this.secondaryColor, this.darkMode);\r\n    this.tertiaryBorderColor = mkBorder(this.tertiaryColor, this.darkMode);\r\n    this.primaryTextColor = invert(this.primaryColor);\r\n    this.secondaryTextColor = invert(this.secondaryColor);\r\n    this.tertiaryTextColor = invert(this.primaryColor);\r\n    this.lineColor = invert(this.background);\r\n    this.textColor = invert(this.background);\r\n\r\n    /* Flowchart variables */\r\n    this.nodeBkg = 'calculated';\r\n    this.nodeBorder = 'calculated';\r\n    this.clusterBkg = 'calculated';\r\n    this.clusterBorder = 'calculated';\r\n    this.defaultLinkColor = 'calculated';\r\n    this.titleColor = '#333';\r\n    this.edgeLabelBackground = '#e8e8e8';\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = 'calculated';\r\n    this.actorBkg = 'calculated';\r\n    this.actorTextColor = 'black';\r\n    this.actorLineColor = 'grey';\r\n    this.signalColor = '#333';\r\n    this.signalTextColor = '#333';\r\n    this.labelBoxBkgColor = 'calculated';\r\n    this.labelBoxBorderColor = '#326932';\r\n    this.labelTextColor = 'calculated';\r\n    this.loopTextColor = 'calculated';\r\n    this.noteBorderColor = 'calculated';\r\n    this.noteBkgColor = '#fff5ad';\r\n    this.noteTextColor = 'calculated';\r\n    this.activationBorderColor = '#666';\r\n    this.activationBkgColor = '#f4f4f4';\r\n    this.sequenceNumberColor = 'white';\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.sectionBkgColor = '#6eaa49';\r\n    this.altSectionBkgColor = 'white';\r\n    this.sectionBkgColor2 = '#6eaa49';\r\n    this.excludeBkgColor = '#eeeeee';\r\n    this.taskBorderColor = 'calculated';\r\n    this.taskBkgColor = '#487e3a';\r\n    this.taskTextLightColor = 'white';\r\n    this.taskTextColor = 'calculated';\r\n    this.taskTextDarkColor = 'black';\r\n    this.taskTextOutsideColor = 'calculated';\r\n    this.taskTextClickableColor = '#003163';\r\n    this.activeTaskBorderColor = 'calculated';\r\n    this.activeTaskBkgColor = 'calculated';\r\n    this.gridColor = 'lightgrey';\r\n    this.doneTaskBkgColor = 'lightgrey';\r\n    this.doneTaskBorderColor = 'grey';\r\n    this.critBorderColor = '#ff8888';\r\n    this.critBkgColor = 'red';\r\n    this.todayLineColor = 'red';\r\n\r\n    /* state colors */\r\n    this.labelColor = 'black';\r\n\r\n    this.errorBkgColor = '#552222';\r\n    this.errorTextColor = '#552222';\r\n  }\r\n  updateColors() {\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = this.mainBkg;\r\n    this.nodeBorder = this.border1;\r\n    this.clusterBkg = this.secondBkg;\r\n    this.clusterBorder = this.border2;\r\n    this.defaultLinkColor = this.lineColor;\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = darken(this.mainBkg, 20);\r\n    this.actorBkg = this.mainBkg;\r\n    this.labelBoxBkgColor = this.actorBkg;\r\n    this.labelTextColor = this.actorTextColor;\r\n    this.loopTextColor = this.actorTextColor;\r\n    this.noteBorderColor = this.border2;\r\n    this.noteTextColor = this.actorTextColor;\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.taskBorderColor = this.border1;\r\n    this.taskTextColor = this.taskTextLightColor;\r\n    this.taskTextOutsideColor = this.taskTextDarkColor;\r\n    this.activeTaskBorderColor = this.taskBorderColor;\r\n    this.activeTaskBkgColor = this.mainBkg;\r\n\r\n    /* state colors */\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    this.transitionLabelColor = this.transitionLabelColor || this.textColor;\r\n    this.stateLabelColor = this.stateLabelColor || this.stateBkg || this.primaryTextColor;\r\n\r\n    this.stateBkg = this.stateBkg || this.mainBkg;\r\n    this.labelBackgroundColor = this.labelBackgroundColor || this.stateBkg;\r\n    this.compositeBackground = this.compositeBackground || this.background || this.tertiaryColor;\r\n    this.altBackground = this.altBackground || '#f0f0f0';\r\n    this.compositeTitleBackground = this.compositeTitleBackground || this.mainBkg;\r\n    this.compositeBorder = this.compositeBorder || this.nodeBorder;\r\n    this.innerEndBackground = this.primaryBorderColor;\r\n    this.specialStateColor = this.lineColor;\r\n\r\n    this.errorBkgColor = this.errorBkgColor || this.tertiaryColor;\r\n    this.errorTextColor = this.errorTextColor || this.tertiaryTextColor;\r\n    this.transitionColor = this.transitionColor || this.lineColor;\r\n    /* class */\r\n    this.classText = this.primaryTextColor;\r\n    /* journey */\r\n    this.fillType0 = this.primaryColor;\r\n    this.fillType1 = this.secondaryColor;\r\n    this.fillType2 = adjust(this.primaryColor, { h: 64 });\r\n    this.fillType3 = adjust(this.secondaryColor, { h: 64 });\r\n    this.fillType4 = adjust(this.primaryColor, { h: -64 });\r\n    this.fillType5 = adjust(this.secondaryColor, { h: -64 });\r\n    this.fillType6 = adjust(this.primaryColor, { h: 128 });\r\n    this.fillType7 = adjust(this.secondaryColor, { h: 128 });\r\n\r\n    /* pie */\r\n    this.pie1 = this.pie1 || this.primaryColor;\r\n    this.pie2 = this.pie2 || this.secondaryColor;\r\n    this.pie3 = this.pie3 || this.tertiaryColor;\r\n    this.pie4 = this.pie4 || adjust(this.primaryColor, { l: -30 });\r\n    this.pie5 = this.pie5 || adjust(this.secondaryColor, { l: -30 });\r\n    this.pie6 = this.pie6 || adjust(this.tertiaryColor, { h: +40, l: -40 });\r\n    this.pie7 = this.pie7 || adjust(this.primaryColor, { h: +60, l: -10 });\r\n    this.pie8 = this.pie8 || adjust(this.primaryColor, { h: -60, l: -10 });\r\n    this.pie9 = this.pie9 || adjust(this.primaryColor, { h: 120, l: 0 });\r\n    this.pie10 = this.pie10 || adjust(this.primaryColor, { h: +60, l: -50 });\r\n    this.pie11 = this.pie11 || adjust(this.primaryColor, { h: -60, l: -50 });\r\n    this.pie12 = this.pie12 || adjust(this.primaryColor, { h: 120, l: -50 });\r\n    this.pieTitleTextSize = this.pieTitleTextSize || '25px';\r\n    this.pieTitleTextColor = this.pieTitleTextColor || this.taskTextDarkColor;\r\n    this.pieSectionTextSize = this.pieSectionTextSize || '17px';\r\n    this.pieSectionTextColor = this.pieSectionTextColor || this.textColor;\r\n    this.pieLegendTextSize = this.pieLegendTextSize || '17px';\r\n    this.pieLegendTextColor = this.pieLegendTextColor || this.taskTextDarkColor;\r\n    this.pieStrokeColor = this.pieStrokeColor || 'black';\r\n    this.pieStrokeWidth = this.pieStrokeWidth || '2px';\r\n    this.pieOpacity = this.pieOpacity || '0.7';\r\n\r\n    /* requirement-diagram */\r\n    this.requirementBackground = this.requirementBackground || this.primaryColor;\r\n    this.requirementBorderColor = this.requirementBorderColor || this.primaryBorderColor;\r\n    this.requirementBorderSize = this.requirementBorderSize || this.primaryBorderColor;\r\n    this.requirementTextColor = this.requirementTextColor || this.primaryTextColor;\r\n    this.relationColor = this.relationColor || this.lineColor;\r\n    this.relationLabelBackground = this.relationLabelBackground || this.edgeLabelBackground;\r\n    this.relationLabelColor = this.relationLabelColor || this.actorTextColor;\r\n\r\n    /* git */\r\n    this.git0 = this.git0 || this.primaryColor;\r\n    this.git1 = this.git1 || this.secondaryColor;\r\n    this.git2 = this.git2 || this.tertiaryColor;\r\n    this.git3 = this.git3 || adjust(this.primaryColor, { h: -30 });\r\n    this.git4 = this.git4 || adjust(this.primaryColor, { h: -60 });\r\n    this.git5 = this.git5 || adjust(this.primaryColor, { h: -90 });\r\n    this.git6 = this.git6 || adjust(this.primaryColor, { h: +60 });\r\n    this.git7 = this.git7 || adjust(this.primaryColor, { h: +120 });\r\n    if (this.darkMode) {\r\n      this.git0 = lighten(this.git0, 25);\r\n      this.git1 = lighten(this.git1, 25);\r\n      this.git2 = lighten(this.git2, 25);\r\n      this.git3 = lighten(this.git3, 25);\r\n      this.git4 = lighten(this.git4, 25);\r\n      this.git5 = lighten(this.git5, 25);\r\n      this.git6 = lighten(this.git6, 25);\r\n      this.git7 = lighten(this.git7, 25);\r\n    } else {\r\n      this.git0 = darken(this.git0, 25);\r\n      this.git1 = darken(this.git1, 25);\r\n      this.git2 = darken(this.git2, 25);\r\n      this.git3 = darken(this.git3, 25);\r\n      this.git4 = darken(this.git4, 25);\r\n      this.git5 = darken(this.git5, 25);\r\n      this.git6 = darken(this.git6, 25);\r\n      this.git7 = darken(this.git7, 25);\r\n    }\r\n    this.gitInv0 = this.gitInv0 || invert(this.git0);\r\n    this.gitInv1 = this.gitInv1 || invert(this.git1);\r\n    this.gitInv2 = this.gitInv2 || invert(this.git2);\r\n    this.gitInv3 = this.gitInv3 || invert(this.git3);\r\n    this.gitInv4 = this.gitInv4 || invert(this.git4);\r\n    this.gitInv5 = this.gitInv5 || invert(this.git5);\r\n    this.gitInv6 = this.gitInv6 || invert(this.git6);\r\n    this.gitInv7 = this.gitInv7 || invert(this.git7);\r\n\r\n    this.tagLabelColor = this.tagLabelColor || this.primaryTextColor;\r\n    this.tagLabelBackground = this.tagLabelBackground || this.primaryColor;\r\n    this.tagLabelBorder = this.tagBorder || this.primaryBorderColor;\r\n    this.commitLabelColor = this.commitLabelColor || this.secondaryTextColor;\r\n    this.commitLabelBackground = this.commitLabelBackground || this.secondaryColor;\r\n  }\r\n  calculate(overrides) {\r\n    if (typeof overrides !== 'object') {\r\n      // Calculate colors form base colors\r\n      this.updateColors();\r\n      return;\r\n    }\r\n\r\n    const keys = Object.keys(overrides);\r\n\r\n    // Copy values from overrides, this is mainly for base colors\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n\r\n    // Calculate colors form base colors\r\n    this.updateColors();\r\n    // Copy values from overrides again in case of an override of derived value\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n  }\r\n}\r\n\r\nexport const getThemeVariables = (userOverrides) => {\r\n  const theme = new Theme();\r\n  theme.calculate(userOverrides);\r\n  return theme;\r\n};\r\n","import { adjust } from 'khroma';\r\n\r\nexport const mkBorder = (col, darkMode) =>\r\n  darkMode ? adjust(col, { s: -40, l: 10 }) : adjust(col, { s: -40, l: -10 });\r\n","import { invert, darken, lighten, adjust } from 'khroma';\r\nimport { mkBorder } from './theme-helpers';\r\n\r\n// const Color = require ( 'khroma/dist/color' ).default\r\n// Color.format.hex.stringify(Color.parse('hsl(210, 66.6666666667%, 95%)')); // => \"#EAF2FB\"\r\n\r\nclass Theme {\r\n  constructor() {\r\n    this.primaryColor = '#eee';\r\n    this.contrast = '#707070';\r\n    this.secondaryColor = lighten(this.contrast, 55);\r\n    this.background = '#ffffff';\r\n\r\n    // this.secondaryColor = adjust(this.primaryColor, { h: 120 });\r\n    this.tertiaryColor = adjust(this.primaryColor, { h: -160 });\r\n    this.primaryBorderColor = mkBorder(this.primaryColor, this.darkMode);\r\n    this.secondaryBorderColor = mkBorder(this.secondaryColor, this.darkMode);\r\n    this.tertiaryBorderColor = mkBorder(this.tertiaryColor, this.darkMode);\r\n    // this.noteBorderColor = mkBorder(this.noteBkgColor, this.darkMode);\r\n\r\n    this.primaryTextColor = invert(this.primaryColor);\r\n    this.secondaryTextColor = invert(this.secondaryColor);\r\n    this.tertiaryTextColor = invert(this.tertiaryColor);\r\n    this.lineColor = invert(this.background);\r\n    this.textColor = invert(this.background);\r\n\r\n    // this.altBackground = lighten(this.contrast, 55);\r\n    this.mainBkg = '#eee';\r\n    this.secondBkg = 'calculated';\r\n    this.lineColor = '#666';\r\n    this.border1 = '#999';\r\n    this.border2 = 'calculated';\r\n    this.note = '#ffa';\r\n    this.text = '#333';\r\n    this.critical = '#d42';\r\n    this.done = '#bbb';\r\n    this.arrowheadColor = '#333333';\r\n    this.fontFamily = '\"trebuchet ms\", verdana, arial, sans-serif';\r\n    this.fontSize = '16px';\r\n\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = 'calculated';\r\n    this.nodeBorder = 'calculated';\r\n    this.clusterBkg = 'calculated';\r\n    this.clusterBorder = 'calculated';\r\n    this.defaultLinkColor = 'calculated';\r\n    this.titleColor = 'calculated';\r\n    this.edgeLabelBackground = 'white';\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = 'calculated';\r\n    this.actorBkg = 'calculated';\r\n    this.actorTextColor = 'calculated';\r\n    this.actorLineColor = 'calculated';\r\n    this.signalColor = 'calculated';\r\n    this.signalTextColor = 'calculated';\r\n    this.labelBoxBkgColor = 'calculated';\r\n    this.labelBoxBorderColor = 'calculated';\r\n    this.labelTextColor = 'calculated';\r\n    this.loopTextColor = 'calculated';\r\n    this.noteBorderColor = 'calculated';\r\n    this.noteBkgColor = 'calculated';\r\n    this.noteTextColor = 'calculated';\r\n    this.activationBorderColor = '#666';\r\n    this.activationBkgColor = '#f4f4f4';\r\n    this.sequenceNumberColor = 'white';\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.sectionBkgColor = 'calculated';\r\n    this.altSectionBkgColor = 'white';\r\n    this.sectionBkgColor2 = 'calculated';\r\n    this.excludeBkgColor = '#eeeeee';\r\n    this.taskBorderColor = 'calculated';\r\n    this.taskBkgColor = 'calculated';\r\n    this.taskTextLightColor = 'white';\r\n    this.taskTextColor = 'calculated';\r\n    this.taskTextDarkColor = 'calculated';\r\n    this.taskTextOutsideColor = 'calculated';\r\n    this.taskTextClickableColor = '#003163';\r\n    this.activeTaskBorderColor = 'calculated';\r\n    this.activeTaskBkgColor = 'calculated';\r\n    this.gridColor = 'calculated';\r\n    this.doneTaskBkgColor = 'calculated';\r\n    this.doneTaskBorderColor = 'calculated';\r\n    this.critBkgColor = 'calculated';\r\n    this.critBorderColor = 'calculated';\r\n    this.todayLineColor = 'calculated';\r\n\r\n    /* state colors */\r\n    this.labelColor = 'black';\r\n\r\n    this.errorBkgColor = '#552222';\r\n    this.errorTextColor = '#552222';\r\n  }\r\n  updateColors() {\r\n    this.secondBkg = lighten(this.contrast, 55);\r\n    this.border2 = this.contrast;\r\n\r\n    /* Flowchart variables */\r\n\r\n    this.nodeBkg = this.mainBkg;\r\n    this.nodeBorder = this.border1;\r\n    this.clusterBkg = this.secondBkg;\r\n    this.clusterBorder = this.border2;\r\n    this.defaultLinkColor = this.lineColor;\r\n    this.titleColor = this.text;\r\n\r\n    /* Sequence Diagram variables */\r\n\r\n    this.actorBorder = lighten(this.border1, 23);\r\n    this.actorBkg = this.mainBkg;\r\n    this.actorTextColor = this.text;\r\n    this.actorLineColor = this.lineColor;\r\n    this.signalColor = this.text;\r\n    this.signalTextColor = this.text;\r\n    this.labelBoxBkgColor = this.actorBkg;\r\n    this.labelBoxBorderColor = this.actorBorder;\r\n    this.labelTextColor = this.text;\r\n    this.loopTextColor = this.text;\r\n    this.noteBorderColor = '#999';\r\n    this.noteBkgColor = '#666';\r\n    this.noteTextColor = '#fff';\r\n\r\n    /* Gantt chart variables */\r\n\r\n    this.sectionBkgColor = lighten(this.contrast, 30);\r\n    this.sectionBkgColor2 = lighten(this.contrast, 30);\r\n\r\n    this.taskBorderColor = darken(this.contrast, 10);\r\n\r\n    this.taskBkgColor = this.contrast;\r\n    this.taskTextColor = this.taskTextLightColor;\r\n    this.taskTextDarkColor = this.text;\r\n    this.taskTextOutsideColor = this.taskTextDarkColor;\r\n    this.activeTaskBorderColor = this.taskBorderColor;\r\n    this.activeTaskBkgColor = this.mainBkg;\r\n    this.gridColor = lighten(this.border1, 30);\r\n\r\n    this.doneTaskBkgColor = this.done;\r\n    this.doneTaskBorderColor = this.lineColor;\r\n    this.critBkgColor = this.critical;\r\n    this.critBorderColor = darken(this.critBkgColor, 10);\r\n\r\n    this.todayLineColor = this.critBkgColor;\r\n\r\n    /* state colors */\r\n    this.transitionColor = this.transitionColor || '#000';\r\n    this.transitionLabelColor = this.transitionLabelColor || this.textColor;\r\n    this.stateLabelColor = this.stateLabelColor || this.stateBkg || this.primaryTextColor;\r\n\r\n    this.stateBkg = this.stateBkg || this.mainBkg;\r\n    this.labelBackgroundColor = this.labelBackgroundColor || this.stateBkg;\r\n    this.compositeBackground = this.compositeBackground || this.background || this.tertiaryColor;\r\n    this.altBackground = this.altBackground || '#f4f4f4';\r\n    this.compositeTitleBackground = this.compositeTitleBackground || this.mainBkg;\r\n    this.stateBorder = this.stateBorder || '#000';\r\n    this.innerEndBackground = this.primaryBorderColor;\r\n    this.specialStateColor = '#222';\r\n\r\n    this.errorBkgColor = this.errorBkgColor || this.tertiaryColor;\r\n    this.errorTextColor = this.errorTextColor || this.tertiaryTextColor;\r\n\r\n    /* class */\r\n    this.classText = this.primaryTextColor;\r\n    /* journey */\r\n    this.fillType0 = this.primaryColor;\r\n    this.fillType1 = this.secondaryColor;\r\n    this.fillType2 = adjust(this.primaryColor, { h: 64 });\r\n    this.fillType3 = adjust(this.secondaryColor, { h: 64 });\r\n    this.fillType4 = adjust(this.primaryColor, { h: -64 });\r\n    this.fillType5 = adjust(this.secondaryColor, { h: -64 });\r\n    this.fillType6 = adjust(this.primaryColor, { h: 128 });\r\n    this.fillType7 = adjust(this.secondaryColor, { h: 128 });\r\n\r\n    // /* pie */\r\n    this.pie1 = this.pie1 || '#F4F4F4';\r\n    this.pie2 = this.pie2 || '#555';\r\n    this.pie3 = this.pie3 || '#BBB';\r\n    this.pie4 = this.pie4 || '#777';\r\n    this.pie5 = this.pie5 || '#999';\r\n    this.pie6 = this.pie6 || '#DDD';\r\n    this.pie7 = this.pie7 || '#FFF';\r\n    this.pie8 = this.pie8 || '#DDD';\r\n    this.pie9 = this.pie9 || '#BBB';\r\n    this.pie10 = this.pie10 || '#999';\r\n    this.pie11 = this.pie11 || '#777';\r\n    this.pie12 = this.pie12 || '#555';\r\n    this.pieTitleTextSize = this.pieTitleTextSize || '25px';\r\n    this.pieTitleTextColor = this.pieTitleTextColor || this.taskTextDarkColor;\r\n    this.pieSectionTextSize = this.pieSectionTextSize || '17px';\r\n    this.pieSectionTextColor = this.pieSectionTextColor || this.textColor;\r\n    this.pieLegendTextSize = this.pieLegendTextSize || '17px';\r\n    this.pieLegendTextColor = this.pieLegendTextColor || this.taskTextDarkColor;\r\n    this.pieStrokeColor = this.pieStrokeColor || 'black';\r\n    this.pieStrokeWidth = this.pieStrokeWidth || '2px';\r\n    this.pieOpacity = this.pieOpacity || '0.7';\r\n\r\n    // this.pie1 = this.pie1 || '#212529';\r\n    // this.pie2 = this.pie2 || '#343A40';\r\n    // this.pie3 = this.pie3 || '#495057';\r\n    // this.pie4 = this.pie4 || '#6C757D';\r\n    // this.pie5 = this.pie5 || adjust(this.secondaryColor, { l: -10 });\r\n    // this.pie6 = this.pie6 || adjust(this.tertiaryColor, { l: -10 });\r\n    // this.pie7 = this.pie7 || adjust(this.primaryColor, { h: +60, l: -10 });\r\n    // this.pie8 = this.pie8 || adjust(this.primaryColor, { h: -60, l: -10 });\r\n    // this.pie9 = this.pie9 || adjust(this.primaryColor, { h: 120, l: 0 });\r\n    // this.pie10 = this.pie10 || adjust(this.primaryColor, { h: +60, l: -20 });\r\n    // this.pie11 = this.pie11 || adjust(this.primaryColor, { h: -60, l: -20 });\r\n    // this.pie12 = this.pie12 || adjust(this.primaryColor, { h: 120, l: -10 });\r\n\r\n    /* requirement-diagram */\r\n    this.requirementBackground = this.requirementBackground || this.primaryColor;\r\n    this.requirementBorderColor = this.requirementBorderColor || this.primaryBorderColor;\r\n    this.requirementBorderSize = this.requirementBorderSize || this.primaryBorderColor;\r\n    this.requirementTextColor = this.requirementTextColor || this.primaryTextColor;\r\n    this.relationColor = this.relationColor || this.lineColor;\r\n    this.relationLabelBackground = this.relationLabelBackground || this.edgeLabelBackground;\r\n    this.relationLabelColor = this.relationLabelColor || this.actorTextColor;\r\n\r\n    /* git */\r\n    this.git0 = darken(this.pie1, 25) || this.primaryColor;\r\n    this.git1 = this.pie2 || this.secondaryColor;\r\n    this.git2 = this.pie3 || this.tertiaryColor;\r\n    this.git3 = this.pie4 || adjust(this.primaryColor, { h: -30 });\r\n    this.git4 = this.pie5 || adjust(this.primaryColor, { h: -60 });\r\n    this.git5 = this.pie6 || adjust(this.primaryColor, { h: -90 });\r\n    this.git6 = this.pie7 || adjust(this.primaryColor, { h: +60 });\r\n    this.git7 = this.pie8 || adjust(this.primaryColor, { h: +120 });\r\n\r\n    this.gitInv0 = this.gitInv0 || invert(this.git0);\r\n    this.gitInv1 = this.gitInv1 || invert(this.git1);\r\n    this.gitInv2 = this.gitInv2 || invert(this.git2);\r\n    this.gitInv3 = this.gitInv3 || invert(this.git3);\r\n    this.gitInv4 = this.gitInv4 || invert(this.git4);\r\n    this.gitInv5 = this.gitInv5 || invert(this.git5);\r\n    this.gitInv6 = this.gitInv6 || invert(this.git6);\r\n    this.gitInv7 = this.gitInv7 || invert(this.git7);\r\n\r\n    this.branchLabelColor = this.branchLabelColor || this.labelTextColor;\r\n    this.gitBranchLabel0 = this.branchLabelColor;\r\n    this.gitBranchLabel1 = 'white';\r\n    this.gitBranchLabel2 = this.branchLabelColor;\r\n    this.gitBranchLabel3 = 'white';\r\n    this.gitBranchLabel4 = this.branchLabelColor;\r\n    this.gitBranchLabel5 = this.branchLabelColor;\r\n    this.gitBranchLabel6 = this.branchLabelColor;\r\n    this.gitBranchLabel7 = this.branchLabelColor;\r\n\r\n    this.tagLabelColor = this.tagLabelColor || this.primaryTextColor;\r\n    this.tagLabelBackground = this.tagLabelBackground || this.primaryColor;\r\n    this.tagLabelBorder = this.tagBorder || this.primaryBorderColor;\r\n    this.commitLabelColor = this.commitLabelColor || this.secondaryTextColor;\r\n    this.commitLabelBackground = this.commitLabelBackground || this.secondaryColor;\r\n  }\r\n  calculate(overrides) {\r\n    if (typeof overrides !== 'object') {\r\n      // Calculate colors form base colors\r\n      this.updateColors();\r\n      return;\r\n    }\r\n\r\n    const keys = Object.keys(overrides);\r\n\r\n    // Copy values from overrides, this is mainly for base colors\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n\r\n    // Calculate colors form base colors\r\n    this.updateColors();\r\n    // Copy values from overrides again in case of an override of derived value\r\n    keys.forEach((k) => {\r\n      this[k] = overrides[k];\r\n    });\r\n  }\r\n}\r\n\r\nexport const getThemeVariables = (userOverrides) => {\r\n  const theme = new Theme();\r\n  theme.calculate(userOverrides);\r\n  return theme;\r\n};\r\n","import { sanitizeUrl } from '@braintree/sanitize-url';\r\nimport {\r\n  curveBasis,\r\n  curveBasisClosed,\r\n  curveBasisOpen,\r\n  curveLinear,\r\n  curveLinearClosed,\r\n  curveMonotoneX,\r\n  curveMonotoneY,\r\n  curveNatural,\r\n  curveStep,\r\n  curveStepAfter,\r\n  curveStepBefore,\r\n  select,\r\n} from 'd3';\r\nimport common from './diagrams/common/common';\r\nimport { configKeys } from './defaultConfig';\r\nimport { log } from './logger';\r\n\r\n// Effectively an enum of the supported curve types, accessible by name\r\nconst d3CurveTypes = {\r\n  curveBasis: curveBasis,\r\n  curveBasisClosed: curveBasisClosed,\r\n  curveBasisOpen: curveBasisOpen,\r\n  curveLinear: curveLinear,\r\n  curveLinearClosed: curveLinearClosed,\r\n  curveMonotoneX: curveMonotoneX,\r\n  curveMonotoneY: curveMonotoneY,\r\n  curveNatural: curveNatural,\r\n  curveStep: curveStep,\r\n  curveStepAfter: curveStepAfter,\r\n  curveStepBefore: curveStepBefore,\r\n};\r\nconst directive =\r\n  /[%]{2}[{]\\s*(?:(?:(\\w+)\\s*:|(\\w+))\\s*(?:(?:(\\w+))|((?:(?![}][%]{2}).|\\r?\\n)*))?\\s*)(?:[}][%]{2})?/gi;\r\nconst directiveWithoutOpen =\r\n  /\\s*(?:(?:(\\w+)(?=:):|(\\w+))\\s*(?:(?:(\\w+))|((?:(?![}][%]{2}).|\\r?\\n)*))?\\s*)(?:[}][%]{2})?/gi;\r\nconst anyComment = /\\s*%%.*\\n/gm;\r\n\r\n/**\r\n * @function detectInit Detects the init config object from the text\r\n *\r\n *   ```mermaid\r\n *   %%{init: {\"theme\": \"debug\", \"logLevel\": 1 }}%%\r\n *   graph LR\r\n *    a-->b\r\n *    b-->c\r\n *    c-->d\r\n *    d-->e\r\n *    e-->f\r\n *    f-->g\r\n *    g-->h\r\n * ```\r\n *\r\n *   Or\r\n *\r\n *   ```mermaid\r\n *   %%{initialize: {\"theme\": \"dark\", logLevel: \"debug\" }}%%\r\n *   graph LR\r\n *    a-->b\r\n *    b-->c\r\n *    c-->d\r\n *    d-->e\r\n *    e-->f\r\n *    f-->g\r\n *    g-->h\r\n * ```\r\n * @param {string} text The text defining the graph\r\n * @param {any} cnf\r\n * @returns {object} The json object representing the init passed to mermaid.initialize()\r\n */\r\nexport const detectInit = function (text, cnf) {\r\n  let inits = detectDirective(text, /(?:init\\b)|(?:initialize\\b)/);\r\n  let results = {};\r\n\r\n  if (Array.isArray(inits)) {\r\n    let args = inits.map((init) => init.args);\r\n    directiveSanitizer(args);\r\n\r\n    results = assignWithDepth(results, [...args]);\r\n  } else {\r\n    results = inits.args;\r\n  }\r\n  if (results) {\r\n    let type = detectType(text, cnf);\r\n    ['config'].forEach((prop) => {\r\n      if (typeof results[prop] !== 'undefined') {\r\n        if (type === 'flowchart-v2') {\r\n          type = 'flowchart';\r\n        }\r\n        results[type] = results[prop];\r\n        delete results[prop];\r\n      }\r\n    });\r\n  }\r\n\r\n  // Todo: refactor this, these results are never used\r\n  return results;\r\n};\r\n\r\n/**\r\n * @function detectDirective Detects the directive from the text. Text can be single line or\r\n *   multiline. If type is null or omitted the first directive encountered in text will be returned\r\n *\r\n *   ```mermaid\r\n *   graph LR\r\n *    %%{somedirective}%%\r\n *    a-->b\r\n *    b-->c\r\n *    c-->d\r\n *    d-->e\r\n *    e-->f\r\n *    f-->g\r\n *    g-->h\r\n * ```\r\n * @param {string} text The text defining the graph\r\n * @param {string | RegExp} type The directive to return (default: null)\r\n * @returns {object | Array} An object or Array representing the directive(s): { type: string, args:\r\n *   object|null } matched by the input type if a single directive was found, that directive object\r\n *   will be returned.\r\n */\r\nexport const detectDirective = function (text, type = null) {\r\n  try {\r\n    const commentWithoutDirectives = new RegExp(\r\n      `[%]{2}(?![{]${directiveWithoutOpen.source})(?=[}][%]{2}).*\\n`,\r\n      'ig'\r\n    );\r\n    text = text.trim().replace(commentWithoutDirectives, '').replace(/'/gm, '\"');\r\n    log.debug(\r\n      `Detecting diagram directive${type !== null ? ' type:' + type : ''} based on the text:${text}`\r\n    );\r\n    let match,\r\n      result = [];\r\n    while ((match = directive.exec(text)) !== null) {\r\n      // This is necessary to avoid infinite loops with zero-width matches\r\n      if (match.index === directive.lastIndex) {\r\n        directive.lastIndex++;\r\n      }\r\n      if (\r\n        (match && !type) ||\r\n        (type && match[1] && match[1].match(type)) ||\r\n        (type && match[2] && match[2].match(type))\r\n      ) {\r\n        let type = match[1] ? match[1] : match[2];\r\n        let args = match[3] ? match[3].trim() : match[4] ? JSON.parse(match[4].trim()) : null;\r\n        result.push({ type, args });\r\n      }\r\n    }\r\n    if (result.length === 0) {\r\n      result.push({ type: text, args: null });\r\n    }\r\n\r\n    return result.length === 1 ? result[0] : result;\r\n  } catch (error) {\r\n    log.error(\r\n      `ERROR: ${error.message} - Unable to parse directive\r\n      ${type !== null ? ' type:' + type : ''} based on the text:${text}`\r\n    );\r\n    return { type: null, args: null };\r\n  }\r\n};\r\n\r\n/**\r\n * @function detectType Detects the type of the graph text. Takes into consideration the possible\r\n *   existence of an %%init directive\r\n *\r\n *   ```mermaid\r\n *   %%{initialize: {\"startOnLoad\": true, logLevel: \"fatal\" }}%%\r\n *   graph LR\r\n *    a-->b\r\n *    b-->c\r\n *    c-->d\r\n *    d-->e\r\n *    e-->f\r\n *    f-->g\r\n *    g-->h\r\n * ```\r\n * @param {string} text The text defining the graph\r\n * @param {{\r\n *   class: { defaultRenderer: string } | undefined;\r\n *   state: { defaultRenderer: string } | undefined;\r\n *   flowchart: { defaultRenderer: string } | undefined;\r\n * }} [cnf]\r\n * @returns {string} A graph definition key\r\n */\r\nexport const detectType = function (text, cnf) {\r\n  text = text.replace(directive, '').replace(anyComment, '\\n');\r\n  if (text.match(/^\\s*sequenceDiagram/)) {\r\n    return 'sequence';\r\n  }\r\n\r\n  if (text.match(/^\\s*gantt/)) {\r\n    return 'gantt';\r\n  }\r\n  if (text.match(/^\\s*classDiagram-v2/)) {\r\n    return 'classDiagram';\r\n  }\r\n  if (text.match(/^\\s*classDiagram/)) {\r\n    if (cnf && cnf.class && cnf.class.defaultRenderer === 'dagre-wrapper') return 'classDiagram';\r\n    return 'class';\r\n  }\r\n\r\n  if (text.match(/^\\s*stateDiagram-v2/)) {\r\n    return 'stateDiagram';\r\n  }\r\n\r\n  if (text.match(/^\\s*stateDiagram/)) {\r\n    if (cnf && cnf.class && cnf.state.defaultRenderer === 'dagre-wrapper') return 'stateDiagram';\r\n    return 'state';\r\n  }\r\n\r\n  if (text.match(/^\\s*gitGraph/)) {\r\n    return 'gitGraph';\r\n  }\r\n  if (text.match(/^\\s*flowchart/)) {\r\n    return 'flowchart-v2';\r\n  }\r\n\r\n  if (text.match(/^\\s*info/)) {\r\n    return 'info';\r\n  }\r\n  if (text.match(/^\\s*pie/)) {\r\n    return 'pie';\r\n  }\r\n\r\n  if (text.match(/^\\s*erDiagram/)) {\r\n    return 'er';\r\n  }\r\n\r\n  if (text.match(/^\\s*journey/)) {\r\n    return 'journey';\r\n  }\r\n\r\n  if (text.match(/^\\s*requirement/) || text.match(/^\\s*requirementDiagram/)) {\r\n    return 'requirement';\r\n  }\r\n  if (cnf && cnf.flowchart && cnf.flowchart.defaultRenderer === 'dagre-wrapper')\r\n    return 'flowchart-v2';\r\n\r\n  return 'flowchart';\r\n};\r\n\r\n/**\r\n * Caches results of functions based on input\r\n *\r\n * @param {Function} fn Function to run\r\n * @param {Function} resolver Function that resolves to an ID given arguments the `fn` takes\r\n * @returns {Function} An optimized caching function\r\n */\r\nconst memoize = (fn, resolver) => {\r\n  let cache = {};\r\n  return (...args) => {\r\n    let n = resolver ? resolver.apply(this, args) : args[0];\r\n    if (n in cache) {\r\n      return cache[n];\r\n    } else {\r\n      let result = fn(...args);\r\n      cache[n] = result;\r\n      return result;\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * @function isSubstringInArray Detects whether a substring in present in a given array\r\n * @param {string} str The substring to detect\r\n * @param {Array} arr The array to search\r\n * @returns {number} The array index containing the substring or -1 if not present\r\n */\r\nexport const isSubstringInArray = function (str, arr) {\r\n  for (let i = 0; i < arr.length; i++) {\r\n    if (arr[i].match(str)) return i;\r\n  }\r\n  return -1;\r\n};\r\n\r\n/**\r\n * Returns a d3 curve given a curve name\r\n *\r\n * @param {string | undefined} interpolate The interpolation name\r\n * @param {any} defaultCurve The default curve to return\r\n * @returns {import('d3-shape').CurveFactory} The curve factory to use\r\n */\r\nexport const interpolateToCurve = (interpolate, defaultCurve) => {\r\n  if (!interpolate) {\r\n    return defaultCurve;\r\n  }\r\n  const curveName = `curve${interpolate.charAt(0).toUpperCase() + interpolate.slice(1)}`;\r\n  return d3CurveTypes[curveName] || defaultCurve;\r\n};\r\n\r\n/**\r\n * Formats a URL string\r\n *\r\n * @param {string} linkStr String of the URL\r\n * @param {{ securityLevel: string }} config Configuration passed to MermaidJS\r\n * @returns {string | undefined} The formatted URL\r\n */\r\nexport const formatUrl = (linkStr, config) => {\r\n  let url = linkStr.trim();\r\n\r\n  if (url) {\r\n    if (config.securityLevel !== 'loose') {\r\n      return sanitizeUrl(url);\r\n    }\r\n\r\n    return url;\r\n  }\r\n};\r\n\r\n/**\r\n * Runs a function\r\n *\r\n * @param {string} functionName A dot seperated path to the function relative to the `window`\r\n * @param {...any} params Parameters to pass to the function\r\n */\r\nexport const runFunc = (functionName, ...params) => {\r\n  const arrPaths = functionName.split('.');\r\n\r\n  const len = arrPaths.length - 1;\r\n  const fnName = arrPaths[len];\r\n\r\n  let obj = window;\r\n  for (let i = 0; i < len; i++) {\r\n    obj = obj[arrPaths[i]];\r\n    if (!obj) return;\r\n  }\r\n\r\n  obj[fnName](...params);\r\n};\r\n\r\n/**\r\n * @typedef {object} Point A (x, y) point\r\n * @property {number} x The x value\r\n * @property {number} y The y value\r\n */\r\n\r\n/**\r\n * Finds the distance between two points using the Distance Formula\r\n *\r\n * @param {Point} p1 The first point\r\n * @param {Point} p2 The second point\r\n * @returns {number} The distance\r\n */\r\nconst distance = (p1, p2) =>\r\n  p1 && p2 ? Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2)) : 0;\r\n\r\n/**\r\n * @param {Point[]} points List of points\r\n * @returns {Point}\r\n * @todo Give this a description\r\n */\r\nconst traverseEdge = (points) => {\r\n  let prevPoint;\r\n  let totalDistance = 0;\r\n\r\n  points.forEach((point) => {\r\n    totalDistance += distance(point, prevPoint);\r\n    prevPoint = point;\r\n  });\r\n\r\n  // Traverse half of total distance along points\r\n  let remainingDistance = totalDistance / 2;\r\n  let center = undefined;\r\n  prevPoint = undefined;\r\n  points.forEach((point) => {\r\n    if (prevPoint && !center) {\r\n      const vectorDistance = distance(point, prevPoint);\r\n      if (vectorDistance < remainingDistance) {\r\n        remainingDistance -= vectorDistance;\r\n      } else {\r\n        // The point is remainingDistance from prevPoint in the vector between prevPoint and point\r\n        // Calculate the coordinates\r\n        const distanceRatio = remainingDistance / vectorDistance;\r\n        if (distanceRatio <= 0) center = prevPoint;\r\n        if (distanceRatio >= 1) center = { x: point.x, y: point.y };\r\n        if (distanceRatio > 0 && distanceRatio < 1) {\r\n          center = {\r\n            x: (1 - distanceRatio) * prevPoint.x + distanceRatio * point.x,\r\n            y: (1 - distanceRatio) * prevPoint.y + distanceRatio * point.y,\r\n          };\r\n        }\r\n      }\r\n    }\r\n    prevPoint = point;\r\n  });\r\n  return center;\r\n};\r\n\r\n/**\r\n * Alias for `traverseEdge`\r\n *\r\n * @param {Point[]} points List of points\r\n * @returns {Point} Return result of `transverseEdge`\r\n */\r\nconst calcLabelPosition = (points) => {\r\n  return traverseEdge(points);\r\n};\r\n\r\nconst calcCardinalityPosition = (isRelationTypePresent, points, initialPosition) => {\r\n  let prevPoint;\r\n  let totalDistance = 0; // eslint-disable-line\r\n  log.info('our points', points);\r\n  if (points[0] !== initialPosition) {\r\n    points = points.reverse();\r\n  }\r\n  points.forEach((point) => {\r\n    totalDistance += distance(point, prevPoint);\r\n    prevPoint = point;\r\n  });\r\n\r\n  // Traverse only 25 total distance along points to find cardinality point\r\n  const distanceToCardinalityPoint = 25;\r\n\r\n  let remainingDistance = distanceToCardinalityPoint;\r\n  let center;\r\n  prevPoint = undefined;\r\n  points.forEach((point) => {\r\n    if (prevPoint && !center) {\r\n      const vectorDistance = distance(point, prevPoint);\r\n      if (vectorDistance < remainingDistance) {\r\n        remainingDistance -= vectorDistance;\r\n      } else {\r\n        // The point is remainingDistance from prevPoint in the vector between prevPoint and point\r\n        // Calculate the coordinates\r\n        const distanceRatio = remainingDistance / vectorDistance;\r\n        if (distanceRatio <= 0) center = prevPoint;\r\n        if (distanceRatio >= 1) center = { x: point.x, y: point.y };\r\n        if (distanceRatio > 0 && distanceRatio < 1) {\r\n          center = {\r\n            x: (1 - distanceRatio) * prevPoint.x + distanceRatio * point.x,\r\n            y: (1 - distanceRatio) * prevPoint.y + distanceRatio * point.y,\r\n          };\r\n        }\r\n      }\r\n    }\r\n    prevPoint = point;\r\n  });\r\n  // if relation is present (Arrows will be added), change cardinality point off-set distance (d)\r\n  let d = isRelationTypePresent ? 10 : 5;\r\n  //Calculate Angle for x and y axis\r\n  let angle = Math.atan2(points[0].y - center.y, points[0].x - center.x);\r\n  let cardinalityPosition = { x: 0, y: 0 };\r\n  //Calculation cardinality position using angle, center point on the line/curve but pendicular and with offset-distance\r\n  cardinalityPosition.x = Math.sin(angle) * d + (points[0].x + center.x) / 2;\r\n  cardinalityPosition.y = -Math.cos(angle) * d + (points[0].y + center.y) / 2;\r\n  return cardinalityPosition;\r\n};\r\n\r\n/**\r\n * Position ['start_left', 'start_right', 'end_left', 'end_right']\r\n *\r\n * @param {any} terminalMarkerSize\r\n * @param {any} position\r\n * @param {any} _points\r\n * @returns {any}\r\n */\r\nconst calcTerminalLabelPosition = (terminalMarkerSize, position, _points) => {\r\n  // Todo looking to faster cloning method\r\n  let points = JSON.parse(JSON.stringify(_points));\r\n  let prevPoint;\r\n  let totalDistance = 0; // eslint-disable-line\r\n  log.info('our points', points);\r\n  if (position !== 'start_left' && position !== 'start_right') {\r\n    points = points.reverse();\r\n  }\r\n\r\n  points.forEach((point) => {\r\n    totalDistance += distance(point, prevPoint);\r\n    prevPoint = point;\r\n  });\r\n\r\n  // Traverse only 25 total distance along points to find cardinality point\r\n  const distanceToCardinalityPoint = 25 + terminalMarkerSize;\r\n\r\n  let remainingDistance = distanceToCardinalityPoint;\r\n  let center;\r\n  prevPoint = undefined;\r\n  points.forEach((point) => {\r\n    if (prevPoint && !center) {\r\n      const vectorDistance = distance(point, prevPoint);\r\n      if (vectorDistance < remainingDistance) {\r\n        remainingDistance -= vectorDistance;\r\n      } else {\r\n        // The point is remainingDistance from prevPoint in the vector between prevPoint and point\r\n        // Calculate the coordinates\r\n        const distanceRatio = remainingDistance / vectorDistance;\r\n        if (distanceRatio <= 0) center = prevPoint;\r\n        if (distanceRatio >= 1) center = { x: point.x, y: point.y };\r\n        if (distanceRatio > 0 && distanceRatio < 1) {\r\n          center = {\r\n            x: (1 - distanceRatio) * prevPoint.x + distanceRatio * point.x,\r\n            y: (1 - distanceRatio) * prevPoint.y + distanceRatio * point.y,\r\n          };\r\n        }\r\n      }\r\n    }\r\n    prevPoint = point;\r\n  });\r\n  // if relation is present (Arrows will be added), change cardinality point off-set distance (d)\r\n  let d = 10 + terminalMarkerSize * 0.5;\r\n  //Calculate Angle for x and y axis\r\n  let angle = Math.atan2(points[0].y - center.y, points[0].x - center.x);\r\n\r\n  let cardinalityPosition = { x: 0, y: 0 };\r\n\r\n  //Calculation cardinality position using angle, center point on the line/curve but pendicular and with offset-distance\r\n\r\n  cardinalityPosition.x = Math.sin(angle) * d + (points[0].x + center.x) / 2;\r\n  cardinalityPosition.y = -Math.cos(angle) * d + (points[0].y + center.y) / 2;\r\n  if (position === 'start_left') {\r\n    cardinalityPosition.x = Math.sin(angle + Math.PI) * d + (points[0].x + center.x) / 2;\r\n    cardinalityPosition.y = -Math.cos(angle + Math.PI) * d + (points[0].y + center.y) / 2;\r\n  }\r\n  if (position === 'end_right') {\r\n    cardinalityPosition.x = Math.sin(angle - Math.PI) * d + (points[0].x + center.x) / 2 - 5;\r\n    cardinalityPosition.y = -Math.cos(angle - Math.PI) * d + (points[0].y + center.y) / 2 - 5;\r\n  }\r\n  if (position === 'end_left') {\r\n    cardinalityPosition.x = Math.sin(angle) * d + (points[0].x + center.x) / 2 - 5;\r\n    cardinalityPosition.y = -Math.cos(angle) * d + (points[0].y + center.y) / 2 - 5;\r\n  }\r\n  return cardinalityPosition;\r\n};\r\n\r\n/**\r\n * Gets styles from an array of declarations\r\n *\r\n * @param {string[]} arr Declarations\r\n * @returns {{ style: string; labelStyle: string }} The styles grouped as strings\r\n */\r\nexport const getStylesFromArray = (arr) => {\r\n  let style = '';\r\n  let labelStyle = '';\r\n\r\n  for (let i = 0; i < arr.length; i++) {\r\n    if (typeof arr[i] !== 'undefined') {\r\n      // add text properties to label style definition\r\n      if (arr[i].startsWith('color:') || arr[i].startsWith('text-align:')) {\r\n        labelStyle = labelStyle + arr[i] + ';';\r\n      } else {\r\n        style = style + arr[i] + ';';\r\n      }\r\n    }\r\n  }\r\n\r\n  return { style: style, labelStyle: labelStyle };\r\n};\r\n\r\nlet cnt = 0;\r\nexport const generateId = () => {\r\n  cnt++;\r\n  return 'id-' + Math.random().toString(36).substr(2, 12) + '-' + cnt;\r\n};\r\n\r\n/**\r\n * @param {any} length\r\n * @returns {any}\r\n */\r\nfunction makeid(length) {\r\n  var result = '';\r\n  var characters = '0123456789abcdef';\r\n  var charactersLength = characters.length;\r\n  for (var i = 0; i < length; i++) {\r\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n  }\r\n  return result;\r\n}\r\n\r\nexport const random = (options) => {\r\n  return makeid(options.length);\r\n};\r\n\r\n/**\r\n * @function assignWithDepth Extends the functionality of {@link ObjectConstructor.assign} with the\r\n *   ability to merge arbitrary-depth objects For each key in src with path `k` (recursively)\r\n *   performs an Object.assign(dst[`k`], src[`k`]) with a slight change from the typical handling of\r\n *   undefined for dst[`k`]: instead of raising an error, dst[`k`] is auto-initialized to {} and\r\n *   effectively merged with src[`k`]<p> Additionally, dissimilar types will not clobber unless the\r\n *   config.clobber parameter === true. Example:\r\n *\r\n *   ```js\r\n *   let config_0 = { foo: { bar: 'bar' }, bar: 'foo' };\r\n *   let config_1 = { foo: 'foo', bar: 'bar' };\r\n *   let result = assignWithDepth(config_0, config_1);\r\n *   console.log(result);\r\n *   //-> result: { foo: { bar: 'bar' }, bar: 'bar' }\r\n *   ```\r\n *\r\n *   Traditional Object.assign would have clobbered foo in config_0 with foo in config_1. If src is a\r\n *   destructured array of objects and dst is not an array, assignWithDepth will apply each element\r\n *   of src to dst in order.\r\n * @param dst\r\n * @param src\r\n * @param config\r\n * @param dst\r\n * @param src\r\n * @param config\r\n * @param dst\r\n * @param src\r\n * @param config\r\n * @param {any} dst - The destination of the merge\r\n * @param {any} src - The source object(s) to merge into destination\r\n * @param {{ depth: number; clobber: boolean }} [config={ depth: 2, clobber: false }] - Depth: depth\r\n *   to traverse within src and dst for merging - clobber: should dissimilar types clobber (default:\r\n *   { depth: 2, clobber: false }). Default is `{ depth: 2, clobber: false }`\r\n * @returns {any}\r\n */\r\nexport const assignWithDepth = function (dst, src, config) {\r\n  const { depth, clobber } = Object.assign({ depth: 2, clobber: false }, config);\r\n  if (Array.isArray(src) && !Array.isArray(dst)) {\r\n    src.forEach((s) => assignWithDepth(dst, s, config));\r\n    return dst;\r\n  } else if (Array.isArray(src) && Array.isArray(dst)) {\r\n    src.forEach((s) => {\r\n      if (dst.indexOf(s) === -1) {\r\n        dst.push(s);\r\n      }\r\n    });\r\n    return dst;\r\n  }\r\n  if (typeof dst === 'undefined' || depth <= 0) {\r\n    if (dst !== undefined && dst !== null && typeof dst === 'object' && typeof src === 'object') {\r\n      return Object.assign(dst, src);\r\n    } else {\r\n      return src;\r\n    }\r\n  }\r\n  if (typeof src !== 'undefined' && typeof dst === 'object' && typeof src === 'object') {\r\n    Object.keys(src).forEach((key) => {\r\n      if (\r\n        typeof src[key] === 'object' &&\r\n        (dst[key] === undefined || typeof dst[key] === 'object')\r\n      ) {\r\n        if (dst[key] === undefined) {\r\n          dst[key] = Array.isArray(src[key]) ? [] : {};\r\n        }\r\n        dst[key] = assignWithDepth(dst[key], src[key], { depth: depth - 1, clobber });\r\n      } else if (clobber || (typeof dst[key] !== 'object' && typeof src[key] !== 'object')) {\r\n        dst[key] = src[key];\r\n      }\r\n    });\r\n  }\r\n  return dst;\r\n};\r\n\r\nexport const getTextObj = function () {\r\n  return {\r\n    x: 0,\r\n    y: 0,\r\n    fill: undefined,\r\n    anchor: 'start',\r\n    style: '#666',\r\n    width: 100,\r\n    height: 100,\r\n    textMargin: 0,\r\n    rx: 0,\r\n    ry: 0,\r\n    valign: undefined,\r\n  };\r\n};\r\n\r\n/**\r\n * Adds text to an element\r\n *\r\n * @param {SVGElement} elem Element to add text to\r\n * @param {{\r\n *   text: string;\r\n *   x: number;\r\n *   y: number;\r\n *   anchor: 'start' | 'middle' | 'end';\r\n *   fontFamily: string;\r\n *   fontSize: string | number;\r\n *   fontWeight: string | number;\r\n *   fill: string;\r\n *   class: string | undefined;\r\n *   textMargin: number;\r\n * }} textData\r\n * @returns {SVGTextElement} Text element with given styling and content\r\n */\r\nexport const drawSimpleText = function (elem, textData) {\r\n  // Remove and ignore br:s\r\n  const nText = textData.text.replace(common.lineBreakRegex, ' ');\r\n\r\n  const textElem = elem.append('text');\r\n  textElem.attr('x', textData.x);\r\n  textElem.attr('y', textData.y);\r\n  textElem.style('text-anchor', textData.anchor);\r\n  textElem.style('font-family', textData.fontFamily);\r\n  textElem.style('font-size', textData.fontSize);\r\n  textElem.style('font-weight', textData.fontWeight);\r\n  textElem.attr('fill', textData.fill);\r\n  if (typeof textData.class !== 'undefined') {\r\n    textElem.attr('class', textData.class);\r\n  }\r\n\r\n  const span = textElem.append('tspan');\r\n  span.attr('x', textData.x + textData.textMargin * 2);\r\n  span.attr('fill', textData.fill);\r\n  span.text(nText);\r\n\r\n  return textElem;\r\n};\r\n\r\nexport const wrapLabel = memoize(\r\n  (label, maxWidth, config) => {\r\n    if (!label) {\r\n      return label;\r\n    }\r\n    config = Object.assign(\r\n      { fontSize: 12, fontWeight: 400, fontFamily: 'Arial', joinWith: '<br/>' },\r\n      config\r\n    );\r\n    if (common.lineBreakRegex.test(label)) {\r\n      return label;\r\n    }\r\n    const words = label.split(' ');\r\n    const completedLines = [];\r\n    let nextLine = '';\r\n    words.forEach((word, index) => {\r\n      const wordLength = calculateTextWidth(`${word} `, config);\r\n      const nextLineLength = calculateTextWidth(nextLine, config);\r\n      if (wordLength > maxWidth) {\r\n        const { hyphenatedStrings, remainingWord } = breakString(word, maxWidth, '-', config);\r\n        completedLines.push(nextLine, ...hyphenatedStrings);\r\n        nextLine = remainingWord;\r\n      } else if (nextLineLength + wordLength >= maxWidth) {\r\n        completedLines.push(nextLine);\r\n        nextLine = word;\r\n      } else {\r\n        nextLine = [nextLine, word].filter(Boolean).join(' ');\r\n      }\r\n      const currentWord = index + 1;\r\n      const isLastWord = currentWord === words.length;\r\n      if (isLastWord) {\r\n        completedLines.push(nextLine);\r\n      }\r\n    });\r\n    return completedLines.filter((line) => line !== '').join(config.joinWith);\r\n  },\r\n  (label, maxWidth, config) =>\r\n    `${label}-${maxWidth}-${config.fontSize}-${config.fontWeight}-${config.fontFamily}-${config.joinWith}`\r\n);\r\n\r\nconst breakString = memoize(\r\n  (word, maxWidth, hyphenCharacter = '-', config) => {\r\n    config = Object.assign(\r\n      { fontSize: 12, fontWeight: 400, fontFamily: 'Arial', margin: 0 },\r\n      config\r\n    );\r\n    const characters = word.split('');\r\n    const lines = [];\r\n    let currentLine = '';\r\n    characters.forEach((character, index) => {\r\n      const nextLine = `${currentLine}${character}`;\r\n      const lineWidth = calculateTextWidth(nextLine, config);\r\n      if (lineWidth >= maxWidth) {\r\n        const currentCharacter = index + 1;\r\n        const isLastLine = characters.length === currentCharacter;\r\n        const hyphenatedNextLine = `${nextLine}${hyphenCharacter}`;\r\n        lines.push(isLastLine ? nextLine : hyphenatedNextLine);\r\n        currentLine = '';\r\n      } else {\r\n        currentLine = nextLine;\r\n      }\r\n    });\r\n    return { hyphenatedStrings: lines, remainingWord: currentLine };\r\n  },\r\n  (word, maxWidth, hyphenCharacter = '-', config) =>\r\n    `${word}-${maxWidth}-${hyphenCharacter}-${config.fontSize}-${config.fontWeight}-${config.fontFamily}`\r\n);\r\n\r\n/**\r\n * This calculates the text's height, taking into account the wrap breaks and both the statically\r\n * configured height, width, and the length of the text (in pixels).\r\n *\r\n * If the wrapped text text has greater height, we extend the height, so it's value won't overflow.\r\n *\r\n * @param {any} text The text to measure\r\n * @param {any} config - The config for fontSize, fontFamily, and fontWeight all impacting the resulting size\r\n * @returns {any} - The height for the given text\r\n */\r\nexport const calculateTextHeight = function (text, config) {\r\n  config = Object.assign(\r\n    { fontSize: 12, fontWeight: 400, fontFamily: 'Arial', margin: 15 },\r\n    config\r\n  );\r\n  return calculateTextDimensions(text, config).height;\r\n};\r\n\r\n/**\r\n * This calculates the width of the given text, font size and family.\r\n *\r\n * @param {any} text - The text to calculate the width of\r\n * @param {any} config - The config for fontSize, fontFamily, and fontWeight all impacting the resulting size\r\n * @returns {any} - The width for the given text\r\n */\r\nexport const calculateTextWidth = function (text, config) {\r\n  config = Object.assign({ fontSize: 12, fontWeight: 400, fontFamily: 'Arial' }, config);\r\n  return calculateTextDimensions(text, config).width;\r\n};\r\n\r\n/**\r\n * This calculates the dimensions of the given text, font size, font family, font weight, and margins.\r\n *\r\n * @param {any} text - The text to calculate the width of\r\n * @param {any} config - The config for fontSize, fontFamily, fontWeight, and margin all impacting\r\n *   the resulting size\r\n * @returns - The width for the given text\r\n */\r\nexport const calculateTextDimensions = memoize(\r\n  function (text, config) {\r\n    config = Object.assign({ fontSize: 12, fontWeight: 400, fontFamily: 'Arial' }, config);\r\n    const { fontSize, fontFamily, fontWeight } = config;\r\n    if (!text) {\r\n      return { width: 0, height: 0 };\r\n    }\r\n\r\n    // We can't really know if the user supplied font family will render on the user agent;\r\n    // thus, we'll take the max width between the user supplied font family, and a default\r\n    // of sans-serif.\r\n    const fontFamilies = ['sans-serif', fontFamily];\r\n    const lines = text.split(common.lineBreakRegex);\r\n    let dims = [];\r\n\r\n    const body = select('body');\r\n    // We don't want to leak DOM elements - if a removal operation isn't available\r\n    // for any reason, do not continue.\r\n    if (!body.remove) {\r\n      return { width: 0, height: 0, lineHeight: 0 };\r\n    }\r\n\r\n    const g = body.append('svg');\r\n\r\n    for (let fontFamily of fontFamilies) {\r\n      let cheight = 0;\r\n      let dim = { width: 0, height: 0, lineHeight: 0 };\r\n      for (let line of lines) {\r\n        const textObj = getTextObj();\r\n        textObj.text = line;\r\n        const textElem = drawSimpleText(g, textObj)\r\n          .style('font-size', fontSize)\r\n          .style('font-weight', fontWeight)\r\n          .style('font-family', fontFamily);\r\n\r\n        let bBox = (textElem._groups || textElem)[0][0].getBBox();\r\n        dim.width = Math.round(Math.max(dim.width, bBox.width));\r\n        cheight = Math.round(bBox.height);\r\n        dim.height += cheight;\r\n        dim.lineHeight = Math.round(Math.max(dim.lineHeight, cheight));\r\n      }\r\n      dims.push(dim);\r\n    }\r\n\r\n    g.remove();\r\n\r\n    let index =\r\n      isNaN(dims[1].height) ||\r\n      isNaN(dims[1].width) ||\r\n      isNaN(dims[1].lineHeight) ||\r\n      (dims[0].height > dims[1].height &&\r\n        dims[0].width > dims[1].width &&\r\n        dims[0].lineHeight > dims[1].lineHeight)\r\n        ? 0\r\n        : 1;\r\n    return dims[index];\r\n  },\r\n  (text, config) => `${text}-${config.fontSize}-${config.fontWeight}-${config.fontFamily}`\r\n);\r\n\r\n/**\r\n * Applys d3 attributes\r\n *\r\n * @param {any} d3Elem D3 Element to apply the attributes onto\r\n * @param {[string, string][]} attrs Object.keys equivalent format of key to value mapping of attributes\r\n */\r\nconst d3Attrs = function (d3Elem, attrs) {\r\n  for (let attr of attrs) {\r\n    d3Elem.attr(attr[0], attr[1]);\r\n  }\r\n};\r\n\r\n/**\r\n * Gives attributes for an SVG's size given arguments\r\n *\r\n * @param {number} height The height of the SVG\r\n * @param {number} width The width of the SVG\r\n * @param {boolean} useMaxWidth Whether or not to use max-width and set width to 100%\r\n * @returns {Map<'height' | 'width' | 'style', string>} Attributes for the SVG\r\n */\r\nexport const calculateSvgSizeAttrs = function (height, width, useMaxWidth) {\r\n  let attrs = new Map();\r\n  attrs.set('height', height);\r\n  if (useMaxWidth) {\r\n    attrs.set('width', '100%');\r\n    attrs.set('style', `max-width: ${width}px;`);\r\n  } else {\r\n    attrs.set('width', width);\r\n  }\r\n  return attrs;\r\n};\r\n\r\n/**\r\n * Applies attributes from `calculateSvgSizeAttrs`\r\n *\r\n * @param {SVGSVGElement} svgElem The SVG Element to configure\r\n * @param {number} height The height of the SVG\r\n * @param {number} width The width of the SVG\r\n * @param {boolean} useMaxWidth Whether or not to use max-width and set width to 100%\r\n */\r\nexport const configureSvgSize = function (svgElem, height, width, useMaxWidth) {\r\n  const attrs = calculateSvgSizeAttrs(height, width, useMaxWidth);\r\n  d3Attrs(svgElem, attrs);\r\n};\r\n\r\nexport const initIdGeneratior = class iterator {\r\n  constructor(deterministic, seed) {\r\n    this.deterministic = deterministic;\r\n    this.seed = seed;\r\n\r\n    this.count = seed ? seed.length : 0;\r\n  }\r\n\r\n  next() {\r\n    if (!this.deterministic) return Date.now();\r\n\r\n    return this.count++;\r\n  }\r\n};\r\n\r\nlet decoder;\r\n\r\n/**\r\n * Decodes HTML, source: {@link https://github.com/shrpne/entity-decode/blob/v2.0.1/browser.js}\r\n *\r\n * @param {string} html HTML as a string\r\n * @returns Unescaped HTML\r\n */\r\nexport const entityDecode = function (html) {\r\n  decoder = decoder || document.createElement('div');\r\n  // Escape HTML before decoding for HTML Entities\r\n  html = escape(html).replace(/%26/g, '&').replace(/%23/g, '#').replace(/%3B/g, ';');\r\n  // decoding\r\n  decoder.innerHTML = html;\r\n  return unescape(decoder.textContent);\r\n};\r\n\r\n/**\r\n * Sanitizes directive objects\r\n *\r\n * @param {object} args Directive's JSON\r\n */\r\nexport const directiveSanitizer = (args) => {\r\n  log.debug('directiveSanitizer called with', args);\r\n  if (typeof args === 'object') {\r\n    // check for array\r\n    if (args.length) {\r\n      args.forEach((arg) => directiveSanitizer(arg));\r\n    } else {\r\n      // This is an object\r\n      Object.keys(args).forEach((key) => {\r\n        log.debug('Checking key', key);\r\n        if (key.indexOf('__') === 0) {\r\n          log.debug('sanitize deleting __ option', key);\r\n          delete args[key];\r\n        }\r\n\r\n        if (key.indexOf('proto') >= 0) {\r\n          log.debug('sanitize deleting proto option', key);\r\n          delete args[key];\r\n        }\r\n\r\n        if (key.indexOf('constr') >= 0) {\r\n          log.debug('sanitize deleting constr option', key);\r\n          delete args[key];\r\n        }\r\n\r\n        if (key.indexOf('themeCSS') >= 0) {\r\n          log.debug('sanitizing themeCss option');\r\n          args[key] = sanitizeCss(args[key]);\r\n        }\r\n        if (configKeys.indexOf(key) < 0) {\r\n          log.debug('sanitize deleting option', key);\r\n          delete args[key];\r\n        } else {\r\n          if (typeof args[key] === 'object') {\r\n            log.debug('sanitize deleting object', key);\r\n            directiveSanitizer(args[key]);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\nexport const sanitizeCss = (str) => {\r\n  const stringsearch = 'o';\r\n  const startCnt = (str.match(/\\{/g) || []).length;\r\n  const endCnt = (str.match(/\\}/g) || []).length;\r\n  if (startCnt !== endCnt) {\r\n    return '{ /* ERROR: Unbalanced CSS */ }';\r\n  }\r\n  // Todo add more checks here\r\n  return str;\r\n};\r\n\r\nexport default {\r\n  assignWithDepth,\r\n  wrapLabel,\r\n  calculateTextHeight,\r\n  calculateTextWidth,\r\n  calculateTextDimensions,\r\n  calculateSvgSizeAttrs,\r\n  configureSvgSize,\r\n  detectInit,\r\n  detectDirective,\r\n  detectType,\r\n  isSubstringInArray,\r\n  interpolateToCurve,\r\n  calcLabelPosition,\r\n  calcCardinalityPosition,\r\n  calcTerminalLabelPosition,\r\n  formatUrl,\r\n  getStylesFromArray,\r\n  generateId,\r\n  random,\r\n  memoize,\r\n  runFunc,\r\n  entityDecode,\r\n  initIdGeneratior,\r\n  directiveSanitizer,\r\n  sanitizeCss,\r\n};\r\n","// 'path' module extracted from Node.js v8.11.1 (only the posix part)\n// transplited with Babel\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + JSON.stringify(path));\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSegmentLength = 0;\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47 /*/*/)\n      break;\n    else\n      code = 47 /*/*/;\n    if (code === 47 /*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== 46 /*.*/ || res.charCodeAt(res.length - 2) !== 46 /*.*/) {\n          if (res.length > 2) {\n            var lastSlashIndex = res.lastIndexOf('/');\n            if (lastSlashIndex !== res.length - 1) {\n              if (lastSlashIndex === -1) {\n                res = '';\n                lastSegmentLength = 0;\n              } else {\n                res = res.slice(0, lastSlashIndex);\n                lastSegmentLength = res.length - 1 - res.lastIndexOf('/');\n              }\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46 /*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base || (pathObject.name || '') + (pathObject.ext || '');\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0) return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47 /*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute) path = '.';\n    if (path.length > 0 && trailingSeparator) path += '/';\n\n    if (isAbsolute) return '/' + path;\n    return path;\n  },\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47 /*/*/;\n  },\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to) return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to) return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47 /*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = fromEnd - fromStart;\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47 /*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = toEnd - toStart;\n\n    // Compare paths to find the longest common path from root\n    var length = fromLen < toLen ? fromLen : toLen;\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47 /*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47 /*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47 /*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47 /*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47 /*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0) return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = code === 47 /*/*/;\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          if (!matchedSlash) {\n            end = i;\n            break;\n          }\n        } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1) return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1) return '//';\n    return path.slice(0, end);\n  },\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string') throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path) return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end) end = firstNonSlashEnd;else if (end === -1) end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1) return '';\n      return path.slice(start, end);\n    }\n  },\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1)\n            startDot = i;\n          else if (preDotState !== 1)\n            preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError('The \"pathObject\" argument must be of type Object. Received type ' + typeof pathObject);\n    }\n    return _format('/', pathObject);\n  },\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0) return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = code === 47 /*/*/;\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1) startDot = i;else if (preDotState !== 1) preDotState = 1;\n        } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n    // We saw a non-dot character immediately before the dot\n    preDotState === 0 ||\n    // The (right-most) trimmed path component is exactly '..'\n    preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute) ret.base = ret.name = path.slice(1, end);else ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0) ret.dir = path.slice(0, startPart - 1);else if (isAbsolute) ret.dir = '/';\n\n    return ret;\n  },\n\n  sep: '/',\n  delimiter: ':',\n  win32: null,\n  posix: null\n};\n\nposix.posix = posix;\n\nmodule.exports = posix;\n","module.exports = require(\"@braintree/sanitize-url\");","module.exports = require(\"d3\");","module.exports = require(\"dagre\");","module.exports = require(\"dagre-d3\");","module.exports = require(\"dagre-d3/lib/label/add-html-label.js\");","module.exports = require(\"dompurify\");","module.exports = require(\"graphlib\");","module.exports = require(\"khroma\");","module.exports = require(\"moment-mini\");","module.exports = require(\"stylis\");","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","","// module cache are used so entry inlining is disabled\n// startup\n// Load entry module and return exports\nvar __webpack_exports__ = __webpack_require__(__webpack_require__.s = \"./src/mermaid.js\");\n",""],"names":["addSVGAccessibilityFields","yy_parser","svg","id","insert","title_string","getTitle","description","getAccDescription","attr","text","assignWithDepth","log","theme","config","defaultConfig","Object","freeze","siteConfig","configFromInitialize","directives","currentConfig","updateCurrentConfig","siteCfg","_directives","cfg","sumOfDirectives","i","length","d","sanitize","tmpConfigFromInitialize","themeVariables","getThemeVariables","setSiteConfig","conf","saveConfigFromInitilize","updateSiteConfig","getSiteConfig","setConfig","getConfig","options","keys","secure","forEach","key","debug","indexOf","addDirective","directive","fontFamily","push","reset","intersectRect","createLabel","select","evaluate","rect","parent","node","trace","shapeSvg","class","label","appendChild","labelText","labelStyle","undefined","bbox","getBBox","flowchart","htmlLabels","div","children","dv","getBoundingClientRect","width","height","padding","halfPadding","diff","JSON","stringify","style","rx","ry","x","y","rectBox","intersect","point","noteGroup","roundedWithTitle","classes","innerRect","append","divider","shapes","clusterElems","insertCluster","elem","shape","getClusterTitleWidth","removeChild","clear","positionCluster","info","el","sanitizeText","sanitizeTxt","txt","applyStyle","dom","styleFn","addHtmlLabel","fo","document","createElementNS","labelClass","isNode","html","_vertexText","isTitle","vertexText","replace","s","vertexNode","svgLabel","setAttribute","rows","split","Array","isArray","j","tspan","setAttributeNS","textContent","trim","line","curveBasis","utils","edgeLabels","terminalLabels","insertEdgeLabel","edge","labelElement","edgeLabel","startLabelLeft","startLabelElement","startEdgeLabelLeft","inner","slBox","startLeft","setTerminalWidth","startLabelRight","startEdgeLabelRight","startRight","endLabelLeft","endLabelElement","endEdgeLabelLeft","endLeft","endLabelRight","endEdgeLabelRight","endRight","value","positionEdgeLabel","paths","path","updatedPath","originalPath","pos","calcLabelPosition","calcTerminalLabelPosition","arrowTypeStart","arrowTypeEnd","outsideNode","dx","Math","abs","dy","w","h","intersection","outsidePoint","insidePoint","warn","r","Q","R","q","res","_x","_y","cutPathAtIntersect","_points","boundryNode","points","lastPointOutside","isInside","inter","pointPresent","p","find","e","insertEdge","clusterDb","diagramType","graph","pointsHasChanged","tail","v","head","slice","unshift","toCluster","fromCluster","reverse","lineData","filter","Number","isNaN","curve","lineFunction","strokeClasses","thickness","pattern","svgPath","url","state","arrowMarkerAbsolute","window","location","protocol","host","pathname","search","dagre","graphlib","insertMarkers","updateNodeBounds","clearGraphlib","adjustClustersAndEdges","findNonClusterChild","sortNodesByHierarchy","insertNode","positionNode","clearNodes","setNodeElem","clearClusters","clearEdges","recursiveRender","_elem","diagramtype","parentCluster","json","write","dir","rankdir","nodes","edges","clusters","edgePaths","data","parse","clusterData","setNode","setParent","clusterNode","o","newEl","name","layout","n","type","render","markers","circle","ellipse","polygon","intersectEllipse","intersectCircle","cx","cy","px","py","det","sqrt","intersectLine","p1","p2","q1","q2","a1","a2","b1","b2","c1","c2","r1","r2","r3","r4","denom","offset","num","sameSign","module","exports","intersectNode","intersectPolygon","polyPoints","x1","y1","intersections","minX","POSITIVE_INFINITY","minY","entry","min","left","top","sort","pdx","pdy","distp","qdx","qdy","distq","sx","sy","markerArray","markerName","extension","composition","aggregation","dependency","cross","barb","decendants","parents","isDecendant","ancenstorId","edgeInCluster","clusterId","copy","newGraph","rootId","setEdge","error","removeNode","extractDecendants","concat","validate","_id","getAnchorId","externalConnections","depth","d1","d2","removeEdge","extractor","hasChildren","graphSettings","clusterGraph","Graph","multigraph","compound","setGraph","nodesep","ranksep","marginx","marginy","setDefaultEdgeLabel","sorter","result","assign","sorted","labelHelper","insertPolygonShape","note","parseMember","question","questionElem","choice","domId","map","join","hexagon","f","m","hex","rect_left_inv_arrow","lean_right","lean_left","trapezoid","inv_trapezoid","rect_right_inv_arrow","cylinder","totalWidth","totalHeight","props","propKeys","Set","borders","applyNodePropertyBorders","delete","propKey","strokeDashArray","addBorder","skipBorder","includes","rectWithTitle","innerLine","text2","flat","title","textRows","titleBox","descr","stadium","doublecircle","gap","circleGroup","outerCircle","innerCircle","subroutine","start","forkJoin","end","class_box","rowPadding","lineHeight","topLine","bottomLine","maxWidth","maxHeight","labelContainer","verticalPos","hasInterface","classData","annotations","interfaceLabelText","interfaceLabel","interfaceBBox","classTitleString","classTitleLabel","classTitleBBox","classAttributes","members","str","parsedInfo","parsedText","displayText","lbl","cssStyle","classMethods","methods","diffX","fork","nodeElems","link","target","securityLevel","linkTarget","tooltip","haveCallback","decodeEntities","_classes","element","themeCSS","maxTextSize","darkMode","logLevel","startOnLoad","deterministicIds","deterministicIDSeed","diagramPadding","nodeSpacing","rankSpacing","useMaxWidth","defaultRenderer","sequence","activationWidth","diagramMarginX","diagramMarginY","actorMargin","boxMargin","boxTextMargin","noteMargin","messageMargin","messageAlign","mirrorActors","forceMenus","bottomMarginAdj","rightAngles","showSequenceNumbers","actorFontSize","actorFontFamily","actorFontWeight","noteFontSize","noteFontFamily","noteFontWeight","noteAlign","messageFontSize","messageFontFamily","messageFontWeight","wrap","wrapPadding","labelBoxWidth","labelBoxHeight","messageFont","fontSize","fontWeight","noteFont","actorFont","gantt","titleTopMargin","barHeight","barGap","topPadding","rightPadding","leftPadding","gridLineStartPadding","sectionFontSize","numberSectionStyles","axisFormat","topAxis","useWidth","journey","leftMargin","taskFontSize","taskFontFamily","taskMargin","textPlacement","actorColours","sectionFills","sectionColours","dividerMargin","sizeUnit","textHeight","titleShift","forkWidth","forkHeight","miniPadding","fontSizeFactor","labelHeight","edgeLengthFactor","compositTitleSize","radius","er","layoutDirection","minEntityWidth","minEntityHeight","entityPadding","stroke","fill","pie","requirement","rect_fill","text_color","rect_border_size","rect_border_color","rect_min_width","rect_min_height","rect_padding","line_height","gitGraph","nodeLabel","mainBranchName","showCommitLabel","showBranches","keyify","obj","prefix","reduce","configKeys","configApi","common","mermaidAPI","MERMAID_DOM_ID_PREFIX","relations","classCounter","funs","parseDirective","statement","context","splitClassNameAndType","genericType","className","addClass","classId","cssClasses","lookUpDomId","classKeys","setupToolTips","getClass","getClasses","getRelations","addRelation","relation","id1","id2","relationTitle1","relationTitle2","addAnnotation","annotation","validatedClassName","addMember","member","theClass","memberString","startsWith","endsWith","substring","addMembers","cleanupLabel","substr","setCssClass","ids","match","setTooltip","setLink","linkStr","formatUrl","setClickEvent","functionName","functionArgs","setClickFunc","elemId","argList","item","charAt","querySelector","addEventListener","runFunc","bindFunctions","fun","lineType","LINE","DOTTED_LINE","relationType","AGGREGATION","EXTENSION","COMPOSITION","DEPENDENCY","tooltipElem","_groups","selectAll","on","transition","duration","scrollX","right","scrollY","body","scrollTop","classed","direction","getDirection","setDirection","setTitle","sanitizedText","accDescription","setAccDescription","classDb","parser","svgDraw","curveLinear","interpolateToCurve","getStylesFromArray","configureSvgSize","yy","idCache","addClasses","g","vertex","cssClassStr","styles","radious","_shape","addRelations","cnt","defaultStyle","defaultLabelStyle","edgeData","arrowhead","getArrowMarker","type1","type2","interpolate","defaultInterpolate","arrowheadStyle","labelpos","labelType","lineBreakRegex","getGraphId","foundEntry","entries","setConf","cnf","draw","sandboxElement","root","contentDocument","svgBounds","_label","doc","labels","querySelectorAll","k","dim","insertBefore","firstChild","marker","diagram","isMultiGraph","classDef","drawClass","drawEdge","vBox","getStyles","nodeBorder","classText","mainBkg","lineColor","edgeCount","getRelationType","l","labelPosition","p1_card_x","p1_card_y","p2_card_x","p2_card_y","cardinality_1_point","calcCardinalityPosition","cardinality_2_point","bounds","classInfo","isFirst","titleText2","classTitle","titleHeight","membersLine","addTspan","membersBox","methodsLine","method","classBox","rectWidth","childNodes","fieldRegEx","methodRegEx","fieldMatch","methodMatch","buildFieldDisplay","buildMethodDisplay","buildLegacyDisplay","visibility","fieldType","parseGenericTypes","fieldName","classifier","parseClassifier","err","methodName","parameters","returnType","memberText","methodStart","methodEnd","firstChar","textEl","tSpan","cleanedText","DOMPurify","getRows","breakToPlaceholder","removeEscapes","newStr","String","fromCharCode","parseInt","_","c","removeScript","rs","idx","decodedText","sanitizeMore","level","placeholderToBreak","sanitizeTextOrArray","a","hasBreaks","test","splitBreaks","getUrl","useAbsolute","val","entities","relationships","Cardinality","ZERO_OR_ONE","ZERO_OR_MORE","ONE_OR_MORE","ONLY_ONE","Identification","NON_IDENTIFYING","IDENTIFYING","addEntity","attributes","getEntities","addAttributes","entityName","attribs","entity","attributeName","addRelationship","entA","rolA","entB","rSpec","rel","entityA","roleA","entityB","relSpec","getRelationships","ERMarkers","ONLY_ONE_START","ONLY_ONE_END","ZERO_OR_ONE_START","ZERO_OR_ONE_END","ONE_OR_MORE_START","ONE_OR_MORE_END","ZERO_OR_MORE_START","ZERO_OR_MORE_END","erDb","erParser","erMarkers","drawAttributes","groupNode","entityTextNode","heightPadding","widthPadding","attrFontSize","labelBBox","attributeNodes","hasKeyType","hasComment","maxTypeWidth","maxNameWidth","maxKeyWidth","maxCommentWidth","cumulativeHeight","attrNum","attributeKeyType","attributeComment","attrPrefix","nodeHeight","typeNode","attributeType","nameNode","attributeNode","tn","nn","typeBBox","nameBBox","max","keyTypeNode","kn","keyTypeBBox","commentNode","cn","commentNodeBBox","widthPaddingFactor","bBox","spareColumnWidth","heightOffset","attribStyle","alignY","typeRect","nameXOffset","parseFloat","nameRect","keyTypeAndCommentXOffset","keyTypeRect","drawEntities","svgNode","firstOne","textId","textNode","entityWidth","entityHeight","rectNode","rectBBox","adjustEntities","getEdgeName","addRelationships","relationship","relCnt","drawRelationshipFromLayout","relType","cardA","cardB","len","getTotalLength","labelPoint","getPointAtLength","labelId","labelNode","directed","edgesep","firstEntity","tertiaryColor","dagreD3","addToRender","addToRenderV2","addShape","vertexCounter","vertices","subGraphs","subGraphLookup","tooltips","subCount","firstGraphFlag","version","veritceKeys","addVertex","addSingleLink","_start","_end","linktext","addLink","updateLinkInterpolate","positions","interp","updateLink","isSubstringInArray","textStyles","newStyle1","newStyle2","setClass","setClickFun","getTooltip","getVertices","getEdges","ver","setGen","addSubGraph","list","_title","uniq","prims","boolean","number","string","objs","nodeList","stmt","hasOwnProperty","apply","nl","subGraph","makeUniq","getPosForId","secCount","posCrossRef","indexNodes2","count","posCount","childPos","getDepthFirstPos","indexNodes","getSubGraphs","firstGraph","destructStartLink","_str","countChar","char","destructEndLink","dots","destructLink","_startStr","startInfo","exists","allSgs","sg","allSubgraphs","lex","flowDb","flow","addVertices","vert","svgId","classStr","parentNode","addEdges","linkIdCnt","defaultStyles","linkIdBase","linkId","linkNameStart","linkNameEnd","minlen","subG","linkNode","flowChartShapes","_doc","Render","arrows","none","normal","util","clusterRects","clusterEl","xPos","baseVal","yPos","cluster","te","classList","add","nodeTextColor","textColor","titleColor","arrowheadColor","edgeLabelBackground","clusterBkg","clusterBorder","border2","moment","sanitizeUrl","dateFormat","todayMarker","excludes","links","sections","tasks","currentSection","tags","inclusiveEndDates","lastOrder","taskCnt","lastTask","lastTaskID","rawTasks","setAxisFormat","getAxisFormat","setTodayMarker","getTodayMarker","setDateFormat","enableInclusiveEndDates","endDatesAreInclusive","enableTopAxis","topAxisEnabled","getDateFormat","setIncludes","toLowerCase","getIncludes","setExcludes","getExcludes","getLinks","addSection","getSections","getTasks","allItemsPricessed","compileTasks","maxDepth","iterationCount","isInvalidDate","date","format","isoWeekday","checkTaskDates","task","manualEndTime","startTime","endTime","renderEndTime","fixTaskDates","toDate","invalid","getStartDate","prevTime","re","afterStatement","exec","latestEndingTask","findTaskById","dt","Date","setHours","mDate","isValid","durationToDate","durationStatement","relativeTime","getEndDate","inclusive","parseId","idStr","compileData","prevTask","dataStr","ds","getTaskTags","endTimeData","parseData","prevTaskId","startData","taskDb","addTask","rawTask","section","processed","raw","taskInfo","active","done","crit","milestone","order","addTaskOrg","newTask","compileTask","allProcessed","_linkStr","pushFun","open","callbackFunction","matchFound","t","regex","RegExp","shift","scaleTime","scaleLinear","interpolateHcl","axisBottom","axisTop","timeFormat","ganttDb","getElementById","parentElement","offsetWidth","taskArray","timeScale","domain","rangeRound","categories","catsUnfiltered","checkUnique","taskCompare","b","taskA","taskB","makeGant","pageWidth","pageHeight","colorScale","range","drawExcludeDays","makeGrid","drawRects","vertLabels","drawToday","theArray","theGap","theTopPad","theSidePad","theBarHeight","theColorScale","enter","rectangles","toString","secNum","taskClass","startX","endX","textWidth","taskType","each","taskRect","taskText","oldParent","Link","createElement","minTime","maxTime","excludeRanges","valueOf","clone","renderEnd","bottomXAxis","tickSize","tickFormat","call","topXAxis","numOccurances","prevGap","getCount","todayG","today","todayLine","arr","hash","prototype","getCounts","word","excludeBkgColor","sectionBkgColor","sectionBkgColor2","altSectionBkgColor","ganttFontSize","gridColor","todayLineColor","taskTextDarkColor","taskTextClickableColor","taskTextColor","taskBkgColor","taskBorderColor","taskTextOutsideColor","activeTaskBkgColor","activeTaskBorderColor","doneTaskBorderColor","doneTaskBkgColor","critBorderColor","critBkgColor","random","commits","branches","curBranch","seq","getId","uniqBy","fn","recordMap","create","out","setOptions","rawOptString","message","getOptions","commit","msg","tag","commitType","NORMAL","branch","checkout","Error","token","loc","first_line","last_line","first_column","last_column","expected","merge","otherBranch","currentCommit","otherCommit","MERGE","upsert","newval","index","splice","prettyPrintCommitHistory","commitArr","newCommit","nextCommit","prettyPrint","getCommitsArray","mainBranch","getBranchesAsObjArray","branchArr","getBranches","getCommits","getCurrentBranch","getHead","REVERSE","HIGHLIGHT","db","gitGraphParser","allCommitsDict","branchNum","branchPos","commitPos","lanes","maxPos","drawText","drawCommits","modifyGraph","gitGraphConfig","gBullets","gLabels","sortedKeys","typeClass","circle2","labelBkg","hole","tagBbox","h2","ly","hasOverlappingCommits","commit1","commit2","allCommits","commit1Pos","commit2Pos","overlappingComits","findLane","y2","_depth","candidate","ok","drawArrow","overlappingCommits","arc","arc2","colorClassNum","lineDef","lineY","arrow","drawArrows","gArrows","drawBranches","bkg","branchLabel","commitLabelColor","commitLabelBackground","tagLabelColor","tagLabelBackground","tagLabelBorder","primaryColor","setMessage","getMessage","setInfo","inf","getInfo","infoParser","showData","setShowData","toggle","getShowData","cleanupValue","scaleOrdinal","d3pie","pieData","pieParser","margin","legendRectSize","legendSpacing","sum","myGeneratedColors","pie1","pie2","pie3","pie4","pie5","pie6","pie7","pie8","pie9","pie10","pie11","pie12","color","dataReady","arcGenerator","innerRadius","outerRadius","toFixed","centroid","legend","horz","pieStrokeColor","pieStrokeWidth","pieOpacity","pieTitleTextSize","pieTitleTextColor","pieSectionTextColor","pieSectionTextSize","pieLegendTextColor","pieLegendTextSize","latestRequirement","requirements","latestElement","elements","RequirementType","REQUIREMENT","FUNCTIONAL_REQUIREMENT","INTERFACE_REQUIREMENT","PERFORMANCE_REQUIREMENT","PHYSICAL_REQUIREMENT","DESIGN_CONSTRAINT","RiskLevel","LOW_RISK","MED_RISK","HIGH_RISK","VerifyType","VERIFY_ANALYSIS","VERIFY_DEMONSTRATION","VERIFY_INSPECTION","VERIFY_TEST","Relationships","CONTAINS","COPIES","DERIVES","SATISFIES","VERIFIES","REFINES","TRACES","addRequirement","risk","verifyMethod","getRequirements","setNewReqId","setNewReqText","setNewReqRisk","setNewReqVerifyMethod","addElement","docRef","getElements","setNewElementType","setNewElementDocRef","src","dst","req","ReqMarkers","ARROW","insertLineEndings","containsNode","requirementDb","newRectNode","newTitleNode","txts","textStr","yPadding","linePadding","totalY","titleNode","newBodyNode","yStart","currentRow","charLimit","wrappedTxts","currentTextLen","firstPart","lastStr","addEdgeLabel","elementString","drawReqs","reqs","reqName","titleNodeInfo","bodyNode","drawElements","els","elName","relationColor","requirementBackground","requirementBorderColor","requirementBorderSize","requirementTextColor","relationLabelBackground","relationLabelColor","prevActor","actors","messages","notes","sequenceNumbersEnabled","wrapEnabled","addActor","old","autoWrap","properties","actorCnt","rectData","nextActor","activationCount","part","LINETYPE","ACTIVE_START","from","actor","ACTIVE_END","addMessage","idFrom","idTo","answer","to","addSignal","messageType","getMessages","getActors","getActor","getActorKeys","enableSequenceNumbers","disableSequenceNumbers","setWrap","wrapSetting","parseMessage","SOLID","DOTTED","NOTE","SOLID_CROSS","DOTTED_CROSS","SOLID_OPEN","DOTTED_OPEN","LOOP_START","LOOP_END","ALT_START","ALT_ELSE","ALT_END","OPT_START","OPT_END","PAR_START","PAR_AND","PAR_END","RECT_START","RECT_END","SOLID_POINT","DOTTED_POINT","AUTONUMBER","ARROWTYPE","FILLED","OPEN","PLACEMENT","LEFTOF","RIGHTOF","OVER","addNote","placement","addLinks","actorId","insertLinks","addALink","sep","addProperties","insertProperties","addDetails","innerHTML","details","getActorProperty","param","sequenceIndex","step","sequenceIndexStep","visible","sequenceVisible","signalType","loopText","optText","altText","parText","description_lex","fixLifeLineHeights","sequenceDb","startx","stopx","starty","stopy","sequenceItems","activations","models","getHeight","loops","it","acc","actorModel","addLoop","loopModel","msgModel","noteModel","lastActor","lastLoop","lastMessage","lastNote","init","updateVal","updateBounds","_self","updateFn","updateItemBounds","_startx","_stopx","_starty","_stopy","newActivation","actorRect","stackedSize","actorActivations","anchored","anchorElement","endActivation","lastActorActivationIdx","activation","lastIndexOf","createLoop","newLoop","endLoop","pop","addSectionToLoop","loop","sectionTitles","getVerticalPos","bumpVerticalPos","bump","getBounds","drawNote","getNoteRect","rectElem","drawRect","textObj","getTextObj","anchor","textMargin","valign","textElem","round","curr","boundMessage","lines","textDims","calculateTextDimensions","lineStarty","totalOffset","fromBounds","toBounds","drawMessage","drawActors","actorKeys","prevWidth","prevMargin","drawActor","drawActorsPopup","minMenuWidth","getRequiredPopupWidth","menuDimensions","drawPopup","activationBounds","actorObj","adjustLoopHeightForWrap","loopWidths","preMargin","postMargin","addLoopFn","heightAdjust","loopWidth","textConf","wrapLabel","maxMessageWidthPerActor","getMaxMessageWidthPerActor","calculateActorMargins","insertComputerIcon","insertDatabaseIcon","insertClockIcon","calculateLoopBounds","insertArrowHead","insertArrowCrossHead","insertArrowFilledHead","insertSequenceNumber","activeEnd","activationData","drawActivation","messagesToDraw","drawLoop","drawBackgroundRect","messageModel","requiredBoxSize","box","actorLines","boxHeight","boxWidth","extraVertForTitle","isNote","isMessage","textFont","wrappedMessage","messageDimensions","messageWidth","requiredPopupWidth","labelDimensions","labelWidth","actorToMessageWidth","prop","actDims","actorKey","actorWidth","buildNoteModel","shouldWrap","textDimensions","buildMessageModel","process","fromIdx","toIdx","allBounds","boundedWidth","msgDims","stack","current","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","toAdd","enabled","stk","actorBorder","actorBkg","actorTextColor","actorLineColor","signalColor","sequenceNumberColor","signalTextColor","labelBoxBorderColor","labelBoxBkgColor","labelTextColor","loopTextColor","noteBorderColor","noteBkgColor","noteTextColor","activationBkgColor","activationBorderColor","addFunction","addPopupInteraction","popupMenuUpFunc","popupMenuDownFunc","textAttrs","displayValue","actorClass","menuWidth","linkY","linkElem","sanitizedLink","_drawMenuItemTextCandidateFunc","drawImage","imageElem","drawEmbeddedImage","popupMenu","popid","popdownMenu","popupId","pu","display","textData","prevTextHeight","textElems","yfunc","dominantBaseline","alignmentBaseline","span","drawLabel","txtObject","genPoints","cut","drawActorTypeParticipant","center","boxpluslineGroup","cssclass","iconSrc","_drawTextCandidateFunc","drawActorTypeActor","actElem","drawLoopLine","sectionHeight","lower","defs","byText","content","_setTextAttrs","byTspan","byFo","toText","fromTextAttrsDict","set","get","size","stateDb","drawStartState","drawDivider","drawSimpleState","stateDef","drawDescrState","descriptions","isSecond","descrLine","descrBox","addTitleAndBox","altBkg","pad","dblPad","orgBox","orgWidth","orgX","titleWidth","graphBox","drawEndState","drawForkJoinState","parentId","tmp","nText","_drawLongText","_text","tHeight","textBounds","drawState","stateInfo","stateBox","titleRows","boundstmp","heightAdj","generateId","rootDoc","setRootDoc","getRootDoc","docTranslator","first","state1","state2","currentDoc","newNode","docNode","getRootDocV2","extract","addState","newDoc","states","documents","currentDocument","startCnt","endCnt","addDescription","des","getState","getStates","logDocuments","_id1","_id2","_descr","theState","dividerCnt","getDividerId","trimColon","nodeDb","setupNode","altFlag","getDir","nodeData","noteData","groupData","position","arrowType","setupDoc","startId","endId","defaultDir","transformationLog","renderDoc","svgWidth","getLabelWidth","domDocument","edgeFreeDoc","ranker","nodeSep","sub","boxBounds","noteDef","nodeCount","svgElem","dividers","pWidth","pShift","getAttribute","transitionColor","stateLabelColor","background","labelBackgroundColor","transitionLabelColor","tertiaryTextColor","specialStateColor","innerEndBackground","compositeBackground","stateBkg","stateBorder","compositeTitleBackground","altBackground","allItemsProcessed","updateActors","tempActors","people","unique","taskData","pieces","score","peeps","peopleList","journeyDb","drawActorLegend","person","colour","circleData","drawCircle","labelData","LEFT_MARGIN","initGraphics","actorNames","actorPos","actorName","drawTasks","fills","textColours","lastSection","sectionVHeight","taskPos","sectionNumber","drawSection","taskActors","drawTask","faceColor","fillType0","fillType1","fillType2","fillType3","fillType4","fillType5","fillType6","fillType7","actor0","actor1","actor2","actor3","actor4","actor5","d3arc","drawFace","faceData","circleElement","face","smile","startAngle","PI","endAngle","sad","ambivalent","labelMargin","taskCount","graphics","interactionFunctions","func","attachFunctions","LEVELS","fatal","setLogLevel","console","bind","time","initThrowsErrors","parseError","arguments","mermaid","sequenceConfig","callback","Node","ganttConfig","idGeneratior","initIdGeneratior","next","entityDecode","detectInit","svgCode","initialize","contentLoaded","compile","serialize","pkg","classRenderer","classRendererV2","classParser","erRenderer","flowRenderer","flowRendererV2","flowParser","ganttRenderer","ganttParser","gitGraphAst","gitGraphRenderer","infoDb","infoRenderer","pieDb","pieRenderer","requirementParser","requirementRenderer","sequenceParser","sequenceRenderer","stateParser","stateRenderer","stateRendererV2","journeyRenderer","journeyParser","errorRenderer","directiveSanitizer","sanitizeCss","graphInit","reinitialize","graphType","detectType","encodeEntities","innerTxt","isInt","_txt","cb","container","iframe","existingSvg","remove","userStyles","altFontFamily","stylis","selector","rules","style1","sequenceDiagram","svgEl","viewBox","btoa","tmpElementSelector","currentDirective","args","handleDirective","updateRendererConfigs","default","globalReset","classDiagram","stateDiagram","themes","calcThemeVariables","userOverRides","calcColors","errorBkgColor","errorTextColor","baseThemeVariables","darkThemeVariables","defaultThemeVariables","forestThemeVariables","neutralThemeVariables","base","dark","forest","neutral","darken","lighten","adjust","invert","mkBorder","Theme","primaryTextColor","secondaryColor","primaryBorderColor","secondaryBorderColor","tertiaryBorderColor","secondaryTextColor","nodeBkg","defaultLinkColor","taskTextLightColor","compositeBorder","git0","git1","git2","git3","git4","git5","git6","git7","gitInv0","gitInv1","gitInv2","gitInv3","gitInv4","gitInv5","gitInv6","gitInv7","branchLabelColor","gitBranchLabel0","gitBranchLabel1","gitBranchLabel2","gitBranchLabel3","gitBranchLabel4","gitBranchLabel5","gitBranchLabel6","gitBranchLabel7","tagBorder","overrides","updateColors","userOverrides","calculate","rgba","secondBkg","mainContrastColor","darkTextColor","border1","labelBackground","labelColor","col","contrast","critical","curveBasisClosed","curveBasisOpen","curveLinearClosed","curveMonotoneX","curveMonotoneY","curveNatural","curveStep","curveStepAfter","curveStepBefore","d3CurveTypes","directiveWithoutOpen","anyComment","inits","detectDirective","results","commentWithoutDirectives","source","lastIndex","memoize","resolver","cache","defaultCurve","curveName","toUpperCase","arrPaths","fnName","params","distance","pow","traverseEdge","prevPoint","totalDistance","remainingDistance","vectorDistance","distanceRatio","isRelationTypePresent","initialPosition","distanceToCardinalityPoint","angle","atan2","cardinalityPosition","sin","cos","terminalMarkerSize","makeid","characters","charactersLength","floor","clobber","drawSimpleText","joinWith","words","completedLines","nextLine","wordLength","calculateTextWidth","nextLineLength","breakString","hyphenatedStrings","remainingWord","Boolean","currentWord","isLastWord","hyphenCharacter","currentLine","character","lineWidth","currentCharacter","isLastLine","hyphenatedNextLine","calculateTextHeight","fontFamilies","dims","cheight","d3Attrs","d3Elem","attrs","calculateSvgSizeAttrs","Map","deterministic","seed","now","decoder","escape","unescape","arg","stringsearch"],"sourceRoot":""}